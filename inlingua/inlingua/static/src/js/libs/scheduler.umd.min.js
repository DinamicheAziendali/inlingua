/*

Bryntum Scheduler 3.0.0
Copyright(c) 2019 Bryntum AB
https://bryntum.com/contact
https://bryntum.com/license

*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("scheduler",[],t):"object"==typeof exports?exports.scheduler=t():(e.bryntum=e.bryntum||{},e.bryntum.scheduler=t())}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=186)}([function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(132);function i(t,n,o){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(10),i=n(60);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t,n){var r=n(125);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){e.exports=n(28)},function(e,t,n){var r=n(155),i=n(156),o=n(157);e.exports=function(e){return r(e)||i(e)||o()}},function(e,t,n){for(var r=n(15),i=n(58),o=n(44),a=n(32),s=n(52),l=n(73),u=n(33),c=u("iterator"),d=u("toStringTag"),h=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=i(f),v=0;v<g.length;v++){var m,p=g[v],y=f[p],k=a[p],b=k&&k.prototype;if(b&&(b[c]||s(b,c,h),b[d]||s(b,d,p),l[p]=h,y))for(m in r)b[m]||o(b,m,r[m],!0)}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){var r=n(164),i=n(165),o=n(166);e.exports=function(e,t){return r(e)||i(e,t)||o()}},function(e,t,n){"use strict";var r=n(82),i={};i[n(33)("toStringTag")]="z",i+""!="[object z]"&&n(44)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(25);r(r.S+r.F,"Object",{assign:n(120)})},function(e,t,n){var r=n(132),i=n(6);function o(e,t,n,a){return(o="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,o){var a,s=r(e,t);if(s){if((a=Object.getOwnPropertyDescriptor(s,t)).set)return a.set.call(o,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(o,t)){if(!a.writable)return!1;a.value=n,Object.defineProperty(o,t,a)}else i(o,t,n);return!0})(e,t,n,a)}e.exports=function(e,t,n,r,i){if(!o(e,t,n,r||e)&&i)throw new Error("failed to set property");return n}},function(e,t,n){"use strict";var r=n(72),i=n(115),o=n(73),a=n(54);e.exports=n(99)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))}}},function(e,t,n){"use strict";var r=n(32),i=n(45),o=n(36),a=n(25),s=n(44),l=n(64).KEY,u=n(37),c=n(80),d=n(74),h=n(69),f=n(33),g=n(122),v=n(121),m=n(150),p=n(123),y=n(29),k=n(30),b=n(51),w=n(54),S=n(68),C=n(62),E=n(81),x=n(151),D=n(59),T=n(83),R=n(35),M=n(58),F=D.f,_=R.f,A=x.f,I=r.Symbol,L=r.JSON,O=L&&L.stringify,P=f("_hidden"),H=f("toPrimitive"),N={}.propertyIsEnumerable,B=c("symbol-registry"),z=c("symbols"),j=c("op-symbols"),V=Object.prototype,W="function"==typeof I&&!!T.f,G=r.QObject,Y=!G||!G.prototype||!G.prototype.findChild,U=o&&u((function(){return 7!=E(_({},"a",{get:function(){return _(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=F(V,t);r&&delete V[t],_(e,t,n),r&&e!==V&&_(V,t,r)}:_,q=function(e){var t=z[e]=E(I.prototype);return t._k=e,t},$=W&&"symbol"==typeof I.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof I},X=function(e,t,n){return e===V&&X(j,t,n),y(e),t=S(t,!0),y(n),i(z,t)?(n.enumerable?(i(e,P)&&e[P][t]&&(e[P][t]=!1),n=E(n,{enumerable:C(0,!1)})):(i(e,P)||_(e,P,C(1,{})),e[P][t]=!0),U(e,t,n)):_(e,t,n)},K=function(e,t){y(e);for(var n,r=m(t=w(t)),i=0,o=r.length;o>i;)X(e,n=r[i++],t[n]);return e},J=function(e){var t=N.call(this,e=S(e,!0));return!(this===V&&i(z,e)&&!i(j,e))&&(!(t||!i(this,e)||!i(z,e)||i(this,P)&&this[P][e])||t)},Q=function(e,t){if(e=w(e),t=S(t,!0),e!==V||!i(z,t)||i(j,t)){var n=F(e,t);return!n||!i(z,t)||i(e,P)&&e[P][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=A(w(e)),r=[],o=0;n.length>o;)i(z,t=n[o++])||t==P||t==l||r.push(t);return r},ee=function(e){for(var t,n=e===V,r=A(n?j:w(e)),o=[],a=0;r.length>a;)!i(z,t=r[a++])||n&&!i(V,t)||o.push(z[t]);return o};W||(s((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(n){this===V&&t.call(j,n),i(this,P)&&i(this[P],e)&&(this[P][e]=!1),U(this,e,C(1,n))};return o&&Y&&U(V,e,{configurable:!0,set:t}),q(e)}).prototype,"toString",(function(){return this._k})),D.f=Q,R.f=X,n(77).f=x.f=Z,n(76).f=J,T.f=ee,o&&!n(63)&&s(V,"propertyIsEnumerable",J,!0),g.f=function(e){return q(f(e))}),a(a.G+a.W+a.F*!W,{Symbol:I});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)f(te[ne++]);for(var re=M(f.store),ie=0;re.length>ie;)v(re[ie++]);a(a.S+a.F*!W,"Symbol",{for:function(e){return i(B,e+="")?B[e]:B[e]=I(e)},keyFor:function(e){if(!$(e))throw TypeError(e+" is not a symbol!");for(var t in B)if(B[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),a(a.S+a.F*!W,"Object",{create:function(e,t){return void 0===t?E(e):K(E(e),t)},defineProperty:X,defineProperties:K,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var oe=u((function(){T.f(1)}));a(a.S+a.F*oe,"Object",{getOwnPropertySymbols:function(e){return T.f(b(e))}}),L&&a(a.S+a.F*(!W||u((function(){var e=I();return"[null]"!=O([e])||"{}"!=O({a:e})||"{}"!=O(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(k(t)||void 0!==e)&&!$(e))return p(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!$(t))return t}),r[1]=t,O.apply(L,r)}}),I.prototype[H]||n(52)(I.prototype,H,I.prototype.valueOf),d(I,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},function(e,t,n){n(121)("asyncIterator")},function(e,t,n){var r=n(35).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(36)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}},function(e,t,n){"use strict";var r=n(25),i=n(113)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(72)("includes")},function(e,t,n){"use strict";var r=n(25),i=n(96);r(r.P+r.F*n(98)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(124)(!0);n(99)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(25),i=n(92)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(72)("find")},function(e,t,n){var r=n(32),i=n(56),o=n(52),a=n(44),s=n(53),l=function(e,t,n){var u,c,d,h,f=e&l.F,g=e&l.G,v=e&l.S,m=e&l.P,p=e&l.B,y=g?r:v?r[t]||(r[t]={}):(r[t]||{}).prototype,k=g?i:i[t]||(i[t]={}),b=k.prototype||(k.prototype={});for(u in g&&(n=t),n)d=((c=!f&&y&&void 0!==y[u])?y:n)[u],h=p&&c?s(d,r):m&&"function"==typeof d?s(Function.call,d):d,y&&a(y,u,d,e&l.U),k[u]!=d&&o(k,u,h),m&&b[u]!=d&&(b[u]=d)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(51),i=n(58);n(75)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){"use strict";var r,i,o,a,s=n(63),l=n(32),u=n(53),c=n(82),d=n(25),h=n(30),f=n(70),g=n(88),v=n(89),m=n(129),p=n(130).set,y=n(161)(),k=n(131),b=n(162),w=n(108),S=n(163),C=l.TypeError,E=l.process,x=E&&E.versions,D=x&&x.v8||"",T=l.Promise,R="process"==c(E),M=function(){},F=i=k.f,_=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[n(33)("species")]=function(e){e(M,M)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(M)instanceof t&&0!==D.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),A=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},I=function(e,t){if(!e._n){e._n=!0;var n=e._c;y((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{s?(i||(2==e._h&&P(e),e._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),a=!0)),n===t.promise?u(C("Promise-chain cycle")):(o=A(n))?o.call(n,l,u):l(n)):u(r)}catch(e){c&&!a&&c.exit(),u(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&L(e)}))}},L=function(e){p.call(l,(function(){var t,n,r,i=e._v,o=O(e);if(o&&(t=b((function(){R?E.emit("unhandledRejection",i,e):(n=l.onunhandledrejection)?n({promise:e,reason:i}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=R||O(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},O=function(e){return 1!==e._h&&0===(e._a||e._c).length},P=function(e){p.call(l,(function(){var t;R?E.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},H=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),I(t,!0))},N=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw C("Promise can't be resolved itself");(t=A(e))?y((function(){var r={_w:n,_d:!1};try{t.call(e,u(N,r,1),u(H,r,1))}catch(e){H.call(r,e)}})):(n._v=e,n._s=1,I(n,!1))}catch(e){H.call({_w:n,_d:!1},e)}}};_||(T=function(e){g(this,T,"Promise","_h"),f(e),r.call(this);try{e(u(N,this,1),u(H,this,1))}catch(e){H.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(90)(T.prototype,{then:function(e,t){var n=F(m(this,T));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=R?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&I(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(N,e,1),this.reject=u(H,e,1)},k.f=F=function(e){return e===T||e===a?new o(e):i(e)}),d(d.G+d.W+d.F*!_,{Promise:T}),n(74)(T,"Promise"),n(105)("Promise"),a=n(56).Promise,d(d.S+d.F*!_,"Promise",{reject:function(e){var t=F(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!_),"Promise",{resolve:function(e){return S(s&&this===a?T:this,e)}}),d(d.S+d.F*!(_&&n(109)((function(e){T.all(e).catch(M)}))),"Promise",{all:function(e){var t=this,n=F(t),r=n.resolve,i=n.reject,o=b((function(){var n=[],o=0,a=1;v(e,!1,(function(e){var s=o++,l=!1;n.push(void 0),a++,t.resolve(e).then((function(e){l||(l=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=F(t),r=n.reject,i=b((function(){v(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),a=new T(r||[]);return o._invoke=function(e,t,n){var r=c;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return M()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var l=u(e,t,n);if("normal"===l.type){if(r=n.done?f:d,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=f,n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var c="suspendedStart",d="suspendedYield",h="executing",f="completed",g={};function v(){}function m(){}function p(){}var y={};y[o]=function(){return this};var k=Object.getPrototypeOf,b=k&&k(k(R([])));b&&b!==n&&r.call(b,o)&&(y=b);var w=p.prototype=v.prototype=Object.create(y);function S(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(e){var t;this._invoke=function(n,i){function o(){return new Promise((function(t,o){!function t(n,i,o,a){var s=u(e[n],e,i);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,o,a)}),(function(e){t("throw",e,o,a)})):Promise.resolve(c).then((function(e){l.value=e,o(l)}),(function(e){return t("throw",e,o,a)}))}a(s.arg)}(n,i,t,o)}))}return t=t?t.then(o,o):o()}}function E(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=u(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function R(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:M}}function M(){return{value:t,done:!0}}return m.prototype=w.constructor=p,p.constructor=m,p[s]=m.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},S(C.prototype),C.prototype[a]=function(){return this},e.AsyncIterator=C,e.async=function(t,n,r,i){var o=new C(l(t,n,r,i));return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(w),w[s]="Generator",w[o]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;D(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){var r=n(30);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";var r=n(29),i=n(51),o=n(46),a=n(71),s=n(106),l=n(86),u=Math.max,c=Math.min,d=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g;n(87)("replace",2,(function(e,t,n,g){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=g(n,e,this,t);if(i.done)return i.value;var d=r(e),h=String(this),f="function"==typeof t;f||(t=String(t));var m=d.global;if(m){var p=d.unicode;d.lastIndex=0}for(var y=[];;){var k=l(d,h);if(null===k)break;if(y.push(k),!m)break;""===String(k[0])&&(d.lastIndex=s(h,o(d.lastIndex),p))}for(var b,w="",S=0,C=0;C<y.length;C++){k=y[C];for(var E=String(k[0]),x=u(c(a(k.index),h.length),0),D=[],T=1;T<k.length;T++)D.push(void 0===(b=k[T])?b:String(b));var R=k.groups;if(f){var M=[E].concat(D,x,h);void 0!==R&&M.push(R);var F=String(t.apply(void 0,M))}else F=v(E,h,x,D,R,t);x>=S&&(w+=h.slice(S,x)+F,S=x+E.length)}return w+h.slice(S)}];function v(e,t,r,o,a,s){var l=r+e.length,u=o.length,c=f;return void 0!==a&&(a=i(a),c=h),n.call(s,c,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(l);case"<":s=a[i.slice(1,-1)];break;default:var c=+i;if(0===c)return n;if(c>u){var h=d(c/10);return 0===h?n:h<=u?void 0===o[h-1]?i.charAt(1):o[h-1]+i.charAt(1):n}s=o[c-1]}return void 0===s?"":s}))}}))},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(80)("wks"),i=n(69),o=n(32).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){var r=n(25),i=n(135)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){var r=n(29),i=n(112),o=n(68),a=Object.defineProperty;t.f=n(36)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(37)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var r=n(97),i=n(29),o=n(129),a=n(106),s=n(46),l=n(86),u=n(107),c=n(37),d=Math.min,h=[].push,f=!c((function(){RegExp(4294967295,"y")}));n(87)("split",2,(function(e,t,n,c){var g;return g="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=void 0===t?4294967295:t>>>0,g=new RegExp(e.source,c+"g");(o=u.call(g,i))&&!((a=g.lastIndex)>d&&(l.push(i.slice(d,o.index)),o.length>1&&o.index<i.length&&h.apply(l,o.slice(1)),s=o[0].length,d=a,l.length>=f));)g.lastIndex===o.index&&g.lastIndex++;return d===i.length?!s&&g.test("")||l.push(""):l.push(i.slice(d)),l.length>f?l.slice(0,f):l}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):g.call(String(i),n,r)},function(e,t){var r=c(g,e,this,t,g!==n);if(r.done)return r.value;var u=i(e),h=String(this),v=o(u,RegExp),m=u.unicode,p=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(f?"y":"g"),y=new v(f?u:"^(?:"+u.source+")",p),k=void 0===t?4294967295:t>>>0;if(0===k)return[];if(0===h.length)return null===l(y,h)?[h]:[];for(var b=0,w=0,S=[];w<h.length;){y.lastIndex=f?w:0;var C,E=l(y,f?h:h.slice(w));if(null===E||(C=d(s(y.lastIndex+(f?0:w)),h.length))===b)w=a(h,w,m);else{if(S.push(h.slice(b,w)),S.length===k)return S;for(var x=1;x<=E.length-1;x++)if(S.push(E[x]),S.length===k)return S;w=b=C}}return S.push(h.slice(b)),S}]}))},function(e,t,n){var r=n(25),i=n(135)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(53),i=n(25),o=n(51),a=n(126),s=n(127),l=n(46),u=n(134),c=n(128);i(i.S+i.F*!n(109)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,d,h=o(e),f="function"==typeof this?this:Array,g=arguments.length,v=g>1?arguments[1]:void 0,m=void 0!==v,p=0,y=c(h);if(m&&(v=r(v,g>2?arguments[2]:void 0,2)),null==y||f==Array&&s(y))for(n=new f(t=l(h.length));t>p;p++)u(n,p,m?v(h[p],p):h[p]);else for(d=y.call(h),n=new f;!(i=d.next()).done;p++)u(n,p,m?a(d,v,[i.value,p],!0):i.value);return n.length=p,n}})},function(e,t,n){"use strict";var r=n(25),i=n(46),o=n(96),a="".startsWith;r(r.P+r.F*n(98)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(154);var r=n(29),i=n(85),o=n(36),a=/./.toString,s=function(e){n(44)(RegExp.prototype,"toString",e,!0)};n(37)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?s((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):"toString"!=a.name&&s((function(){return a.call(this)}))},function(e,t,n){"use strict";var r=n(25),i=n(92)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(72)(o)},function(e,t,n){var r=n(32),i=n(52),o=n(45),a=n(69)("src"),s=n(147),l=(""+s).split("toString");n(56).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(71),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){"use strict";var r=n(133),i=n(65);e.exports=n(110)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){var r=n(30),i=n(64).onFreeze;n(75)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){"use strict";var r=n(133),i=n(65);e.exports=n(110)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(50);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(35),i=n(62);e.exports=n(36)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(70);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(95),i=n(50);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";var r=n(32),i=n(45),o=n(57),a=n(104),s=n(68),l=n(37),u=n(77).f,c=n(59).f,d=n(35).f,h=n(158).trim,f=r.Number,g=f,v=f.prototype,m="Number"==o(n(81)(v)),p="trim"in String.prototype,y=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,o=(t=p?t.trim():h(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var a,l=t.slice(2),u=0,c=l.length;u<c;u++)if((a=l.charCodeAt(u))<48||a>i)return NaN;return parseInt(l,r)}}return+t};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof f&&(m?l((function(){v.valueOf.call(n)})):"Number"!=o(n))?a(new g(y(t)),n,f):y(t)};for(var k,b=n(36)?u(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;b.length>w;w++)i(g,k=b[w])&&!i(f,k)&&d(f,k,c(g,k));f.prototype=v,v.constructor=f,n(44)(r,"Number",f)}},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(116),i=n(101);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(76),i=n(62),o=n(54),a=n(68),s=n(45),l=n(112),u=Object.getOwnPropertyDescriptor;t.f=n(36)?u:function(e,t){if(e=o(e),t=a(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var r=n(143);e.exports=function(e){return new r(e)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=!1},function(e,t,n){var r=n(69)("meta"),i=n(30),o=n(45),a=n(35).f,s=0,l=Object.isExtensible||function(){return!0},u=!n(37)((function(){return l(Object.preventExtensions({}))})),c=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},d=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[r].w},onFreeze:function(e){return u&&d.NEED&&l(e)&&!o(e,r)&&c(e),e}}},function(e,t,n){var r=n(30);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){var r=n(125);function i(t,n,o){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?e.exports=i=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o}:e.exports=i=Reflect.construct,i.apply(null,arguments)}e.exports=i},function(e,t,n){var r=n(178);e.exports=function(e){return function(){return new r(e.apply(this,arguments))}}},function(e,t,n){var r=n(30);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(33)("unscopables"),i=Array.prototype;null==i[r]&&n(52)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t){e.exports={}},function(e,t,n){var r=n(35).f,i=n(45),o=n(33)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(25),i=n(56),o=n(37);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(116),i=n(101).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(25),i=n(46),o=n(96),a="".endsWith;r(r.P+r.F*n(98)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),s=void 0===n?r:Math.min(i(n),r),l=String(e);return a?a.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,n){"use strict";n(168)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,n){var r=n(56),i=n(32),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(63)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(29),i=n(149),o=n(101),a=n(100)("IE_PROTO"),s=function(){},l=function(){var e,t=n(94)("iframe"),r=o.length;for(t.style.display="none",n(117).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[o[r]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(57),i=n(33)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(32),i=n(104),o=n(35).f,a=n(77).f,s=n(97),l=n(85),u=r.RegExp,c=u,d=u.prototype,h=/a/g,f=/a/g,g=new u(h)!==h;if(n(36)&&(!g||n(37)((function(){return f[n(33)("match")]=!1,u(h)!=h||u(f)==f||"/a/i"!=u(h,"i")})))){u=function(e,t){var n=this instanceof u,r=s(e),o=void 0===t;return!n&&r&&e.constructor===u&&o?e:i(g?new c(r&&!o?e.source:e,t):c((r=e instanceof u)?e.source:e,r&&o?l.call(e):t),n?this:d,u)};for(var v=function(e){e in u||o(u,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},m=a(c),p=0;m.length>p;)v(m[p++]);d.constructor=u,u.prototype=d,n(44)(r,"RegExp",u)}n(105)("RegExp")},function(e,t,n){"use strict";var r=n(29);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(82),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(153);var r=n(44),i=n(52),o=n(37),a=n(50),s=n(33),l=n(107),u=s("species"),c=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var h=s(e),f=!o((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),g=f?!o((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[u]=function(){return n}),n[h](""),!t})):void 0;if(!f||!g||"replace"===e&&!c||"split"===e&&!d){var v=/./[h],m=n(a,h,""[e],(function(e,t,n,r,i){return t.exec===l?f&&!i?{done:!0,value:v.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),p=m[0],y=m[1];r(String.prototype,e,p),i(RegExp.prototype,h,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(53),i=n(126),o=n(127),a=n(29),s=n(46),l=n(128),u={},c={};(t=e.exports=function(e,t,n,d,h){var f,g,v,m,p=h?function(){return e}:l(e),y=r(n,d,t?2:1),k=0;if("function"!=typeof p)throw TypeError(e+" is not iterable!");if(o(p)){for(f=s(e.length);f>k;k++)if((m=t?y(a(g=e[k])[0],g[1]):y(e[k]))===u||m===c)return m}else for(v=p.call(e);!(g=v.next()).done;)if((m=i(v,y,g.value,t))===u||m===c)return m}).BREAK=u,t.RETURN=c},function(e,t,n){var r=n(44);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r=n(29),i=n(46),o=n(106),a=n(86);n(87)("match",1,(function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var l=r(e),u=String(this);if(!l.global)return a(l,u);var c=l.unicode;l.lastIndex=0;for(var d,h=[],f=0;null!==(d=a(l,u));){var g=String(d[0]);h[f]=g,""===g&&(l.lastIndex=o(u,i(l.lastIndex),c)),f++}return 0===f?null:h}]}))},function(e,t,n){var r=n(53),i=n(95),o=n(51),a=n(46),s=n(172);e.exports=function(e,t){var n=1==e,l=2==e,u=3==e,c=4==e,d=6==e,h=5==e||d,f=t||s;return function(t,s,g){for(var v,m,p=o(t),y=i(p),k=r(s,g,3),b=a(y.length),w=0,S=n?f(t,b):l?f(t,0):void 0;b>w;w++)if((h||w in y)&&(m=k(v=y[w],w,p),e))if(n)S[w]=m;else if(m)switch(e){case 3:return!0;case 5:return v;case 6:return w;case 2:S.push(v)}else if(c)return!1;return d?-1:u||c?c:S}}},function(e,t,n){var r=n(25);r(r.P,"String",{repeat:n(137)})},function(e,t,n){var r=n(30),i=n(32).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(57);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(97),i=n(50);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(30),i=n(57),o=n(33)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(33)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){"use strict";var r=n(63),i=n(25),o=n(44),a=n(52),s=n(73),l=n(148),u=n(74),c=n(102),d=n(33)("iterator"),h=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,g,v,m,p){l(n,t,g);var y,k,b,w=function(e){if(!h&&e in x)return x[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",C="values"==v,E=!1,x=e.prototype,D=x[d]||x["@@iterator"]||v&&x[v],T=D||w(v),R=v?C?w("entries"):T:void 0,M="Array"==t&&x.entries||D;if(M&&(b=c(M.call(new e)))!==Object.prototype&&b.next&&(u(b,S,!0),r||"function"==typeof b[d]||a(b,d,f)),C&&D&&"values"!==D.name&&(E=!0,T=function(){return D.call(this)}),r&&!p||!h&&!E&&x[d]||a(x,d,T),s[t]=T,s[S]=f,v)if(y={values:C?T:w("values"),keys:m?T:w("keys"),entries:R},p)for(k in y)k in x||o(x,k,y[k]);else i(i.P+i.F*(h||E),t,y);return y}},function(e,t,n){var r=n(80)("keys"),i=n(69);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(45),i=n(51),o=n(100)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(35),i=n(25),o=n(29),a=n(68);i(i.S+i.F*n(37)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){o(e),t=a(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(30),i=n(152).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){"use strict";var r=n(32),i=n(35),o=n(36),a=n(33)("species");e.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(124)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){"use strict";var r,i,o=n(85),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,u=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),c=void 0!==/()??/.exec("")[1];(u||c)&&(l=function(e){var t,n,r,i,l=this;return c&&(n=new RegExp("^"+l.source+"$(?!\\s)",o.call(l))),u&&(t=l.lastIndex),r=a.call(l,e),u&&r&&(l.lastIndex=l.global?r.index+r[0].length:t),c&&r&&r.length>1&&s.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=l},function(e,t,n){var r=n(32).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(33)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(32),i=n(25),o=n(44),a=n(90),s=n(64),l=n(89),u=n(88),c=n(30),d=n(37),h=n(109),f=n(74),g=n(104);e.exports=function(e,t,n,v,m,p){var y=r[e],k=y,b=m?"set":"add",w=k&&k.prototype,S={},C=function(e){var t=w[e];o(w,e,"delete"==e?function(e){return!(p&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(p&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return p&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof k&&(p||w.forEach&&!d((function(){(new k).entries().next()})))){var E=new k,x=E[b](p?{}:-0,1)!=E,D=d((function(){E.has(1)})),T=h((function(e){new k(e)})),R=!p&&d((function(){for(var e=new k,t=5;t--;)e[b](t,t);return!e.has(-0)}));T||((k=t((function(t,n){u(t,k,e);var r=g(new y,t,k);return null!=n&&l(n,m,r[b],r),r}))).prototype=w,w.constructor=k),(D||R)&&(C("delete"),C("has"),m&&C("get")),(R||x)&&C(b),p&&w.clear&&delete w.clear}else k=v.getConstructor(t,e,m,b),a(k.prototype,n),s.NEED=!0;return f(k,e),S[e]=k,i(i.G+i.W+i.F*(k!=y),S),p||v.setStrong(k,e,m),k}},function(e,t,n){"use strict";var r=n(29),i=n(167),o=n(86);n(87)("search",1,(function(e,t,n,a){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=a(n,e,this);if(t.done)return t.value;var s=r(e),l=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var c=o(s,l);return i(s.lastIndex,u)||(s.lastIndex=u),null===c?-1:c.index}]}))},function(e,t,n){e.exports=!n(36)&&!n(37)((function(){return 7!=Object.defineProperty(n(94)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(54),i=n(46),o=n(114);e.exports=function(e){return function(t,n,a){var s,l=r(t),u=i(l.length),c=o(a,u);if(e&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(71),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(45),i=n(54),o=n(113)(!1),a=n(100)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(32).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(30);n(75)("isFrozen",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(59),i=n(25),o=n(29);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},function(e,t,n){"use strict";var r=n(36),i=n(58),o=n(83),a=n(76),s=n(51),l=n(95),u=Object.assign;e.exports=!u||n(37)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r}))?function(e,t){for(var n=s(e),u=arguments.length,c=1,d=o.f,h=a.f;u>c;)for(var f,g=l(arguments[c++]),v=d?i(g).concat(d(g)):i(g),m=v.length,p=0;m>p;)f=v[p++],r&&!h.call(g,f)||(n[f]=g[f]);return n}:u},function(e,t,n){var r=n(32),i=n(56),o=n(63),a=n(122),s=n(35).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){t.f=n(33)},function(e,t,n){var r=n(57);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(71),i=n(50);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){var r=n(29);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(73),i=n(33)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(82),i=n(33)("iterator"),o=n(73);e.exports=n(56).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(29),i=n(70),o=n(33)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},function(e,t,n){var r,i,o,a=n(53),s=n(160),l=n(117),u=n(94),c=n(32),d=c.process,h=c.setImmediate,f=c.clearImmediate,g=c.MessageChannel,v=c.Dispatch,m=0,p={},y=function(){var e=+this;if(p.hasOwnProperty(e)){var t=p[e];delete p[e],t()}},k=function(e){y.call(e.data)};h&&f||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return p[++m]=function(){s("function"==typeof e?e:Function(e),t)},r(m),m},f=function(e){delete p[e]},"process"==n(57)(d)?r=function(e){d.nextTick(a(y,e,1))}:v&&v.now?r=function(e){v.now(a(y,e,1))}:g?(o=(i=new g).port2,i.port1.onmessage=k,r=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",k,!1)):r="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:h,clear:f}},function(e,t,n){"use strict";var r=n(70);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(0);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t,n){"use strict";var r=n(35).f,i=n(81),o=n(90),a=n(53),s=n(88),l=n(89),u=n(99),c=n(115),d=n(105),h=n(36),f=n(64).fastKey,g=n(65),v=h?"_s":"size",m=function(e,t){var n,r=f(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var c=e((function(e,r){s(e,c,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[v]=0,null!=r&&l(r,n,e[u],e)}));return o(c.prototype,{clear:function(){for(var e=g(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var n=g(this,t),r=m(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[v]--}return!!r},forEach:function(e){g(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(g(this,t),e)}}),h&&r(c.prototype,"size",{get:function(){return g(this,t)[v]}}),c},def:function(e,t,n){var r,i,o=m(e,t);return o?o.v=n:(e._l=o={i:i=f(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[v]++,"F"!==i&&(e._i[i]=o)),e},getEntry:m,setStrong:function(e,t,n){u(e,t,(function(e,n){this._t=g(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))}),n?"entries":"values",!n,!0),d(t)}}},function(e,t,n){"use strict";var r=n(35),i=n(62);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(36),i=n(58),o=n(54),a=n(76).f;e.exports=function(e){return function(t){for(var n,s=o(t),l=i(s),u=l.length,c=0,d=[];u>c;)n=l[c++],r&&!a.call(s,n)||d.push(e?[n,s[n]]:s[n]);return d}}},function(e,t,n){var r=n(46),i=n(137),o=n(50);e.exports=function(e,t,n,a){var s=String(o(e)),l=s.length,u=void 0===n?" ":String(n),c=r(t);if(c<=l||""==u)return s;var d=c-l,h=i.call(u,Math.ceil(d/u.length));return h.length>d&&(h=h.slice(0,d)),a?h+s:s+h}},function(e,t,n){"use strict";var r=n(71),i=n(50);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){"use strict";var r=n(25),i=n(136),o=n(108),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){var r=n(30);n(75)("isExtensible",(function(e){return function(t){return!!r(t)&&(!e||e(t))}}))},function(e,t,n){var r=n(25);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(25);r(r.S,"Reflect",{ownKeys:n(142)})},function(e,t,n){var r=n(77),i=n(83),o=n(29),a=n(32).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t){e.exports=function(e){this.wrapped=e}},function(e,t,n){var r=n(25);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){(function(r){var i,o;void 0===(o="function"==typeof(i=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}var l=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){var t=this;if(e.type in this.listeners){for(var n=function(n){setTimeout((function(){return n.call(t,e)}))},r=this.listeners[e.type],i=0,o=r.length;i<o;i++)n(r[i]);return!e.defaultPrevented}}}]),t}(),u=function(t){function r(){var t;return e(this,r),(t=function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(e):t}(this,i(r).call(this))).listeners||l.call(a(t)),Object.defineProperty(a(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(a(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,t),n(r,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),s(i(r.prototype),"dispatchEvent",this).call(this,e)}}]),r}(l),c=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new u,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();function d(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(c.prototype[Symbol.toStringTag]="AbortController",u.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(d(e))if(e.fetch){var t=function(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=void 0===r?n.Request:r,o=t.AbortController,a=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==a&&a;if(!d({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:n,Request:l};var l=i;(l&&!l.prototype.hasOwnProperty("signal")||s)&&((l=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var r=new i(e,t);return n&&Object.defineProperty(r,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),r}).prototype=i.prototype);var u=n;return{fetch:function(e,t){var n=l&&l.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var r;try{r=new DOMException("Aborted","AbortError")}catch(e){(r=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(r);var i=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(r)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([i,u(e,t)])}return u(e,t)},Request:l}}(e),n=t.fetch,r=t.Request;e.fetch=n,e.Request=r,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:c}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:u})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:r)})?i.call(t,n,t,e):i)||(e.exports=o)}).call(this,n(146))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){e.exports=n(80)("native-function-to-string",Function.toString)},function(e,t,n){"use strict";var r=n(81),i=n(62),o=n(74),a={};n(52)(a,n(33)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(35),i=n(29),o=n(58);e.exports=n(36)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,l=0;s>l;)r.f(e,n=a[l++],t[n]);return e}},function(e,t,n){var r=n(58),i=n(83),o=n(76);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),l=o.f,u=0;s.length>u;)l.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){var r=n(54),i=n(77).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){var r=n(30),i=n(29),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(53)(Function.call,n(59).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){"use strict";var r=n(107);n(25)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(36)&&"g"!=/./g.flags&&n(35).f(RegExp.prototype,"flags",{configurable:!0,get:n(85)})},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,n){var r=n(25),i=n(50),o=n(37),a=n(159),s="["+a+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()})),l=i[e]=s?t(d):a[e];n&&(i[n]=l),r(r.P+r.F*s,"String",i)},d=c.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=c},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(32),i=n(130).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,l="process"==n(57)(a);e.exports=function(){var e,t,n,u=function(){var r,i;for(l&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(l)n=function(){a.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(u)}}else n=function(){i.call(r,u)};else{var d=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),n=function(){h.data=d=!d}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(29),i=n(30),o=n(131);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(25),i=n(37),o=n(50),a=/"/g,s=function(e,t,n,r){var i=String(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},function(e,t,n){var r=n(25);r(r.S,"Math",{sign:n(170)})},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,n){"use strict";var r=n(25),i=n(136),o=n(108),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){var r=n(173);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(30),i=n(123),o=n(33)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(35),i=n(59),o=n(102),a=n(45),s=n(25),l=n(62),u=n(29),c=n(30);s(s.S,"Reflect",{set:function e(t,n,s){var d,h,f=arguments.length<4?t:arguments[3],g=i.f(u(t),n);if(!g){if(c(h=o(t)))return e(h,n,s,f);g=l(0)}if(a(g,"value")){if(!1===g.writable||!c(f))return!1;if(d=i.f(f,n)){if(d.get||d.set||!1===d.writable)return!1;d.value=s,r.f(f,n,d)}else r.f(f,n,l(0,s));return!0}return void 0!==g.set&&(g.set.call(f,s),!0)}})},function(e,t,n){var r=n(59),i=n(102),o=n(45),a=n(25),s=n(30),l=n(29);a(a.S,"Reflect",{get:function e(t,n){var a,u,c=arguments.length<3?t:arguments[2];return l(t)===c?t[n]:(a=r.f(t,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(u=i(t))?e(u,n,c):void 0}})},function(e,t,n){"use strict";var r,i=n(32),o=n(92)(0),a=n(44),s=n(64),l=n(120),u=n(177),c=n(30),d=n(65),h=n(65),f=!i.ActiveXObject&&"ActiveXObject"in i,g=s.getWeak,v=Object.isExtensible,m=u.ufstore,p=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(c(e)){var t=g(e);return!0===t?m(d(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(d(this,"WeakMap"),e,t)}},k=e.exports=n(110)("WeakMap",p,y,u,!0,!0);h&&f&&(l((r=u.getConstructor(p,"WeakMap")).prototype,y),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=k.prototype,n=t[e];a(t,e,(function(t,i){if(c(t)&&!v(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)}))})))},function(e,t,n){"use strict";var r=n(90),i=n(64).getWeak,o=n(29),a=n(30),s=n(88),l=n(89),u=n(92),c=n(45),d=n(65),h=u(5),f=u(6),g=0,v=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},p=function(e,t){return h(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=p(this,e);if(t)return t[1]},has:function(e){return!!p(this,e)},set:function(e,t){var n=p(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=f(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var u=e((function(e,r){s(e,u,t,"_i"),e._t=t,e._i=g++,e._l=void 0,null!=r&&l(r,n,e[o],e)}));return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=i(e);return!0===n?v(d(this,t)).delete(e):n&&c(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=i(e);return!0===n?v(d(this,t)).has(e):n&&c(n,this._i)}}),u},def:function(e,t,n){var r=i(o(t),!0);return!0===r?v(e).set(t,n):r[e._i]=n,e},ufstore:v}},function(e,t,n){var r=n(143);function i(e){var t,n;function i(t,n){try{var a=e[t](n),s=a.value,l=s instanceof r;Promise.resolve(l?s.wrapped:s).then((function(e){l?i("return"===t?"return":"next",e):o(a.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(i.prototype[Symbol.asyncIterator]=function(){return this}),i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i},function(e,t,n){"use strict";var r=n(25),i=n(51),o=n(70),a=n(35);n(36)&&r(r.P+n(180),"Object",{__defineGetter__:function(e,t){a.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";e.exports=n(63)||!n(37)((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete n(32)[e]}))},function(e,t,n){var r=n(30);n(75)("isSealed",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(25),i=n(142),o=n(54),a=n(59),s=n(134);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),l=a.f,u=i(r),c={},d=0;u.length>d;)void 0!==(n=l(r,t=u[d++]))&&s(c,t,n);return c}})},function(e,t,n){var r=n(25);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(25);r(r.P,"Array",{fill:n(185)}),n(72)("fill")},function(e,t,n){"use strict";var r=n(51),i=n(114),o=n(46);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:i(l,n);u>s;)t[s++]=e;return t}},function(e,t,n){"use strict";n.r(t);var r={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(r.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(e){return e&&i.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r.iterable&&(t[Symbol.iterator]=function(){return t}),t}function u(e){this.map={},e instanceof u?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function h(e){var t=new FileReader,n=d(t);return t.readAsArrayBuffer(e),n}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:r.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r.arrayBuffer&&r.blob&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||o(e))?this._bodyArrayBuffer=f(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e,t,n,r=c(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=d(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(e,t){e=a(e),t=s(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},u.prototype.delete=function(e){delete this.map[a(e)]},u.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},u.prototype.set=function(e,t){this.map[a(e)]=s(t)},u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},u.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),l(e)},u.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),l(e)},u.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),l(e)},r.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(e,t){var n,r,i=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new u(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),v.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function p(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function y(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},g.call(m.prototype),g.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var k=[301,302,303,307,308];y.redirect=function(e,t){if(-1===k.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})};var b=self.DOMException;try{new b}catch(e){(b=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),b.prototype.constructor=b}function w(e,t){return new Promise((function(n,i){var o=new m(e,t);if(o.signal&&o.signal.aborted)return i(new b("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new u,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new y(i,r))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new b("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&r.blob&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",s),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",s)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}w.polyfill=!0,self.fetch||(self.fetch=w,self.Headers=u,self.Request=m,self.Response=y);n(145),n(28),n(19),n(21),n(22),n(9),n(15),n(12),n(26),n(118),n(48),n(103),n(119),n(13),n(41);var S=n(2),C=n.n(S),E=n(3),x=n.n(E),D=(n(18),n(17),n(84),n(31),n(42),/([a-z])([A-Z])/g),T=/[.*+?^${}()|[\]\\]/g,R=/(^[^a-z]+|[^\w]+)/gi,M=function(e,t,n){return t+"-"+n.toLowerCase()},F=function(e){return e?"_x".concat(e.charCodeAt(0).toString(16)):"__blank__"},_={},A=function(){function e(){C()(this,e)}return x()(e,null,[{key:"capitalizeFirstLetter",value:function(e){return e?e[0].toUpperCase()+e.substr(1):null}},{key:"lowercaseFirstLetter",value:function(e){return e?e[0].toLowerCase()+e.substr(1):null}},{key:"hyphenate",value:function(e){var t=_[e];return t||(_[e]=e.replace(D,M))}},{key:"safeJsonParse",value:function(e){var t=null;try{t=JSON.parse(e)}catch(e){console.error(e)}return t}},{key:"safeJsonStringify",value:function(e){var t=null;try{t=JSON.stringify(e)}catch(e){console.error(e)}return t}},{key:"createId",value:function(e){return String(e).replace(R,F)}},{key:"escapeRegExp",value:function(e){return e.replace(T,"\\$&")}},{key:"joinPaths",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}}]),e}();A._$name="StringHelper";var I=function(){function e(){C()(this,e)}return x()(e,null,[{key:"setVersion",value:function(e,t){this[e=e.toLowerCase()]={version:t,isNewerThan:function(e){return e<t},isOlderThan:function(e){return e>t}},window.bryntum||(window.bryntum={});var n="";try{n="scheduler"}catch(e){}var r="".concat(n,".").concat(e).concat(t.replace(/\./g,"-"));if(!0===window.bryntum[r]){if(!window.parent.Siesta)throw new Error("Bundle included twice, check cache-busters and file types (.js)");window.BUNDLE_EXCEPTION=!0}else window.bryntum[r]=!0}},{key:"getVersion",value:function(e){if(!this[e=e.toLowerCase()])throw new Error("No version specified");return this[e].version}}]),e}();I._$name="VersionHelper";var L=Symbol("defaultConfig"),O=Symbol("propertyInitializers"),P=Symbol("classHierarchy"),H=Symbol("configuration"),N=Symbol("originalConfig"),B=Symbol("instanceProperties"),z=function(){function e(){C()(this,e),this.construct.apply(this,arguments),this.afterConstruct()}return x()(e,[{key:"construct",value:function(){null!==(arguments.length<=0?void 0:arguments[0])&&this.configure.apply(this,arguments),this.afterConfigure()}},{key:"destroy",value:function(){var e=this;for(var t in e.isDestroying=!0,e.doDestroy(),Object.setPrototypeOf(this,null),e)delete e[t];delete e[N],e.isDestroyed=!0}},{key:"_thisIsAUsedExpression",value:function(e){}},{key:"startConfigure",value:function(e){}},{key:"finishConfigure",value:function(e){}},{key:"afterConfigure",value:function(){}},{key:"afterConstruct",value:function(){}},{key:"callback",value:function(e,t,n){"this"===t&&(t=this);var r=this.resolveCallback(e,t),i=r.handler,o=r.thisObj;return n?i.apply(o,n):i.call(o)}},{key:"resolveCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e.substr){if(e.startsWith("up."))for(e=e.substr(3),t=this.owner;t&&!t[e];t=t.owner);else e.startsWith("this.")&&(t=this);e=t[e]}return{handler:e,thisObj:t}}},{key:"bindCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e){var n=this.resolveCallback(e,t),r=n.handler,i=n.thisObj;if(r)return r.bind(i)}}},{key:"delay",value:function(e,t){e=this.setTimeout?e:e.bind(this),("number"==typeof t?this.setTimeout||setTimeout:this.requestAnimationFrame||requestAnimationFrame)(e,t)}},{key:"doDestroy",value:function(){}},{key:"destroyProperties",value:function(){for(var e,t,n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var a=0,s=i;a<s.length;a++)!((e=s[a])in n)||n[H]&&n[H][e]||((t=n[e])&&t.destroy&&t.destroy(),delete n[e])}},{key:"configure",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;n.initialConfig=t,n.isConfiguring=!0,Object.assign(n,n.getProperties()),n.setConfig(n[N]=e.assign(n.getDefaultConfiguration(),t),!0),n.isConfiguring=!1}},{key:"setConfig",value:function(t,n){var r,i,o=this,a=o[H],s=a?o.configDone:o.configDone={},l=o[B]={};for(r in o[H]=a?Object.setPrototypeOf(Object.assign({},t),a):t,t)null!=t[r]||t.hasOwnProperty(r)?(l[r]||!(i=Reflect.getOwnPropertyDescriptor(o,r))||"value"in i||(l[r]=i),Reflect.defineProperty(o,r,e.createPropInitializer(r)),n||(s[r]=!1)):s[r]=!0;for(r in n&&o.startConfigure(t),t)s[r]||(o[r]=t[r]);a?o[H]=a:delete o[H],n&&o.finishConfigure(t)}},{key:"getDefaultConfiguration",value:function(){return this.constructor.getDefaultConfiguration()}},{key:"getProperties",value:function(){var e,t,n=this.classHierarchy(),r=n.length,i={};for(e=0;e<r;e++)(t=n[e]).hasOwnProperty("properties")&&Object.assign(i,t.properties);return i}},{key:"classHierarchy",value:function(t){var n,r=this.constructor,i=r.hasOwnProperty(P)?r[P]:null;if(!i){for(i=r[P]=[];r!==e;r=Object.getPrototypeOf(r))i.unshift(r);Object.freeze(i)}if(t)for(var o=0;!n&&o<i.length;o++)i[o]===t&&(n=i.slice(o));else n=i;return n}},{key:"classNameHierarchy",value:function(e){return this.classHierarchy(e).map((function(e){return e.$name}))}},{key:"detachListeners",value:function(e){var t=this.$detachers;if(t=t&&t[e])for(;t.length;)t.pop()()}},{key:"trackDetacher",value:function(e,t){var n=this.$detachers||(this.$detachers={});(n[e]||(n[e]=[])).push(t)}},{key:"untrackDetachers",value:function(e){var t=this.$detachers;if(t)for(var n in t)for(var r=t[n],i=r.length;i-- >0;)r[i].eventer===e&&r.splice(i,1)}},{key:"$name",get:function(){return this.constructor.$name}},{key:"config",get:function(){var e,t={},n=this[N];for(e in n)t[e]=n[e];return t}}],[{key:"destroy",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e&&e.destroy&&!e.isDestroyed&&e.destroy()}))}},{key:"getDefaultConfiguration",value:function(){var e=this.getConfigDescriptor();return e.needsFork?this.fork(e.defaultConfig):Object.setPrototypeOf({},e.defaultConfig)}},{key:"getConfigDescriptor",value:function(t){var n,r,i,o,a,s=this,l=!t&&s.hasOwnProperty(L)?s[L]:null;if(!l){for(r in l={defaultConfig:n=s.hasOwnProperty("defaultConfig")?s.defaultConfig:{},needsFork:0},t||(s[L]=l),n)if((o=n[r])&&(o.constructor===Object||Array.isArray(o))&&!Object.isFrozen(o)){l.needsFork=1;break}if(!t)for(i=s.superclass;i&&i!==e;i=i.superclass)a=i.getConfigDescriptor(!0),Object.keys(a.defaultConfig).length&&(l.needsFork|=a.needsFork,Object.setPrototypeOf(n,n=a.defaultConfig))}return l}},{key:"fork",value:function(e){var t,n,r;if(e&&e.constructor===Object&&!Object.isFrozen(e))for(n in t=Object.setPrototypeOf({},e),e)(r=e[n])&&(r.constructor===Object?t[n]=this.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}},{key:"assign",value:function(e){for(var t,n,r=0,i=arguments.length<=1?0:arguments.length-1;r<i;r++)for(n in t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])e[n]=t[n];return e}},{key:"createPropInitializer",value:function(e){var t=(this[O]||(this[O]={}))[e];if(!t){var n="initializing"+A.capitalizeFirstLetter(e);t=this[O][e]={configurable:!0,get:function(){var t=this,r=t[B][e];return r?Reflect.defineProperty(t,e,r):delete t[e],t[n]=!0,t[e]=t[H][e],t[n]=!1,t.configDone[e]=!0,t[e]},set:function(t){var n=this,r=n[B][e];r?Reflect.defineProperty(n,e,r):delete n[e],n.configDone[e]=!0,n[e]=t}}}return t}},{key:"isOfTypeName",value:function(e){return this.classNameHierarchy().includes(e)}},{key:"$name",get:function(){return this.hasOwnProperty("_$name")&&this._$name||this.name}},{key:"superclass",get:function(){return Object.getPrototypeOf(this)}}]),e}();Object.assign(z.prototype,{$detachers:null}),I.setVersion("core","0.0.0"),z._$name="Base";var j=n(66),V=n.n(j),W=n(8),G=n.n(W),Y=(n(55),n(10)),U=n.n(Y),q=n(6),$=n.n(q),X=function(){function e(){C()(this,e)}return x()(e,null,[{key:"register",value:function(e,t){var n=J[t];e=e.toLowerCase(),K[e]=t,n?n[e]=1:J[t]=$()({},e,1)}},{key:"getClass",value:function(e){return K[e.toLowerCase()]}},{key:"isType",value:function(e,t,n){t=t.toLowerCase();for(var r=e.constructor;r;r=n&&Object.getPrototypeOf(r)){var i=r.hasOwnProperty("$name")?r.$name:r.name,o=J[r]||i&&(J[r]=$()({},i.toLowerCase(),1));if(o&&o[t])return!0}}},{key:"createWidget",value:function(e,t){var n=this.getClass(e||"widget");return n?new n(t):null}}]),e}(),K=X.widgetRegister={},J=X.widgetClassRegister={};X._$name="BryntumWidgetAdapterRegister";function Q(e,t){for(var n=e.classHierarchy(),r=0;r<n.length;r++)if(n[r].$name.toLowerCase()===t)return!0;return!1}var Z=function(){function e(){C()(this,e)}return x()(e,null,[{key:"generateId",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generatedId";return t+ ++e.idCounter}},{key:"register",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t.id;if(null==r&&(r=t.id=e.generateId(n),t.hasGeneratedId=!0),r in e.idMap&&!this.disableThrow)throw new Error("Id "+r+" already in use");e.idMap[r]=t}},{key:"unregister",value:function(t){e.idMap[t.id]===t&&delete e.idMap[t.id]}},{key:"get",value:function(t){return e.idMap[t]}},{key:"query",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.idMap;for(var i in r)if(ee(r[i],t,n))return r[i];return null}},{key:"queryAll",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.idMap,i=[];for(var o in r)ee(r[o],t,n)&&i.push(r[o]);return i}},{key:"fromElement",value:function(t,n,r){var i=U()(n);t&&t instanceof Event&&(t=t.target),("number"===i||n&&1===n.nodeType)&&(r=n,n=null);var o,a,s,l=t,u=e.idMap,c=0;for("number"!=typeof r&&(o=r,r=Number.MAX_VALUE),"string"===i&&(n=n.toLowerCase());l&&1===l.nodeType&&c<r&&l!==o;){if(a=l.dataset&&l.dataset.ownerCmp||l.id){if(s=u[a]){if(!n)return s;if("function"===i){if(n(s))return s}else if(ee(s,n)||Q(s,n))return s}c++}l=l.parentNode}return null}}]),e}();function ee(e,t,n){return"*"===t||("function"==typeof t?t(e):X.isType(e,t,n))}Z.idCounter=0,Z.idMap={},(window.bryntum||(window.bryntum={})).get=Z.get,window.bryntum.IdHelper=Z,window.bryntum.query=Z.query,window.bryntum.queryAll=Z.queryAll,window.bryntum.fromElement=Z.fromElement,Z._$name="IdHelper";var te=function(){function e(){C()(this,e)}return x()(e,null,[{key:"getById",value:function(e){return Z.get(e)}},{key:"fromElement",value:function(e,t,n){return Z.fromElement(e,t,n)}},{key:"createWidget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.adapter.createWidget(e)}},{key:"append",value:function(e,t){if(e=Array.isArray(e)&&e||[e],(t instanceof HTMLElement||"string"==typeof t)&&(t={appendTo:t}),t.insertFirst){var n="string"==typeof t.insertFirst?document.getElementById(t.insertFirst):t.insertFirst;n.firstChild?t.insertBefore=n.firstChild:t.appendTo=n}return this.adapter.appendWidgets(e,t)}},{key:"openPopup",value:function(e,t){return this.adapter.openPopup(e,t)}},{key:"showContextMenu",value:function(e,t){return this.adapter.showContextMenu(e,t)}},{key:"attachTooltip",value:function(e,t){return this.adapter.attachTooltip(e,t)}},{key:"hasTooltipAttached",value:function(e){return this.adapter.hasTooltipAttached(e)}},{key:"destroyTooltipAttached",value:function(e){return this.adapter.destroyTooltipAttached(e)}},{key:"mask",value:function(e,t){return this.adapter.mask(e,t)}},{key:"unmask",value:function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.adapter.unmask(e)}},{key:"toast",value:function(e){this.adapter.toast(e)}},{key:"adapter",set:function(e){this._adapter=new e},get:function(){if(!this._adapter)throw new Error("Widget adapter is required. Please import BryntumWidgetAdapter class. See docs here: https://www.bryntum.com/docs/grid/#Core/adapter/widget/BryntumWidgetAdapter");return this._adapter}},{key:"hasAdapter",get:function(){return!!this._adapter}},{key:"defaultStyle",set:function(e){this.adapter.defaultStyle=e},get:function(){return this.adapter.defaultStyle}}]),e}();te._$name="WidgetHelper";n(27),n(78);var ne=n(4),re=n.n(ne),ie=n(0),oe=n.n(ie),ae=n(1),se=n.n(ae),le=n(5),ue=n.n(le),ce=(n(49),n(23),n(47),window.parent&&window.parent.Siesta?window.bryntum.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,isEmpty:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ce.timeouts.size+ce.animationFrames.size+(e?ce.intervals.size:0)===0}}:null),de=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){var e=this;e.timeoutIds&&(e.timeoutIds.forEach((function(e,t){"function"==typeof e&&e(),clearTimeout(t),ce&&ce.timeouts.delete(t)})),e.timeoutIds=null),e.timeoutMap&&(e.timeoutMap.forEach((function(e,t){return clearTimeout(t)})),e.timeoutMap=null),e.intervalIds&&(e.intervalIds.forEach((function(e){clearInterval(e),ce&&ce.intervals.delete(e)})),e.intervalIds=null),e.animationFrameIds&&(e.animationFrameIds.forEach((function(e){cancelAnimationFrame(e),ce&&ce.animationFrames.delete(e)})),e.animationFrameIds=null),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"hasTimeout",value:function(e){return!(!this.timeoutMap||!this.timeoutMap.has(e))}},{key:"setTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.fn,n=e.delay,r=e.name,i=e.runOnDestroy,o=e.cancelOutstanding,a=e.args;if(arguments.length>1||"function"==typeof arguments[0]){var s=Array.prototype.slice.call(arguments);t=s[0],n=s[1],r=s[2],i=s[3]}"string"==typeof t?r=t:r||(r=t.name),o&&this.clearTimeout(r);var l=this,u=l.timeoutIds||(l.timeoutIds=new Map),c=l.timeoutMap||(l.timeoutMap=new Map),d=setTimeout((function(){"string"==typeof t&&(t=l[r]),u&&u.delete(d),c&&c.delete(r),ce&&ce.timeouts.delete(d),t.apply(l,a)}),n);return u.set(d,!i||t),ce&&ce.timeouts.set(d,{fn:t,delay:n,name:r}),r&&c.set(r,d),d}))},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e;if("string"==typeof t){if(!this.timeoutMap)return;t=this.timeoutMap.get(e),this.timeoutMap.delete(e)}clearTimeout(t),this.timeoutIds&&this.timeoutIds.delete(t),ce&&ce.timeouts.delete(t)}))},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){clearInterval(e),this.intervalIds&&this.intervalIds.delete(e),ce&&ce.intervals.delete(e)}))},{key:"setInterval",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n=setInterval(e,t);return(this.intervalIds||(this.intervalIds=new Set)).add(n),ce&&ce.intervals.set(n,{fn:e,delay:t}),n}))},{key:"requestAnimationFrame",value:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n){var r=requestAnimationFrame(t||n||ce?function(){return ce&&ce.animationFrames.delete(r),e.apply(n,t)}:e);return(this.animationFrameIds||(this.animationFrameIds=new Set)).add(r),ce&&ce.animationFrames.set(r,{fn:e,extraArgs:t,thisObj:n}),r}))},{key:"createOnFrame",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,o=arguments.length>3?arguments[3]:void 0,a=function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];t&&o&&(n.cancelAnimationFrame(t),t=null),t||(t=n.requestAnimationFrame((function(){"string"==typeof e&&(e=i[e]),t=null,s.push.apply(s,G()(r)),e.apply(i,s)})))};return a.cancel=function(){return n.cancelAnimationFrame(t)},a}},{key:"cancelAnimationFrame",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){cancelAnimationFrame(e),this.animationFrameIds&&this.animationFrameIds.delete(e),ce&&ce.animationFrames.delete(e)}))},{key:"buffer",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=null;"string"==typeof e&&(e=r[e]);var o=function o(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];o.called=!1,null!==i&&n.clearTimeout(i),i=n.setTimeout((function(){var t;(t=e).call.apply(t,[r].concat(s)),o.called=!0}),t)};return o}},{key:"throttle",value:function(e,t){var n,r,i,o=this,a=0,s=function(){r=0,a=performance.now(),e.apply(o,n),i.called=!0};return(i=function(){for(var e=performance.now()-a,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];n=u,e>=t?(o.clearTimeout(r),s()):r||(r=o.setTimeout(s,t-e),i.called=!1)}).cancel=function(){return o.clearTimeout(r)},i}},{key:"widgetClass",get:function(){}}]),t}(e||z)},he=(n(38),n(40),n(11)),fe=n.n(he),ge=(n(34),n(111),n(91),function(){function e(){C()(this,e)}return x()(e,null,[{key:"cacheFlags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.platform,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:navigator.userAgent,n=this;n._isLinux=Boolean(e.match(/Linux/)),n._isMac=Boolean(e.match(/Mac/)),n._isWindows=Boolean(e.match(/Win32/)),n._isIE11=Boolean(t.match(/rv:11/)),n._edgeVersion=n.getVersion(t,/Edge\/(\d+)\./),n._isEdge=n._edgeVersion>0,n._isWebkit=Boolean(t.match(/WebKit/))&&!n._isEdge,n._firefoxVersion=n.getVersion(t,/Firefox\/(\d+)\./),n._isFirefox=n._firefoxVersion>0,n._chromeVersion=n._isEdge?0:n.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),n._isChrome=n._chromeVersion>0,n._isSafari=Boolean(t.match(/Safari/))&&!n._isChrome&&!n._isEdge,n._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),n._isAndroid=Boolean(t.match(/Android/g));try{document.querySelector(":scope"),n.supportsQueryScope=!n._isFirefox}catch(e){n.supportsQueryScope=!1}n._supportsPassive=!1;try{document.addEventListener("__notvalid__",null,{get passive(){n._supportsPassive=!0}})}catch(e){}}},{key:"getVersion",value:function(e,t){var n=e.match(t);return n?parseInt(n[1]):0}},{key:"setLocalStorageItem",value:function(e,t){this.storageAvailable&&localStorage.setItem(e,t)}},{key:"getLocalStorageItem",value:function(e){return this.storageAvailable&&localStorage.getItem(e)}},{key:"removeLocalStorageItem",value:function(e){this.storageAvailable&&localStorage.removeItem(e)}},{key:"searchParam",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.location.search,r=new RegExp("[?&]".concat(e,"=([^&]*)")),i=n.match(r);return i&&i[1]||t}},{key:"isTouchDevice",get:function(){return"_isTouchDevice"in this?this._isTouchDevice:"ontouchstart"in window||!this.isEdge&&navigator.maxTouchPoints>0||this.isEdge&&window.TouchEvent||navigator.msMaxTouchPoints>0},set:function(e){this._isTouchDevice=e}},{key:"isMac",get:function(){return this._isMac}},{key:"isWindows",get:function(){return this._isWindows}},{key:"isLinux",get:function(){return this._isLinux}},{key:"isIE11",get:function(){return this._isIE11}},{key:"isEdge",get:function(){return this._isEdge}},{key:"edgeVersion",get:function(){return this._edgeVersion}},{key:"isWebkit",get:function(){return this._isWebkit}},{key:"isChrome",get:function(){return this._isChrome}},{key:"chromeVersion",get:function(){return this._chromeVersion}},{key:"isFirefox",get:function(){return this._isFirefox}},{key:"firefoxVersion",get:function(){return this._firefoxVersion}},{key:"isSafari",get:function(){return this._isSafari}},{key:"isMobileSafari",get:function(){return this._isMobileSafari}},{key:"isAndroid",get:function(){return this._isAndroid}},{key:"supportsPassive",get:function(){return this._supportsPassive}},{key:"storageAvailable",get:function(){var e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}}]),e}());ge.cacheFlags(),ge._$name="BrowserHelper";n(79);var ve=["border-top-width","border-right-width","border-bottom-width","border-left-width"],pe=["padding-top","padding-right","padding-bottom","padding-left"],ye="border-top-width",ke="border-right-width",be="border-bottom-width",we="border-left-width",Se="padding-top",Ce="padding-right",Ee="padding-bottom",xe="padding-left",De=Object.freeze({x:0,y:0}),Te=/^([trblc])(\d*)-([trblc])(\d*)$/i,Re=/^([trblc])(\d*)$/i,Me=["top","right","bottom","left"],Fe={t:0,r:1,b:2,l:3},_e=["b-t","l-r","t-b","r-l"],Ae=Object.freeze([0,0]),Ie=["width","height"];function Le(e){return"".concat(Me[(Fe[e.myEdge]+2)%4][0]).concat(e.myOffset,"-").concat(Me[(Fe[e.targetEdge]+2)%4][0]).concat(e.targetOffset)}var Oe=function(){function e(t,n,r,i){C()(this,e);this._x=t,this._y=n,this._width=r,this._height=i}return x()(e,[{key:"round",value:function(){var e=this;return e._x=rn.roundPx(e._x),e._y=rn.roundPx(e._y),e._width=rn.roundPx(e._width),e._height=rn.roundPx(e._height),e}},{key:"$name",get:function(){return this.constructor.$name}}],[{key:"from",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t instanceof e)return t;if(n){var i=n,o=i.scrollLeft,a=i.scrollTop;(ge.isEdge||ge.isSafari)&&n===document.body&&(o=a=0),n=e.from(n).translate(-o,-a)}else n=De;var s=t===document||t===window,l=s?new e(0,0,window.innerWidth,window.innerHeight):t.getBoundingClientRect(),u=r||s?[0,0]:[window.pageXOffset,window.pageYOffset];return new e(l.left+u[0]-n.x,l.top+u[1]-n.y,l.width,l.height)}},{key:"inner",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=rn.getStyleValue(e,ve);r.x+=parseInt(i[we]),r.y+=parseInt(i[ye]),r.right-=parseInt(i[ke]),r.bottom-=parseInt(i[be])}return r}},{key:"content",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=rn.getStyleValue(e,ve),o=rn.getStyleValue(e,pe);r.x+=parseInt(i[we])+parseInt(o[xe]),r.y+=parseInt(i[ye])+parseInt(o[Se]),r.right-=parseInt(i[ke])+parseInt(o[Ce]),r.bottom-=parseInt(i[be])+parseInt(o[Ee])}return r}},{key:"client",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.content(e,t,r),o=rn.scrollBarWidth;return o&&(e.scrollHeight>e.clientHeight&&"hidden"!==rn.getStyleValue(e,"overflow-y")&&(n=parseInt(rn.getStyleValue(e,"padding-right")),i.right+=n-Math.max(n,o)),e.scrollWidth>e.clientWidth&&"hidden"!==rn.getStyleValue(e,"overflow-x")&&(n=parseInt(rn.getStyleValue(e,"padding-bottom")),i.bottom+=n-Math.max(n,o))),i}},{key:"union",value:function(){var t,n=arguments.length<=0?void 0:arguments[0],r=n.x,i=n.y,o=n.right,a=n.bottom;if(arguments.length>1)for(var s=1;s<arguments.length;s++)(t=s<0||arguments.length<=s?void 0:arguments[s]).x<r&&(r=t.x),t.y<i&&(i=t.y),t.right>o&&(o=t.right),t.bottom>a&&(a=t.bottom);return new e(r,i,o-r,a-i)}},{key:"$name",get:function(){return this.hasOwnProperty("_$name")&&this._$name||this.name}}]),x()(e,[{key:"clone",value:function(){var t=this,n=new e(t.x,t.y,t.width,t.height);return n.minHeight=t.minHeight,n.minWidth=t.minWidth,n}},{key:"contains",value:function(t){return t instanceof e&&(t._x>=this._x&&t._y>=this._y&&t.right<=this.right&&t.bottom<=this.bottom)}},{key:"intersect",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this,i=Math.max(r.y,t.y),o=Math.min(r.right,t.right),a=Math.min(r.bottom,t.bottom),s=Math.max(r.x,t.x);return a>i&&o>s&&(!!n||new e(s,i,o-s,a-i))}},{key:"equals",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n?function(e){return Math.round(e)}:function(e){return e};return t instanceof e&&r(t.x)===r(this.x)&&r(t.y)===r(this.y)&&r(t.width)===r(this.width)&&r(t.height)===r(this.height)}},{key:"translate",value:function(e,t){return this._x+=e||0,this._y+=t||0,this}},{key:"moveTo",value:function(e,t){return null!=e&&(this._x=e),null!=t&&(this._y=t),this}},{key:"getDelta",value:function(e){return[e.x-this.x,e.y-this.y]}},{key:"adjust",value:function(e,t,n,r){var i=this;return i.x+=e,i.y+=t,i.width+=n,i.height+=r,i}},{key:"inflate",value:function(e){return this.adjust(-e,-e,e,e)}},{key:"constrainTo",value:function(e,t){var n=this,r=n.height,i=n.y,o=n.minWidth||n.width,a=n.minHeight||n.height;if(n.height>=e.height){if(t&&a>e.height)return!1;n._y=e.y,n.height=e.height}if(n.width>=e.width){if(t&&o>e.width)return n.y=i,n.height=r,!1;n._x=e.x,n.width=e.width}var s=n.bottom-e.bottom;return s>0&&n.translate(0,-s),(s=n.right-e.right)>0&&n.translate(-s),(s=e.y-n.y)>0&&n.translate(0,s),(s=e.x-n.x)>0&&n.translate(s),n}},{key:"alignTo",value:function(t){var n,r,i,o,a=this.clone(),s=t.target,l=t.constrainTo;!s||s instanceof e||(s=e.from(s.element?s.element:s)),!l||l instanceof e||(o=l===window||l===document,l=e.from(l.element?l.element:l,null,t.ignorePageScroll));var u,c=this,d=null==(u=t.offset)?Ae:"number"==typeof u?[u,u]:u,h=t.align,f=t.axisLock,g=t.anchorSize,v=t.anchorPosition,m=function(e){var t=Te.exec(e),n=parseInt(t[2]||50),r=parseInt(t[4]||50);return{myAlignmentPoint:t[1]+n,myEdge:t[1],myOffset:n,targetAlignmentPoint:t[3]+r,targetEdge:t[3],targetOffset:r,startZone:Fe[t[3]]}}(h),p=t.position||(s&&"Point"===s.$name?s:null),y=l&&l.clone(),k=[],b=[{zone:r=m.startZone,align:h}],w=t.matchSize&&Ie[1&m.startZone],S=c[w];if(w&&f&&(a[w]=s[w]),l&&a.constrainTo(l),l&&null!=m.startZone)if(f)b.push({zone:r=(r+2)%4,align:Le(m)}),"flexible"===f&&(b.push({zone:r=(m.startZone+1)%4,align:_e[r]}),b.push({zone:r=(r+2)%4,align:_e[r]}));else for(var C=1;C<4;C++)b.push({zone:r=(r+1)%4,align:_e[r]});if(v){var E,x=1&m.startZone?"y":"x";E={},$()(E,x,v[x]),$()(E,"edge",Me[(m.startZone+2)%4]),n=E}if(y&&s&&(y.adjust(-s.width,-s.height,s.width,s.height),s.constrainTo(y)),a.minWidth=c.minWidth,a.minHeight=c.minHeight,p)a.moveTo(p.x,p.y),l&&a.constrainTo(l);else{var D=g?[g[1]+d[0],g[1]+d[1]]:d,T=s.getAlignmentPoint(m.targetAlignmentPoint,D),R=a.getAlignmentPoint(m.myAlignmentPoint);if(a.translate(T[0]-R[0],T[1]-R[1]),a.intersect(s,!0))l&&a.constrainTo(l),i=m.startZone;else if(l&&!l.contains(a)){var M,F,_=a.clone(),A=[];n=null,k[0]=M=l.clone(),M.bottom=s.y-D[1],k[1]=M=l.clone(),M.x=s.right+D[0],k[2]=M=l.clone(),M.y=s.bottom+D[1],k[3]=M=l.clone(),M.right=s.x-D[0];for(var I=0;I<b.length;I++){if(w&&2==I&&(a[w]=S),M=k[i=b[I].zone],(a=a.alignTo({target:s,offsets:D,align:b[I].align})).constrainTo(M,!0)&&(A.push({result:a,zone:i}),!F||a.width<c.width||a.height<c.height)){a.align=b[I].align;break}if(!F||M.area>F.area){var L=a.clone();switch(i){case 0:L.moveTo(null,M.bottom-L.height);break;case 1:L.moveTo(M.left);break;case 2:L.moveTo(null,M.top);break;case 3:L.moveTo(M.right-L.width)}F={area:M.area,result:L,zone:i}}}A.length?(A.length>1&&!f&&A.sort((function(e,t){return Math.sqrt(Math.pow(_.x-e.result.x,2)+Math.pow(_.y-e.result.y,2))-Math.sqrt(Math.pow(_.x-t.result.x,2)+Math.pow(_.y-t.result.y,2))})),a=A[0].result,i=A[0].zone):(a=F.result,i=F.zone,o&&a.constrainTo(l))}else i=m.startZone;if(a.zone=i,g){if(!n){var O,P=1&i,H=P?"y":"x",N=P?"bottom":"right",B=Math.max(s[H],a[H]),z=B+(Math.min(s[N],a[N])-B)/2-g[0]/2,j=z+g[0];j>a[N]&&(z-=j-a[N]),z<a[H]&&(z+=a[H]-z),O={},$()(O,H,z-a[H]),$()(O,"edge",Me[(i+2)%4]),n=O}a.anchor=n}}return a}},{key:"getAlignmentPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ae,n=this,r=Re.exec(e),i=r[1].toLowerCase(),o=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(i){case"t":return[n.x+n.width*o,n.y-t[1]];case"r":return[n.right+t[0],n.y+n.height*o];case"b":return[n.x+n.width*o,n.bottom+t[1]];case"l":return[n.x-t[0],n.y+n.height*o];case"c":var a=n.center;return[a.x+t[0],a.y+t[1]]}}},{key:"highlight",value:function(){var e=rn.createElement({parent:document.body,style:"position:absolute;z-index:9999999;pointer-events:none;\n                            left:".concat(this.x,"px;top:").concat(this.y,"px;width:").concat(this.width,"px;height:").concat(this.height,"px")});return rn.highlight(e).then((function(){return e.remove()}))}},{key:"center",get:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2)}},{key:"x",set:function(e){var t=e-this._x;this._x=e,this._width-=t},get:function(){return this._x}},{key:"left",set:function(e){this.x=e},get:function(){return this.x}},{key:"top",set:function(e){this.y=e},get:function(){return this.y}},{key:"y",set:function(e){var t=e-this._y;this._y=e,this._height-=t},get:function(){return this._y}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}},{key:"right",set:function(e){this._width=e-this._x},get:function(){return this._x+this._width}},{key:"bottom",set:function(e){this._height=e-this._y},get:function(){return this._y+this._height}},{key:"area",get:function(){return this.width*this.height}},{key:"minWidth",set:function(e){var t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.width=Math.max(t.width,t._minWidth))},get:function(){return this._minWidth}},{key:"minHeight",set:function(e){var t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.height=Math.max(t.height,t._minHeight))},get:function(){return this._minHeight}}]),e}();Oe._$name="Rectangle";n(169),n(171),n(138);var Pe=function(){function e(){C()(this,e)}return x()(e,null,[{key:"get",value:function(e,t){return this.fetch(e,t)}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t instanceof FormData||"string"==typeof t||(t=JSON.stringify(t)),this.fetch(e,Object.assign({method:"POST",body:t},n))}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new AbortController;if(t.signal=n.signal,"credentials"in t||(t.credentials="include"),t.queryParams){var r=Object.entries(t.queryParams);r.length&&(e+="?"+r.map((function(e){var t=fe()(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(encodeURIComponent(r))})).join("&"))}var i=new Promise((function(n,r){fetch(e,t).then((function(e){t.parseJson?e.json().then((function(t){e.parsedJson=t,n(e)})).catch((function(t){e.parsedJson=null,e.error=t,r(e)})):n(e)})).catch((function(e){r(e)}))}));return i.abort=function(){n.abort()},i}))}]),e}();Pe._$name="AjaxHelper";n(139),n(43),n(174),n(140),n(175);var He=function(){function e(){C()(this,e)}return x()(e,[{key:"magnitudeCompare",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"lexicalCompare",value:function(e,t){return(e=String(e))<(t=String(t))?-1:e>t?1:0}}],[{key:"clean",value:function(e){return e.reduce((function(e,t){return null==t||Array.isArray(t)&&0===t.length||""===t||e.push(t),e}),[])}},{key:"remove",value:function(e){for(var t,n,r=!1,i=0;i<(arguments.length<=1?0:arguments.length-1);i++)n=i+1<1||arguments.length<=i+1?void 0:arguments[i+1],-1!==(t=e.indexOf(n))&&(e.splice(t,1),r=!0);return r}},{key:"findInsertionIndex",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.lexicalCompare,o=arguments.length>3?arguments[3]:void 0,a=t.length;return o<a&&(n=o>0?i(t[o-1],e):0,r=o<a-1?i(e,t[o]):0,n<1&&r<1)?o:this.binarySearch(t,e,i)}},{key:"binarySearch",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.lexicalCompare,s=e.length;for(i instanceof Function?(a=i,i=0):o instanceof Function&&(a=o,o=s),--o;i<=o;)(r=a(t,e[n=i+o>>1]))>=0?i=n+1:r<0&&(o=n-1);return i}},{key:"fill",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[],i=Array.isArray(t)?t:[t],o=0;o<e;o++){var a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,h=Object.assign({},d);n&&n(h,o),r.push(h)}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}}return r}},{key:"populate",value:function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}},{key:"include",value:function(e,t){e.includes(t)||e.push(t)}},{key:"allowNegative",value:function(e){return new Proxy(e,{get:function(e,t,n){if("string"!=typeof t)return Reflect.get(e,t,n);var r=Number(t);return Number.isNaN(r)?Reflect.get(e,t,n):e[r<0?e.length+r:r]},set:function(e,t,n,r){if("string"!=typeof t)return Reflect.set(e,t,n,r);var i=Number(t);return Number.isNaN(i)?Reflect.set(e,t,n,r):(e[i<0?e.length+i:i]=n,!0)}})}},{key:"delta",value:function(e,t){if(!t)return{onlyInA:e,onlyInB:[],inBoth:[]};for(var n=[],r=[],i=[],o=0;o<e.length;o++){var a=e[o];t.includes(a)?i.push(a):n.push(a)}for(var s=0;s<t.length;s++){var l=t[s];i.includes(l)||r.push(l)}return{onlyInA:n,onlyInB:r,inBoth:i}}}]),e}();He._$name="ArrayHelper";var Ne={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,name:1,_oldDestructor:1},Be=function(e,t){return t.prio-e.prio},ze=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"destroy",value:function(){this.trigger("beforeDestroy"),se()(oe()(t.prototype),"destroy",this).call(this)}},{key:"construct",value:function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=se()(oe()(t.prototype),"construct",this)).call.apply(e,[this].concat(r)),this.processConfiguredListeners()}},{key:"processConfiguredListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.listeners&&this.initialEventListeners,t=this;if(e&&!t.defaultListenersInitialized){var n=t.addListener(e,t);!1!==t.listeners.detachable&&(t.listenerDetacher=n),t.defaultListenersInitialized=!0}}},{key:"doDestroy",value:function(){this.trigger("destroy"),this.listenerDetacher&&this.listenerDetacher(),this.removeAllListeners(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"addListener",value:function(e,t,n){var r,i=this,o=i.eventListeners||(i.eventListeners={});if("string"==typeof e)return i.addListener((r={},$()(r,e,t),$()(r,"detachable",!1!==t.detachable),$()(r,"thisObj",n),r));for(var a in t=void 0!==e.thisObj?e.thisObj:e.thisObj=t,e)Ne[a]||function(){var n=e[a],r={fn:"object"===U()(n)?n.fn:n,thisObj:void 0!==n.thisObj?n.thisObj:t,args:n.args||e.args,prio:void 0!==n.prio?n.prio:void 0!==e.prio?e.prio:0,once:void 0!==n.once?n.once:void 0!==e.once&&e.once,catchAll:"catchAll"===a},s=a.toLowerCase(),l=o[s]||(o[s]=[]);n.expires&&i.delay((function(){return i.un(s,r)}),e.expires),l.splice(He.findInsertionIndex(r,l,Be,l.length),0,r)}();e.relayAll&&i.relayAll(e.relayAll),t&&i.attachAutoDetacher(e);var s=!1!==e.detachable,l=e.name,u=e.expires||s||l?function(){i.isDestroyed||i.removeListener(e)}:null;return u&&(u.eventer=i,u.listenerName=l,l&&t&&t.trackDetacher&&t.trackDetacher(l,u),e.expires&&i.delay(u,e.expires),s)?u:void 0}},{key:"on",value:function(){return this.addListener.apply(this,arguments)}},{key:"un",value:function(){this.removeListener.apply(this,arguments)}},{key:"removeListener",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.thisObj,n=this;"string"!=typeof e?(Object.entries(e).forEach((function(e){var r=fe()(e,2),i=r[0],o=r[1];if(!Ne[i]){var a=i.toLowerCase(),s=n.eventListeners&&n.eventListeners[a];if(s){var l=s.findIndex((function(e){return!(e.fn!==o&&e.fn!==o.fn||e.thisObj!==t&&e.thisObj!==o.thisObj&&t)}));l>=0&&(s.splice(l,1),s.length||delete n.eventListeners[a])}}})),e.thisObj&&!e.thisObj.isDestroyed&&n.detachAutoDetacher(e)):n.removeListener($()({},e,t),!((arguments.length<=2?0:arguments.length-2)>0)||(arguments.length<=2?void 0:arguments[2]))}},{key:"hasListener",value:function(e){return Boolean(this.eventListeners&&this.eventListeners[e])}},{key:"relayAll",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(this.relayAllTargets||(this.relayAllTargets=[])).push({through:e,prefix:t,transformCase:n})}},{key:"removeAllListeners",value:function(){var e,t,n=this.eventListeners;for(var r in n){var i=n[r];for(e=i.length;e-- >0;){var o=i[e];this.removeListener(r,o),(t=o.thisObj)&&t.untrackDetachers&&t.untrackDetachers(this)}}}},{key:"relayEvents",value:function(e,t,n){var r=this,i={detachable:!0},o=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return r.trigger.apply(r,[(n||"")+e].concat(i))};return t.forEach((function(e){i[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.apply(void 0,[e].concat(n))}})),e.on(i)}},{key:"attachAutoDetacher",value:function(e){var t=this,n=e.thisObj,r="doDestroy"in n?"doDestroy":"destroy";r in n?(e._oldDestructor=n[r],n[r]=function(){t.isDestroyed||t.removeListener(e),e._oldDestructor.call(n)}):n[r]=function(){t.removeListener(e)}}},{key:"detachAutoDetacher",value:function(e){var t=e.thisObj,n="doDestroy"in t?"doDestroy":"destroy";e._oldDestructor&&(t[n]=e._oldDestructor)}},{key:"await",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{checkLog:!0,resetLog:!0},n=this;return!1===t&&(t={checkLog:!1}),new Promise((function(r){var i;t.checkLog&&n._triggered&&n._triggered[e]&&(r(),t.resetLog&&n.clearLog(e)),n.on((i={},$()(i,e,(function(){r.apply(void 0,arguments),t.resetLog&&n.clearLog(e)})),$()(i,"prio",-1e4),$()(i,"once",!0),i))}))}},{key:"clearLog",value:function(e){this._triggered&&(e?delete this._triggered[e]:this._triggered={})}},{key:"callPreventable",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this;if(!i&&!1===o.trigger("before"+A.capitalizeFirstLetter(e),t))return!1;var a=n.apply(void 0,[t].concat(G()(r)));return i||o.trigger(e,t),a}},{key:"trigger",value:function(e,t){var n,r=this,i=e.toLowerCase(),o=r.eventsSuspended,a=r.relayAllTargets,s=r.callOnFunctions,l=r.owner,u=r.eventListeners&&r.eventListeners[i],c=!0;if(r._triggered||(r._triggered={}),r._triggered[e]=!0,o)return o.shouldQueue&&o.queue.push(arguments),!0;r.eventListeners&&r.eventListeners.catchall&&((n=u=u?u.slice():[]).push.apply(n,G()(r.eventListeners.catchall)),u.sort(Be),c=!1);if(!u&&!a&&!s)return!0;if(t?"source"in t||(Object.isExtensible(t)?t.source=r:t=Object.setPrototypeOf({source:r},t)):t={source:r},t.type!==i&&(t.constructor!==Object?Reflect.defineProperty(t,"type",{get:function(){return i}}):t.type=i),s){var d="on"+A.capitalizeFirstLetter(e);if(d in r&&(r.callback(r[d],r,[t]),!r.isDestroyed&&r.hasOwnProperty(d)&&(!r.pluginFunctionChain||!r.pluginFunctionChain[d]))){var h=Object.getPrototypeOf(r);if(d in h&&(h[d].call(r,t),r.isDestroyed))return}}if(u){var f,g,v=0;for(c&&(u=u.slice());v<u.length&&!r.isDestroyed;v++){var m=(f=u[v]).thisObj;if(!m||!m.isDestroyed){if(f.once&&r.removeListener(i,f),"string"==typeof f.fn){if(m&&(g=m[f.fn]),!g){var p=r.resolveCallback(f.fn);g=p.handler,m=p.thisObj}}else g=f.fn;var y;if(f.args){if(!1===(y=g).call.apply(y,[m||r].concat(G()(f.args),[t])))return!1}else if(!1===g.call(m||r,t))return!1}}}return a&&a.forEach((function(n){var r=e;if(n.transformCase&&(r=A.capitalizeFirstLetter(r)),n.prefix&&(r=n.prefix+r),!1===n.through.trigger(r,t))return!1})),!(t.bubbles&&l&&!l.isDestroyed)||l.trigger(e,t)}},{key:"suspendEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.eventsSuspended||(this.eventsSuspended={shouldQueue:e,queue:[],count:0});t.count++}},{key:"resumeEvents",value:function(){var e=this.eventsSuspended;if(e&&0==--e.count&&(this.eventsSuspended=null,e.shouldQueue)){var t=!0,n=!1,r=void 0;try{for(var i,o=e.queue[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.trigger.apply(this,G()(a))}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}return!Boolean(this.eventsSuspended)}},{key:"listeners",set:function(e){this.isConfiguring?this.initialEventListeners=e:(this.removeAllListeners(),e&&this.on(e))},get:function(){return this.eventListeners||this.initialEventListeners}}]),t}(e||z)},je=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){for(var e,n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=se()(oe()(t.prototype),"construct",this)).call.apply(e,[this].concat(i));var a=document.querySelector("script[data-default-locale]");a&&(n.defaultLocaleName=a.dataset.defaultLocale),window.bryntum&&window.bryntum.locales&&(Object.keys(window.bryntum.locales).forEach((function(e){if(!e.startsWith("moment")){var t=window.bryntum.locales[e];t.extends?n.extendLocale(t.extends,t):n.registerLocale(t.localeName,{desc:t.localeDesc,locale:t})}})),n.locale||"En"!==n.defaultLocaleName&&n.applyLocale(n.defaultLocaleName||Object.keys(n.locales)[0]))}},{key:"registerLocale",value:function(e,t){var n=this,r=n.defaultLocaleName===e,i=n.locale&&n.locale.localeName===e,o=0===Object.keys(n.locales).length;n.locales[e]=t,(r||!n.defaultLocaleName&&(o||i))&&n.internalApplyLocale(t)}},{key:"extendLocale",value:function(e,t){var n=this.locales[e];return!!n&&(Object.keys(t).forEach((function(e){n.locale[e]?Object.assign(n.locale[e],t[e]):n.locale[e]=t[e]})),delete n.locale.extends,!0)}},{key:"internalApplyLocale",value:function(e){this._locale=e.locale,this.trigger("locale",e)}},{key:"applyLocale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.locales[e];if(i&&i.locale&&r._locale===i.locale&&!t)return!0;if(!i){if(n)return!0;throw new Error("Locale ".concat(e," not registered"))}function o(){r.internalApplyLocale(i)}return i.locale?(o(),!0):new Promise((function(t,n){r.loadLocale(i.path).then((function(n){n.text().then((function(n){new Function(n)(),i.locale=window.bryntum.locales[e],o(),t(i)}))})).catch((function(e){return n(e)}))}))}},{key:"loadLocale",value:function(e){return Pe.get(e)}},{key:"locales",set:function(e){this._locales=e},get:function(){return this._locales}},{key:"locale",set:function(e){"string"==typeof e?this.applyLocale(e):(e.locale||(e={locale:e,localeName:e.localeName||"custom"}),this.registerLocale(e.localeName,e),this.applyLocale(e.localeName))},get:function(){return this._locale}}],[{key:"defaultConfig",get:function(){return{locales:{}}}}]),t}(ze(z))),Ve=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){for(var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(e=se()(oe()(t.prototype),"construct",this)).call.apply(e,[this,n].concat(o)),je.on("locale",r.updateLocalization,r),r.updateLocalization()}},{key:"localizeProperty",value:function(e){var t=this;if("string"==typeof t[e]){t.originalLocales=t.originalLocales||{},t.originalLocales[e]=t.originalLocales[e]||t[e];var n=t.originalLocales[e];n&&(t[e]=t.L(n))}}},{key:"updateLocalization",value:function(){this.localizableProperties&&this.localizableProperties.forEach(this.localizeProperty,this)}},{key:"buildLocalizableProperties",value:function(e){var t=[];e.localizableProperties&&t.push.apply(t,G()(e.localizableProperties));for(var n=this.constructor.superclass;n&&n!==z;n=n.superclass){var r=n.getConfigDescriptor(!0).defaultConfig;r&&r.localizableProperties&&t.push.apply(t,G()(r.localizableProperties.filter((function(e){return t.indexOf(e)<0}))))}return t}},{key:"startConfigure",value:function(e){e.localizableProperties=this.buildLocalizableProperties(e),se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"L",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.localeClass&&this.localeClass!==this.constructor?t.L(e,n,this.localeClass,this.constructor):t.L(e,n,this.constructor)}},{key:"localeClass",get:function(){return this._localeClass||this.parent&&this.parent.localeClass||null},set:function(e){this._localeClass=e}},{key:"localeManager",get:function(){return je}}],[{key:"parseText",value:function(e){var t=this.inTextLocaleRegExp.exec(e);return t?t[1]:e}},{key:"getTranslation",value:function(e,t,n){var r,i,o=je.locale;if(o)for(e=this.parseText(e);n&&(i="string"==typeof n?n:n.$name||n.name);){var a=o[i];if(a&&e in a){var s=a[e];r="function"==typeof s&&void 0!==t?s(t):s;break}if("string"==typeof n)break;n=Object.getPrototypeOf(n)}return r}},{key:"L",value:function(e){for(var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];return o.length||(o=[this]),o.some((function(i){return void 0!==(t=n.getTranslation(e,r,i))})),void 0===t?e:t}},{key:"defaultConfig",get:function(){return{localeClass:null,localizableProperties:[]}}},{key:"inTextLocaleRegExp",get:function(){return/L{([^}]+)}/g}}]),t}(e||z)},We=function(e){return e+({1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th")},Ge=new RegExp("‎"),Ye="en-US",Ue=We,qe={},$e={},Xe={};function Ke(e,t,n){var r=($e[e]||($e[e]=new Intl.DateTimeFormat(Ye,t))).format(n);return ge.isIE11&&(r=r.replace(Ge,"")),r}var Je={M:function(e){return e.getMonth()+1},Mo:function(e){return Ue(Je.M(e).toString())},MM:function(e){return(e.getMonth()+1).toString().padStart(2,"0")},MMM:function(e){return Ke("MMM",{month:"short"},e)},MMMM:function(e){return Ke("MMMM",{month:"long"},e)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},Qo:function(e){return Ue(Je.Q(e).toString())},D:function(e){return e.getDate()},Do:function(e){return Ue(Je.D(e).toString())},DD:function(e){return e.getDate().toString().padStart(2,"0")},DDD:function(e){return Math.ceil((new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0)-new Date(e.getFullYear(),0,0,12,0,0))/864e5)},DDDo:function(e){return Ue(Je.DDD(e).toString())},DDDD:function(e){return Je.DDD(e).toString().padStart(3,"0")},d:function(e){return e.getDay()},do:function(e){return Ue(e.getDay().toString())},d1:function(e){return Je.ddd(e).substring(0,1)},dd:function(e){return Je.ddd(e).substring(0,2)},ddd:function(e){return Ke("ddd",{weekday:"short"},e)},dddd:function(e){return Ke("dddd",{weekday:"long"},e)},e:function(e){return e.getDay()},E:function(e){return e.getDay()+1},W:function(e){var t=new Date(e.valueOf());t.setDate(t.getDate()-(e.getDay()+6)%7+3);var n=t.valueOf();return t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7),1+Math.ceil((n-t)/6048e5)},Wo:function(e){return Ue(Je.W(e).toString())},WW:function(e){return Je.W(e).toString().padStart(2,"0")},Y:function(e){return e.getFullYear()},YY:function(e){return e.getFullYear()%100},YYYY:function(e){return e.getFullYear()},A:function(e){return e.getHours()<12?"AM":"PM"},a:function(e){return e.getHours()<12?"am":"pm"},H:function(e){return e.getHours()},HH:function(e){return e.getHours().toString().padStart(2,"0")},h:function(e){return e.getHours()%12||12},hh:function(e){return Je.h(e).toString().padStart(2,"0")},k:function(e){return e.getHours()+1},kk:function(e){return Je.k(e).toString().padStart(2,"0")},K:function(e){return Ke("K",{hour:"numeric"},e)},KK:function(e){return Ke("KK",{hour:"2-digit"},e)},m:function(e){return e.getMinutes()},mm:function(e){return Je.m(e).toString().padStart(2,"0")},s:function(e){return e.getSeconds()},ss:function(e){return Je.s(e).toString().padStart(2,"0")},S:function(e){return e.getMilliseconds().toString().substr(0,1)},SS:function(e){return e.getMilliseconds().toString().substr(0,2).padEnd(2,"0")},SSS:function(e){return e.getMilliseconds().toString().substr(0,3).padEnd(3,"0")},z:function(e){return Ke("z",{timeZoneName:"short"},e)},zz:function(e){return Ke("zz",{timeZoneName:"long"},e)},LT:function(e){return Ke("LT",{hour:"2-digit",minute:"2-digit"},e)},LTS:function(e){return Ke("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},e)},L:function(e){return Ke("L",{year:"numeric",month:"2-digit",day:"2-digit"},e)},l:function(e){return Ke("l",{year:"numeric",month:"numeric",day:"numeric"},e)},LL:function(e){return Ke("LL",{year:"numeric",month:"long",day:"numeric"},e)},ll:function(e){return Ke("ll",{year:"numeric",month:"short",day:"numeric"},e)},LLL:function(e){return Ke("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},e)},lll:function(e){return Ke("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},e)},LLLL:function(e){return Ke("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},e)},llll:function(e){return Ke("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},e)}},Qe=Object.keys(Je).sort((function(e,t){return t.length-e.length})),Ze="^(?:".concat(Qe.join("|"),")"),et=function(){return{}},tt={YYYY:function(e){return{year:parseInt(e)}},Y:function(e){return{year:parseInt(e)}},YY:function(e){var t=parseInt(e);return{year:t+(t>1968?1900:2e3)}},MM:function(e){return{month:parseInt(e)-1}},Mo:function(e){return{month:parseInt(e)-1}},DD:function(e){return{date:parseInt(e)}},M:function(e){return{month:parseInt(e)-1}},D:function(e){return{date:parseInt(e)}},Do:function(e){return{date:parseInt(e)}},DDD:et,MMM:et,MMMM:et,DDDo:et,DDDD:et,d:et,do:et,d1:et,dd:et,ddd:et,dddd:et,Q:et,Qo:et,W:et,Wo:et,WW:et,e:et,E:et,HH:function(e){return{hours:parseInt(e)}},hh:function(e){return{hours:parseInt(e)}},mm:function(e){return{minutes:parseInt(e)}},H:function(e){return{hours:parseInt(e)}},m:function(e){return{minutes:parseInt(e)}},ss:function(e){return{seconds:parseInt(e)}},s:function(e){return{seconds:parseInt(e)}},S:function(e){return{milliseconds:parseInt(e)}},SS:function(e){return{milliseconds:parseInt(e)}},SSS:function(e){return{milliseconds:parseInt(e)}},A:function(e){return{amPm:e.toLowerCase()}},a:function(e){return{amPm:e.toLowerCase()}},L:"MM/DD/YYYY",LT:"HH:mm A",Z:function(e){if(!e)return{};var t=0;if(!e.endsWith("Z")){var n=ft.exec(e);if(n)t=("+"===n[1]?1:-1)*(60*(parseInt(n[2])||0)+(parseInt(n[3])||0));else t=-1*(new Date).getTimezoneOffset()}return{timeZone:t}}},nt=Object.keys(tt).sort((function(e,t){return t.length-e.length})),rt=new RegExp("(".concat(nt.join("|"),")")),it=new RegExp("(l|LL|ll|LLL|lll|LLLL|llll)"),ot={year:{year:1,quarter:4,month:12,week:52,day:365,hour:8760,minute:525600,second:31536e3,millisecond:31536e6},quarter:{year:.25,quarter:1,month:3,week:4,day:91,hour:2184,minute:131040,second:7862400,millisecond:78624e5},month:{year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-720,minute:-43200,second:-2592e3,millisecond:-2592e6},week:{year:-1/52,quarter:-1/13,month:-.25,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{year:-1/8760,quarter:-1/2184,month:-1/720,week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{year:-1/525600,quarter:-1/131040,month:-1/43200,week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{year:-1/31536e3,quarter:-1/7862400,month:-1/2592e3,week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{year:-1/31536e6,quarter:-1/78624e5,month:-1/2592e6,week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:.001}},at={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year"},st=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,lt=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,ut=["millisecond","second","minute","hour","day","week","month","quarter","year"],ct=["year","month","week","day","hour","minute","second","millisecond"],dt=["milliseconds","seconds","minutes","hours","date","month","year"],ht=function(e){var t=parseFloat(e);return isNaN(t)?null:t},ft=/([+-])(\d\d):*(\d\d)*$/,gt={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8},vt=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"buildParser",value:function(e){var n=this,r=e.split(rt),i=[];return 1===r.length||it.test(e)?[]:(r.reduce((function(r,o,a,s){if(0!==a||""!==o)if(rt.test(o)){var l=("parsers"!==n.L("parsers")&&n.L("parsers")||{})[o]||tt[o];if("Z"===o&&a<s.length-2)throw new Error("Invalid format ".concat(e," TimeZone (Z) must be last token"));if("string"==typeof l){var u=t.buildParser(l),c=u.pop();delete c.last,i.push.apply(i,G()(u)),r=c}else r.pattern=o,r.fn=tt[o]}else r.splitter=o,i.push(r),r={};else r.hasOwnProperty("pattern")&&i.push(r);return r}),{}),i[i.length-1].last=!0,i)}},{key:"parse",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultFormat;if(!e)return null;if(e instanceof Date)return e;var r={year:0,month:0,date:0,hours:0,minutes:0,seconds:0,milliseconds:0},i=Xe[n];i||(i=Xe[n]=t.buildParser(n)),i.reduce((function(e,t){if(!t.last){var n,i,o;if(-1===(n="T"===t.splitter&&-1===e.indexOf("T")?e.indexOf(" "):""!==t.splitter?e.indexOf(t.splitter):t.pattern&&t.pattern.length||-1)){var a=e.split(/([Z\-+])/);1===a.length?(i=e,o=""):(i=a[0],o="".concat(a[1]).concat(a[2]))}else i=e.substring(0,n)||e,o=e.substring(n+t.splitter.length);return t.fn&&Object.assign(r,t.fn(i)),o}Object.assign(r,t.fn(e))}),e),r.year&&!r.date&&(r.date=1);var o=this.create(r);return o||new Date(e)}},{key:"create",value:function(e){var t=Object.assign({},e),n=!0,r=!1;if(dt.forEach((function(e){e in t&&!isNaN(t[e])||(t[e]=0),t[e]>0&&(n=!1)})),"pm"===t.amPm&&(t.hours=t.hours%12+12),"timeZone"in t&&(r=!0,t.minutes-=t.timeZone),n)return null;var i=[t.year,t.month,t.date,t.hours,t.minutes,t.seconds,t.milliseconds];return r?new Date(Date.UTC.apply(Date,i)):V()(Date,i)}},{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultFormat;if(!e||isNaN(e))return null;var n=qe[t],r="";if(!n){n=qe[t]=[];for(var i=0;i<t.length;i++){var o=t.substr(i).match(Ze),a=o&&o[0];if(a){var s="formats"!==this.L("formats")&&this.L("formats")||{},l=s[a]||Je[a];n.push(l),i+=a.length-1}else if("{"===t[i]){var u=t.indexOf("}",i+1);-1===u?(n.push(t.substr(i+1)),i=t.length):(n.push(t.substring(i+1,u)),i=u)}else n.push(t[i])}}return n.forEach((function(t){r+="string"==typeof t?t:t(e)})),(ge.isEdge||ge.isIE11)&&(r=r.replace(/\u200E/g,"")),r}},{key:"asMilliseconds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"==typeof e&&(t=e,e=1),this.as("millisecond",e,t)}},{key:"formatDelta",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=t?this.getShortNameOfUnit:this.getLocalizedNameOfUnit,i=t?"":" ",o=!0,a=!1,s=void 0;try{for(var l,u=ct[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=Math.floor(this.as(c,e));if(d&&(n.push("".concat(d).concat(i).concat(r.call(this,c,d>1))),e-=this.as("ms",d,c)),!e)break}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return n.join(", ")}},{key:"as",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms";return e===n?t:(e=this.normalizeUnit(e),n=this.normalizeUnit(n),gt[n]>gt[e]?t*Math.abs(ot[n][e]):t/Math.abs(ot[e][n]))}},{key:"formatContainsHourInfo",value:function(e){return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(/(\\.)/g,""))}},{key:"is24HourFormat",value:function(e){return this.format(new Date(1970,0,0,13,0,0),e).includes("13")}},{key:"add",value:function(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms",o=this;if(r="string"==typeof e?o.parse(e):new Date(e.getTime()),!i||0===n)return r;switch(i=t.normalizeUnit(i)){case"millisecond":r=new Date(r.getTime()+n);break;case"second":r=new Date(r.getTime()+1e3*n);break;case"minute":r=new Date(r.getTime()+6e4*n);break;case"hour":r=new Date(r.getTime()+36e5*n);break;case"day":n%1==0?r.setDate(r.getDate()+n):r=new Date(r.getTime()+864e5*n),23===r.getHours()&&0===r.getHours()&&(r=o.add(r,1,"hour"));break;case"week":r.setDate(r.getDate()+7*n);break;case"month":var a=r.getDate();a>28&&(a=Math.min(a,o.getLastDateOfMonth(o.add(o.getFirstDateOfMonth(r),n,"month")).getDate())),r.setDate(a),r.setMonth(r.getMonth()+n);break;case"quarter":r=o.add(r,3*n,"month");break;case"year":r.setFullYear(r.getFullYear()+n)}return r}},{key:"diff",value:function(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms",o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(i=t.normalizeUnit(i),!e||!n)return 0;switch(i){case"year":r=this.diff(e,n,"month")/12;break;case"quarter":r=this.diff(e,n,"month")/3;break;case"month":r=12*(n.getFullYear()-e.getFullYear())+(n.getMonth()-e.getMonth());break;case"week":r=this.diff(e,n,"day")/7;break;case"day":var a=e.getTimezoneOffset()-n.getTimezoneOffset();r=(n-e+60*a*1e3)/864e5;break;case"hour":r=(n-e)/36e5;break;case"minute":r=(n-e)/6e4;break;case"second":r=(n-e)/1e3;break;case"millisecond":r=n-e}return o?r:Math.round(r)}},{key:"startOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;t=this.normalizeUnit(t),n&&(e=this.clone(e));for(var r={},i=gt[t],o=0;o<i;o++){var a=ut[o];"quarter"!==a&&"week"!==a&&(r[a]="day"===a?1:0)}if("quarter"===t)r.month=3*(this.get(e,"quarter")-1);else if("week"===t){var s=e.getDay()-this.weekStartDay;r.day=e.getDate()-s}return this.set(e,r)}},{key:"clone",value:function(e){return new Date(e.getTime())}},{key:"clearTime",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.startOf(e,"day",n)}},{key:"set",value:function(e,t,n){var r=this;if(!t)return e;if("string"==typeof t)switch(this.normalizeUnit(t)){case"millisecond":(0!==n||e.getMilliseconds()>0)&&e.setMilliseconds(n);break;case"second":(0!==n||e.getSeconds()>0)&&e.setSeconds(n);break;case"minute":(0!==n||e.getMinutes()>0)&&e.setMinutes(n);break;case"hour":e.setHours(n);break;case"day":case"date":e.setDate(n);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(n);break;case"quarter":e.setDate(1),e.setMonth(3*(n-1));break;case"year":e.setFullYear(n)}else Object.entries(t).sort((function(e,t){return gt[e[0]]-gt[t[0]]})).forEach((function(t){var n=fe()(t,2),i=n[0],o=n[1];r.set(e,i,o)}));return e}},{key:"constrain",value:function(e,t,n){return null!=t&&(e=this.max(e,t)),null==n?e:this.min(e,n)}},{key:"getTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Date(1970,0,1,e,t,n)}},{key:"copyTimeValues",value:function(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}},{key:"isDST",value:function(e){var t=new Date(e.getFullYear(),0,1),n=new Date(e.getFullYear(),6,1);return e.getTimezoneOffset()<Math.max(t.getTimezoneOffset(),n.getTimezoneOffset())}},{key:"isBefore",value:function(e,t){return e<t}},{key:"isAfter",value:function(e,t){return e>t}},{key:"isEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===n?e&&t&&e.getTime()===t.getTime():this.startOf(e,n)-this.startOf(t,n)==0}},{key:"compare",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this;return n&&(e=r.startOf(e,n),t=r.startOf(t,n)),r.isBefore(e,t)?-1:r.isAfter(e,t)?1:0}},{key:"isStartOf",value:function(e,t){return this.isEqual(e,this.startOf(e,t))}},{key:"betweenLesser",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<n.getTime()}},{key:"betweenLesserEqual",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<=n.getTime()}},{key:"intersectSpans",value:function(e,t,n,r){return this.betweenLesser(e,n,r)||this.betweenLesser(n,e,t)}},{key:"compareUnits",value:function(e,t){return Math.sign(gt[e]-gt[t])}},{key:"timeSpanContains",value:function(e,t,n,r){return n-e>=0&&t-r>=0}},{key:"get",value:function(e,t){switch(this.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return Je.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}},{key:"daysInMonth",value:function(e){var t=this.clone(e);return t.setDate(1),t.setMonth(e.getMonth()+1),t.setDate(0),t.getDate()}},{key:"getFirstDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth(),1)}},{key:"getLastDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}},{key:"min",value:function(e,t){return e.getTime()<t.getTime()?e:t}},{key:"max",value:function(e,t){return e.getTime()>t.getTime()?e:t}},{key:"getNext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.weekStartDay,i=this;if("week"===t){var o=i.clone(e),a=o.getDay();return o=i.startOf(o,"day"),(o=i.add(o,r-a+7*(n-(r<=a?0:1)),"day")).getDay()!==r&&i.add(o,1,"hour"),o}return i.startOf(i.add(e,n,t),t)}},{key:"getStartOfNextDay",value:function(e,n,r){var i=t.add(r?e:t.clearTime(e,n),1,"day");if(i.getDate()==e.getDate()){var o=t.add(t.clearTime(e,n),"day",2).getTimezoneOffset(),a=e.getTimezoneOffset();i=t.add(i,a-o,"minute")}return i}},{key:"getEndOfPreviousDay",value:function(e,n){var r=n?e:t.clearTime(e,!0);return r-e?r:this.add(r,-1,"day")}},{key:"formatCount",value:function(e,n){return n=t.normalizeUnit(n),1!==e&&(n+="s"),e+" "+n}},{key:"getUnitToBaseUnitRatio",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(e=t.normalizeUnit(e))===(n=t.normalizeUnit(n))?1:ot[e]&&ot[e][n]&&(r||ot[e][n]>0)?1/t.as(n,1,e):ot[n]&&ot[n][e]&&(r||ot[n][e]>0)?t.as(e,1,n):-1}},{key:"getMeasuringUnit",value:function(e){return"week"===e?"day":e}},{key:"getShortNameOfUnit",value:function(e){return e=this.parseTimeUnit(e),this.unitLookup[e].abbrev}},{key:"getLocalizedNameOfUnit",value:function(e,t){return e=this.normalizeUnit(e),e=this.parseTimeUnit(e),this.unitLookup[e][t?"plural":"single"]}},{key:"normalizeUnit",value:function(e){return e?"date"===e.toLowerCase()?e.toLowerCase():ut.includes(e.toLowerCase())?e.toLowerCase():at[e]||at[e.toLowerCase()]:null}},{key:"getUnitByName",value:function(e){return t.normalizeUnit(e)||t.normalizeUnit(this.parseTimeUnit(e))}},{key:"getDurationInUnit",value:function(e,t,n,r){return this.diff(e,t,n,r)}},{key:"doesUnitsAlign",value:function(e,t){return e===t||"week"!==t}},{key:"getSmallerUnit",value:function(e){return ut[gt[this.normalizeUnit(e)]-1]||null}},{key:"getLargerUnit",value:function(e){return ut[gt[this.normalizeUnit(e)]+1]||null}},{key:"parseDuration",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this,i=t?st:lt,o=i.exec(e);if(null==e||!o)return null;var a=ht(o[1]),s=r.parseTimeUnit(o[2])||n;return s?{magnitude:a,unit:s}:null}},{key:"parseTimeUnit",value:function(e){var t=null==e?null:this.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(var n=0;n<ut.length;n++)if(t[n+1])return ut[n]}},{key:"fillDayNames",value:function(){var e=this,t=new Date("2000-01-01T00:00:00"),n=e._dayNames||[],r=e._dayShortNames||[];n.length=0,r.length=0;for(var i=2;i<9;i++)t.setDate(i),n.push(e.format(t,"dddd")),r.push(e.format(t,"ddd"));e._dayNames=n,e._dayShortNames=r}},{key:"getDayNames",value:function(){return this._dayNames}},{key:"getDayName",value:function(e){return this._dayNames[e]}},{key:"getDayShortNames",value:function(){return this._dayShortNames}},{key:"getDayShortName",value:function(e){return this._dayShortNames[e]}},{key:"fillMonthNames",value:function(){var e=this,t=new Date("2000-01-01T00:00:00"),n=e._monthNames||[],r=e._monthShortNames||[];n.length=0,r.length=0;for(var i=0;i<12;i++)t.setMonth(i),n.push(e.format(t,"MMMM")),r.push(e.format(t,"MMM"));e._monthNames=n,e._monthShortNames=r}},{key:"getMonthShortNames",value:function(){return this._monthShortNames}},{key:"getMonthShortName",value:function(e){return this._monthShortNames[e]}},{key:"getMonthNames",value:function(){return this._monthNames}},{key:"getMonthName",value:function(e){return this._monthNames[e]}},{key:"applyLocale",value:function(){var e=this,t=e.L("unitAbbreviations"),n=e.unitNames=e.L("unitNames");if("unitNames"!==n){"en-US"===(Ye=e.L("locale")||"en-US")?Ue=We:"ordinalSuffix"!==e.L("ordinalSuffix")&&(Ue=e.L("ordinalSuffix")),qe={},Xe={},$e={};var r="";e.unitLookup={};for(var i=0;i<t.length;i++){var o=t[i],a=n[i];a.canonicalUnitName=ut[i],e.unitLookup[a.single]=e.unitLookup[a.single.toUpperCase()]=e.unitLookup[a.canonicalUnitName]=e.unitLookup[a.canonicalUnitName.toUpperCase()]=a,r+="".concat(i?"|":"","(");for(var s=0;s<o.length;s++)r+="".concat(o[s],"|");r+="".concat(a.single,"|").concat(a.plural,"|").concat(a.canonicalUnitName,")")}e.durationRegEx=new RegExp("^(?:".concat(r,")$")),e.fillDayNames(),e.fillMonthNames()}}},{key:"defaultFormat",set:function(e){this._defaultFormat=e},get:function(){return this._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}},{key:"weekStartDay",get:function(){var e=this.L("weekStartDay");return"weekStartDay"!==e?e:0}},{key:"locale",set:function(e){Ye=e},get:function(){return Ye}}]),t}(Ve());vt._$name="DateHelper",je.on({locale:"applyLocale",thisObj:vt}),je.locale&&vt.applyLocale(),vt._$name="DateHelper";var mt=/\s+/,pt=function(e){var t=U()(e);if("object"===t){if(null===e)return"null";if("[object Date]"===Object.prototype.toString.call(e))return"date"}return t},yt="1.01"===1.005.toFixed(2)?null:function(e,t){var n=e.toString().split("."),r=+(n[1]?n.join(".")+"1":n[0]);return e.toFixed.call(r,t)},kt=function(){function e(){C()(this,e)}return x()(e,null,[{key:"isEqual",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===e&&null!==t||void 0===e&&void 0!==t||null===t&&null!==e||void 0===t&&void 0!==e)return!1;if(null==e&&null==t)return!0;if(e===t)return!0;var i=U()(e),o=U()(t);if(i===o){switch(i){case"number":case"string":case"boolean":return e===t}switch(!0){case e instanceof Date&&t instanceof Date:return e.getTime()===t.getTime();case Array.isArray(e)&&Array.isArray(t):return e.length===t.length&&e.every((function(e,i){return n.isEqual(e,t[i],r)}));case"object"===i&&e.constructor.prototype===t.constructor.prototype:return r?this.isDeeplyEqual(e,t,r):JSON.stringify(e)===JSON.stringify(t)}}return String(e)===String(t)}},{key:"isDeeplyEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;if(!e||!t)return!1;var r=this.keys(e,n.ignore),i=this.keys(t,n.ignore);if(r.length!==i.length)return!1;for(var o=0;o<r.length;o++){var a=r[o],s=i[o];if(a!==s)return!1;var l=e[a],u=t[s];if(!n.shouldEvaluate||!1!==n.shouldEvaluate(a,{value:l,object:e},{value:u,object:t})){if(n.evaluate){var c=n.evaluate(a,{value:l,object:e},{value:u,object:t});if(!1===c)return!1;if(!0===c)continue}if(!this.isEqual(l,u,n))return!1}}return!0}},{key:"isPartial",value:function(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),-1!=e.indexOf(t)}},{key:"isLessThan",value:function(e,t){return e instanceof Date&&t instanceof Date?vt.isBefore(e,t):e<t}},{key:"isMoreThan",value:function(e,t){return e instanceof Date&&t instanceof Date?vt.isAfter(e,t):e>t}},{key:"fork",value:function(e){var t,n,r;if(e&&e.constructor===Object)for(n in t=Object.setPrototypeOf({},e),e)(r=e[n])&&(r.constructor===Object?t[n]=this.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}},{key:"assign",value:function(e){for(var t,n,r=0,i=arguments.length<=1?0:arguments.length-1;r<i;r++)for(n in t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])e[n]=t[n];return e}},{key:"clone",value:function(e){if(null==e)return e;var t,n,r=e.constructor.name,i=e;if("Date"===r)return new Date(e.getTime());if("Array"===r)for(t=e.length,i=[];t--;)i[t]=this.clone(e[t]);else if("Object"===r)for(n in i={},e)i[n]=this.clone(e[n]);return i}},{key:"merge",value:function(e){for(var t,n,r,i,o=0,a=arguments.length<=1?0:arguments.length-1;o<a;o++)for(n in t=o+1<1||arguments.length<=o+1?void 0:arguments[o+1])(r=t[n])&&r.constructor===Object?(i=e[n])&&"Object"===i.constructor.name?this.merge(i,r):e[n]=this.clone(r):e[n]=r;return e}},{key:"copyProperties",value:function(e,t,n){var r,i;for(i=0;i<n.length;i++)(r=n[i])in t&&(e[r]=t[r]);return e}},{key:"copyPropertiesIf",value:function(e,t,n){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l in e||(e[l]=t[l])}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}},{key:"keys",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];for(var r in e)t&&t[r]||n.push(r);return n}},{key:"isEmpty",value:function(e){for(var t in e)return!1;return!0}},{key:"getTruthyKeys",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;)e[t[n]]?n++:t.splice(n,1);return t}},{key:"getTruthyValues",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;)e[t[n]]?t[n]=e[t[n++]]:t.splice(n,1);return t}},{key:"createTruthyKeys",value:function(e){"string"==typeof e&&(e=e.split(mt));var t={},n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.length&&(t[s]=1)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}},{key:"allKeys",value:function(e){for(var t=[];e;e=Object.getPrototypeOf(e))t.push.apply(t,G()(Object.keys(e)));return t}},{key:"pathExists",value:function(e,t){return t.split(".").every((function(t){return t in e&&(e=e[t],!0)}))}},{key:"getPath",value:function(e,t){return t.split(".").reduce((function(e,t){return(e||{})[t]}),e)}},{key:"setPath",value:function(e,t,n){t.split(".").reduce((function(e,t,r,i){return r===i.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e[t])}),e)}},{key:"coerce",value:function(e,t){var n=pt(e),r=pt(t),i="string"==typeof e;if(n!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return!(i&&(!e||"false"===e||"0"===e))&&Boolean(e);case"null":return!(!i||e&&"null"!==e)&&null;case"undefined":return!(!i||e&&"undefined"!==e)&&void 0;case"date":return i&&isNaN(e)?vt.parse(e):Date(Number(e))}return e}},{key:"wrapProperty",value:function(e,t,n,r){for(var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o={},a=Object.getPrototypeOf(e),s=Object.getOwnPropertyDescriptor(a,t);!s&&a&&i;)(a=Object.getPrototypeOf(a))&&(s=Object.getOwnPropertyDescriptor(a,t));s?(s.set?o.set=function(t){s.set.call(e,t),r&&r.call(e,s.get.call(e))}:o.set=r,s.get?o.get=function(){var t=s.get.call(e);return n&&(t=n.call(e,t)),t}:o.get=n):(o.set=function(n){e["_".concat(t)]=n,r&&r.call(e,n)},o.get=function(){var r=e["_".concat(t)];return n&&(r=n.call(e,r)),r}),Object.defineProperty(e,t,o)}},{key:"getPropertyDescriptor",value:function(e,t){for(var n=null,r=e;!n&&r!==z;r=Object.getPrototypeOf(r))n=Object.getOwnPropertyDescriptor(r,t);return n}},{key:"cleanupProperties",value:function(e){return Object.entries(e).forEach((function(t){var n=fe()(t,2),r=n[0];return null==n[1]&&delete e[r]})),e}},{key:"assertType",value:function(e,t,n){if(null!=e&&U()(e)!==t)throw new Error('Incorrect type "'.concat(U()(e),'" for ').concat(n,', expected "').concat(t,'"'))}},{key:"assertNumber",value:function(e,t){this.assertType(e,"number",t)}},{key:"assertBoolean",value:function(e,t){this.assertType(e,"boolean",t)}},{key:"toFixed",value:function(e,t){return yt?yt(e,t):e.toFixed(t)}},{key:"round",value:function(e,t){if(null==t)return e;var n=Math.pow(10,t);return Math.round(e*n)/n}}]),e}();kt._$name="ObjectHelper";var bt=function(){function e(){C()(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];"object"===U()(n[0])?Object.assign(this,n[0]):this.process(1,n),this[Et]=!0}return x()(e,[{key:"clone",value:function(){return new e(this)}},{key:"toString",value:function(){return this.length?"".concat(this.value," "):""}},{key:"trim",value:function(){return this.value}},{key:"isEqual",value:function(e){if("string"==typeof e&&(xt.value=e,e=xt),this.length===e.length){for(var t=kt.getTruthyKeys(e),n=0,r=t.length;n<r;n++)if(!this[t[n]])return!1;return!0}return!1}},{key:"process",value:function(e,t){for(var n=t.length,r=0;r<n;r++)if(t[r])for(var i=t[r],o=i.values?Array.from(i.values()):i.item?Array.from(i):i.split(wt),a=o.length,s=0;s<a;s++)o[s]&&(this[o[s]]=e);this[Et]=!0}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.process(1,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.process(0,t)}},{key:"split",value:function(){return kt.getTruthyKeys(this)}},{key:"forEach",value:function(e){return kt.getTruthyKeys(this).forEach(e)}},{key:"value",get:function(){var e=this;if(e[Et]){var t=kt.getTruthyKeys(e);e[Ct]=t.length,e[St]=t.join(" "),e[Et]=!1}return e[St]},set:function(e){for(var t=Object.keys(this),n=t.length,r=0;r<n;r++)delete this[t[r]];e?this.process(1,[e]):this[Et]=!0}},{key:"length",get:function(){return this.value?this[Ct]:0}},{key:"isDomClassList",get:function(){return!0}}]),e}(),wt=/\s+/,St=Symbol("value"),Ct=Symbol("length"),Et=Symbol("dirty"),xt=new bt;bt._$name="DomClassList";var Dt,Tt,Rt,Mt,Ft,_t,At={align:"t0-t0"},It=null,Lt=0,Ot=null,Pt=/(?:matrix\((?:-?\d*\.?[0-9]*),\s?(?:-?\d*\.?[0-9]*),\s?(?:-?\d*\.?[0-9]*),\s?(?:-?\d*\.?[0-9]*),\s?(-?\d*\.?[0-9]*),\s?(-?\d*\.?[0-9]*))|(?:matrix3d\((?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(?:-?\d*),\s?(-?\d*),\s?(-?\d*))/,Ht=/translate(3d|X)?\((-?\d*\.?[0-9]*)px(?:,\s?(-?\d*\.?[0-9]*)px)?/,Nt=/translate(3d|Y)?\((-?\d*\.?[0-9]*)px(?:,\s?(-?\d*\.?[0-9]*)px)?/,Bt=/^[^a-z]+|[^\w:.-]+/gi,zt=/\s+/,jt={tag:1,html:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,className:1,unmatched:1,_element:1,onlyChildren:1,elementData:1,compareHtml:1,syncOptions:1},Vt={length:1,parentRule:1,style:1},Wt={width:1,height:1,top:1,left:1,minWidth:1,minHeight:1,maxWidth:1,maxHeight:1,fontSize:1},Gt={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,HTML:ge.isIE11?1:0,BODY:ge.isIE11?0:1},Yt=window,Ut=document,qt={},$t=[],Xt=Array.prototype.slice,Kt=new Promise((function(e){return e()})),Jt=window.devicePixelRatio||1,Qt=1===Jt?Math.round:function(e){return Math.round(e*Jt)/Jt},Zt=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],en=function(e){return e._hidden},tn=document.documentElement.getRootNode?function(e){return e.getRootNode()}:function(e){for(;e.parentNode;)e=e.parentNode;return e},nn=function e(t){return t&&(document.body.contains(t)||(Dt=tn(t).host)&&e(Dt))},rn=function(){function e(){C()(this,e)}return x()(e,null,[{key:"isFocusable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&(!this.isVisible(e)||Z.fromElement(e,en)))return!1;var n=e.nodeName;return Gt[n]||("A"===n||"LINK"===n)&&!!e.href||null!=e.getAttribute("tabIndex")||"true"===e.contentEditable}},{key:"isInView",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Oe.from(e),r=!0,i=n.height,o=n.width;r&&e.parentElement;)e=e.parentElement,r=(n=n.intersect(Oe.from(e)))&&(!t||n.height>=i&&n.width>=o);return r}},{key:"isVisible",value:function(e){for(var t,n,r,i=e.ownerDocument;e;e=(r=e).parentNode||r.host){if(e===i)return!0;if(1===e.nodeType&&(n=void 0,"none"===(n=(t=e).ownerDocument.defaultView.getComputedStyle(t)).getPropertyValue("display")||"hidden"===n.getPropertyValue("visibility")))return!1}return!1}},{key:"roundPx",value:function(e){return Qt(e)}},{key:"isCustomElement",value:function(e){return e&&e.shadowRoot}},{key:"elementFromPoint",value:function(t,n){var r=document.elementFromPoint(t,n);return e.isCustomElement(r)&&(r=r.shadowRoot.elementFromPoint(t,n)||r),r}},{key:"getId",value:function(e){return e.id||(e.id="b-element-"+ ++Lt)}},{key:"getElement",value:function(e){return e instanceof Element?e:Ut.querySelector(e)}},{key:"setAttributes",value:function(e,t){var n=this.getElement(e);Object.entries(t).forEach((function(e){var t=fe()(e,2),r=t[0],i=t[1];return n.setAttribute(r,i)}))}},{key:"setLength",value:function(e,t,n){return 1===arguments.length?"number"==typeof e?"".concat(e,"px"):e:(e=this.getElement(e)).style[t]="number"==typeof n?"".concat(n,"px"):n}},{key:"getChild",value:function(e,t){if(ge.supportsQueryScope)t=":scope>"+t;else{var n=e.id||(e.id="b-element-"+ ++Lt);t="#".concat(n," > ").concat(t)}return e.querySelector(t)}},{key:"hasChild",value:function(t,n){return null!=e.getChild(t,n)}},{key:"children",value:function(e,t){return Array.from(e.querySelectorAll(t))}},{key:"down",value:function(e,t){if(!e)return null;if(e.matches&&e.matches(t))return e;if(ge.supportsQueryScope)t=":scope "+t;else{var n=e.id||(e.id="b-element-"+ ++Lt);t="#".concat(n," ").concat(t)}return e.querySelector(t)}},{key:"isDescendant",value:function(e,t){return e.contains||(e=e.body),e.contains(t)}},{key:"forEachSelector",value:function(e,t,n){"string"==typeof e&&(n=t,t=e,e=Ut),this.children(e,t).forEach(n)}},{key:"forEachChild",value:function(e,t){Array.from(e.children).forEach(t)}},{key:"removeEachSelector",value:function(e,t){this.forEachSelector(e,t,(function(e){return e.remove()}))}},{key:"removeClsGlobally",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];r.forEach((function(n){return t.forEachSelector(e,"."+n,(function(e){return e.classList.remove(n)}))}))}},{key:"up",value:function(e,t){return e&&e.closest(t)}},{key:"getAncestor",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!1,o=e;for(Array.isArray(t)||(t=[t]);o=o.parentElement;){if(t.includes(o)){i=!0;break}if(r&&o===r)break;n=o}return i?n||e:null}},{key:"getParents",value:function(e){for(var t=[];e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}},{key:"makeValidId",value:function(e){return null==e?null:String(e).replace(Bt,"")}},{key:"createElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;"string"==typeof t.parent&&(t.parent=document.getElementById(t.parent)),t.syncOptions&&t.syncOptions.syncIdField&&(i=t.syncOptions.syncIdField);var o,a=t.parent||t.nextSibling&&t.nextSibling.parentNode;o=t.ns?Ut.createElementNS(t.ns,t.tag||"svg"):Ut.createElement(t.tag||"div"),null!=t.html&&(t.html instanceof DocumentFragment?o.appendChild(t.html):o.innerHTML=t.html),t.tooltip&&te.attachTooltip(o,t.tooltip),t.style&&this.applyStyle(o,t.style),t.dataset&&Object.assign(o.dataset,t.dataset),a&&a.insertBefore(o,t.nextSibling),t.reference&&((r||(r={}))[t.reference]=o,o.setAttribute("reference",t.reference)),t.elementData&&(o.elementData=t.elementData);var s=t.className;s&&(s.isDomClassList?o.className=s.toString():"object"===U()(s)?o.className=new bt(s):o.className=s);for(var l=0,u=Object.keys(t);l<u.length;l++){var c=u[l];jt[c]||(t.ns?o.setAttribute(c,t[c]):o[c]=t[c])}return!0===n?n=[o]:Array.isArray(n)&&n.push(o),t.children&&(i&&(o.syncIdMap={}),t.children.forEach((function(a){if(a)if("string"==typeof a)o.appendChild(document.createTextNode(a));else if(isNaN(a.nodeType)){a.parent=o,!a.ns&&t.ns&&(a.ns=t.ns);var s=e.createElement(a,n,r,i),l=a.dataset&&a.dataset[i];null!=l&&(o.syncIdMap[l]=s),delete a.parent}else o.appendChild(a)}))),o.lastConfig=t,t._element=o,r||n||o}},{key:"createElementFromTemplate",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qt,i=r.array,o=r.raw,a=r.fragment;if(e.supportsTemplate){if((Tt||(Tt=Ut.createElement("template"))).innerHTML=t,n=Tt.content,a)return n.cloneNode(!0)}else{if((Rt||(Rt=new DOMParser)).parseFromString(t,"text/html"),n=Rt.parseFromString(t,"text/html").body,a){var s=n?n.childNodes:$t;for(n=document.createDocumentFragment();s.length;)n.appendChild(s[0]);return n}n||(n={children:[],childNodes:[]})}return 1!==(n=o?n.childNodes:n.children).length||i?Xt.call(n):n[0]}},{key:"insertFirst",value:function(t,n){return n&&n.nodeType!==Node.ELEMENT_NODE&&n.tag&&(n=e.createElement(n)),t.insertBefore(n,t.firstElementChild)}},{key:"insertBefore",value:function(t,n,r){return n&&n.nodeType!==Node.ELEMENT_NODE&&n.tag&&(n=e.createElement(n)),r?t.insertBefore(n,r):e.insertFirst(t,n)}},{key:"append",value:function(t,n){return n&&("string"==typeof n?n=e.createElementFromTemplate(n):n.nodeType!==Node.ELEMENT_NODE&&n.tag&&(n=e.createElement(n))),Array.isArray(n)?n.map((function(e){return t.appendChild(e)})):t.appendChild(n)}},{key:"getTranslateX",value:function(e){var t=e.style.transform,n=Ht.exec(t);return n?parseInt(n[2]):(n=Pt.exec(t)||Pt.exec(this.getStyleValue(this.getElement(e),"transform")))?parseInt(n[1]||n[3]):0}},{key:"getTranslateY",value:function(e){var t=e.style.transform,n=Nt.exec(t);if(n){var r=parseInt(n["Y"===n[1]?2:3]);return isNaN(r)?0:r}return(n=Pt.exec(t)||Pt.exec(this.getStyleValue(this.getElement(e),"transform")))?parseInt(n[2]||n[4]):0}},{key:"getTranslateXY",value:function(e){return[this.getTranslateX(e),this.getTranslateY(e)]}},{key:"getOffsetX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}},{key:"getOffsetY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}},{key:"getOffsetXY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return[this.getOffsetX(e,t),this.getOffsetY(e,t)]}},{key:"focusWithoutScrolling",value:function(t){function n(e){e.forEach((function(e){var t=e.element,n=e.scrollLeft,r=e.scrollTop;t.scrollLeft!==n&&(t.scrollLeft=n),t.scrollTop!==r&&(t.scrollTop=r)}))}if(ge.chromeVersion>=64||ge.fireFoxVersion>=68)t.focus({preventScroll:!0});else{var r=e.getParents(t).map((function(e){return{element:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}));t.focus(),ge.isIE11?n(r):setTimeout((function(){return n(r)}),0)}}},{key:"getPageX",value:function(e){return e.getBoundingClientRect().left+Yt.pageXOffset}},{key:"getPageY",value:function(e){return e.getBoundingClientRect().top+Yt.pageYOffset}},{key:"getExtremalSizePX",value:function(e,t){var n=A.hyphenate(t),r=n.split("-")[1],i=this.getStyleValue(e,n);return i=/%/.test(i)?e.parentElement?parseInt(this.getStyleValue(e.parentElement,r),10):NaN:parseInt(i,10)}},{key:"setTranslateX",value:function(t,n){var r=e.getStyleValue(t,"transform").split(/,\s*/);n=Qt(n),r.length>1?(r[r[0].startsWith("matrix3d")?12:4]=n,t.style.transform=r.join(",")):t.style.transform="translateX(".concat(n,"px)")}},{key:"setTranslateY",value:function(t,n){var r=e.getStyleValue(t,"transform").split(/,\s*/);n=Qt(n),r.length>1?(r[r[0].startsWith("matrix3d")?13:5]=n,t.style.transform=r.join(",")+")"):t.style.transform="translateY(".concat(n,"px)")}},{key:"setTop",value:function(e,t){this.setLength(e,"top",t)}},{key:"setLeft",value:function(e,t){this.setLength(e,"left",t)}},{key:"setTranslateXY",value:function(t,n,r){if(null==n)return this.setTranslateY(t,r);if(null==r)return this.setTranslateX(t,n);n=Qt(n),r=Qt(r);var i=e.getStyleValue(t,"transform").split(/,\s*/),o=i[0].startsWith("matrix3d");i.length>1?(i[o?12:4]=n,i[o?13:5]=r,t.style.transform=i.join(",")+")"):t.style.transform="translateX(".concat(n,"px) translateY(").concat(r,"px)")}},{key:"addTranslateX",value:function(t,n){e.setTranslateX(t,e.getTranslateX(t)+n)}},{key:"addTranslateY",value:function(t,n){e.setTranslateY(t,e.getTranslateY(t)+n)}},{key:"addLeft",value:function(t,n){e.setLeft(t,e.getOffsetX(t)+n)}},{key:"addTop",value:function(t,n){e.setTop(t,e.getOffsetY(t)+n)}},{key:"alignTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:At;t=t instanceof Oe?t:Oe.from(t,null,!0);var r=this.getTranslateXY(e),i=Oe.from(e,null,!0),o=i.alignTo(Object.assign(n,{target:t}));this.setTranslateXY(e,r[0]+o.x-i.x,r[1]+o.y-i.y)}},{key:"getStyleValue",value:function(e,t,n,r){var i=n?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){var o={},a=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;o[d]=i.getPropertyValue(A.hyphenate(d))}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return o}return i.getPropertyValue(A.hyphenate(t))}},{key:"applyStyle",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof t)n?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else for(var r in n&&(e.style.cssText=""),t.style&&("string"==typeof t.style?e.style.cssText=t.style:t=Object.assign({},t.style,t)),t)Vt[r]||(Wt[r]&&"number"==typeof t[r]?e.style[A.hyphenate(r)]=t[r]+"px":e.style[A.hyphenate(r)]=t[r])}},{key:"getCSSText",value:function(e){if("string"==typeof e)return e;var t="";for(var n in e)Vt[n]||(t+="".concat(A.hyphenate(n),":").concat(e[n],";"));return t}},{key:"addClasses",value:function(e,t){t.forEach((function(t){return e.classList.add(t)}))}},{key:"removeClasses",value:function(e,t){t.forEach((function(t){return e.classList.remove(t)}))}},{key:"toggleClasses",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)||(t=[t]),!0===n?this.addClasses(e,t):!1===n?this.removeClasses(e,t):t.forEach((function(t){return e.classList.toggle(t)}))}},{key:"addTemporaryClass",value:function(e,t,n){n>0&&(e.classList.add(t),setTimeout((function(){e&&e.classList.remove(t)}),n))}},{key:"highlight",value:function(e){return e instanceof Oe?e.highlight():new Promise((function(t){setTimeout((function(){e.classList.add("b-fx-highlight"),setTimeout((function(){e.classList.remove("b-fx-highlight"),t()}),1e3)}),0)}))}},{key:"resetScrollBarWidth",value:function(){It=null}},{key:"measureText",value:function(e,t,n,r){var i=this.getMeasureElement(t,r);i[n?"innerHTML":"innerText"]=e;var o=i.clientWidth;return i.className="",o}},{key:"measureSize",value:function(t,n){if(!t)return 0;if("number"==typeof t)return t;if(!t.length)return 0;if(/^\d+(px)?$/.test(t))return parseInt(t);if(n){var r=this.getMeasureElement(n);r.innerHTML="",r.style.width=e.setLength(t);var i=r.offsetWidth;return r.style.width=r.className="",i}return/^\d+em$/.test(t)?14*parseInt(t):isNaN(t)?0:parseInt(t)}},{key:"getMeasureElement",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ut.body,r=Yt.getComputedStyle(t),i=n.offScreenDiv=n.offScreenDiv||e.createElement({parent:n,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},!0)[1];return Zt.forEach((function(e){i.style[e]!==r[e]&&(i.style[e]=r[e])})),i.className=t.className,i.parentElement.parentElement!==n&&n.appendChild(i.parentElement),i}},{key:"sync",value:function(e,t){if("string"==typeof e){if(""===e)return void(t.innerHTML="");e=this.createElementFromTemplate(e)}return this.performSync(e,t),t}},{key:"performSync",value:function(e,t){return e.outerHTML!==t.outerHTML&&(this.syncAttributes(e,t),this.syncContent(e,t),this.syncChildren(e,t),!0)}},{key:"getSyncAttributes",value:function(e){for(var t={},n=[],r=0;r<e.attributes.length;r++){var i=e.attributes[r];if(i.specified){var o=i.name.toLowerCase();t[o]=i.value,n.push(o)}}return{attributes:t,names:n}}},{key:"syncAttributes",value:function(e,t){var n=this.getSyncAttributes(e),r=n.attributes,i=n.names,o=this.getSyncAttributes(t),a=o.attributes,s=o.names,l=i.includes("dataset"),u=i.filter((function(e){return!s.includes(e)})),c=s.filter((function(e){return!(i.includes(e)||l&&e.startsWith("data-"))})),d=i.filter((function(e){return s.includes(e)}));if(u.length>0)for(var h=0;h<u.length;h++){var f=u[h];"style"===f?this.applyStyle(t,r.style,!0):"dataset"===f?Object.assign(t.dataset,r.dataset):t.setAttribute(f,r[f])}if(c.length>0)for(var g=0;g<c.length;g++)t.removeAttribute(c[g]);if(d.length>0)for(var v=0;v<d.length;v++){var m=d[v];if("style"===m)this.applyStyle(t,r.style,!0);else if("dataset"===m)Object.assign(t.dataset,r.dataset);else if("class"!==m||!r.class.isDomClassList&&"object"!==U()(r.class))a[m]!==r[m]&&t.setAttribute(m,r[m]);else{var p=void 0;(p=r.class.isDomClassList?r.class:new bt(r.class)).isEqual(a.class)||t.setAttribute("class",p)}}}},{key:"syncContent",value:function(e,t){0===e.childElementCount&&(t.innerText=e.innerText)}},{key:"setInnerText",value:function(e,t){var n=e.firstChild;n?n.data=t:e.textContent=t}},{key:"syncChildren",value:function(e,t){for(var n=Xt.call(e.childNodes),r=Xt.call(t.childNodes);n.length;){var i=n.shift(),o=r.shift();if(i&&i.nodeType!==Node.TEXT_NODE&&i.nodeType!==Node.ELEMENT_NODE)throw new Error("Source node type ".concat(i.nodeType," not supported by DomHelper.sync()"));if(o&&o.nodeType!==Node.TEXT_NODE&&o.nodeType!==Node.ELEMENT_NODE)throw new Error("Target node type ".concat(o.nodeType," not supported by DomHelper.sync()"));if(o)if(i.nodeType===o.nodeType)i.nodeType===Node.TEXT_NODE?o.data=i.data:i.tagName===o.tagName?this.performSync(i,o):(t.insertBefore(i,o),o.remove());else{if(i.nodeType!==Node.TEXT_NODE||o.nodeType!==Node.ELEMENT_NODE)throw new Error("Currently no support for transforming nodeType");t.innerText=i.data.trim()}else t.appendChild(i)}r.forEach((function(e){e.remove()}))}},{key:"syncClassList",value:function(e,t){var n,r=e.classList,i="string"==typeof t,o=i?t.trim().split(zt):Array.isArray(t)?t:kt.getTruthyKeys(t),a=o.length,s=r.length!==a;for(n=0;!s&&n<a;n++)s=!r.contains(o[n]);s&&(e.className=i?t:o.join(" "))}},{key:"setTheme",value:function(t){t=t.toLowerCase();var n=this.themeInfo.name.toLowerCase(),r=document.head.querySelector("#bryntum-theme")||document.head.querySelector('[href$="'.concat(n,'.css"]'));if(!r||!r.href.includes("".concat(n,".css")))throw new Error("Theme link for ".concat(n," not found"));return r.href.includes(t)?Kt:new Promise((function(n,i){var o=document.createElement("link"),a=r.nextSibling,s=e.themeInfo.name.toLowerCase(),l={theme:t,prev:s};o.rel="stylesheet",o.id="bryntum-theme",o.addEventListener("load",(function(){Ot=null,r.remove(),window.bryntum.GlobalEvents.trigger("theme",l),n(l)})),o.addEventListener("error",(function(e){i(e)})),o.href=r.href.replace(s,t),a.parentNode.insertBefore(o,a)}))}},{key:"activeElement",get:function(){for(var e=document.activeElement;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}},{key:"scrollBarWidth",get:function(){if(null===It&&Ut.body){var t=e.createElement({parent:Ut.body,style:"position:absolute;top:-999px;width:100px;height:100px;overflow:scroll"});It=t.offsetWidth-t.clientWidth,t.remove()}return It}},{key:"themeInfo",get:function(){if(!Ot){var e=this.createElement({parent:document.body,className:"b-theme-info"}),t=this.getStyleValue(e,"content",!1,":before");if(t)try{Ot=JSON.parse(t.replace(/^["']|["']$|\\/g,""))}catch(e){Ot=null}e.remove()}return Ot}}]),e}(),on=function(){return rn.isTouchEvent=!1},an=function(){rn.isTouchEvent=!0,clearTimeout(Mt),Mt=setTimeout(on,400)};if(Ut.addEventListener("touchstart",an,!0),Ut.addEventListener("touchend",an,!0),rn.supportsTemplate="content"in Ut.createElement("template"),!("children"in Node.prototype)){var sn=function(e){return 1===e.nodeType};Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,sn)}})}(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),Yt.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(e){var t=this;if(!Ut.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}:Node.prototype.closest=function(e){return this.parentNode.closest(e)},[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),SVGElement.prototype.contains||(SVGElement.prototype.contains=function(e){do{if(this===e)return!0;e=e.parentNode}while(e);return!1}),"function"!=typeof Yt.CustomEvent)&&(Yt.CustomEvent=_t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(Ft=Ut.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),Ft},_t.prototype=Yt.Event.prototype,Yt.MouseEvent=_t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(Ft=Ut.createEvent("MouseEvents")).initMouseEvent(e,t.bubbles,t.cancelable,Ut.defaultView||Yt,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,document),Ft},_t.prototype=Yt.Event.prototype,Yt.KeyboardEvent=_t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0},n="".concat(t.shiftKey?"Shift ":"").concat(t.ctrlKey?"Control":"");return(Ft=Ut.createEvent("KeyboardEvent")).initKeyboardEvent(e,t.bubbles,t.cancelable,Ut.defaultView||Yt,t.key,t.location,n,!1,""),Ft},_t.prototype=Yt.Event.prototype);if(!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset")||!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset").get){var ln={enumerable:!0,get:function(){var e,t,n,r,i,o={},a=this.attributes,s=a.length,l=function(e){return e.charAt(1).toUpperCase()},u=function(){return this},c=function(e,t){return void 0!==t?this.setAttribute(e,t):this.removeAttribute(e)};for(e=0;e<s;e++)(i=a[e])&&i.name&&/^data-\w[\w-]*$/.test(i.name)&&(t=i.value,r=(n=i.name).substr(5).replace(/-./g,l),Object.defineProperty(o,r,{enumerable:this.enumerable,get:u.bind(t||""),set:c.bind(this,n)}));return o}};Object.defineProperty(SVGElement.prototype,"dataset",ln)}var un=DOMTokenList.prototype.add,cn=DOMTokenList.prototype.remove;DOMTokenList.prototype.add=function(e){Array.isArray(e)?un.call.apply(un,[this].concat(G()(e))):un.call.apply(un,[this].concat(Array.prototype.slice.call(arguments)))},DOMTokenList.prototype.remove=function(e){Array.isArray(e)?cn.call.apply(cn,[this].concat(G()(e))):cn.call.apply(cn,[this].concat(Array.prototype.slice.call(arguments)))},rn._$name="DomHelper";var dn=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),this.element||(this.element=document.body),this.show()}},{key:"doDestroy",value:function(){var e=this;e.maskElement&&(e.maskElement.remove(),e.maskElement=null,e.mode.endsWith("blur")&&rn.forEachChild(e.element,(function(t){t.classList.remove("b-masked-".concat(e.mode))})),e.elementMask=null),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"create",value:function(){var e,t=this;t.elementMask=t,Object.assign(t,rn.createElement({parent:t.element,className:(e={"b-mask":1,"b-mask-type":1,"b-widget":1},$()(e,"b-mask-".concat(t.mode),1),$()(e,"b-progress",t.maxProgress),$()(e,"b-prevent-transitions",!t.useTransition),e),reference:"maskElement",children:[{className:"b-mask-content",reference:"maskContent",children:[t.maxProgress?{className:"b-mask-progress-bar",reference:"progressElement",style:{width:Math.round(t.progress/t.maxProgress*100)+"%"}}:null,{className:"b-mask-text",reference:"maskText"}]}]})),t.text=t._text}},{key:"show",value:function(){var e=this;e.hasTimeout("hide")&&(e.resolve(),e.clearTimeout("hide")),e.elementMask||e.create();var t=e.element,n=e.maskElement;n&&(t.classList.add("b-masked"),n.classList.add("b-visible"),n.classList.remove("b-hidden"),e.shown=!0,e.mode.endsWith("blur")&&rn.forEachChild(t,(function(t){t!==n&&t.classList.add("b-masked-".concat(e.mode))})))}},{key:"hide",value:function(){var e=this,t=e.element,n=e.maskElement;return new Promise((function(r){e.shown?(e.shown=!1,n.classList.remove("b-visible"),n.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&rn.forEachChild(t,(function(t){t!==n&&t.classList.remove("b-masked-".concat(e.mode))})),e.resolve=r,e.setTimeout((function(){return r()}),500,"hide")):r()}))}},{key:"close",value:function(){var e=this;return new Promise((function(t){e.hide().then((function(){e.destroy(),t()}))}))}},{key:"typeName",get:function(){return"string"==typeof this.type?this.type.trim():""}},{key:"maskName",get:function(){return"mask".concat(this.typeName)}},{key:"elementMask",get:function(){return this.element&&this.element[this.maskName]},set:function(e){this.element&&(this.element[this.maskName]=e)}},{key:"text",set:function(e){var t=this;t._text=e||"",t.maskText&&(t.maskText.innerHTML='<i class="b-mask-icon '.concat(t.icon,'"></i>').concat(t._text))},get:function(){return this._text}},{key:"progress",set:function(e){this._progress=e,this.progressElement&&null!=e&&(this.progressElement.style.width=Math.round(e/this._maxProgress*100)+"%")},get:function(){return this._progress}},{key:"maxProgress",set:function(e){this._maxProgress=e,this.progress=this.progress},get:function(){return this._maxProgress}}],[{key:"mask",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;return new t("string"!=typeof e?Object.assign({element:n},e):{element:n,text:e})}},{key:"unmask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return e.mask&&e.mask.close()}},{key:"$name",get:function(){return"Mask"}},{key:"defaultConfig",get:function(){return{mode:"dark",icon:"b-icon b-icon-spinner",text:null,type:null,progress:null,maxProgress:null,useTransition:!1}}}]),t}(de());dn._$name="Mask";n(24);var hn=n(14),fn=n.n(hn),gn=(n(39),null),vn=[],mn=function(e){return 1===e.nodeType&&"absolute"===e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue("position")},pn=function(){function e(){C()(this,e)}return x()(e,null,[{key:"addResizeListener",value:function(e,t){var n=this;if(e!==document&&e!==window||(e=document.body),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)n.hasWindowResizeListener||(window.addEventListener("resize",n.onWindowResize),n.hasWindowResizeListener=!0);else if(window.ResizeObserver)n.resizeObserver||(n.resizeObserver=new ResizeObserver(n.onElementResize)),n.resizeObserver.observe(e);else{var r=rn.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},!0),i=fe()(r,3),o=i[0],a=i[1],s=i[2];a.scrollLeft=a.scrollTop=s.scrollLeft=s.scrollTop=1e6,a.addEventListener("scroll",n.onSizeMonitorScroll,!0),s.addEventListener("scroll",n.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver((function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;"childList"===l.type&&(t.push.apply(t,l.removedNodes),t.push.apply(t,l.addedNodes))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}t.length>0&&t.every(mn)||a.dispatchEvent(new CustomEvent("scroll",{bubbles:!1}))}))).observe(e,{childList:!0,subtree:!0}),t.monitorElement=o}e._bResizemonitor.handlers.push(t)}},{key:"removeResizeListener",value:function(e,t){if(e){e!==document&&e!==window||(e=document.body);var n=e._bResizemonitor,r=0;n&&n.handlers&&(He.remove(n.handlers,t),r=n.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}},{key:"onElementResize",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=a.target,l=s._bResizemonitor,u=a.contentRect||s.getBoundingClientRect();if(s.offsetParent&&(!l.rectangle||u.width!==l.rectangle.width||u.height!==l.rectangle.height)){var c=l.rectangle;l.rectangle=u;var d=!0,h=!1,f=void 0;try{for(var g,v=l.handlers[Symbol.iterator]();!(d=(g=v.next()).done);d=!0){(0,g.value)(s,c,u)}}catch(e){h=!0,f=e}finally{try{d||null==v.return||v.return()}finally{if(h)throw f}}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"onSizeMonitorScroll",value:function(t){if(document.body.contains(t.target)){t.stopImmediatePropagation();var n=t.target.parentNode,r=n.parentNode,i=r._bResizemonitor,o=r.getBoundingClientRect();i.rectangle&&o.width===i.rectangle.width&&o.height===i.rectangle.height||(vn.push([r,i.rectangle,o]),i.rectangle=o,gn||(gn=requestAnimationFrame(e.fireResizeEvents))),n.firstChild.scrollLeft=n.firstChild.scrollTop=n.childNodes[1].scrollTop=n.childNodes[1].scrollLeft=1e6}}},{key:"onWindowResize",value:function(e){var t=document.body,n=t._bResizemonitor,r=n.rectangle;n.rectangle=document.documentElement.getBoundingClientRect();var i=!0,o=!1,a=void 0;try{for(var s,l=n.handlers[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){(0,s.value)(t,r,n.rectangle)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}},{key:"fireResizeEvents",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=vn[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=o[0]._bResizemonitor.handlers[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;o[0].offsetParent&&d.apply(this,o)}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}gn=null,vn.length=0}}]),e}();pn._$name="ResizeMonitor";var yn=function(e){function t(e,n){return C()(this,t),re()(this,oe()(t).call(this,e,n,0,0))}return ue()(t,e),x()(t,null,[{key:"from",value:function(e){var n=e.changedTouches;return new t(n?n[0].screenX:e.screenX,n?n[0].screenY:e.pageY)}}]),x()(t,[{key:"constrain",value:function(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}},{key:"toArray",value:function(){return[this.x,this.y]}}]),t}(Oe);yn.__proto__.Point=yn,yn._$name="Point";var kn=function(){function e(){C()(this,e)}return x()(e,null,[{key:"curry",value:function(e){return function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length>=e.length?e.apply(this,r):function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,r.concat(n))}}}},{key:"bindAll",value:function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=e[t].bind(e))}},{key:"createInterceptor",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return!1!==t.call.apply(t,[n].concat(i))&&e.call.apply(e,[n].concat(i))}}},{key:"createSequence",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=e.call.apply(e,[n].concat(i)),s=t.call.apply(t,[n].concat(i));return void 0===s?a:s}}},{key:"createThrottled",value:function(e,t,n,r,i){var o,a,s,l=0,u=function(){a=0,l=performance.now(),o.push.apply(o,r),e.apply(n,o)};return(s=function(){for(var e=performance.now()-l,s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];o=c,e>=t?(clearTimeout(a),u()):(a||(a=setTimeout(u,t-e)),i&&(o.push.apply(o,r),i.apply(n,o)))}).cancel=function(){return clearTimeout(a)},s}},{key:"createBuffered",value:function(e,t,n,r){var i,o,a,s=function(){o=0,i.push.apply(i,r),e.apply(n,i)};return(a=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];i=n,o&&clearTimeout(o),o=setTimeout(s,t)}).cancel=function(){return clearTimeout(o)},a}},{key:"returnTrue",value:function(){return!0}},{key:"animate",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"linear",o=!1,a=new Promise((function(a){var s=performance.now();!function l(){var u=Math.min((performance.now()-s)/e,1);o||!1===t.call(n,r.easingFunctions[i](u))&&a(),o||1===u?requestAnimationFrame((function(){return a()})):requestAnimationFrame(l)}()}));return a.cancel=function(){return o=!0,!1},a}}]),e}(),bn=1.70158,wn=7.5625,Sn=1.525,Cn=2/2.75,En=2.25/2.75,xn=1/2.75,Dn=1.5/2.75,Tn=2.5/2.75,Rn=2.625/2.75;kn.easingFunctions={linear:function(e){return e},easeInQuad:function(e){return Math.pow(e,2)},easeOutQuad:function(e){return-(Math.pow(e-1,2)-1)},easeInOutQuad:function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},easeInCubic:function(e){return Math.pow(e,3)},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},easeInQuart:function(e){return Math.pow(e,4)},easeOutQuart:function(e){return-(Math.pow(e-1,4)-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeInQuint:function(e){return Math.pow(e,5)},easeOutQuint:function(e){return Math.pow(e-1,5)+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeOutBounce:function(e){return e<xn?wn*e*e:e<Cn?wn*(e-=Dn)*e+.75:e<Tn?wn*(e-=En)*e+.9375:wn*(e-=Rn)*e+.984375},easeInBack:function(e){return e*e*((bn+1)*e-bn)},easeOutBack:function(e){return(e-=1)*e*((bn+1)*e+bn)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Sn))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Sn))*e+t)+2)},elastic:function(e){return-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1},swingFromTo:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Sn))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Sn))*e+t)+2)},swingFrom:function(e){return e*e*((bn+1)*e-bn)},swingTo:function(e){return(e-=1)*e*((bn+1)*e+bn)+1},bounce:function(e){return e<xn?wn*e*e:e<Cn?wn*(e-=Dn)*e+.75:e<Tn?wn*(e-=En)*e+.9375:wn*(e-=Rn)*e+.984375},bouncePast:function(e){return e<xn?wn*e*e:e<Cn?2-(wn*(e-=Dn)*e+.75):e<Tn?2-(wn*(e-=En)*e+.9375):2-(wn*(e-=Rn)*e+.984375)},easeFromTo:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeFrom:function(e){return Math.pow(e,4)},easeTo:function(e){return Math.pow(e,.25)}},kn._$name="FunctionHelper";var Mn=["clientX","clientY","pageX","pageY","screenX","screenY"],Fn={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1},_n={get:function(){return!0}},An={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},In=function(e){var t=e.type;if(t.startsWith("key")){var n=An[e.key];n&&Object.defineProperty(e,"key",{get:function(){return n}})," "!==e.key||e.code||Object.defineProperty(e,"code",{get:function(){return"Space"}})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",_n),e.target&&e.target.shadowRoot&&e.composedPath&&!ge.isIE11&&!ge.isEdge){var r=e.composedPath()[0],i=e.target;e.target!==r&&(Object.defineProperty(e,"target",{get:function(){return r}}),Object.defineProperty(e,"originalTarget",{get:function(){return i}}))}if(ge.isChrome&&e.target){var o=e.target,a=e.offsetX,s=e.offsetY,l=o.offsetWidth,u=o.offsetHeight,c=Math.min(Math.max(a,0),l-1),d=Math.min(Math.max(s,0),u-1);!Object.getOwnPropertyDescriptor(e,"offsetX")&&(a<0||a>=l)&&Object.defineProperty(e,"offsetX",{get:function(){return c}}),!Object.getOwnPropertyDescriptor(e,"offsetY")&&(s<0||s>=u)&&Object.defineProperty(e,"offsetY",{get:function(){return d}})}if(e.target&&9===e.target.nodeType&&"clientX"in e){var h=rn.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{get:function(){return h}})}if(e.target&&3===e.target.nodeType){var f=e.target.parentElement;Object.defineProperty(e,"target",{get:function(){return f}})}if(e.relatedTarget&&3===e.relatedTarget.nodeType){var g=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{get:function(){return g}})}return t.startsWith("touch")&&e.touches.length&&Ln.normalizeEvent(e),e},Ln=function(){function e(){C()(this,e)}return x()(e,null,[{key:"normalizeEvent",value:function(e){return kt.copyPropertiesIf(e,e.touches[0]||e.changedTouches[0],Mn)}},{key:"getXY",value:function(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}},{key:"getDistanceBetween",value:function(e,t){var n=this.getXY(e),r=this.getXY(t);return Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2))}},{key:"getPagePoint",value:function(e){return new yn(e.pageX,e.pageY)}},{key:"getClientPoint",value:function(e){return new yn(e.clientX,e.clientY)}},{key:"addListener",value:function(e,t,n,r){return r=e.nodeType?"string"==typeof t?Object.assign($()({element:e},t,n),r):Object.assign({element:e},t):e,this.on(r)}},{key:"on",value:function(e){var t,n,r=e.element,i=e.thisObj,o=[],a=kt.allKeys(e),s=a.length;for(t=0;t<s;t++)if(n=a[t],!Fn[n]){var l=e[n];"object"!==U()(l)&&(l={handler:l});var u=l.element||r;ge.isTouchDevice&&!ge.isAndroid&&"contextmenu"===n&&o.push(this.addElementListener(u,"touchstart",{handler:this.createContextMenuWrapper(l.handler,l.thisObj||i)},e)),o.push(this.addElementListener(u,n,l,e))}var c=function(){for(s=o.length,t=0;t<s;t++){var e=o[t];e[0].removeEventListener(e[1],e[2],e[3])}o.length=0};return i&&!1!==e.autoDetach&&(i.doDestroy=kn.createInterceptor(i.doDestroy,c,i)),c}},{key:"addElementListener",value:function(e,t,n,r){var i=this.createHandler(e,t,n,r),o="passive"in n,a=n.expires||r.expires,s=n.capture||r.capture;return(o||"passive"in r)&&ge.supportsPassive&&(s={capture:!!s,passive:o?n.passive:r.passive}),e.addEventListener(t,i,s),a&&("number"==typeof a?setTimeout:requestAnimationFrame)((function(){return e.removeEventListener(t,i,s)}),a),[e,t,i,s]}},{key:"createHandler",value:function(e,t,n,r){var i=this,o=n.delay||r.delay,a=n.throttled||r.throttled,s=n.once||r.once,l=n.thisObj||r.thisObj,u=n.capture||r.capture,c=n.delegate||r.delegate,d=n.handler,h=function(e){var t;if(!(i.playingDemo&&e.isTrusted||l&&l.isDestroyed)){if(In(e),c){var n=e.target instanceof HTMLElement&&e.target.closest(c);if(!n)return;Object.defineProperty(e,"currentTarget",{get:function(){return n},configurable:!0})}"string"==typeof d&&(d=l[d]);for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];(t=d).call.apply(t,[l,e].concat(o))}};if(null!=o){var f=h;h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];setTimeout((function(){f.apply(void 0,t)}),o)}}if(null!=a){var g,v=a;a.buffer&&(g=function(e){return a.alt.call(i,In(e))},v=a.buffer),h=kn.createThrottled(h,v,l,null,g)}if(s){var m=h;h=function(){e.removeEventListener(t,h,u),m.apply(void 0,arguments)}}return n.thisObj&&!1!==n.autoDetach&&(l.doDestroy=kn.createInterceptor(l.doDestroy,(function(){return e.removeEventListener(t,h)}),l)),h}},{key:"createContextMenuWrapper",value:function(e,t){var n=this;return function(r){if(1===r.touches.length)var i=r.touches[0],o=setTimeout((function(){s();var o=new MouseEvent("contextmenu",i);Object.defineProperty(o,"target",{get:function(){return i.target}}),"string"==typeof e&&(e=t[e]),o.browserEvent=r,e.call(t,o),n.contextMenuTouchId=i.identifier}),n.longPressTime),a=function(){n.contextMenuTouchId=null,s(),clearTimeout(o)},s=n.on({element:document,touchmove:a,touchend:a,pointermove:a,pointerup:a,capture:!0})}}},{key:"createDblClickWrapper",value:function(e,t,n){var r,i,o,a=this;return function(){i||(i=a.on({element:e,touchstart:function(e){r=e.changedTouches[0].identifier,e.preventDefault()},touchend:function(e){if(e.changedTouches[0].identifier===r){e.preventDefault(),clearTimeout(o),r=i=null;var a=Oe.from(e.changedTouches[0].target,null,!0),s=e.changedTouches[0].pageX-a.x,l=e.changedTouches[0].pageY-a.y,u=Object.assign({browserEvent:e},e),c=new MouseEvent("dblclick",u);Object.defineProperty(c,"target",{get:function(){return e.target}}),Object.defineProperty(c,"offsetX",{get:function(){return s}}),Object.defineProperty(c,"offsetY",{get:function(){return l}}),"string"==typeof t&&(t=n[t]),t.call(n,c)}},once:!0}),o=setTimeout((function(){i(),r=i=null}),a.dblClickTime))}}},{key:"lockComposedPath",value:function(e){var t;e.composedPath&&(e.composedPath=(t=e.composedPath(),function(){return t}))}}]),e}();Ln.longPressTime=500,Ln.dblClickTime=300,Ln.on({element:document,mousedown:function(){rn.isTouchEvent||(rn.usingKeyboard=!1,document.body.classList.remove("b-using-keyboard"))},touchmove:function(){rn.usingKeyboard=!1,document.body.classList.remove("b-using-keyboard")},keydown:function(){rn.usingKeyboard=!0,document.body.classList.add("b-using-keyboard")}}),ge.isTouchDevice&&Ln.on({element:document,touchmove:function(e){e.target.closest(".b-dragging")&&e.preventDefault()},passive:!1,capture:!0}),Ln._$name="EventHelper";n(176);var On=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){"function"==typeof e&&(e={filterBy:e}),se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"onChange",value:function(e){var t=this;!t.isConfiguring&&t.owner&&!t.owner.isConfiguring&&t.owner.onFilterChanged&&t.owner.onFilterChanged(t,e)}},{key:"defaultFilterBy",value:function(e){return this[this.operator](this.convert(e[this.property]))}},{key:"convert",value:function(e){return this.caseSensitive||"string"!=typeof e?e:e.toLowerCase()}},{key:"filter",value:function(e){return this.filterBy(e)}},{key:"startsWith",value:function(e){return String(e).startsWith(this.value)}},{key:"endsWith",value:function(e){return String(e).endsWith(this.value)}},{key:"=",value:function(e){return kt.isEqual(e,this.value)}},{key:"!=",value:function(e){return!kt.isEqual(e,this.value)}},{key:">",value:function(e){return kt.isMoreThan(e,this.value)}},{key:">=",value:function(e){return kt.isMoreThan(e,this.value)||kt.isEqual(e,this.value)}},{key:"<",value:function(e){return kt.isLessThan(e,this.value)}},{key:"<=",value:function(e){return kt.isLessThan(e,this.value)||kt.isEqual(e,this.value)}},{key:"*",value:function(e){return kt.isPartial(e,this.value)}},{key:"id",get:function(){return this._id||(this._id=this.property||Z.generateId("b-filter"))},set:function(e){this._id=e}},{key:"filterBy",get:function(){return this._filterBy||this.defaultFilterBy},set:function(e){this._filterBy=e}},{key:"property",set:function(e){this._property=e,this.onChange("property")},get:function(){return this._property}},{key:"value",set:function(e){this._value=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase(),this.onChange("value")},get:function(){return this._value}},{key:"operator",set:function(e){this._operator=e,this.onChange("operator")},get:function(){return this._operator||("string"==typeof this.value?"*":"=")}}],[{key:"generateFiltersFunction",value:function(e){return e&&(e.length||e.count)?function(t){var n=!0,r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(l.disabled||(n=l.filter(t)),!n)break}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}:kn.returnTrue}},{key:"defaultConfig",get:function(){return{property:null,value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null}}}]),t}(z);On._$name="CollectionFilter";var Pn=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){"function"==typeof e&&(e={sortFn:e}),se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"defaultSortFn",value:function(e,t){var n=this.convert,r=this.property,i=this.useLocaleSort,o="desc"===this.direction.toLowerCase()?-1:1;if(e=e[r],t=t[r],n&&(e=n(e),t=n(t)),i&&null!=e&&null!=t){if(!0===i)return String(e).localeCompare(t);if("string"==typeof i)return String(e).localeCompare(t,i);if("object"===U()(i))return String(e).localeCompare(t,i.locale,i)}return(e>t?1:e<t?-1:0)*o}},{key:"id",get:function(){return this._id||(this._id=this.property||Z.generateId("b-sorter"))},set:function(e){this._id=e}},{key:"sortFn",set:function(e){this._sortFn=e},get:function(){return this._sortFn?this._sortFn:this.defaultSortFn}}],[{key:"generateSortFunction",value:function(e,t){var n=e.isCollection?e.values:e,r=n.length;return function(e,i){var o,a;for(a=0;a<r;++a)if(o=n[a].sortFn(e,i))return o;return t?t(e,i):0}}},{key:"defaultConfig",get:function(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}}]),t}(z);Pn._$name="CollectionSorter";var Hn=function(){return 0},Nn=function(e,t){return t-e},Bn=Symbol("filteredIndicesProperty"),zn=Object.freeze([]),jn=Object.freeze({action:"sort",added:zn,removed:zn,replaced:zn}),Vn=Object.freeze({action:"filter",added:zn,removed:zn,replaced:zn}),Wn={string:1,number:1},Gn=new WeakMap,Yn=function(e){if(e&&"object"===U()(e)){var t=Gn.get(e);void 0===t&&(t=Symbol("bscik"),Gn.set(e,t)),e=t}return e},Un=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){this.generation=0,this._values=[],se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"doDestroy",value:function(){se()(oe()(t.prototype),"doDestroy",this).call(this),this._values.length=0,this.isFiltered&&(this._filteredValues.length=0,this.filters.destroy()),this._sorters&&this._sorters.destroy()}},{key:"clear",value:function(){var e=this,t=this._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}},{key:"replaceValues",value:function(e,t,n){var r,i=this;i.isFiltered&&!n?(r=i._filteredValues,i._filteredValues=e.slice()):(r=i._values,i._values=e,i.isFiltered&&n&&i.autoFilter?(i._filterFunction=null,i._filteredValues=i._values.filter(i.filterFunction),i._indicesInvalid=!0):i._filteredValues&&(i._filteredValues.length=0)),i._indicesInvalid=!0,i.generation++,t||i.trigger("change",{action:"replaceValues",removed:r,values:e,replaced:[]})}},{key:Symbol.iterator,value:function(){return this.values[Symbol.iterator]()}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[this._values.length,null].concat(t)):this.splice(this._values.length,null,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[0].concat(t)):this.splice(0,t)}},{key:"move",value:function(e,t){var n=this,r=n._values,i=n.indexOf(e,!0),o=t?n.indexOf(t,!0):r.length;if(-1===i||-1===o)throw new Error("Collection move parameters must be present in Collection");return i!==o&&i!==o-1&&(i<o&&o--,r.splice(i,1),r.splice(o,0,e),n._indicesInvalid=!0,n.trigger("change",{action:"move",item:e,from:i,to:o})),o}},{key:"splice",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o,a,s=this,l=s.idProperty,u=s._values,c={},d=[],h=[],f=s.totalCount;if(r)if(1===r.length&&Array.isArray(r[0])&&(r=r[0]),f&&r.length){var g=s.indices[l];o=[];for(var v=0;v<r.length;v++){var m=r[v],p=Yn(m[l]),y=g[p];c[p]=!0,null!=y?u[y]!==m&&(h.push([u[y],m]),u[y]=m):o.push(m)}}else o=r;if(t)if("number"==typeof t)for(var k=e;t;--t){var b=Yn(u[k][l]);c[b]?(e++,k++):(d.push(u[k]),u.splice(k,1),s._indicesInvalid=a=!0)}else{var w,S=0===o.length;Array.isArray(t)||(t=[t]);var C=t.reduce((function(e,t){var n="number"==typeof t,r=n?t:s.indexOf(t,!0);return S&&(null!=w&&r!==w+1||n)&&(S=!1),r>=0&&r<f&&e.push(r),w=r,e}),[]).sort(Nn);if(S)C.length&&(d.push.apply(d,t),u.splice(C[C.length-1],C.length),s._indicesInvalid=a=!0);else for(var E=0;E<C.length;E++){var x=C[E];if(-1!==x){var D=Yn(u[x][l]);c[D]||(d.unshift(u[x]),u.splice(x,1),s._indicesInvalid=a=!0)}}}if(o.length&&(u.splice.apply(u,[Math.min(e,u.length),0].concat(G()(o))),s._indicesInvalid=a=!0),s.isSorted)s.onSortersChanged();else if(s.isFiltered){var T;if(s.autoFilter)s.onFiltersChanged();else(T=s._filteredValues).push.apply(T,G()(o))}a||h.length?(s.generation++,s.trigger("change",{action:"splice",removed:d,added:o,replaced:h,oldCount:f})):s.trigger("noChange",{index:e,toRemove:t,toAdd:r})}},{key:"changeId",value:function(e,t){var n=this,r=n.idProperty,i=Wn[U()(e)]?e:e[r],o=n.get(i);if(o){var a=n.get(t);if(a&&o!==a)throw new Error("Attempt to set item ".concat(i," to already existing member's id ").concat(t));if(o[r]=t,!n._indicesInvalid){var s=n.indices.id,l=s[i];delete s[i],s[t]=l}}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getBy(this.idProperty,e,t)}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}},{key:"getBy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;if(r.isFiltered&&n){var i=r.findIndex(e,t,!0);if(-1!==i)return r._values[i]}else{var o=r.findIndex(e,t);if(-1!==o)return r.values[o]}}},{key:"addSorter",value:function(e){var t=e instanceof Pn?e:new Pn(e);return this.sorters.add(t),t}},{key:"onSortersChanged",value:function(){var e=this;delete e._sortFunction,e._values.sort(e.sortFunction),e._indicesInvalid=!0,e.trigger("change",jn)}},{key:"addFilter",value:function(e){var t=e instanceof On?e:new On(e);return this.filters.add(t),t}},{key:"onFiltersChanged",value:function(){var e=this;e._filterFunction=null,e._filteredValues=e._values.filter(e.filterFunction),e._indicesInvalid=!0,e.trigger("change",Vn)}},{key:"addIndex",value:function(e){(this._indices||(this._indices={}))[e]={},this._indicesInvalid=!0}},{key:"findIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isFiltered,o=i&&!n?r.indices[Bn][e]:r.indices[e];if(o){var a=o[Yn(t)];if(null!=a)return a}else for(var s=i&&!n?r._filteredValues:r._values,l=s.length,u=0;u<l;u++)if(s[u][e]==t)return u;return-1}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.findIndex(this.idProperty,Wn[U()(e)]?e:e[this.idProperty],t)}},{key:"includes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return-1!==this.indexOf(e,t)}},{key:"rebuildIndices",value:function(){var e,t,n=this,r=n.isFiltered,i=n._indices||(n._indices={}),o=Object.keys(i),a=o.length,s=n._values,l=s.length;for(r&&(i[Bn]={}),e=0;e<a;e++)i[o[e]]={},r&&(i[Bn][o[e]]={});for(e=0;e<l;e++){var u=s[e];for(t=0;t<a;t++){var c=o[t];i[c][Yn(u[c])]=e}}if(r){var d=n._filteredValues,h=d.length,f=n._indices[Bn];for(e=0;e<h;e++){var g=d[e];for(t=0;t<a;t++){var v=o[t];f[v][Yn(g[v])]=e}}}n._indicesInvalid=!1}},{key:"isCollection",get:function(){return!0}},{key:"values",set:function(e){this.splice(0,this._values.length,e)},get:function(){return this.isFiltered?this._filteredValues:this._values}},{key:"first",get:function(){return this.values[0]}},{key:"last",get:function(){return this.values[this.count-1]}},{key:"allValues",get:function(){return this._values}},{key:"count",get:function(){return this.values.length}},{key:"totalCount",get:function(){return this._values.length}},{key:"idProperty",set:function(e){this._idProperty=e,this.addIndex(e)},get:function(){return this._idProperty}},{key:"extraKeys",set:function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++)this.addIndex(e[t])}},{key:"sorters",get:function(){return this._sorters||(this._sorters=new t({listeners:{change:"onSortersChanged",thisObj:this}})),this._sorters}},{key:"isSorted",get:function(){return Boolean(this._sorters&&this._sorters.count)}},{key:"sortFunction",get:function(){return this._sortFunction||(this.isSorted?this._sortFunction=Pn.generateSortFunction(this.sorters.values):this._sortFunction=Hn),this._sortFunction}},{key:"filters",get:function(){return this._filters||(this._filters=new t({listeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}},{key:"isFiltered",get:function(){return Boolean(this._filters&&this._filters.count)}},{key:"filterFunction",get:function(){return this._filterFunction||(this.isFiltered?this._filterFunction=On.generateFiltersFunction(this.filters.values):this._filterFunction=kn.returnTrue),this._filterFunction}},{key:"indices",get:function(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}}],[{key:"defaultConfig",get:function(){return{idProperty:"id",extraKeys:null,autoFilter:!0}}}]),t}(ze(z));Un._$name="Collection";var qn={true:"auto",false:"hidden","hidden-scroll":"auto"},$n={block:"nearest"},Xn=new Promise((function(e){return e()})),Kn=function(e){return new Promise((function(t){return Ln.on({element:e,scroll:t,once:!0})}))},Jn={x:1},Qn=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"addPartner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jn;"string"==typeof t&&(t=$()({},t,1)),(this.partners||(this.partners=new Un)).add({id:e.id,scroller:e,axes:t}),e.partners&&e.partners.includes(this.id)||e.addPartner(this,t)}},{key:"removePartner",value:function(e){this.partners&&this.partners.includes(e)&&(this.partners.remove(e),e.removePartner(this))}},{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$n,n=e instanceof Oe,r=n?e:Oe.from(e),i=this.getDeltaTo(e,t),o=i.xDelta,a=i.yDelta,s=this.scrollBy(o,a,t);return(t.highlight||t.focus)&&s.then((function(){n&&(e=r.translate(-o,-a)),t.highlight&&rn.highlight(e),t.focus&&e.focus()})),s}},{key:"scrollBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$n,r=this,i="object"===U()(n)?n.animate:n,o=Math.abs(e),a=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=n.silent);var s=i&&("number"==typeof i?i:"number"==typeof i.duration?i.duration:300);if(s&&(o>10||a>10)){var l=r.x,u=r.y,c=l,d=u;return Math.max(o,a)<50&&(s=Math.min(s,500)),r.scrollAnimation=kn.animate(s,(function(i){var o=1===i;if(e){if(r.x!==c&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.x=Math.max(l+(o?e:Math.round(e*i)),0)}if(t){if(r.y!==d&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.y=Math.max(u+(o?t:Math.round(t*i)),0)}c=r.x,d=r.y}),null,i.easing),r.scrollAnimation.then((function(){r.scrollAnimation=null})),r.scrollAnimation}return e|t?(r.x+=e,r.y+=t,Kn(r.element)):Xn}},{key:"scrollTo",value:function(e,t,n){var r=this.x,i=this.y,o=null==e?0:e-r,a=null==t?0:t-i;return this.scrollBy(o,a,n)}},{key:"doDestroy",value:function(){var e=this;e._element&&(e._element.removeEventListener("scroll",e.scrollHandler),e.wheelListenerRemover&&e.wheelListenerRemover()),e.scrollAnimation&&e.scrollAnimation.cancel(),e.partners&&e.partners.forEach((function(t){return t.scroller.removePartner(e)})),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onElMutation",value:function(e){var t=this,n=rn.getTranslateXY(t.element),r=fe()(n,2),i=r[0],o=r[1];if(t._x!==-i||t.y!==-o){var a=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(a,"target",{get:function(){return t.element}}),t.onScroll(a)}}},{key:"onScroll",value:function(e){var t=this;t.widget&&t.widget.isDestroyed||(t.positionDirty=!0,e.widget=t.widget,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.scrollEndHandler(e))}},{key:"syncPartners",value:function(){var e=this;e.partners&&e.partners.forEach((function(t){var n=t.axes,r=t.scroller;r!==e.controllingPartner&&r.sync(e,n)}))}},{key:"onScrollEnd",value:function(e){this.silent&&(this.silent=!1),this.trigger("scrollEnd",e)}},{key:"getDeltaTo",value:function(e,t){e instanceof Oe||(e=Oe.from(e)),e.round();var n=this,r=t.block||"nearest",i=n.viewport.round(),o=t.edgeOffset||0,a=i.width>=e.width+2*o?o:0,s=i.height>=e.height+2*o?o:0,l=e.clone().adjust(-a,-s,a,s).constrainTo(new Oe(i.x-n.x,i.y-n.y,n.scrollWidth,n.scrollHeight)),u=l.clone(),c=0,d=0;if("start"===r)u.moveTo(i.x,i.y),c=l.x-u.x,d=l.y-u.y;else if("end"===r)u.translate(i.right-u.right,i.bottom-u.bottom),c=l.x-u.x,d=l.y-u.y;else if("center"===r){var h=i.center;u.moveTo(h.x-u.width/2,h.y-u.height/2),c=c||l.x-u.x,d=d||l.y-u.y}else u.width>i.width?c=u.x-i.x:u.right>i.right?c=u.right-i.right:u.x<i.x&&(c=u.x-i.x),u.height>i.height?d=u.y-i.y:u.bottom>i.bottom?d=u.bottom-i.bottom:u.y<i.y&&(d=u.y-i.y);return{xDelta:!1===t.x?0:Math.max(Math.min(c,n.maxX-n.x),-n.x),yDelta:!1===t.y?0:Math.max(Math.min(d,n.maxY-n.y),-n.y)}}},{key:"sync",value:function(e,t){var n=t.x,r=t.y;this.controllingPartner=e,null!=n&&(this.x=e.x),null!=r&&(this.y=e.y)}},{key:"updateOverflowX",value:function(e){var t=this.element,n=this.translate;"hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowX=qn[e]||e),this.positionDirty=!this.isConfiguring}},{key:"updateOverflowY",value:function(e){var t=this.element,n=this.translate;"hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowY=qn[e]||e),this.positionDirty=!this.isConfiguring}},{key:"enableWheel",value:function(){ge.isChrome||ge.isSafari||this.wheelListenerRemover||(this.wheelListenerRemover=Ln.on({element:this.element,wheel:"onWheel",thisObj:this}))}},{key:"onWheel",value:function(e){e.deltaX>e.deltaY&&!1!==this.overflowX?this.x+=e.deltaX:!1!==this.overflowY&&(this.y+=e.deltaY)}},{key:"viewport",get:function(){return Oe.client(this.element)}},{key:"element",get:function(){return this._element},set:function(e){var t=this,n=t.scrollHandler||(t.scrollHandler=t.onScroll.bind(t));if(t.scrollEndHandler||(t.scrollEndHandler=t.buffer(t.onScrollEnd,100)),t._element&&(t.translate?t.mutationObserver&&t.mutationObserver.disconnect(t._element):(t._element.removeEventListener("scroll",n),t._element.classList.remove("b-widget-scroller"))),t._element=e,t.translate){if(t.mutationObserver||(t.mutationObserver=new MutationObserver((function(e){return t.onElMutation(e)}))),t.mutationObserver.observe(e,{attributes:!0}),t._x=t._y=0,document.contains(e)){var r=rn.getTranslateXY(e),i=fe()(r,2),o=i[0],a=i[1];t._x=-o,t._y=-a}}else e.addEventListener("scroll",n),e.classList.add("b-widget-scroller");t.updateOverflowX(t.overflowX),t.updateOverflowY(t.overflowY)}},{key:"x",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=rn.getTranslateXY(t),r=fe()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._x},set:function(e){var t=this.element,n=this.widget;n&&n.isConfiguring||(this._x=e,t&&(this.trigger("scrollStart",{x:e}),this.translate?rn.setTranslateX(t,-e):t.scrollLeft=e,this.positionDirty=!0))}},{key:"y",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=rn.getTranslateXY(t),r=fe()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y},set:function(e){var t=this.element,n=this.widget;n&&n.isConfiguring||(this._y=e,t&&(this.trigger("scrollStart",{y:e}),this.translate?rn.setTranslateY(t,-e):t.scrollTop=e,this.positionDirty=!0))}},{key:"maxX",get:function(){return this.scrollWidth-this.clientWidth}},{key:"maxY",get:function(){return this.scrollHeight-this.clientHeight}},{key:"overflowX",get:function(){return this._overflowX},set:function(e){this._overflowX=e,this.element&&this.updateOverflowX(e)}},{key:"overflowY",get:function(){return this._overflowY},set:function(e){this._overflowY=e,this.element&&this.updateOverflowY(e)}},{key:"scrollWidth",get:function(){return this.element?this.element.scrollWidth:0},set:function(e){var t=this,n=t.widthStretcher;n&&null==e?(n.remove(),t.widthStretcher=null):e&&(n||(n=t.widthStretcher=rn.createElement({className:"b-scroller-stretcher"})),n.style.transform="translateX(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n))}},{key:"scrollHeight",get:function(){return this.element?this.element.scrollHeight:0},set:function(e){var t=this,n=t.stretcher||(t.stretcher=rn.createElement({className:"b-scroller-stretcher"}));n.style.transform="translateY(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n)}},{key:"clientWidth",get:function(){return this.element?this.element.clientWidth:0}},{key:"clientHeight",get:function(){return this.element?this.element.clientHeight:0}},{key:"id",get:function(){return this._id||(this.widget?this._id="".concat(this.widget.id,"-scroller"):this._id=Z.generateId("scroller-")),this._id}}],[{key:"defaultConfig",get:function(){return{element:null,overflowX:null,overflowY:null,translate:null,_x:0,_y:0}}}]),t}(de(ze(z)));Qn._$name="Scroller";var Zn={localeName:"En",localeDesc:"English",Object:{Yes:"Yes",No:"No",Cancel:"Cancel"},InstancePlugin:{fnMissing:function(e){return"Trying to chain fn ".concat(e.plugIntoName,"#").concat(e.fnName,", but plugin fn ").concat(e.pluginName,"#").concat(e.fnName," does not exist")},overrideFnMissing:function(e){return"Trying to override fn ".concat(e.plugIntoName,"#").concat(e.fnName,", but plugin fn ").concat(e.pluginName,"#").concat(e.fnName," does not exist")}},Field:{invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},TimeField:{invalidTime:"Invalid time input"},DateHelper:{locale:"en-US",shortWeek:"W",shortQuarter:"q",week:"Week",weekStartDay:0,unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A"},ordinalSuffix:function(e){return e+({1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th")}},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:function(e){return"of ".concat(e.lastPage)},summaryTemplate:function(e){return"Displaying records ".concat(e.start," - ").concat(e.end," of ").concat(e.allCount)}},List:{loading:"Loading..."}},er=Zn;je.registerLocale("En",{desc:"English",locale:Zn});var tr,nr,rr=!1,ir=(window.bryntum||(window.bryntum={})).GlobalEvents=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"suspendFocusEvents",value:function(){rr=!0}},{key:"resumeFocusEvents",value:function(){rr=!1}},{key:"lastInteractionType",get:function(){return nr}}]),t}(ze(z))),or=function(e){return e.isVisible&&e.isTopModal};function ar(e,t,n,r,i,o,a){var s=new CustomEvent(e,a);return Object.defineProperty(s,"target",{get:function(){return t}}),Object.defineProperty(s,"relatedTarget",{get:function(){return n}}),s.fromWidget=r,s.toWidget=i,s.backwards=o,s}function sr(e,t){if(e===t)return e;for(var n=e instanceof vr;e&&!e[n?"owns":"contains"](t)&&e!==t;)e=e[n?"owner":"parentNode"];return e}var lr={element:document,touchstart:function(e){tr=tr||1!==e.changedTouches.length?null:e.changedTouches[0]},touchend:{handler:function(e){tr&&(tr.identifier===Ln.contextMenuTouchId?(e.stopImmediatePropagation(),e.preventDefault()):1===e.changedTouches.length&&e.changedTouches[0].identifier===tr.identifier&&ir.trigger("globaltap",{event:e}),tr=null)},passive:!1},mousedown:{handler:function(e){nr="mouse",tr||ir.trigger("globaltap",{event:e})},passive:!1},keydown:function(){nr="key"},keypress:function(){nr="key"},focusin:function(e){if(vr.floatRoot.scrollTop=vr.floatRoot.scrollLeft=0,!rr){var t=e.relatedTarget?e.relatedTarget instanceof HTMLElement?e.relatedTarget:document.body:null,n=e.target||document.body,r=Z.fromElement(t),i=Z.fromElement(n),o=sr(r,i),a=!!(t&&4&n.compareDocumentPosition(t)),s=Z.query(or);if(!s||i&&s.owns(i)){for(var l=ar("focusout",t,e.target,r,i,a),u=r;u&&u!==o;u=u.owner)u.isDestroyed||u.isDestroying||u.onFocusOut&&u.onFocusOut(l);if(o&&e.target===o.element)document.activeElement===n&&o.focusElement&&o.focusElement!==o.element&&setTimeout((function(){return o.focus&&o.focus()}),0);else{l=ar("focusin",n,t,r,i,a);for(var c=i;c&&c!==o;c=c.owner)c.isDestroyed||c.isDestroying||c.onFocusIn&&c.onFocusIn(l)}var d=sr(t&&1===t.nodeType?t:null,n)||n.parentNode;l=ar("focusmove",n,t,r,i,a,{bubbles:!0}),d.dispatchEvent(l)}else s.focus()}},focusout:function(e){rr||e.relatedTarget&&Z.fromElement(e.relatedTarget)||lr.focusin({target:e.relatedTarget,relatedTarget:e.target})},capture:!0,passive:!0};function ur(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=kt.assign({},lr,{element:e});Ln.on(t)}ur();var cr=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,dr={INPUT:1,TEXTAREA:1},hr=function(e){e.isVisible&&e.triggerPaint()},fr=/^:not\((.+)\)$/,gr=rn.createElement({html:" ",style:"position:absolute;top:-10000em;left:-10000em"}),vr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;n.alignConstrained=0,n.afterHideShowAnimate=n.afterHideShowAnimate.bind(n),n.callRealign=n.realign.bind(n),n.doHideOrRealign=n.doHideOrRealign.bind(n),n.initialRender=!0,n._isUserAction=!1;for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];se()(oe()(t.prototype),"construct",this).call(this,e,i),n.finalizeInit()}},{key:"isType",value:function(e,t){return Z.isType(this,e,t)}},{key:"startConfigure",value:function(e){var n=this,r=n.adopt,i=n.element;if(r){var o="string"==typeof r?document.getElementById(r):r,a=Z.fromElement(o);a&&a.destroy(),n.preExistingElements=Array.from(o.childNodes),n.adoptedElementClassName=o.className,n.adoptedElementCssText=o.style.cssText,o.id&&!e.id&&(n.id=i.id=o.id),rn.syncAttributes(i,o);for(var s=0,l=i.childNodes.length;s<l;s++)o.appendChild(i.childNodes[0]);n._element=o,delete n._contentRange}se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"finalizeInit",value:function(){(this.insertBefore||this.appendTo||this.insertFirst||this.adopt)&&this.render()}},{key:"doDestroy",value:function(){var e=this,n=e._element,r=e.tooltip,i=e.preExistingElements;if(e.scrollable&&e.scrollable.destroy(),r&&(e._tooltip?r.destroy():r.activeTarget===n&&r.isVisible&&r.hide()),e.unmask(),n){if(e.removeTransientListeners(),e.revertFocus(),pn.removeResizeListener(n.parentElement,e.onParentElementResize),pn.removeResizeListener(n,e.onElementResize),e.adopt){for(var o=Array.from(n.childNodes),a=0,s=o.length;a<s;a++){var l=o[a];i.includes(l)||l===t.floatRoot||l.remove()}n.className=e.adoptedElementClassName,n.style.cssText=e.adoptedElementCssText}else n.remove();e.dragEventDetacher&&e.dragEventDetacher(),e.dragOverEventDetacher&&e.dragOverEventDetacher(),gr.remove()}Z.unregister(e),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"render",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.element;pn.removeResizeListener(r.parentElement,n.onParentElementResize),pn.removeResizeListener(r,n.onElementResize),n.emptyCache(),n.syncElement&&n.currentElement?rn.sync(r,n.currentElement):(e?(n.appendTo="string"==typeof e?document.getElementById(e):e,n.appendTo.appendChild(r)):n.insertBefore?(n.insertBefore="string"==typeof n.insertBefore?document.getElementById(n.insertBefore):n.insertBefore,n.insertBefore.parentElement.insertBefore(r,n.insertBefore)):n.insertFirst?(n.insertFirst="string"==typeof n.insertFirst?document.getElementById(n.insertFirst):n.insertFirst,n.insertFirst.firstChild?n.insertFirst.insertBefore(r,n.insertFirst.firstChild):n.insertFirst.appendChild(r)):n.appendTo&&(n.appendTo="string"==typeof n.appendTo?document.getElementById(n.appendTo):n.appendTo,n.appendTo.appendChild(r)),n.currentElement=r),n.rendered=!0,t&&(n._thisIsAUsedExpression(n.contentRange),n.triggerPaint())}},{key:"template",value:function(e){return'<div class="'.concat(e.html?"b-html":"",'" ').concat(e.name?'data-name="'.concat(e.name,'"'):"",">").concat(e.html||"","</div>")}},{key:"alignTo",value:function(e){(1===e.nodeType||e instanceof t||e instanceof yn)&&(e={target:e}),this.releaseSizeConstraints();var n=this,r=n.scrollable,i=n.element,o=e.target,a=o&&(o instanceof Oe?o:o.element||o),s=Oe.from(i,n.positioned?i.offsetParent:null,!0),l=a&&1===a.nodeType;if(e=Object.assign({constrainTo:n.positioned?null:n.constrainTo,axisLock:n.axisLock,anchor:n.anchor},"object"===U()(n.align)?n.align:{align:n.align},e),s.minWidth=e.minWidth||n.minWidth,s.minHeight=e.minHeight||n.minHeight,n.lastAlignSpec=e,l&&a.offsetParent){(e=Object.setPrototypeOf({},e)).target=Oe.from(a,n.positioned?i.offsetParent:null,!n.positioned),e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1);var u=n.clippedBy;if(u){var c=e.target.intersect(u);if(!c){var d=n.hide();return n.lastAlignSpec.targetHidden=!0,d}e.target=c}n.anchoredTo=a}else n.anchoredTo=null;e.anchor&&(e.anchorSize=n.anchorSize,i.appendChild(n.anchorElement)),n.isAligning=!0,n.trigger("beforeAlign",e),n.isAligning=!1;var h=e.constrainTo,f=h===window||h===document,g=s.alignTo(e),v=g.align,m=g.anchor,p=g.x,y=g.y,k=g.width,b=g.height,w=g.bottom,S=g.right;if(n.lastAlignSpec.zone=g.zone,b!==s.height&&("configuredHeight"in n||(n.configuredHeight=i.style.height),n.height=b,n.alignConstrained=1|n.alignConstrained,r&&(r.overflowY=!0)),k!==s.width&&("configuredWidth"in n||(n.configuredWidth=i.style.width),n.width=k,n.alignConstrained=2|n.alignConstrained,r&&(r.overflowX=r.clientWidth>r.scrollWidth)),v&&n.alignConstrained){e.align=v;var C=Oe.from(i,n.positioned?i.offsetParent:null,!0).alignTo(e);m=C.anchor,p=C.x,y=C.y,k=C.width,b=C.height,w=C.bottom,S=C.right}if(n.setXY(p,y),m){var E,x=m.edge,D=n.anchorElement,T=[],R=i.style.pointerEvents;i.style.pointerEvents="all","top"===x||"bottom"===x?(T[0]=p+m.x,T[1]="top"===x?y+1:w-1):(T[0]="left"===x?p+1:S-1,T[1]=y+m.y);var M=(E=document).elementFromPoint.apply(E,T);if(i.style.pointerEvents=R||null,M){var F=rn.getStyleValue(M,"background-color");F.match(cr)?n.anchorPathElement.setAttribute("fill",n.defaultAnchorBackgroundColor):n.anchorPathElement.setAttribute("fill",F)}D.classList.remove("b-hide-display"),D.style.transform="",D.className="b-anchor b-anchor-".concat(x),rn.setTranslateXY(D,m.x,m.y)}else n._anchorElement&&n.anchorElement.classList.add("b-hide-display");"hide"!==n.scrollAction||l||(i.style.pointerEvents="none",n.anchoredTo=document.elementFromPoint(p,y),i.style.pointerEvents=""),("realign"===n.scrollAction&&l||"hide"===n.scrollAction)&&!n.documentScrollListener&&n.setTimeout((function(){document.addEventListener("scroll",n.doHideOrRealign,!0),n.documentScrollListener=!0}),0),!ge.isAndroid&&f&&(!h||1!==h.nodeType&&!f||n.constrainListeners||(pn.addResizeListener(h,n.callRealign),f||n.constrainMutationMonitor||(n.constrainMutationMonitor=new MutationObserver(n.callRealign)).observe(h,{attributes:!0,childList:!0}),n.constrainListeners=!0))}},{key:"realign",value:function(e){var t=this;if(t.isVisible&&(t.floating||t.positioned)&&t.lastAlignSpec){var n=t.lastAlignSpec.target;if(n&&1===n.nodeType){var r=Oe.from(n);if(r.minHeight=r.minWidth=1,n!==document.body&&!n.offsetParent||e&&1===e.nodeType&&e.contains(n)&&!Oe.from(e).intersect(r))return t.hide()}t.alignTo(t.lastAlignSpec)}}},{key:"releaseSizeConstraints",value:function(){var e=this,t=e.scrollable;1&e.alignConstrained&&(e.height=e.configuredHeight,t&&(t.overflowY=t.config.overflowY)),2&e.alignConstrained&&(e.width=e.configuredWidth,t&&(t.overflowX=t.config.overflowX)),e.alignConstrained=0}},{key:"toFront",value:function(){this.element&&this.element.nextSibling&&this.element.parentNode.appendChild(this.element)}},{key:"onThemeChange",value:function(){this.anchorElement&&this.anchorElement.offsetParent&&(this._anchorSize=null,this.realign())}},{key:"onWidgetDragStart",value:function(e){var t=this,n=document.elementFromPoint(e.clientX,e.clientY),r=t.draggable.handleSelector;if(r){var i=fr.exec(r)[1];if(i){if(n.closest("#".concat(t.element.id," ").concat(i)))return void e.preventDefault()}else if(!n.closest("#".concat(t.element.id," ").concat(r)))return void e.preventDefault()}t.removeTransientListeners();var o=e.clientX,a=e.clientY,s=document.scrollingElement||document.body,l=t.getXY()[0],u=t.getXY()[1];document.body.appendChild(gr),e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(gr,0,0)),e.dataTransfer.effectAllowed="none",t.dragOverEventDetacher=Ln.addListener({element:document.body,dragover:function(e){return t.setXY(l+e.clientX-o-s.scrollLeft,u+e.clientY-a-s.scrollTop)}}),t.anchor=null}},{key:"onWidgetDragEnd",value:function(e){gr.remove(),this.dragOverEventDetacher()}},{key:"getXY",value:function(){return[rn.getPageX(this.element),rn.getPageY(this.element)]}},{key:"setXY",value:function(e,t){var n=this;(n.floating||n.positioned)&&(null!=e&&(n._x=e,n.centered=!1),null!=t&&(n._y=t,n.centered=!1),rn.setTranslateXY(n.element,n._x||0,n._y||0))}},{key:"fixIEMaxHeightBug",value:function(){var e=this.element,t=this.contentElement;if("column"===rn.getStyleValue(e,"flex-direction")){t.style.maxHeight="";for(var n=Oe.client(e).height,r=e.childNodes,i=r.length,o=0;o<i;o++){var a=r[o];a===t||a.classList.contains("b-resize-monitors")||(n-=a.offsetHeight)}this.contentElement.style.maxHeight="".concat(n,"px")}}},{key:"onDisabled",value:function(e){}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"focus",value:function(){this.isFocusable&&rn.focusWithoutScrolling(this.focusElement)}},{key:"show",value:function(){var e=this;return new Promise((function(n){var r,i,o=e,a=o.showAnimation,s=o.element,l=t.floatRoot,u=s.style;o.isVisible||!1===o.trigger("beforeShow")||(o.cancelHideShowAnimation(),a&&(r=Object.keys(a)[0],i=a[r],o.currentAnimation={styleProp:r,resolve:n},s.addEventListener("transitionend",o.afterHideShowAnimate),u[r]=i.from),o.floating&&(l.contains(s)||(o.rendered?l.appendChild(o.element):o.render(l,!1))),o._hidden=!1,s.classList.remove("b-hidden"),a&&(u.transition="".concat(r," ").concat(i.duration," ease ").concat(i.delay),o.requestAnimationFrame((function(){u[r]=i.to}))),o.afterShow(!a&&n),!o.inShowBy&&o.floating&&o.forElement&&o.alignTo(o.forElement))}))}},{key:"showBy",value:function(e){var t=this;t.inShowBy=!0,t.show(),t.inShowBy=!1,t.isVisible&&t.alignTo(e)}},{key:"showByPoint",value:function(e,t,n){var r=1===arguments.length?e:[e,t];this.showBy(Object.assign({target:new Oe(r[0],r[1],1,1),align:"t-b"},n))}},{key:"afterShow",value:function(e){this.boundMaxHeightBugHandler&&this.boundMaxHeightBugHandler(),this.trigger("show"),this.triggerPaint(),e&&e()}},{key:"triggerPaint",value:function(){var e=this,t=e.element,n=!e.isPainted;e.isVisible&&(n&&(e.scaleToFitWidth?(e.onParentElementResize=e.onParentElementResize.bind(e),pn.addResizeListener(t.parentElement,e.onParentElementResize),e.isVisible&&e.updateScale()):e.monitorResize&&(e.onElementResize=e.onElementResize.bind(e),pn.addResizeListener(t,e.onElementResize))),e.eachWidget&&e.eachWidget(hr,!1),e.trigger("paint",{firstPaint:n}),n&&e.monitorResize&&!e.scaleToFitWidth&&pn.onElementResize([{target:e.element}]),e.isPainted=!0)}},{key:"cancelHideShowAnimation",value:function(){var e=this,t=e.element,n=t.style;e.currentAnimation&&(t.classList.remove("b-hiding"),t.removeEventListener("transitionend",e.afterHideShowAnimate),n.transition=n[e.currentAnimation.styleProp]="",e.currentAnimation=null)}},{key:"afterHideShowAnimate",value:function(e){if(!this.isDestroyed){var t=this,n=t.element,r=n.style,i=t.currentAnimation,o=i.styleProp,a=i.resolve;e.target===n&&e.propertyName===o&&(n.classList.remove("b-hiding"),t.currentAnimation=null,n.removeEventListener("transitionend",t.afterHideShowAnimate),r.transition=r[o]="",t._hidden&&t.afterHideAnimation(),a())}}},{key:"hide",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(n){var r=e,i=r.element,o=i.style,a=t&&r.hideAnimation;if(!r._hidden&&!1!==r.trigger("beforeHide")){if(r._hidden=!0,!i)return;if(r.revertFocus(),r.isDestroyed)return void n();if(r.currentAnimation&&r.cancelHideShowAnimation(),a){var s=Object.keys(a)[0],l=a[s];r.currentAnimation={styleProp:s,resolve:n},i.classList.add("b-hiding"),i.addEventListener("transitionend",r.afterHideShowAnimate),o[s]=l.from,o.transition="".concat(s," ").concat(l.duration," ease ").concat(l.delay),r.requestAnimationFrame((function(){o[s]=l.to}))}else i.classList.add("b-hidden");r.afterHide(!a&&n)}}))}},{key:"doHideOrRealign",value:function(e){var t=this,n=t.anchoredTo,r=t.lastAlignSpec,i=r&&r.target,o=document.activeElement,a=t.getXY(),s=fe()(a,2),l=s[0],u=s[1];if(e.isTrusted&&!(9===e.target.nodeType&&t.element.contains(o)&&dr[o]&&window.innerHeight<document.body.offsetHeight)&&(t.realign(e.target),!t.isDestroyed&&"hide"===t.scrollAction)){var c=t.getXY(),d=fe()(c,2),h=d[0],f=d[1];!(h!==l||f!==u||i instanceof yn)||n&&!rn.isDescendant(e.target,n)||t.hide()}}},{key:"afterHide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.lastAlignSpec;n&&(n.targetHidden=null),t.removeTransientListeners(),t.hideAnimation||t.afterHideAnimation(),t.trigger("hide"),e&&e()}},{key:"removeTransientListeners",value:function(){var e=this;e.documentScrollListener&&(document.removeEventListener("scroll",e.doHideOrRealign,!0),e.documentScrollListener=!1),e.constrainListeners&&(pn.removeResizeListener(e.lastAlignSpec.constrainTo,e.callRealign),e.constrainMutationMonitor&&e.constrainMutationMonitor.disconnect(),e.constrainListeners=!1)}},{key:"afterHideAnimation",value:function(){var e=this.element;this.floating&&t.floatRoot.contains(e)?e.remove():e.classList.add("b-hidden")}},{key:"getSibling",value:function(e){var t=this.parent,n=t?t.childItems:Array.from(this.element.parentElement.querySelectorAll(".b-widget"));return t?n[n.indexOf(this)+e]:Z.fromElement(n[n.indexOf(this.element)+e])}},{key:"up",value:function(e,t,n){for(var r=U()(n),i="number"===r,o="string"===r,a=this.owner,s=1;a;a=a.owner,s++){if(ee(a,e,t))return a;if(i&&s>=n)return;if(o&&ee(a,n,t))return;if(a===n)return}}},{key:"owns",value:function(e){if(e){if(e.eventPhase&&(e=e.target),1===e.nodeType){if(this.element.contains(e))return!0;e=Z.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}},{key:"onFocusIn",value:function(e){var t=this,n=t.element;t.containsFocus=!0,t.focusInEvent=e,n.classList.add("b-contains-focus"),n.contains(e.target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=Ln.on({element:n,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}},{key:"onFocusOut",value:function(e){var t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!0),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.trigger("focusout",e))}},{key:"revertFocus",value:function(e){var t=this.focusInEvent&&this.focusInEvent.relatedTarget;(e||this.containsFocus&&t&&1===t.nodeType&&this.element.contains(document.activeElement))&&(t&&rn.isFocusable(t)||(t=this.getFocusRevertTarget()),t&&rn.isFocusable(t)&&rn.focusWithoutScrolling(t))}},{key:"getFocusRevertTarget",value:function(){var e=this,t=e.owner,n=e.focusInEvent,r=n&&n.backwards?1:-1,i=n&&n.relatedTarget,o=i&&Z.fromElement(i);if(t&&!t.isDestroyed&&(!i||!rn.isFocusable(i)||o&&!o.isFocusable)){if(i=null,t.eachWidget){var a=[];if(t.eachWidget((function(t){(t===e||t.isFocusable)&&a.push(t)}),!1),a.length>1){var s=a.indexOf(e);i=a[s+r]||a[s-r]}}!i&&t.isFocusable&&(i=t),i=i?i.focusElement:t.getFocusRevertTarget()}return i}},{key:"fromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.element;if(!n)return null;var r=this;return r.cache[e]||(r.cache[e]=t?rn.children(n,e):rn.down(n,e)),r.cache[e]}},{key:"emptyCache",value:function(){this.cache={}}},{key:"mask",value:function(e){var t=this;return t.maskInstance&&t.maskInstance.destroy(),"string"==typeof e?t.maskInstance=te.mask(t.element,e):(e.element=t.element,t.maskInstance=te.mask(e))}},{key:"unmask",value:function(){this.maskInstance&&(te.unmask(this.element),this.maskInstance=null)}},{key:"onInternalResize",value:function(e,t,n,r,i){this._width=e.offsetWidth,this._height=e.offsetHeight}},{key:"onElementResize",value:function(e){var t=this,n=t.element,r=t._width,i=t._height,o=n.offsetWidth,a=n.offsetHeight;t.suspendResizeMonitor||r===o&&i===a||(t.onInternalResize(n,o,a,r,i),t.trigger("resize",{width:o,height:a,oldWidth:r,oldHeight:i}))}},{key:"updateScale",value:function(){var e=this,t=e.element,n=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),e.parentHeight||(e.parentHeight=n.offsetHeight),t.style.display="none";var r=n.offsetWidth/e.configuredWidth,i=e.allowGrowWidth?Math.min(r,1):r;t.style.transform="scale(".concat(i,")"),t.style.transformOrigin="top left",t.style.display="",n.style.height=e.parentHeight*i+"px",e.allowGrowWidth&&r>1&&(e.width=e.configuredWidth*r)}},{key:"onParentElementResize",value:function(e){this.updateScale()}},{key:"parseTRBL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";if("number"==typeof(e=e||0))return["".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t)];var n=e.split(" "),r=n.length;return 1===r?n[1]=n[2]=n[3]=n[0]:2===r?(n[2]=n[0],n[3]=n[1]):3===r&&(n[3]=n[1]),[isFinite(n[0])?"".concat(n[0]).concat(t):n[0],isFinite(n[1])?"".concat(n[1]).concat(t):n[2],isFinite(n[2])?"".concat(n[2]).concat(t):n[3],isFinite(n[3])?"".concat(n[3]).concat(t):n[4]]}},{key:"title",set:function(e){this._title!==e&&(this._title=e,this.titleElement&&(this.titleElement.innerHTML=e))},get:function(){return this._title}},{key:"element",get:function(){return this._element},set:function(e){var t=this;"string"==typeof e?e=rn.createElementFromTemplate(e):"Object"===e.constructor.name?e=rn.createElement(e):1!==e.nodeType&&(e=rn.createElementFromTemplate(t.template(t))),t._element=e;var n=e.classList;e.id=t.id,e.className+=" "+t.widgetClassList.join(" "),t._hidden&&n.add("b-hidden"),t.parent||(t.floating||t.owner||n.add("b-outer"),ge.isTouchDevice&&n.add("b-touch-events"),rn.scrollBarWidth?n.add("b-visible-scrollbar"):n.add("b-overlay-scrollbar"),ge.isChrome?n.add("b-chrome"):ge.isSafari?n.add("b-safari"):ge.isFirefox?n.add("b-firefox"):ge.isIE11?n.add("b-ie"):ge.isEdge&&n.add("b-edge"));var r=e.querySelectorAll("[reference]"),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.getAttribute("reference");u.removeAttribute("reference"),t[c]=u,u.dataset&&(u.dataset.ownerCmp=t.id)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}},{key:"constrainTo",set:function(e){this._constrainTo=e},get:function(){return"_constrainTo"in this?this._constrainTo:window}},{key:"centered",set:function(e){if(this._centered=e,e&&!this.floating)throw new Error("`centered` is only relevant when a Widget is `floating`");e?this.element.classList.add("b-centered"):this.element.classList.remove("b-centered")},get:function(){return this._centered}},{key:"contentElement",get:function(){return this.element}},{key:"contentRange",get:function(){var e=this,t=e.contentElement,n=e._contentRange||(e._contentRange=ge.isIE11?document.createRange():new Range);return n.collapsed&&(n.setStart(t,e.contentRangeStartOffset||0),n.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),n}},{key:"id",get:function(){return this._id},set:function(e){var t=this,n=t._id;if(e?t.hasGeneratedId=!1:(e=Z.generateId("b-".concat(t.$name.toLowerCase(),"-")),t.hasGeneratedId=!0),n){var r=t.element.querySelectorAll('[data-owner-cmp="'.concat(n,'"]'));Z.unregister(t);for(var i=0,o=r.length;i<o;i++)r[i].dataset.ownerCmp=e;t.element.id=e}t._id=e,Z.register(t)}},{key:"style",get:function(){return this.element?this.element.ownerDocument.defaultView.getComputedStyle(this.element):this._style},set:function(e){this._style=e,this.element&&rn.applyStyle(this.element,this._style)}},{key:"dataset",get:function(){return this.element.dataset},set:function(e){Object.assign(this.dataset,e)}},{key:"ref",set:function(e){this._ref=e,this.element.dataset.ref=e},get:function(){return this._ref}},{key:"clippedBy",set:function(e){this._clippedBy=Array.isArray(e)?e:e?[e]:null},get:function(){var e=this._clippedBy;if(e){var t,n=Oe.from(e[0],null,!0);for(t=1;t<e.length;t++)n=n.intersect(Oe.from(e[t],null,!0));return n}}},{key:"overflowElement",get:function(){return this.contentElement}},{key:"maxHeightElement",get:function(){return this.element}},{key:"scrollable",set:function(e){var t=this.overflowElement;"boolean"==typeof e&&(e={overflowX:e,overflowY:e}),t&&(e.element=t),e.widget=this,this._scrollable=new this.scrollerClass(e)},get:function(){return this._scrollable}},{key:"html",get:function(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML},set:function(e){var t=this,n=null==e,r=t.element,i=t.contentElement;if(t._html!==e&&(t._html=e,r)){var o=i===r&&t._anchorElement;r.classList[n?"remove":"add"]("b-html"),o&&t.element.removeChild(o),t.contentElement.innerHTML=n?"":e,o&&r.appendChild(o),(t.floating||t.positioned)&&(t.isAligning||t.realign())}}},{key:"content",set:function(e){var t=this,n=null==e,r=t.element;if(t._html!==e&&(t._html=e,r)){var i=t.contentRange;r.classList[n?"remove":"add"]("b-html"),nn(r)?(i.deleteContents(),n||i.insertNode(rn.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=i.startOffset,t.contentRangeEndOffset=i.endOffset,t.isAligning&&!t.positioned||t.realign()}}},{key:"anchorSize",get:function(){var e=this,t=this._anchorSize;if(!t){var n=parseFloat(rn.getStyleValue(e.element,"border-top-width")),r=rn.getStyleValue(e.element,"border-top-color"),i=e.anchorElement,o=i.firstElementChild,a=e.anchorPathElement=o.lastElementChild,s=e._hidden,l=rn.getStyleValue(e.contentElement,"background-color");l.match(cr)&&(l=rn.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=l,t=i.getBoundingClientRect();var u=t=e._anchorSize=[t.width,t.height],c=fe()(u,2),d=c[0],h=c[1];o.setAttribute("height",h+n),o.setAttribute("width",d),a.setAttribute("d","M0,".concat(h,"L").concat(d/2,",0.5L").concat(d,",").concat(h)),n&&(a.setAttribute("stroke-width",n),a.setAttribute("stroke",r)),t[1]-=n,s&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=ir.on({theme:"onThemeChange",thisObj:e}))}return e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor),t}},{key:"anchorElement",get:function(){var e=this._anchorElement;return e||(e=this._anchorElement=rn.createElement({parent:this.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[{tag:"defs",children:[{tag:"filter",id:"shadow-filter",children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:2,"flood-opacity":.05}]}]},{tag:"path",filter:ge.isIE11||ge.isEdge?null:"url(#shadow-filter)"}]}]})),e}},{key:"anchor",set:function(e){this._anchor=e,this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")},get:function(){return this._anchor}},{key:"draggable",get:function(){return this._draggable},set:function(e){var t=this,n=t.element;t._draggable=e,n.setAttribute("draggable",Boolean(e)),e?t.dragEventDetacher=Ln.addListener({element:t.element,dragstart:t.onWidgetDragStart,dragend:t.onWidgetDragEnd,thisObj:t}):(t.dragEventDetacher&&t.dragEventDetacher(),t.dragOverEventDetacher&&t.dragOverEventDetacher())}},{key:"floating",get:function(){return this._floating},set:function(e){e=Boolean(e),Boolean(this.floating)!==e&&(this._floating=e)}},{key:"positioned",get:function(){return this._positioned},set:function(e){e=Boolean(e),Boolean(this.positioned)!==e&&(this.element.classList[e?"add":"remove"]("b-positioned"),this._positioned=e)}},{key:"x",set:function(e){this.setXY(e)},get:function(){return this.getXY()[0]}},{key:"y",set:function(e){this.setXY(null,e)},get:function(){return this.getXY()[1]}},{key:"width",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._width&&(e._width=t.offsetWidth),e._width):t.offsetWidth},set:function(e){rn.setLength(this.element,"width",e),this._width=null,this._flex=null,this.element.style.flex=ge.isIE11?"":null}},{key:"maxWidth",get:function(){return rn.measureSize(this.element.style.maxWidth,this.element)},set:function(e){rn.setLength(this.element,"maxWidth",e)}},{key:"minWidth",get:function(){return rn.measureSize(this.element.style.minWidth,this.element)},set:function(e){rn.setLength(this.element,"minWidth",e)}},{key:"flex",get:function(){return this._flex},set:function(e){this._flex=e,("number"==typeof e||"string"==typeof e&&1===e.split(/\s/).length)&&(e="".concat(e," ").concat(e)),this.element.style.flex=e,this.element.style.width=ge.isIE11?"":null}},{key:"alignSelf",get:function(){return this._alignSelf},set:function(e){this.element.style.alignSelf=e}},{key:"margin",get:function(){return this._margin},set:function(e){this.element.style.margin=this._margin=this.parseTRBL(e).join(" ")}},{key:"height",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._height&&(e._height=t.offsetHeight),e._height):t.offsetHeight},set:function(e){rn.setLength(this.element,"height",e),this._height=null}},{key:"maxHeight",get:function(){return rn.measureSize(this.maxHeightElement.style.maxHeight,this.element)},set:function(e){var t=this,n=t.element;rn.setLength(t.maxHeightElement,"maxHeight",e),ge.isIE11&&t.contentElement!==n&&(null==e?pn.removeResizeListener(n,t.boundMaxHeightBugHandler):(pn.addResizeListener(n,t.boundMaxHeightBugHandler||(t.boundMaxHeightBugHandler=t.fixIEMaxHeightBug.bind(t))),document.body.contains(n)&&t.fixIEMaxHeightBug()))}},{key:"minHeight",get:function(){return rn.measureSize(this.element.style.minHeight,this.element)},set:function(e){rn.setLength(this.element,"minHeight",e)}},{key:"disabled",get:function(){return this._disabled},set:function(e){var t=this.element,n=this.focusElement;e&&this.revertFocus(),t&&(t.classList[e?"add":"remove"]("b-disabled"),n&&(n.disabled=e)),this._disabled=e,this.onDisabled(e)}},{key:"tooltip",get:function(){if(this._tooltip)return this._tooltip;var e=this.constructor.tooltip;return e&&e.trigger("pointerOver",{source:e,target:this.element}),e},set:function(e){var t=this;t._tooltip&&(t._tooltip.destroy(),t._tooltip=null),!e||t.preventTooltipOnTouch&&ge.isTouchDevice||("Object"!==e.constructor.name&&(e={html:"string"==typeof e?e:t.placeholder,textContent:!0}),e.newInstance?(e.type="tooltip",e.forElement||(e.forElement=t.element),"showOnHover"in e||e.forSelector||(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),t._tooltip=te.createWidget(e)):(t.element.dataset.btip=!0,t.tipConfig=e))}},{key:"isVisible",get:function(){var e=this,t=e.element;return Boolean(t&&!e._hidden&&!e.isDestroying&&nn(t)&&(!e.requireSize||function e(t){return t&&(t===document.body||("offsetParent"in t?t.offsetParent:e(t.parentNode)))}(t))&&(!e.owner||e.owner.isVisible))}},{key:"focusElement",get:function(){}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&!this.disabled&&(e===document.body||e.offsetParent)}},{key:"visible",set:function(e){this.hidden=!e}},{key:"hidden",set:function(e){this.isConfiguring?(this._hidden=e,this.element.classList[e?"add":"remove"]("b-hidden")):e?this.hide():this.show()},get:function(){return Boolean(this._hidden)}},{key:"assignedId",get:function(){return this.hasGeneratedId?null:this.id}},{key:"owner",get:function(){return this.parent||this._owner||this._element&&Z.fromElement(this.forElement||this.element.parentNode)},set:function(e){this._owner=e}},{key:"previousSibling",get:function(){return this.getSibling(-1)}},{key:"nextSibling",get:function(){return this.getSibling(1)}},{key:"widgetClassList",get:function(){var e=this,n=e.cls,r=e.classHierarchy(t).reduce((function(t,n){var r,i=Reflect.getOwnPropertyDescriptor(n.prototype,"widgetClass");if(i&&i.get)r=i.get.call(e);else{var o=n.hasOwnProperty("$name")?n.$name:n.name;r="b-".concat(o.toLowerCase())}return r&&t.push.apply(t,G()(r.split(" "))),t}),n?n.split(" "):[]);return e.floating&&r.push("b-floating"),ge.isTouchDevice&&r.push("b-touch"),r}}],[{key:"fromElement",value:function(e,t,n){}},{key:"$name",get:function(){return"Widget"}},{key:"defaultConfig",get:function(){return{element:!0,callOnFunctions:!0,id:"",html:null,hasGeneratedId:null,cls:null,style:null,disabled:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:null,preventTooltipOnTouch:null,monitorResize:null,cache:{},floating:null,positioned:null,draggable:null,align:"t-b",centered:null,constrainTo:null,anchor:null,scrollAction:null,hideAnimation:null,showAnimation:null,x:null,y:null,scrollable:null,scrollerClass:Qn,defaultBindProperty:"html",defaultAction:null,width:null,height:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title"],requireSize:!1,ref:null,hidden:null}}},{key:"floatRoot",get:function(){var e=this;return e._floatRoot||(e._floatRoot=document.querySelector(".b-float-root")),e._floatRoot?document.body.contains(e._floatRoot)||document.body.appendChild(e._floatRoot):(e._floatRoot=rn.createElement({className:"b-float-root",parent:document.body}),ge.isAndroid&&(e._floatRoot.style.height="".concat(screen.height,"px"),Ln.on({element:window,orientationchange:function(){return e._floatRoot.style.height="".concat(screen.height,"px")}}))),e._floatRoot}}]),t}(de(ze(Ve(z))));vr._$name="Widget",X.register("widget",vr);var mr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"template",value:function(){return'<div class="b-icon"></div>'}},{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),Ln.on({element:this.element,click:"onClick",mousedown:"onMousedown",thisObj:this})}},{key:"onClick",value:function(e){var t=this,n=t.panel,r="function"==typeof t.handler?t.handler:n[t.handler];!1!==n.trigger("toolclick",{tool:t})&&r&&t.callback(r,n,[e])}},{key:"onMousedown",value:function(e){var t=this.panel,n=t.focusElement;e.preventDefault(),n&&document.activeElement!==n&&t.focus()}},{key:"panel",get:function(){return this.parent}}],[{key:"$name",get:function(){return"Tool"}}]),t}(vr);mr._$name="Tool",X.register("tool",mr);var pr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"renderChildren",value:function(){var e=this.owner,t=this.containerCls,n=this.itemCls,r=e.contentElement,i=e.items,o=e.itemCls,a=i&&i.length;if(r.classList.add("b-content-element"),t&&r.classList.add(t),a)for(var s=0;s<a;s++){var l=i[s],u=l.element;u.dataset.itemIndex=s,n&&u.classList.add(n),o&&u.classList.add(o),u.classList.remove("b-outer"),l.render(r,Boolean(e.isPainted))}}},{key:"removeChild",value:function(e){var t=e.element,n=this.owner,r=this.itemCls,i=n.contentElement,o=n.itemCls;i.removeChild(t),delete t.dataset.itemIndex,r&&t.classList.remove(r),o&&t.classList.remove(o),this.fixChildIndices()}},{key:"appendChild",value:function(e){var t=e.element,n=this.owner.indexOfChild(e),r=this.owner,i=this.itemCls,o=r.contentElement,a=r.itemCls;t.dataset.itemIndex=n,i&&t.classList.add(i),a&&t.classList.add(a),o.appendChild(t)}},{key:"insertChild",value:function(e,t){var n=e.element,r=this.owner,i=this.itemCls,o=r.contentElement,a=o.querySelector('[data-item-index="'.concat(t-1,'"]')),s=r.itemCls;i&&n.classList.add(i),s&&n.classList.add(s),o.insertBefore(n,a&&a.nextSibling),this.fixChildIndices()}},{key:"fixChildIndices",value:function(){this.owner.items.forEach((function(e,t){e.element.dataset.itemIndex=t}))}}],[{key:"getLayout",value:function(e,n){if(e instanceof t)return e;var r="string"==typeof e,i={owner:n};return new(r?yr[e]:e)(r?i:Object.assign(i,e))}},{key:"registerLayout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.$name.toLowerCase();yr[t]=e}},{key:"defaultConfig",get:function(){return{containerCls:null,itemCls:null}}}]),t}(ze(z)),yr={default:pr};pr._$name="Layout";var kr=0,br=function(e){return e.ripple},wr=window.Ripple=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"afterConstruct",value:function(){se()(oe()(t.prototype),"afterConstruct",this).call(this),Ln.on({element:document,DOMContentLoaded:"doEnableDisable",thisObj:this}),ir.on({theme:"doEnableDisable",thisObj:this}),!ge.isEdge||"complete"!==document.readyState&&"interactive"!==document.readyState||this.doEnableDisable()}},{key:"doEnableDisable",value:function(){var e=this;e.show();var t=rn.getStyleValue(e.circleElement,"animationName");e.hide(),t&&"none"!==t?e.listenerDetacher=Ln.on({mousedown:{element:document,capture:!0,handler:"onDocumentMousedown"},touchstart:{element:document,capture:!0,handler:"onDocumentTouchStart"},animationend:{element:e.circleElement,handler:"onAnimationEnd"},thisObj:e}):e.listenerDetacher&&e.listenerDetacher()}},{key:"onDocumentTouchStart",value:function(e){kr=performance.now(),this.handleTriggerEvent(e)}},{key:"onDocumentMousedown",value:function(e){performance.now()-kr>200&&this.handleTriggerEvent(e)}},{key:"handleTriggerEvent",value:function(e){var t=Z.fromElement(e.target,br);if(t){var n=t.ripple,r=n.delegate?e.target.closest(n.delegate):t.focusElement||t.element;if(r){var i=kt.assign({event:e,target:r,radius:this.radius},n);if("string"==typeof i.clip&&(i.clip=t[i.clip]||e.target.closest(i.clip),!i.clip))return;this.ripple(i)}}}},{key:"ripple",value:function(e){var t=e.event,n=e.point,r=void 0===n?Ln.getClientPoint(t):n,i=e.target,o=void 0===i?t.target:i,a=e.clip,s=void 0===a?o:a,l=e.radius,u=void 0===l?this.radius:l,c=e.color,d=void 0===c?this.color:c;this.clip=s,s=Oe.from(s,null,!0);var h=this,f=s.getDelta(r),g=h.rippleElement.style,v=h.circleElement;h.hide(),h.alignTo(s),g.transform="translateX(".concat(f[0],"px) translateY(").concat(f[1],"px)"),g.height=g.width="".concat(u,"px"),v.setAttribute("r",u),v.setAttribute("fill",d),h.show(),h.requestAnimationFrame((function(){document.addEventListener("scroll",h.callRealign,!0),h.documentScrollListener=!0}))}},{key:"alignTo",value:function(e){1===e.nodeType&&(e=Oe.from(e,null,!0));var t=e,n=t.x,r=t.y,i=t.width,o=t.height;this.x=n,this.y=r,this.height=o,this.width=i}},{key:"onAnimationEnd",value:function(e){"b-ripple-expand"===e.animationName&&this.hide()}},{key:"realign",value:function(){this.isVisible&&this.alignTo(this.clip)}}],[{key:"defaultConfig",get:function(){return{id:"bryntum-ripple",old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}},{key:"$name",get:function(){return"Ripple"}}]),t}(vr)),Sr=function(){function e(t){C()(this,e);var n=this;n.generation=0,n.items=new Set,n.idMap={},n.idProperty="id",t&&(t.idProperty&&(n.idProperty=t.idProperty),t.values&&(n.values=t.values))}return x()(e,[{key:"get",value:function(e){return this.idMap[Yn(e)]}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&Array.isArray(t[0])&&(t=t[0]);for(var r=this,i=r.items,o=r.idMap,a=r.idProperty,s=t.length,l=0;l<s;l++){var u=t[l],c=Yn(u[a])||u,d=o[c];null==d?(o[c]=u,i.add(u),r.generation++):d!==u&&(o[c]=u,i.delete(d),i.add(u))}}},{key:"remove",value:function(e){Array.isArray(e)||(e=[e]);for(var t=this.items,n=this.idMap,r=this.idProperty,i=e.length,o=0;o<i;o++){var a=e[o],s=Yn(a[r]),l=n[s];null!=l&&(t.delete(l),delete n[s],this.generation++)}}},{key:"clear",value:function(){this.items.clear(),this.idMap={},this.generation++}},{key:"changeId",value:function(e,t){var n=this.idMap,r=this.idProperty,i=Wn[U()(e)]?e:Yn(e[r]),o=this.get(i);if(o){var a=this.get(t);if(a&&o!==a)throw new Error("Attempt to set item ".concat(i," to already existing member's id ").concat(t));o[r]=t,delete n[i],n[t]=o}}},{key:"includes",value:function(e){var t=Wn[U()(e)]?e:Yn(e[this.idProperty]);return Boolean(this.idMap[t])}},{key:"map",value:function(e,t){var n=this.items,r=new Array(n.size);return n.forEach((function(i){return r[0]=e.call(t,i,0,n)})),r}},{key:"forEach",value:function(e,t){return this.items.forEach(e,t)}},{key:"find",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.items[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(e(a))return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:Symbol.iterator,value:function(){return this.items[Symbol.iterator]()}},{key:"indexOf",value:function(e){return this.values.indexOf(e)}},{key:"sort",value:function(e){this.values=this.values.sort(e)}},{key:"some",value:function(e,t){return this.values.some(e,t)}},{key:"count",get:function(){return this.items.size}},{key:"values",get:function(){return G()(this.items)},set:function(e){Array.isArray(e)||(e=[e]),this.clear(),this.add.apply(this,e),this.generation++}}]),e}();Sr._$name="Bag";var Cr=Object.freeze({}),Er=function(e){return e.weight},xr=function(e,t){return(e.weight||0)-(t.weight||0)},Dr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"setConfig",value:function(e,n){e.widgets&&(e.items=e.widgets),se()(oe()(t.prototype),"setConfig",this).call(this,e,n)}},{key:"startConfigure",value:function(e){var n=this.items;this.hasItems=Boolean(n&&n.length),se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0;1===t.length&&(Array.isArray(t[0])?t=t[0]:r=!1);for(var i=this,o=[],a=0;a<t.length;a++){var s=t[a];i._items.includes(s)&&(i._items.remove(s),i.layout.removeChild(s),o.push(s),i.unregisterReference(s))}return r?o:o[0]}},{key:"removeAll",value:function(){return this.remove(this.items)}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0;1===t.length&&(Array.isArray(t[0])?t=t[0]:r=!1);for(var i=this,o=[],a=0;a<t.length;a++){var s=t[a];s instanceof vr?s.parent=i:s=i.createWidget(s),i._items.includes(s)||(i.registerReference(s),i._items.add(s),i.layout.appendChild(s),o.push(s))}return r?o:o[0]}},{key:"insert",value:function(e,t){var n=this,r=n._items;e instanceof vr?e.parent=n:e=n.createWidget(e),r.includes(t)&&(t=n.indexOfChild(t)),t=Math.min(t,r.count);var i=r.values;return i.splice(t,0,e),r.values=i,n.registerReference(e),n.layout.insertChild(e,t),e}},{key:"indexOfChild",value:function(e){return this._items.indexOf(e)}},{key:"processItemsArray",value:function(e,t){var n,r,i=e.length;for(n=0;n<i;n++)(r=e[n])instanceof vr?r.parent=this:r=this.createWidget(r),r&&t.add(r)}},{key:"processItemsObject",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cr,i=arguments.length>2?arguments[2]:void 0;for(n in e)(t=e[n])&&(n in r&&(t="object"===U()(t)?kt.merge(kt.clone(r[n]),t):r[n]),t&&(t instanceof vr?t.parent=this:t=this.createWidget(t),t&&(t.ref=n,i.add(t))))}},{key:"registerReference",value:function(e){var t=e.ref||e.id;if(t)for(var n=this;n;n=n.parent)n.widgetMap[t]||(n.widgetMap[t]=e)}},{key:"unregisterReference",value:function(e){var t=e.ref||e.id;if(t)for(var n=this;n;n=n.parent)n.widgetMap[t]===e&&delete n.widgetMap[t]}},{key:"getValues",value:function(e){for(var t=this.queryAll((function(e){return e.name})),n=t.length,r={},i=0;i<n;i++){var o=t[i],a=o.name;e&&!e(o)||(r[a]=o.value)}return r}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.childItems,r=n?n.length:0,i=0;i<r;i++){var o=n[i];if(!1===e(o))return!1;if(t&&o.eachWidget&&!1===o.eachWidget(e,t))return!1}return!0}},{key:"queryAll",value:function(e){var t=[];return this.eachWidget((function(n){e(n)&&t.push(n)})),t}},{key:"query",value:function(e){var t=null;return this.eachWidget((function(n){if(e(n))return t=n,!1})),t}},{key:"getWidgetById",value:function(e){return this.widgetMap[e]}},{key:"processWidgetConfig",value:function(e){}},{key:"createWidget",value:function(e){var t=this;"string"==typeof e?e={html:e}:1===e.nodeType&&(e={element:e,id:e.id}),(e=Object.setPrototypeOf({parent:t},e)).type||(e.type=t.defaultType);for(var n=e.parent;n;n=n.parent)if(!1===n.processWidgetConfig(e))return null;return!1===t.trigger("beforeWidgetCreate",{widget:e})?null:te.createWidget(kt.assign({},t.defaults,e),t.defaultType||"widget")}},{key:"render",value:function(){this.layout.renderChildren(),se()(oe()(t.prototype),"render",this).apply(this,arguments)}},{key:"doDestroy",value:function(){!this.configuredItems&&this.items&&this.items.forEach((function(e){return e.destroy&&e.destroy()})),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"setValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._isSettingValues=!0,this.eachWidget((function(n){var r=n.highlightExternalChange,i=t?n.name:n.name||n.ref||n.id;"value"in n&&i&&(n.highlightExternalChange=!1,n.value=e&&i in e?e[i]:null,n.highlightExternalChange=r)}),!0),this._isSettingValues=!1}},{key:"widgets",set:function(e){console.warn("`widgets` was deprecated in 2.1, please change your code to use `items`")},get:function(){return console.warn("`widgets` was deprecated in 2.1, please change your code to use `items`"),this.items}},{key:"items",set:function(e){this.configuredItems=e},get:function(){var e=this,t=e._items||(e._items=new Sr),n=e.configuredItems;return n&&(e.configuredItems=!1,Array.isArray(n)?e.processItemsArray(n,t):n&&e.processItemsObject(n,e.namedItems,t),t.some(Er)&&t.sort(xr),t.forEach(e.registerReference,e)),t.values}},{key:"widgetMap",get:function(){return this._widgetMap||(this._widgetMap={}),this._thisIsAUsedExpression(this.items),this._widgetMap}},{key:"record",set:function(e){this._record=e,this.setValues(e,!0)},get:function(){return this._record}},{key:"layoutStyle",set:function(e){rn.applyStyle(this.contentElement,e),this._layoutStyle=e},get:function(){return this._layoutStyle}},{key:"layout",set:function(e){this._layout=pr.getLayout(e,this)},get:function(){return this._layout||(this._layout=new pr)}},{key:"childItems",get:function(){return this.items}},{key:"focusElement",get:function(){var e=this.query(this.defaultFocus||function(e){return e.isFocusable});return e?e.focusElement:se()(oe()(t.prototype),"focusElement",this)}},{key:"isValid",get:function(){var e=!0;return this.eachWidget((function(t){if("isValid"in t&&!t.isValid)return e=!1}),!0),e}},{key:"values",get:function(){var e={};return this.eachWidget((function(t){"value"in t&&(e[t.name||t.ref||t.id]=t.value)}),!0),e},set:function(e){this.setValues(e)}},{key:"isSettingValues",get:function(){return this._isSettingValues||this.parent&&this.parent.isSettingValues}}],[{key:"$name",get:function(){return"Container"}},{key:"defaultConfig",get:function(){return{items:null,widgets:null,defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:"default",namedItems:null}}}]),t}(vr);Dr._$name="Container",X.register("container",Dr);var Tr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"createWidget",value:function(e){"->"===e?e={type:"widget",cls:"b-toolbar-fill"}:"|"===e?e={type:"widget",cls:"b-toolbar-separator"}:"string"==typeof e&&(e={type:"widget",cls:"b-toolbar-text",html:e});var n=se()(oe()(t.prototype),"createWidget",this).call(this,e);return this.widgetCls&&n.element.classList.add(this.widgetCls),n}}],[{key:"$name",get:function(){return"Toolbar"}},{key:"defaultConfig",get:function(){return{defaultType:"button",widgetCls:null,layout:"default"}}}]),t}(Dr);Tr._$name="Toolbar",X.register("toolbar",Tr);var Rr=function(e){return!e.classList.contains("b-focus-trap")&&rn.isFocusable(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},Mr=function(e,t){return(e.weight||0)-(t.weight||0)},Fr=function(e,t){return(t.weight||0)-(e.weight||0)};Rr.acceptNode=Rr;var _r=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onFocusTrapped",value:function(e){var t=this,n=t.treeWalker;e.target===t.bottomFocusTrap?(n.currentNode=t.topFocusTrap,n.nextNode()):(n.currentNode=t.bottomFocusTrap,n.previousNode()),t.requestAnimationFrame((function(){return n.currentNode.focus()}))}},{key:"doDestroy",value:function(){var e=this.tools;if(e)for(var n=0,r=Object.values(e);n<r.length;n++){r[n].destroy()}this.tbar&&this.tbar.destroy(),this.bbar&&this.bbar.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"element",set:function(e){var n=this,r=n.title&&(!n.parent||!n.parent.suppressChildHeaders),i=n.header||(n.tools||r?{}:null),o=n.footer,a=i&&("string"==typeof i?i:n.title||i.title),s=i&&(i.titleAlign||"start"),l=n.classHierarchy(t).map((function(e){return"b-".concat(e.$name.toLowerCase(),"-header")})).join(" "),u=n.tbar,c=n.bbar||n.buttons,d=[{reference:"topFocusTrap",className:"b-focus-trap",tabIndex:0}],h=[],f=[],g={children:d};if((n.hasItems||n.focusable)&&(g.tabIndex=0),i){var v=[{reference:"titleElement",className:"b-header-title b-align-".concat(s),html:a}];for(var m in n.tools){var p=n.tools[m];"start"===p.align?h.unshift(p):f.push(p)}h.sort(Mr),f.sort(Fr),v.unshift.apply(v,G()(h.map((function(e){return e.element})))),v.push.apply(v,G()(f.map((function(e){return e.element})))),d.push({tag:"header",reference:"headerElement",className:"".concat(l," b-dock-").concat(i.dock||"top"," ").concat(i.cls||""),children:v})}u&&(u.layout.renderChildren(),d.push(u.element)),d.push(n.bodyConfig),c&&(c.layout.renderChildren(),d.push(c.element)),o&&d.push({tag:"footer",reference:"footerElement",className:"".concat(l," b-dock-").concat(o.dock||"bottom"," ").concat(o.cls||"")}),d.push({reference:"bottomFocusTrap",className:"b-focus-trap",tabIndex:0}),fn()(oe()(t.prototype),"element",g,this,!0)},get:function(){return se()(oe()(t.prototype),"element",this)}},{key:"bodyConfig",set:function(e){this._bodyConfig=e},get:function(){return this._bodyConfig||{reference:"bodyElement",className:this.classHierarchy(t).map((function(e){return"b-".concat(e.$name.toLowerCase(),"-content")})).join(" "),html:this.html}}},{key:"tbar",set:function(e){e instanceof Tr?e.parent=this:(Array.isArray(e)&&(e={items:e}),e=new Tr(Object.assign({parent:this},e))),this.hasItems=this.hasItems||e.hasItems,e.element.classList.add("b-top-toolbar","b-dock-".concat(e.dock||"top")),this._tbar=e},get:function(){return this._tbar}},{key:"bbar",set:function(e){e instanceof Tr?e.parent=this:(Array.isArray(e)&&(e={items:e}),e=te.createWidget(Object.assign({type:"toolbar",parent:this},e))),this.hasItems=this.hasItems||e.hasItems,e.element.classList.add("b-bottom-toolbar","b-dock-".concat(e.dock||"bottom")),this._bbar=e},get:function(){return this._bbar}},{key:"childItems",get:function(){var e=this,t=e.items?e.items.slice():[];return e.tools&&t.unshift.apply(t,G()(Object.values(e.tools))),e.tbar&&t.unshift(e.tbar),e.bbar&&t.push(e.bbar),t}},{key:"tools",set:function(e){var t=this._tools={};for(var n in e){var r=t[n]=te.createWidget(kt.assign({type:"tool",ref:n,reference:n,parent:this},e[n]),this.defaultToolType||"tool");this.registerReference(r,r.ref)}},get:function(){return this._tools}},{key:"trapFocus",set:function(e){var t=this;t.element.classList[e?"add":"remove"]("b-focus-trapped"),e?(t.focusTrapListener=Ln.on({element:t.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:t}),t.treeWalker||(t.treeWalker=document.createTreeWalker(t.element,NodeFilter.SHOW_ELEMENT,Rr,!1))):t.focusTrapListener&&(t.focusTrapListener(),t.focusTrapListener=null),t._trapFocus=e},get:function(){return this._trapFocus}},{key:"focusElement",get:function(){return this.hasItems&&(se()(oe()(t.prototype),"focusElement",this)||this.element)}},{key:"contentElement",get:function(){return this.element&&this.bodyElement}},{key:"widgetClassList",get:function(){var e=this,n=se()(oe()(t.prototype),"widgetClassList",this),r=e.header;return(r||e.title||e.tools)&&n.push("b-panel-has-header b-header-dock-".concat(r&&r.dock||"top")),e.tbar&&n.push("b-panel-has-top-toolbar"),e.bbar&&n.push("b-panel-has-bottom-toolbar"),n}}],[{key:"$name",get:function(){return"Panel"}},{key:"defaultConfig",get:function(){return{trapFocus:null,title:null,header:null,footer:null,tools:null,tbar:null,bbar:null}}}]),t}(Dr);_r._$name="Panel",X.register("panel",_r);var Ar=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"startConfigure",value:function(e){this._thisIsAUsedExpression(this.closable),se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"finalizeInit",value:function(){var e=this;e.anchoredTo=e.forElement,e.initialAnchor=e.anchor,e.forElement&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),Ln.on({element:e.forElement,click:"onElementUserAction",thisObj:e})),se()(oe()(t.prototype),"finalizeInit",this).call(this),e.autoShow&&(!0===e.autoShow?e.show():e.setTimeout((function(){return e.show()}),e.autoShow))}},{key:"doDestroy",value:function(){this.syncModalMask(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"close",value:function(){if(!this._hidden&&!1!==this.trigger("beforeClose")||this._hidden&&"destroy"==this.closeAction)return this[this.closeAction]()}},{key:"onElementResize",value:function(e,n,r){var i=this,o=i.lastAlignSpec;if(i.isVisible&&o&&o.target){var a=!n||r.height!==n.height,s=!n||r.width!==n.width;(a&&2!==o.zone||s&&1!==o.zone)&&i.requestAnimationFrame((function(){return i.realign()}))}se()(oe()(t.prototype),"onElementResize",this).call(this,e)}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.close(!0))}},{key:"onDocumentMouseDown",value:function(e){var n=e.event,r=this;r.modal&&n.target===t.modalMask?(n.preventDefault(),r.modal.closeOnMaskTap?r.close():r.containsFocus||r.focus()):r.owns(n.target)||!r.autoClose||r.containsFocus||r.close(),r.setTimeout((function(){return document.body.classList.add("b-using-keyboard")}),0)}},{key:"onFocusIn",value:function(e){var n=document.activeElement;se()(oe()(t.prototype),"onFocusIn",this).call(this,e),document.activeElement===n&&e.target===this.element&&this.focus()}},{key:"onFocusOut",value:function(e){!this.modal&&this.autoClose&&this.close(),se()(oe()(t.prototype),"onFocusOut",this).call(this,e)}},{key:"onShow",value:function(){var e=this;e.autoClose&&!e.mouseDownRemover&&(e.mouseDownRemover=ir.on({globaltap:"onDocumentMouseDown",thisObj:e})),e.focusOnToFront&&e.focus(),se()(oe()(t.prototype),"onShow",this)&&se()(oe()(t.prototype),"onShow",this).call(this),e.syncModalMask()}},{key:"syncModalMask",value:function(){var e=this,n=e.modal,r=t.modalMask;if(n&&e.isVisible)e._x||e._y||(e.centered=!0),r.classList.remove("b-hide-display"),r.parentNode.insertBefore(r,e.element),e.element.classList.add("b-modal");else{e.element.classList.remove("b-modal");var i=e.constructor.floatRoot.querySelectorAll(".b-modal");if(i.length){var o=i[i.length-1];r.classList.remove("b-hide-display"),r.parentNode.insertBefore(r,o)}else r.classList.add("b-hide-display")}}},{key:"onHide",value:function(){this.mouseDownRemover&&(this.mouseDownRemover(),this.mouseDownRemover=null),se()(oe()(t.prototype),"onHide",this)&&se()(oe()(t.prototype),"onHide",this).call(this),this.syncModalMask()}},{key:"onElementUserAction",value:function(){this.show()}},{key:"isTopModal",get:function(){return rn.isVisible(t.modalMask)&&this.element.previousElementSibling===t.modalMask}},{key:"closable",set:function(e){this._closable=e,this.tools||(this.tools={})},get:function(){return this._closable}},{key:"tools",set:function(e){this.closable&&((e||(e={})).close={cls:"b-popup-close",handler:"close",weight:-1e3}),fn()(oe()(t.prototype),"tools",e,this,!0)},get:function(){return se()(oe()(t.prototype),"tools",this)}}],[{key:"$name",get:function(){return"Popup"}},{key:"defaultConfig",get:function(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:ge.isIE11?null:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:ge.isIE11?null:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,modal:null}}},{key:"modalMask",get:function(){var e=this;return e._modalMask?e.floatRoot.contains(e._modalMask)||e.floatRoot.appendChild(e._modalMask):e._modalMask=rn.createElement({className:"b-modal-mask b-hide-display",parent:e.floatRoot}),e._modalMask}}]),t}(_r);Ar._$name="Popup",X.register("popup",Ar);var Ir=n(20),Lr=n.n(Ir),Or=(n(93),/>[ \t\r\n]+</g),Pr=/\s\s+/g,Hr=function(){function e(){C()(this,e)}return x()(e,null,[{key:"tpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(Or,"><").replace(Pr," ").trim()}},{key:"docsTpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(Or,"><").trim()}},{key:"repeat",value:function(t){return function(){return e.tpl.apply(e,arguments).repeat(t)}}},{key:"loop",value:function(e){}}]),e}();function Nr(){var e=Lr()(["\n            <"," "," ",' class="','" ',' tabIndex="-1">\n                ','\n                <span class="b-menu-text" reference="textElement">',"</span>\n                ","\n            </",">"]);return Nr=function(){return e},e}Hr._$name="TemplateHelper";var Br=/^b-icon-/,zr=/^b-fa-/,jr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doAction",value:function(e){var t=this.parent,n={menu:t,item:this,element:this.element,bubbles:!0};"boolean"==typeof this.checked&&(this.checked=!this.checked),this.trigger("beforeItem",n),this.trigger("item",n),this.closeParent&&t&&(t.rootMenu.close(),e&&!this.href&&e.preventDefault())}},{key:"doDestroy",value:function(){var e=this._menu;e instanceof vr&&e.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(e){var t=e.icon||("boolean"==typeof e.checked?"b-fw-icon b-icon-".concat(e.checked?"":"un","checked"):""),n=Br.test(t)?" b-icon":zr.test(t)?" b-fa":"",r=e.href?"a":"div";return Hr.tpl(Nr(),r,"a"===r?'href="'.concat(e.href,'"'):"","a"===r&&e.target?'target="'.concat(e.target,'"'):"",e.hasMenu?"b-has-submenu":"",e.name?'data-name="'.concat(e.name,'"'):"",t?'<i class="b-menuitem-icon '.concat(t).concat(n,'" reference="iconElement"></i>'):"",e.text,e.hasMenu?'<i class="b-fw-icon b-icon-sub-menu" reference="subMenuIcon"></i>':"",r)}},{key:"onFocusIn",value:function(e){se()(oe()(t.prototype),"onFocusIn",this).call(this,e),!this.disabled&&this.menu&&this.openMenu()}},{key:"onFocusOut",value:function(e){se()(oe()(t.prototype),"onFocusOut",this).call(this,e),this.closeMenu()}},{key:"openMenu",value:function(e){var t=this.menu;!this.disabled&&t&&(t.focusOnToFront=e,t.show(),this.owner.currentSubMenu=t)}},{key:"closeMenu",value:function(){this._menu instanceof vr&&this.menu.close()}},{key:"focusElement",get:function(){return this.element}},{key:"contentElement",get:function(){return this.textElement}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&(e===document.body||e.offsetParent)}},{key:"checked",set:function(e){var t=this,n=t.isConfiguring;(n||"boolean"==typeof t._checked)&&(e=!!e)!==t._checked&&(t._checked=e,n||(t.iconElement.classList[e?"add":"remove"]("b-icon-checked"),t.iconElement.classList[e?"remove":"add"]("b-icon-unchecked"),t.trigger("toggle",{menu:t.owner,item:t,checked:t._checked,element:t.element,bubbles:!0})))},get:function(){return this._checked}},{key:"menu",set:function(e){this._menu=e},get:function(){var e=this,t=e._menu;return!t||t instanceof vr||("object"!==U()(t)||"items"in t||"widgets"in t||"html"in t||(t={items:t}),t=e.menu=te.createWidget(Object.assign({type:"menu",autoShow:!1,autoClose:!0,scrollAction:e.owner.scrollAction,constrainTo:e.owner.constrainTo,forElement:e.element,align:"l0-r0",anchor:!0,owner:e,cls:"b-sub-menu"},t))),t}},{key:"text",get:function(){return this.html},set:function(e){this.html=e}},{key:"closeParent",set:function(e){this._closeParent=e},get:function(){return("boolean"==typeof this.checked?this._closeParent:!1!==this._closeParent)&&!this.hasMenu}},{key:"hasMenu",get:function(){var e=this.isConfiguring?this.initialConfig.menu:this._menu;return e&&(e instanceof vr||"object"===U()(e)||e.length>0)}}],[{key:"$name",get:function(){return"MenuItem"}},{key:"defaultConfig",get:function(){return{menu:null,icon:null,text:null,checked:null,closeParent:null,localizableProperties:["text"]}}}]),t}(vr);jr._$name="MenuItem",X.register("menuitem",jr);var Vr={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1},Wr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){Array.isArray(e)&&(e={items:e}),se()(oe()(t.prototype),"construct",this).call(this,e),Ln.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseleave:"onMouseLeave",thisObj:this})}},{key:"afterShow",value:function(e){this.items.some((function(e){return Boolean(e._menu)}))&&this.element.classList.add("b-menu-with-submenu"),this.items.some((function(e){return e.icon}))&&this.element.classList.add("b-menu-with-icon"),se()(oe()(t.prototype),"afterShow",this).call(this,e)}},{key:"createWidget",value:function(e){return"string"==typeof e&&(e={text:e}),se()(oe()(t.prototype),"createWidget",this).call(this,e)}},{key:"onDocumentMouseDown",value:function(e){this.parentMenu&&this.parentMenu.owns(e.event.target)||se()(oe()(t.prototype),"onDocumentMouseDown",this).call(this,e)}},{key:"hide",value:function(e){se()(oe()(t.prototype),"hide",this).call(this,e),this.currentSubMenu&&this.currentSubMenu.hide(e),this.parentMenu&&(this.parentMenu.currentSubMenu=null)}},{key:"onMouseClick",value:function(e){var t=e.target.closest(".b-menuitem");t&&(this.triggerElement(t,e),e.stopImmediatePropagation())}},{key:"onMouseOver",value:function(e){if(!1!==this.focusOnHover){var t=rn.up(e.relatedTarget,".b-widget"),n=rn.up(e.target,".b-widget"),r=Z.fromElement(n);!rn.isTouchEvent&&n&&n!==t&&r.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[r],cancelOutstanding:!0})}}},{key:"handleMouseOver",value:function(e){e.focus()}},{key:"onMouseLeave",value:function(e){var t=this,n=e.relatedTarget,r=n&&t.owns(n),i=n&&n instanceof HTMLElement&&Z.fromElement(n),o=!r;if(i){for(;i.ownerCmp;)i=i.ownerCmp;o&=!rn.getAncestor(i.element,[e.target])}!r&&o&&(t.currentSubMenu&&t.currentSubMenu.hide(),t.currentSubMenu=t.selectedElement=null,t.element.contains(document.activeElement)&&document.activeElement.matches(".b-menuitem")&&t.element.focus())}},{key:"onInternalKeyDown",value:function(e){var n=Z.fromElement(e),r=n&&n!==this&&!(n instanceof jr);if("Escape"!==e.key){if(se()(oe()(t.prototype),"onInternalKeyDown",this).call(this,e),!r){Vr[e.key]&&e.preventDefault();var i=document.activeElement,o=this.element;this.navigateFrom(i!==o&&o.contains(i)?i:null,e.key,e)}}else(r?this:this.rootMenu).close()}},{key:"navigateFrom",value:function(e,t,n){var r,i=this,o=i.treeWalker,a=e&&i.getItem(e);switch(t){case"ArrowUp":o.currentNode=e||(e=i.bottomFocusTrap),o.previousNode(),r=o.currentNode;break;case"ArrowDown":o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(a&&a.menu?i.openSubMenu(e,a):i.triggerElement(e,n));break;case"ArrowRight":if(e&&a&&a.menu&&!e.classList.contains("b-disabled")){var s=i.openSubMenu(e,a);s&&s.focus()}else o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case"ArrowLeft":i.isSubMenu?i.hide():e||(o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&i.triggerElement(e,n)}r&&(r===i.element?i.navigateFrom(i.bottomFocusTrap,"ArrowUp",n):r===e?i.navigateFrom(i.topFocusTrap,"ArrowDown",n):r.focus())}},{key:"getItem",value:function(e){if(null!=e)return"number"==typeof e?this.items[e]:1===e.nodeType?Z.fromElement(e,"menuitem",this.contentElement):this.items.find((function(t){return t.id==e}))}},{key:"triggerElement",value:function(e,t){var n=this.getItem(e);n&&!n.disabled&&n.doAction(t)}},{key:"openSubMenu",value:function(e,t){var n=t.menu;if(n){if(!n.isVisible){var r={item:t,element:e};if(!1===this.trigger("beforeSubMenu",r))return;if(t.onBeforeSubMenu&&!1===t.onBeforeSubMenu(r))return;n.show()}return this.currentSubMenu=n}}},{key:"selectFirst",value:function(){var e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame((function(){return e.currentNode.focus()}))}},{key:"focusElement",get:function(){var e=this.parentMenu&&this.parentMenu.element.contains(document.activeElement),n=this.items[0];return!e&&n instanceof jr?this.element:se()(oe()(t.prototype),"focusElement",this)}},{key:"isSubMenu",get:function(){return this.owner&&this===this.owner.menu}},{key:"selectedElement",set:function(e){var t=this._selectedElement;if(t){var n=this.getItem(t),r=n&&n.menu;r&&r.hide(),t.classList.remove("b-active")}if(this._selectedElement=e,e){var i=rn.isFocusable(e);e.classList.add("b-active"),this.scrollable.scrollIntoView(e,{animate:!i,focus:i})}},get:function(){return this._selectedElement}},{key:"parentMenu",get:function(){var e=this.owner;if(e instanceof jr&&(e=e.owner),e instanceof t)return e}},{key:"rootMenu",get:function(){for(var e=this;e.parentMenu&&e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}],[{key:"$name",get:function(){return"Menu"}},{key:"defaultConfig",get:function(){return{align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem"}}}]),t}(Ar);Wr._$name="Menu",X.register("menu",Wr);var Gr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){var e=t.toasts.indexOf(this);e>-1&&t.toasts.splice(e,1),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"show",value:function(){se()(oe()(t.prototype),"show",this).call(this),this.timeout>0&&(this.hideTimeout=this.setTimeout("hide",this.timeout))}},{key:"hide",value:function(){var e=this;e.destroyTimeout||(e.element.classList.add("b-toast-hide"),e.element.style.bottom="",e.animationTimeout=e.setTimeout("destroy",200))}},{key:"element",set:function(e){},get:function(){if(!this._element&&!this.isConfiguring){var e=this,n=t.toasts.length&&t.toasts[0].element,r=n?n._nextBottom:e.bottomMargin,i=fn()(oe()(t.prototype),"element",rn.createElement({parent:e.appendTo||vr.floatRoot,children:e.showProgress?[{className:"b-toast-progress",style:"animation-duration:".concat(e.timeout/1e3,"s;")}]:null,html:e._html,className:e.color||"",style:e._style||""}),this,!0);Ln.on({element:i,click:"hide",thisObj:e}),t.toasts.unshift(e),i._nextBottom=r+i.offsetHeight+e.bottomMargin,i.style.cssText+=";bottom:".concat(r,"px;transform:translateY(0)")}return se()(oe()(t.prototype),"element",this)}}],[{key:"hideAll",value:function(){t.toasts.reverse().forEach((function(e){return e.hide()}))}},{key:"show",value:function(e){var n=new t("string"==typeof e?{html:e}:e);return n.show(),n}},{key:"$name",get:function(){return"Toast"}},{key:"defaultConfig",get:function(){return{floating:!0,timeout:2500,showProgress:!0,color:null,bottomMargin:20}}}]),t}(vr);Gr.toasts=[],Gr._$name="Toast",X.register("toast",Gr);var Yr={left:!0,right:!0,top:!0,bottom:!0,transform:!0},Ur=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"afterConstruct",value:function(){var e=this;e.forSelector&&(e.showOnHover=!0,e.forElement||(e.trackMouse=!0,e.forElement=document.body)),se()(oe()(t.prototype),"afterConstruct",this).call(this),e.forElement&&e.showOnHover&&Ln.on({element:e.forElement,mouseover:"internalOnPointerOver",mouseout:"onPointerOut",transitionend:"onTransitionEnd",thisObj:e}),e.autoShow&&e.show(),e.allowOver&&Ln.on({element:e.element,mouseenter:"onOwnElementMouseEnter",mouseleave:"onPointerOut",thisObj:e})}},{key:"onDocumentMouseDown",value:function(e){var n=e.event,r=this.pointerEvent;r&&rn.isTouchEvent&&n.pageX===r.pageX&&n.pageY===r.pageY&&this.activeTarget.contains(n.target)&&performance.now()-r.timeStamp<500||se()(oe()(t.prototype),"onDocumentMouseDown",this).call(this,{event:n})}},{key:"internalOnPointerOver",value:function(e){var t,n=this,r=n.forElement,i=n.forSelector,o=n.activeTarget;if(!(n.disabled||n.allowOver&&n.element.contains(e.target))){if(i){if(o&&o.contains(e.target)&&o.contains(e.relatedTarget))return;if((t=e.target.closest(i))&&e.relatedTarget&&e.relatedTarget.closest(i)===t)return}else{if(r.contains(e.relatedTarget))return;t=r}t?n.handleForElementOver(e,t):o&&n.handleForElementOut()}}},{key:"onTransitionEnd",value:function(e){var n=this,r=t.currentOverElement;if(Yr[e.propertyName]){if(n.allowOver&&n.element.contains(r))return;n.isVisible&&n.activeTarget.contains(r)&&!n.trackMouse&&n.realign()}}},{key:"handleForElementOver",value:function(e,t){var n=this;if(!1===n.trigger("pointerOver",{event:e,target:t}))n.onPointerOut(e);else if(n.pointerEvent=e,n.abortDelayedHide(),n.isVisible&&!n.hideOnDelegateChange){if(n.updateActiveTarget(t),!1===n.trigger("beforeShow"))return n.hide();n.alignTo({target:n.anchorToTarget?t:new yn(n.pointerEvent.pageX-window.pageXOffset+n.mouseOffsetX,n.pointerEvent.pageY-window.pageYOffset+n.mouseOffsetY),overlap:!(n.anchorToTarget&&n.anchor)}),n.trigger("show"),n.afterShowByTarget()}else n.hideOnDelegateChange&&n.hide(),n.updateActiveTarget(t),n.delayShow(t)}},{key:"delayShow",value:function(e){var t=this;t.currentAnimation&&(t.cancelHideShowAnimation(),t._hidden=!0),t.isVisible||t.hasTimeout("show")?t.isVisible&&t.showByTarget(e):!t.hoverDelay||t.forSelector&&Date.now()-t.lastHidden<t.quickShowInterval?t.showByTarget(e):(t.listeningForMouseMove||t.anchorToTarget||(t.mouseMoveRemover=Ln.on({element:document,mousemove:"onMouseMove",thisObj:t})),t.setTimeout((function(){return t.showByTarget(e)}),t.pointerEvent&&"mouseover"!==t.pointerEvent.type?0:t.hoverDelay,"show"))}},{key:"showByTarget",value:function(e){var t=this;t.mouseMoveRemover&&(t.mouseMoveRemover(),t.mouseMoveRemover=null),t.showBy({target:t.anchorToTarget?e:new yn(t.pointerEvent.pageX-window.pageXOffset+t.mouseOffsetX,t.pointerEvent.pageY-window.pageYOffset+t.mouseOffsetY),overlap:!(t.anchorToTarget&&t.anchor)})}},{key:"afterShowByTarget",value:function(){var e=this.dismissDelay;this.abortDelayedShow(),e&&this.setTimeout("hide",e),this.toFront()}},{key:"updateActiveTarget",value:function(e){var t=this.activeTarget;this.activeTarget=e,this.isConfiguring||this.trigger("overtarget",{newTarget:e,lastTarget:t})}},{key:"onPointerOut",value:function(e){var t=this,n=e.relatedTarget;t.allowOver&&t.element.contains(n)||t.element.contains(e.target)&&t.activeTarget&&t.activeTarget.contains(n)||t.activeTarget&&!t.activeTarget.contains(e.relatedTarget)&&t.handleForElementOut()}},{key:"handleForElementOut",value:function(){var e=this,t=e.hideDelay;e.abortDelayedShow(),e.isVisible&&!1!==t&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())}},{key:"show",value:function(){var e=this;e.forElement&&e.anchorToTarget&&!e.forSelector&&!e.inShowBy?e.showByTarget(e.forElement):(e.inShowBy&&(e.y=-1e4),se()(oe()(t.prototype),"show",this).call(this)),e.afterShowByTarget(),e.mouseMoveRemover||e._hidden||!e.trackMouse||(e.mouseMoveRemover=Ln.on({element:document,mousemove:"onMouseMove",thisObj:e}))}},{key:"hide",value:function(){var e=this;if(e.isVisible){var n;e.abortDelayedShow(),e.abortDelayedHide();for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(n=se()(oe()(t.prototype),"hide",this)).call.apply(n,[this].concat(i)),e.lastHidden=Date.now(),e.activeTarget=null,e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null),e.listeningForMouseMove=!1}}},{key:"abortDelayedShow",value:function(){var e=this;e.hasTimeout("show")&&(e.clearTimeout("show"),e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null))}},{key:"abortDelayedHide",value:function(){this.clearTimeout("hide")}},{key:"realign",value:function(e){var n=this,r=n.lastAlignSpec,i=n.clippedBy;!n.isConfiguring&&i&&!n.isVisible&&r.targetHidden&&(Oe.from(r.target,n.positioned?n.element.offsetParent:null,!n.positioned).intersect(i)&&(n.show(),r.targetHidden=!1));se()(oe()(t.prototype),"realign",this).call(this,e)}},{key:"alignTo",value:function(e){var n=this;if(n.isVisible){if(n.getHtml&&(!n.pointerEvent||!n.element.contains(n.pointerEvent.target))){1===e.nodeType&&(e={target:e});var r=e instanceof yn?e:e.position||(1===e.target.nodeType?Oe.from(e.target):e.target);n.isAligning=!0,n.html=n.getHtml({tip:n,element:n.element,forElement:n.activeTarget,x:r.x,y:r.y,event:n.pointerEvent}),n.isAligning=!1}n.isVisible&&se()(oe()(t.prototype),"alignTo",this).call(this,e)}}},{key:"onMouseMove",value:function(e){var t=this,n=e.pageX-window.pageXOffset+t.mouseOffsetX,r=e.pageY-window.pageYOffset+t.mouseOffsetY,i=t.hasTimeout("hide"),o=e.target;t.pointerEvent=e,t._hidden||(!t.forSelector||i||1!==o.nodeType||o.matches(t.forSelector)||t.allowOver&&t.element.contains(o)?i&&!t.forElement.contains(o)||(t.dismissDelay&&!i&&t.setTimeout("hide",t.dismissDelay),t.trackMouse&&t.alignTo({position:new yn(n,r),ignorePageScroll:!0})):t.handleForElementOut())}},{key:"onOwnElementMouseEnter",value:function(e){this.abortDelayedHide()}},{key:"focusElement",get:function(){var e=se()(oe()(t.prototype),"focusElement",this);if(e!==this.element)return e}},{key:"anchorToTarget",get:function(){return this._anchorToTarget},set:function(e){this._anchorToTarget=e,e||(this.anchor=!1)}},{key:"trackMouse",set:function(e){this._trackMouse=e},get:function(){return this._trackMouse&&!this.anchorToTarget}},{key:"textContent",set:function(e){this._textContent=e,this.element.classList[e?"add":"remove"]("b-tooltip-text-content")},get:function(){return this._textContent}},{key:"html",set:function(e){var n=this;if(!1===e?e='<div class="b-tooltip-loading"><div class="b-icon b-icon-spinner"></div>'.concat(n.L(n.loadingMsg),"</div>"):null!=e&&(e=n.L(String(e))),e){var r=n.getHtml;n.getHtml=null,fn()(oe()(t.prototype),"html",e,this,!0),n.isAligning||n.realign(),n.getHtml=r,n.trigger("innerHtmlUpdate")}else n.hide()},get:function(){return se()(oe()(t.prototype),"html",this)}}],[{key:"$name",get:function(){return"Tooltip"}},{key:"defaultConfig",get:function(){return{mouseOffsetX:15,mouseOffsetY:15,floating:!0,getHtml:null,forElement:null,trackMouse:null,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:!1,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:!1,textContent:!1,anchor:!0,align:"b-t",axisLock:!0,showAnimation:null,hideAnimation:null}}}]),t}(Ar);Ln.on({element:document,mouseenter:function(e){return Ur.currentOverElement=e.target},capture:!0}),Ur._$name="Tooltip",X.register("tooltip",Ur),vr.tooltip=new Ur({id:"bryntum-tooltip",forElement:window,forSelector:"[data-btip]",header:!0,resetCfg:{},listeners:{pointerOver:function(e){var t=e.source,n=e.target;for(var r in t.resetCfg)"listeners"===r?t.un(t.resetCfg[r].set):"was"in t.resetCfg[r]?t[r]=t.resetCfg[r].was:delete t[r];t.resetCfg={};var i=Z.get(n.id),o=i?i.tipConfig:t.gatherDataConfigs(n.dataset);for(var a in o)t.resetCfg[a]={set:o[a]},t.hasOwnProperty(a)&&(t.resetCfg[a].was=t[a]),"listeners"===a?t.on(o[a]):t[a]=o[a];t.headerElement.style.display=t.title?"":"none"}},gatherDataConfigs:function(e){var t={};for(var n in e)if(n.startsWith("btip"))if(n.length>4){var r=A.lowercaseFirstLetter(n.substr(4));if(r in this.getDefaultConfiguration()){var i=e[n];t[r]=isNaN(i)?i:parseInt(i,10)}}else t.html=e[n];return t}});var qr=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),this._badge&&(this.badge=this._badge)}},{key:"badge",set:function(e){var t=this.element;this._badge=e,t&&(null!=e&&""!==e?(t.dataset.badge=e,t.classList.add("b-badge")):(t.dataset.badge&&delete t.dataset.badge,t.classList.remove("b-badge")))},get:function(){return this._badge}},{key:"widgetClass",get:function(){if(this.badge)return"b-badge"}}]),t}(e||z)};function $r(){var e=Lr()(['\n            <button class="'," ",'" ',">\n                 \n            </button>\n        "],['\n            <button class="'," ",'" ',">\n                \\xa0\n            </button>\n        "]);return $r=function(){return e},e}var Xr=/^b-icon-/,Kr=/^b-fa-/,Jr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"template",value:function(){var e=this;return Hr.tpl($r(),e.color||"",e.toggleable&&e.pressed?"b-pressed":"",e.toggleGroup?'data-group="'.concat(e.toggleGroup,'"'):"")}},{key:"construct",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.toggleGroup&&(n.toggleable=!0);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(e=se()(oe()(t.prototype),"construct",this)).call.apply(e,[this,n].concat(i)),Ln.on({element:this.element,click:"onInternalClick",thisObj:this})}},{key:"doDestroy",value:function(){this.destroyProperties("menu"),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"eachWidget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.menu;if(n){if(!1===e(n))return;t&&n.eachWidget&&n.eachWidget(e,t)}}},{key:"onFocusOut",value:function(e){se()(oe()(t.prototype),"onFocusOut",this).call(this,e),this.menu&&this.menu.hide()}},{key:"onInternalClick",value:function(e){var t=this,n={event:e};if(t.toggleable){if(t.toggleGroup&&t.pressed)return;t.toggle(!t.pressed)}t.trigger("click",n),t.isDestroyed||t.trigger("action",n),e.preventDefault(),e.stopPropagation()}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.menu;t.toggleable&&(null===e&&(e=!t.pressed),t.pressed=e,t.toggling=!0,n&&(n.minWidth=t.width,n[e?"show":"hide"]()),t.syncIconCls(),t.trigger("toggle",{pressed:e}),t.toggling=!1)}},{key:"syncIconCls",value:function(){var e=this,t=e._iconEl;if(e.icon){t||(t=e._iconEl=rn.createElement({tag:"i",nextSibling:e.element.firstChild}));var n=e.pressed&&e.pressedIcon?e.pressedIcon:e.icon;e._iconEl.className=n,Xr.test(n)?t.classList.add("b-icon"):Kr.test(n)&&t.classList.add("b-fa")}else t&&t.remove()}},{key:"focusElement",get:function(){return this.element}},{key:"text",get:function(){return this._text},set:function(e){var t=this.element;null==e&&(e=""),t.lastChild.data=this._text=e,t.classList[e?"add":"remove"]("b-text")}},{key:"menu",get:function(){var e=this,t=e._menu;return!t||t instanceof vr||("object"!==U()(t)||"items"in t||"widgets"in t||"html"in t||(t={items:t}),t=e.menu=te.createWidget(Object.assign({type:"menu",autoShow:!1,autoClose:!0,scrollAction:"realign",constrainTo:document.body,forElement:e.element,align:"t0-b0",owner:e,onHide:function(){e.setTimeout((function(){return e.toggle(!1)}),300)}},t))),t},set:function(e){this._menu=e,this.toggleable=Boolean(e)}},{key:"pressed",set:function(e){var t=this;e&&t.toggleGroup&&rn.forEachSelector("button[data-group=".concat(t.toggleGroup,"]"),(function(e){e!==t.element&&te.getById(e.id).toggle(!1)})),t._pressed=e,t.element&&t.element.classList[e?"add":"remove"]("b-pressed")},get:function(){return this._pressed}},{key:"icon",set:function(e){this._icon=e,this.syncIconCls()},get:function(){return this._icon}},{key:"pressedIcon",set:function(e){this._pressedIcon=e,this.syncIconCls()},get:function(){return this._pressedIcon}},{key:"iconAlign",set:function(e){var t=this._iconAlign;e!==t&&(t&&this.element.classList.remove("b-icon-align-".concat(t)),this.element.classList.add("b-icon-align-".concat(e)),this._iconAlign=e)},get:function(){return this._iconAlign}}],[{key:"$name",get:function(){return"Button"}},{key:"defaultConfig",get:function(){return{icon:null,pressedIcon:null,iconAlign:"start",text:"",color:null,toggleable:!1,pressed:!1,toggleGroup:null,ripple:{radius:75},defaultBindProperty:"text",localizableProperties:["text"],menu:null}}}]),t}(qr(vr));Jr._$name="Button",X.register("button",Jr);var Qr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};se()(oe()(t.prototype),"construct",this).call(this,n),this.items.forEach((function(t){return t.on("click",e.onItemClick,e)}))}},{key:"onItemClick",value:function(){this._value=null}},{key:"createWidget",value:function(e){var n=this;n.color&&!e.color&&(e.color=n.color),n.toggleGroup&&!e.toggleGroup&&("boolean"==typeof n.toggleGroup&&(n.toggleGroup=Z.generateId("toggleGroup")),e.toggleGroup=n.toggleGroup),n.columns&&(e.width="".concat(100/n.columns,"%"));var r=se()(oe()(t.prototype),"createWidget",this).call(this,e);if(!(r instanceof Jr))throw new Error("A ButtonGroup can only contain buttons");return r}},{key:"value",get:function(){if(!this._value){var e=[];this.items.forEach((function(t){t.pressed&&void 0!==t.value&&e.push(t.value)})),this._value=e.join(this.valueSeparator)}return this._value},set:function(e){Array.isArray(e)||(e=null==e?[]:"string"==typeof e?e.split(this.valueSeparator):[e]),this._value=e,this.items.forEach((function(t){void 0!==t.value&&(t.pressed=e.indexOf(t.value)>-1)}))}},{key:"disabled",get:function(){return se()(oe()(t.prototype),"disabled",this)},set:function(e){fn()(oe()(t.prototype),"disabled",e,this,!0),this.items.forEach((function(t){return t.disabled=e}))}},{key:"widgetClassList",get:function(){var e=se()(oe()(t.prototype),"widgetClassList",this);return this.columns&&e.push("b-columned"),e}}],[{key:"$name",get:function(){return"ButtonGroup"}},{key:"defaultConfig",get:function(){return{defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null}}}]),t}(Dr);Qr._$name="ButtonGroup",X.register("buttonGroup",Qr);var Zr=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.mousedownRemover&&this.mousedownRemover(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onMouseDown",value:function(e){var t=this,n=t.delegate?e.target.closest(t.delegate):t.element;n&&(t.triggerEvent=e,Ln.lockComposedPath(t.triggerEvent),t.activeListenerRemover=Ln.on({mouseup:{element:document,handler:"onMouseUp"},mousemove:{element:n,handler:"onTargetMouseMove"},mouseleave:{element:n,handler:"onTargetMouseLeave"},mouseenter:{element:n,handler:"onTargetMouseEnter"},thisObj:t}),t.setTimeout("startAutoRepeat",t.delay))}},{key:"onMouseUp",value:function(e){var t=this;t.acceleration&&t.acceleration.cancel(),t.activeListenerRemover&&t.activeListenerRemover(),t.clearTimeout("startAutoRepeat"),t.clearTimeout(t.repeatTimer)}},{key:"onTargetMouseLeave",value:function(){this.clearInterval(this.repeatTimer)}},{key:"onTargetMouseEnter",value:function(e){this.triggerEvent=e,this.fireClick()}},{key:"onTargetMouseMove",value:function(e){this.triggerEvent=e}},{key:"startAutoRepeat",value:function(){var e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=kn.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}},{key:"nextTick",value:function(e){this.interval=this.startInterval-this.accelerationDelta*e}},{key:"fireClick",value:function(){var e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}},{key:"element",set:function(e){this._element=e,this.mousedownRemover=Ln.on({element:e,mousedown:"onMouseDown",thisObj:this})},get:function(){return this._element}}],[{key:"defaultConfig",get:function(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3}}}]),t}(de(z));Zr._$name="ClickRepeater";var ei=function(e,t){return(e.weight||0)-(t.weight||0)},ti=function(e,t){return(t.weight||0)-(e.weight||0)},ni={array:!0},ri=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){var e=this,n=e.triggers,r=t._errorTip;if(e.inputListenerRemover&&e.inputListenerRemover(),e.keyListenerRemover&&e.keyListenerRemover(),se()(oe()(t.prototype),"doDestroy",this).call(this),n)for(var i=0,o=Object.values(n);i<o.length;i++){o[i].destroy()}r&&r.field===e&&r.hide()}},{key:"construct",value:function(e){var n=this;n.highlightChanged=n.createOnFrame("addUpdatedCls"),se()(oe()(t.prototype),"construct",this).call(this,e),t.errorTip,n.keyStrokeChangeDelay&&(n.changeOnKeyStroke=n.buffer(n.internalOnChange,n.keyStrokeChangeDelay))}},{key:"onFocusIn",value:function(e){this.valueOnFocus=kt.clone(this.value),se()(oe()(t.prototype),"onFocusIn",this).call(this,e)}},{key:"onFocusOut",value:function(e){se()(oe()(t.prototype),"onFocusOut",this).call(this,e),this.updateRequired(),this.onEditComplete()}},{key:"onEditComplete",value:function(){}},{key:"select",value:function(e,t){var n=this.focusElement;if(n.value.length){if(0===arguments.length)return void this.selectAll();if(!this.supportsTextSelection)return;ge.isIE11?(n.focus(),n.setSelectionRange(e,t)):n.setSelectionRange(e,t)}}},{key:"moveCaretToEnd",value:function(){var e=this.input;if(e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}},{key:"selectAll",value:function(){this.focusElement.select()}},{key:"updateEmpty",value:function(){var e=this.isEmptyInput,t=this.isEmpty,n=this.element,r=this.clearIcon,i=e&&t;n&&(r&&r.classList[i?"add":"remove"]("b-icon-hidden"),n.classList[i?"add":"remove"]("b-empty"))}},{key:"updateInvalid",value:function(){this.updatingInvalid=!0;var e=this.isValid,t=this.element,n=this.errorTip,r=this.inputWrap;t&&(t.classList[e?"remove":"add"]("b-invalid"),e?n.isVisible&&n.field===this&&n.hide():r.contains(Ur.currentOverElement)&&(n.activeTarget===r&&n.isVisible?n.onBeforeShow():(n.activeTarget=r,n.showBy(r)))),this.updatingInvalid=!1}},{key:"hasChanged",value:function(e,t){return t!==e}},{key:"syncInputFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.input;n&&!t.inputting&&(t.input.value=t.inputValue,t.isConfiguring||t.containsFocus||!t.highlightExternalChange||(n.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),e||t.parent&&t.parent.isSettingValues||t.highlightChanged())),t.updateEmpty(),t.updateInvalid()}},{key:"addUpdatedCls",value:function(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",1500)}},{key:"removeUpdatedCls",value:function(){this.input.classList.remove("b-field-updated")}},{key:"internalOnInputFocus",value:function(){var e=this.input.value.length;ge.isIE11&&e&&!this.autoSelect&&this.select(e,e)}},{key:"internalOnChange",value:function(e){var t=this;t.isValid&&t.hasChanged(t._lastValue,t.value)&&(t.triggerChange(e,!0),t._lastValue=t.value)}},{key:"triggerChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Boolean(this._isUserAction),n=this,r=n.value,i=n._lastValue,o=n.isValid;n.trigger("change",{value:r,oldValue:i,event:e,userAction:t,valid:o}),"change"===n.defaultAction&&n.trigger("action",{value:r,oldValue:i,event:e,userAction:t,valid:o})}},{key:"internalOnInput",value:function(e){var t=this;t.inputting=!0,t.value=t.input.value,t.inputting=!1,t.trigger("input",{value:t.value,event:e}),t.changeOnKeyStroke&&t.changeOnKeyStroke(e)}},{key:"internalOnKeyPress",value:function(e){var t=this,n=t.value,r=!1;if("keydown"===e.type)if("Escape"!==e.key||t.readOnly)"Enter"===e.key&&ge.isIE11&&t.internalOnChange(e);else{var i="initialValue"in t?t.initialValue:t.valueOnFocus,o=t.hasChanged(i,n),a=t.input.value!==String(t.inputValue);t.revertOnEscape&&(!t.isValid||o||a)?(o&&(t.value=i),a&&t.syncInputFieldValue(!0),t.clearError(),r=!0):t.clearable&&(n||t.input.value)&&t.clear()}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}},{key:"clear",value:function(){this.value=null,this.trigger("clear")}},{key:"onDisabled",value:function(){this.updateInvalid()}},{key:"updateRequired",value:function(){var e=this;e.isConfiguring||!e.required||""!==e.value&&null!=e.value?e.clearError("fieldRequired",e.updatingInvalid):e.setError("fieldRequired",e.updatingInvalid)}},{key:"setError",value:function(e,t){(this.errors||(this.errors={}))[e]=this.L(e),t||this.updateInvalid()}},{key:"clearError",value:function(e,t){this.errors&&(e?delete this.errors[e]:this.errors={}),t||this.updateInvalid()}},{key:"getErrors",value:function(){if(!this.isValid){var e=this.errors?kt.getTruthyValues(this.errors):[this.input.validationMessage||this.L("invalidValue")];if(e&&e.length)return e}}},{key:"errorTip",get:function(){return this.constructor.errorTip}},{key:"element",set:function(e){var n=this,r=n.initialConfig.value,i=rn.createElementFromTemplate(n.inputTemplate(n),ni),o=[{className:"b-field-inner",reference:"inputWrap",children:i}],a=[],s=[],l=n.labels||[];for(var u in n.label&&l.push({reference:"labelElement",html:n.label}),l&&l.forEach((function(e){var t=Object.assign({tag:"label",htmlFor:"".concat(n.id,"_input"),className:"b-align-".concat(e.align||"start")},e);e.align&&"start"!==e.align?o.push(t):o.unshift(t)})),n._thisIsAUsedExpression(n.clearable),n.triggers){var c=n.triggers[u];"start"===c.align?a.unshift(c):s.push(c)}a.sort(ei),s.sort(ti),i.unshift.apply(i,G()(a.map((function(e){return e.element})))),i.push.apply(i,G()(s.map((function(e){return e.element})))),fn()(oe()(t.prototype),"element",{className:l.length?"b-has-label":"",children:o},this,!0),null!=r&&(n.value=r),n.updateEmpty(),n.updateInvalid();var d=n.input||n.focusElement;d&&(n.keyListenerRemover=Ln.on({element:d,thisObj:n,keydown:"internalOnKeyPress",keypress:"internalOnKeyPress",keyup:"internalOnKeyPress"}))},get:function(){return se()(oe()(t.prototype),"element",this)}},{key:"focusElement",get:function(){return this.input}},{key:"attributeString",get:function(){var e=this,t=e.attributes.map((function(t){return null!=e[t]?"".concat(t.toLowerCase(),'="').concat(e[t],'"'):""})).join(" ");return e.inputAttributes&&(t+=Object.keys(e.inputAttributes).map((function(t){return"".concat(t,'="').concat(e.inputAttributes[t],'"')})).join(" ")),t}},{key:"editable",get:function(){return this._editable&&!this.readOnly},set:function(e){var t=this,n=t.input;t._editable=e,n&&(t.readOnly||(n.readOnly=!1===e?"readOnly":null),!1!==e?t.inputListenerRemover=Ln.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"}):t.inputListenerRemover&&t.inputListenerRemover())}},{key:"clearable",set:function(e){this._clearable=e,e&&!this.triggers&&(this.triggers={})},get:function(){return this._clearable}},{key:"triggers",set:function(e){var t=this,n=t._triggers={};for(var r in t.clearable&&((e||(e={})).clear={cls:"b-icon-remove",handler:function(){t._isUserAction=!0,t.clear(),t._isUserAction=!1},weight:1e3}),e)n[r]=te.createWidget(kt.assign({type:"trigger",reference:r,parent:t},e[r]),t.defaultTriggerType||"trigger")},get:function(){return this._triggers}},{key:"labelWidth",set:function(e){this.labelElement&&(this.labelElement.style.flex="0 0 ".concat(rn.setLength(e)),this.inputWrap.style.flexBasis=null==e?"":0)}},{key:"label",get:function(){return this._label},set:function(e){null==e&&(e=""),this._label=e,this.labelElement&&(this.labelElement.innerHTML=e)}},{key:"readOnly",get:function(){return this._readOnly||this.disabled},set:function(e){this._readOnly=e,this.element.classList[e?"add":"remove"]("b-readonly"),e?this.input.setAttribute("readonly",""):this.input.removeAttribute("readonly")}},{key:"isValid",get:function(){var e=this;if(!e.disabled){if(e.updateRequired(),e.errors&&kt.getTruthyValues(e.errors).length)return!1;if(e.input&&e.input.validity)return e.input.validity.valid}return!0}},{key:"isEmpty",get:function(){return null==this.value||""===this.value}},{key:"isEmptyInput",get:function(){return!this.input||null==this.input.value||""===this.input.value}},{key:"value",get:function(){return this._value},set:function(e){var t=this,n=t._value;t.hasChanged(n,e)?(t._value=e,t.isConfiguring||(t.updateRequired(),t.inputting||t.triggerChange()),t.inputting||(t._lastValue=e),t.syncInputFieldValue()):""===e&&t.updateRequired()}},{key:"inputValue",get:function(){return null==this.value?"":this.value}},{key:"supportsTextSelection",get:function(){var e=this.focusElement;return e&&("textarea"===e.tagName.toLowerCase()||e.type&&(/text|search|password|tel|url/.test(e.type)||ge.isEdge))}}],[{key:"$name",get:function(){return"Field"}},{key:"defaultConfig",get:function(){return{value:"",label:null,labels:null,required:null,clearable:null,revertOnEscape:null,labelWidth:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder"],autoSelect:!1,autoComplete:"off",inputAttributes:null}}},{key:"errorTip",get:function(){return t._errorTip||(t._errorTip=new Ur({id:"bryntum-field-errortip",cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:"l-r",scrollAction:"realign",onBeforeShow:function(){var e=Z.fromElement(this.activeTarget);if(e){var t=e.getErrors();if(t)return this.html=t.join("<br>"),this.field=e,!0}return!1}}))}}]),t}(qr(vr));function ii(){var e=Lr()(['\n            <input type="checkbox" id="','_input" reference="input" ','/>\n            <label class="b-checkbox-label" for="','_input" reference="textLabel">',"</label>\n        "]);return ii=function(){return e},e}ri.Trigger=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"template",value:function(){return'<div class="b-icon b-align-'.concat(this.align||"end",'"></div>')}},{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),Ln.on({element:this.element,click:{handler:"onClick",thisObj:this},mousedown:{handler:"onMousedown",thisObj:this}})}},{key:"onClick",value:function(e){var t=this,n=t.field,r="function"==typeof t.handler?t.handler:n[t.handler];n.disabled||n.readOnly||r&&!1!==n.trigger("trigger",{trigger:t})&&r.call(n,e)}},{key:"onMousedown",value:function(e){var t=this.field;!("key"in e)&&rn.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout((function(){return t.editable=!0}),500)),e.preventDefault(),document.activeElement!==t.input&&t.focus()}},{key:"field",get:function(){return this.parent}}],[{key:"$name",get:function(){return"FieldTrigger"}},{key:"defaultConfig",get:function(){return{align:null}}}]),t}(vr),ri.SpinTrigger=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.clickRepeater&&this.clickRepeater.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(){return'<div class="b-icon b-align-'.concat(this.align||"end",'">\n                    <div reference="upButton" class="b-icon b-spin-up"></div>\n                    <div reference="downButton" class="b-icon b-spin-down"></div>\n                </div>')}},{key:"onClick",value:function(e){var t=this.field;t.disabled||(e.target===this.upButton?t.doSpinUp():e.target===this.downButton&&t.doSpinDown())}},{key:"repeat",set:function(e){var t=this;e?t.clickRepeater=new Zr(Object.assign({element:t.element},e)):t.clickrepeater&&(t.clickRepeater.destroy(),t.clickrepeater=null)}}],[{key:"$name",get:function(){return"SpinTrigger"}},{key:"defaultConfig",get:function(){return{repeat:!0}}}]),t}(ri.Trigger),ri._$name="Field",X.register("trigger",ri.Trigger),X.register("spintrigger",ri.SpinTrigger);var oi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e);this.initialConfig.readOnly&&(this.readOnly=!0)}},{key:"inputTemplate",value:function(){var e=this;return Hr.tpl(ii(),e.id,e.toggleGroup?'data-group="'.concat(e.toggleGroup,'"'):"",e.id,e.text||"")}},{key:"getToggleGroupMembers",value:function(){var e=this.checked,t=this.toggleGroup,n=this.input,r=[];return e&&t&&rn.forEachSelector("input[type=checkbox][data-group=".concat(t,"]"),(function(e){if(e!==n){var t=te.fromElement(e);t&&r.push(t)}})),r}},{key:"uncheckToggleGroupMembers",value:function(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((function(e){return e.checked=!1}))}},{key:"check",value:function(){this.checked=!0}},{key:"uncheck",value:function(){this.checked=!1}},{key:"toggle",value:function(){this.checked=!this.checked}},{key:"internalOnChange",value:function(e){this.triggerChange(!0)}},{key:"triggerChange",value:function(e){var t=this,n=t.input.checked;(!n&&e&&t.toggleGroup&&t.getToggleGroupMembers().filter((function(e){return e.isVisible&&!e.disabled})).length||!t.callPreventable("change",{checked:n,userAction:e},(function(n){return e&&t.uncheckToggleGroupMembers(),t.trigger("action",n),!0})))&&(t.input.checked=!t.input.checked)}},{key:"element",set:function(e){var n=this;fn()(oe()(t.prototype),"element",e,this,!0),n.color&&n.element.classList.add(n.color),n.text&&n.element.classList.add("b-text")},get:function(){return se()(oe()(t.prototype),"element",this)}},{key:"text",get:function(){return this._text},set:function(e){this._text=e,this.textLabel&&(this.textLabel.innerHTML=e)}},{key:"value",get:function(){return this.input.value},set:function(e){this.input.value=e}},{key:"checked",get:function(){return this.input.checked},set:function(e){var t=this;e=Boolean(e),t.input.checked!==e&&(t.input.checked=e,t.uncheckToggleGroupMembers(),t.isConfiguring||t.triggerChange(!1))}},{key:"readOnly",get:function(){return this._readOnly},set:function(e){this._readOnly=e,this.element.classList[e?"add":"remove"]("b-readonly"),this.input.disabled=e}}],[{key:"$name",get:function(){return"Checkbox"}},{key:"defaultConfig",get:function(){return{text:"",color:null,value:"",toggleGroup:null,defaultBindProperty:"value",localizableProperties:["label","text"]}}}]),t}(ri);oi._$name="Checkbox",X.register("checkbox",oi),X.register("check",oi);var ai=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.pluggedInto=this.client=e,se()(oe()(t.prototype),"construct",this).call(this,n),this.applyPluginConfig(e)}},{key:"applyPluginConfig",value:function(e){var t=this,n=t.pluginConfig||t.constructor.pluginConfig;if(n){var r=n.assign,i=n.chain,o=n.after,a=n.before,s=n.override;r&&t.applyAssign(e,r),(i||o)&&t.applyChain(e,i||o),a&&t.applyChain(e,a,!1),s&&t.applyOverride(e,s)}}},{key:"applyAssign",value:function(e,t){var n=this;t.forEach((function(t){return n.assign(e,t)}))}},{key:"applyChain",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.forEach((function(t){e[t]?n.chain(e,t,r):n.assign(e,t)}))}},{key:"applyOverride",value:function(e,t){var n=this,r=this;r.overridden||(r.overridden={}),t.forEach((function(t){if(!r[t])throw new Error(n.L("overrideFnMissing",{plugIntoName:e.$name,pluginName:r.$name,fnName:t}));"function"==typeof e[t]&&(r.overridden[t]=e[t].bind(e)),e[t]=r[t].bind(r)}))}},{key:"assign",value:function(e,t){var n=this,r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(n),t);r&&(r.get||r.set)?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(n),set:r.set&&r.set.bind(n)}):e[t]=n[t].bind(n)}},{key:"chain",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this,i=e.pluginFunctionChain||(e.pluginFunctionChain={});if(i[t]||(i[t]=[e[t].bind(e)]),!r[t])throw new Error(this.L("fnMissing",{plugIntoName:e.$name,pluginName:r.$name,fnName:t}));i[t][n?"push":"unshift"](r[t].bind(r)),e[t]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return r.functionChainRunner.apply(r,[t].concat(n))}}},{key:"functionChainRunner",value:function(e){for(var t,n=this.client.pluginFunctionChain[e],r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var a=0;a<n.length;a++)if(!1===(t=n[a].apply(n,i)))return!1;return t}},{key:"doDisable",value:function(e){var t=this.constructor,n="featureClass"in t?t.featureClass:"b-".concat(t.$name.toLowerCase());n&&this.client&&this.client.element&&this.client.element.classList[e?"remove":"add"](n),e?this.trigger("disable"):this.trigger("enable")}},{key:"client",get:function(){return this._client},set:function(e){this._client=e}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this.doDisable(e)}}],[{key:"initPlugins",value:function(e){for(var t=e.plugins||(e.plugins={}),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];t[s.$name]=new s(e)}}},{key:"defaultConfig",get:function(){return{disabled:!1}}}]),t}(Ve(ze(z)));ai._$name="InstancePlugin";var si,li=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"initPlugins",value:function(){}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ai.initPlugins.apply(ai,[this].concat(t))}},{key:"hasPlugin",value:function(e){return null!=this.getPlugin(e)}},{key:"getPlugin",value:function(e){return"function"==typeof e&&(e=e.$name),this.plugins&&this.plugins[e]}},{key:"plugins",get:function(){return this._plugins||(this._plugins={}),this._plugins},set:function(e){e&&(Array.isArray(e)||(e=[e]),ai.initPlugins.apply(ai,[this].concat(G()(e)))),this.initPlugins()}},{key:"widgetClass",get:function(){}}]),t}(e||z)},ui=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"state",get:function(){return this._state=this.getState(),this._state},set:function(e){this._state=e,this.applyState(e)}},{key:"widgetClass",get:function(){}}]),t}(e||z)},ci=(n(141),Symbol("STM_PROP")),di={children:1,data:1,meta:1},hi={},fi=function(e){return e instanceof Date||(e=vt.parse(e,this.format||this.dateFormat||vt.defaultFormat)),e||void 0},gi=function(e,t,n){return e&&e.isEqual?e.isEqual(t,n):kt.isEqual(t,n)},vi=function(){},mi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.constructor,s=a.fieldMap,l=n?Array.isArray(n)?n:[n]:[];if(n=l[0],o.meta=Object.assign({modified:{}},a.metaConfig,r),se()(oe()(t.prototype),"construct",this).call(this,null),i?a.hasOwnProperty("fieldMap")||a.exposeProperties():a.exposeProperties(e),!a.hasOwnProperty("idFieldProcessed")){var u=o.meta.idField;u||(a._assignedIdField?u=a.idField:n&&(u=n.idField)),u&&u!==s.id.dataSource&&a.addField({name:"id",dataSource:u}),a.idFieldProcessed=!0}o._internalId=t._internalIdCounter++,o.stores=[],o.unjoinedStores=[],o.originalData||(o.originalData=e),o.data=a.processData(e,!1,n),null==o.id&&o.setData("id",o.generateId(n)),o.data[a.childrenField]&&o.processChildren(l),o.generation=0}},{key:"equals",value:function(e){if(e instanceof this.constructor){for(var t=this.fields,n=0,r=t.length;n<r;n++){var i=t[n],o=i.name;if("id"!==o&&!gi(i,this[o],e[o]))return!1}return!0}return!1}},{key:"getFieldDefinition",value:function(e){return this.constructor.getFieldDefinition(e)}},{key:"getDataSource",value:function(e){var t=this.constructor.getFieldDefinition(e);if(t)return t.dataSource||t.name}},{key:"initRelations",value:function(){var e=this;e.constructor.relations&&e.stores.forEach((function(t){t.modelRelations||t.initRelations();var n=[];t.modelRelations&&t.modelRelations.forEach((function(t){n.push({related:e.initRelation(t),config:t})})),t.updateRecordRelationCache(e,n)}))}},{key:"initRelation",value:function(e){var t=this.get(e.fieldName),n=void 0!==t&&"string"!=typeof e.store&&e.store.getById(t),r={id:t,placeHolder:!0};return this.meta.relationCache||(this.meta.relationCache={}),this.meta.relationCache[e.relationName]=n||(null!=t?r:null),n}},{key:"removeRelation",value:function(e){this.meta.relationCache[e.relationName]&&(delete this.meta.relationCache[e.relationName],e.nullFieldOnRemove&&this.setData(e.fieldName,null))}},{key:"getForeign",value:function(e){return this.meta.relationCache&&this.meta.relationCache[e]}},{key:"setForeign",value:function(e,n,r){var i=t.asId(n);return this.set(r.fieldName,i)}},{key:"get",value:function(e){var t=this,n=t.meta.batchChanges?Object.assign({},t.data,t.meta.batchChanges):t.data,r=t.constructor.fieldMap[e],i=r?r.dataSource:e;if(i)return r&&r.complexMapping?kt.getPath(n,i):i in n?n[i]:n[e]}},{key:"setData",value:function(e,t){var n=this.constructor.fieldMap[e],r=n?n.dataSource:e;r&&kt.setPath(this.data,r,t)}},{key:"syncId",value:function(e){var t=this.id;if(t!==e){this.setData("id",e);var n={id:{value:e,oldValue:t}};this.afterChange(n,n)}}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this;if(i.isBatchUpdating)return i.inBatchSet(e,t),null;var o=i.beforeSet?i.beforeSet(e,t,n,r):void 0,a=i.inSet(e,t,n,r);return i.afterSet&&i.afterSet(e,t,n,r,o,a),a}},{key:"fieldToKeys",value:function(e,t){var n;return"string"!=typeof e?(n={},Reflect.ownKeys(e).forEach((function(t){return n[t]=e[t]}))):n=$()({},e,t),n}},{key:"inBatchSet",value:function(e,t){var n=this;if("string"!=typeof e){var r=this.fieldToKeys(e,t);Object.keys(r).forEach((function(e){n.meta.batchChanges[e]=n.constructor.processField(e,r[e])}))}else this.meta.batchChanges[e]=t}},{key:"inSet",value:function(e,t,n,r){var i=this,o=i.constructor.fieldMap,a=i.constructor.prototype,s=i.data,l={},u=i.fieldToKeys(e,t),c=!1;return n||i.triggerBeforeUpdate(u)?(Object.keys(u).forEach((function(e){if(e!==i.constructor.childrenField){var t=o[e],n=t&&t.readOnly,d=t?t.dataSource:e,h=!t&&e in a,f=h?i[d]:kt.getPath(s,d),g=i.constructor.processField(e,u[e]),v=u[e]={value:g},m=i.getRelationConfig(e);n||gi(t,f,g)?delete u[e]:(i.generation++,v.oldValue=f,c=!0,gi(t,i.meta.modified[e],g)?delete i.meta.modified[e]:(i.meta.modified[e]=f,void 0===v.oldValue&&"oldValue"in v&&delete v.oldValue),l[e]=v,h?i[e]=g:kt.setPath(s,d,g),m&&!r&&(i.initRelation(m),i.stores.forEach((function(e){return e.cacheRelatedRecord(i,g,m.relationName,v.oldValue)}))))}})),c&&i.afterChange(u,l,n,r),c?l:null):null}},{key:"afterChange",value:function(e,t,n,r){var i=this;this.stores.forEach((function(o){o.onModelChange(i,e,t,n,r)}))}},{key:"isFieldModified",value:function(e){return this.isModified&&this.meta.modified[e]}},{key:"getFieldPersistentValue",value:function(e){var t,n=this.getFieldDefinition(e);return n&&!n.persist||(t=this[e],n&&n.serialize&&(t=n.serialize.call(this,t,this))),t}},{key:"clearChanges",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.meta;r.modified={},r.committing=!1,e&&n.stores.forEach((function(e){if(e.modified.remove(n),e.added.remove(n),t){var r=e.collectDescendants(n).all;e.added.remove(r),e.modified.remove(r)}}))}},{key:"generateId",value:function(){return this.constructor.generatedIdIndex||(this.constructor.generatedIdIndex=0),"_generated"+this.$name+ ++this.constructor.generatedIdIndex}},{key:"toJSON",value:function(){return this.data}},{key:"beginBatch",value:function(){this.batching||(this.batching=0,this.meta.batchChanges={}),this.batching++}},{key:"endBatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.constructor.parentIdField;if(t.batching&&(t.batching--,!(t.batching>0||kt.isEmpty(t.meta.batchChanges)))){var r=Object.assign({},t.meta.batchChanges);t.meta.batchChanges=null,r[n]&&(t.parentId=r[n],delete r[n]),t.set(r,void 0,e),t.cancelBatch()}}},{key:"cancelBatch",value:function(){this.batching=null,this.meta.batchChanges=null}},{key:"triggerBeforeUpdate",value:function(e){var t=this;return!this.stores.some((function(n){if(!1===n.trigger("beforeUpdate",{record:t,changes:e}))return!0}))}},{key:"copy",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this,o=Object.assign({},i.data),a=i.constructor.idField,s=!0;return r&&"object"===U()(r)?(e=r.deep,t=r.id,delete r.id):t=r,e&&i.children?(s=!1,o.children=i.children.map((function(e){return e.copy(r)}))):(delete o.children,delete o.expanded),t?o[a]=t:null==t&&(o[a]=i.generateId(i.firstStore)),n=s?new i.constructor(o):o,n.originalInternalId=i.internalId,n}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=this.parent;n?n.removeChild(t):t.stores.length&&(t.meta.specialRow||t.stores.forEach((function(n){return n.remove(t,e,!1,!0)})))}},{key:"getRelationConfig",value:function(e){return this.firstStore&&this.firstStore.modelRelations&&this.firstStore.modelRelations.find((function(t){return t.fieldName===e}))}},{key:"joinStore",value:function(e){var n=this,r=n.stores,i=n.unjoinedStores;r.includes(e)||(se()(oe()(t.prototype),"joinStore",this)&&se()(oe()(t.prototype),"joinStore",this).call(this,e),e.register(n),r.push(e),i.includes(e)&&i.splice(i.indexOf(e),1),n.isLoaded&&n.children.forEach((function(t){return t.joinStore(e)})),n.initRelations())}},{key:"unJoinStore",value:function(e){var n=this,r=n.stores,i=n.unjoinedStores;r.includes(e)&&(e.unregister(n),n.children&&n.children.forEach((function(t){return t.unJoinStore(e)})),r.splice(r.indexOf(e),1),i.push(e),se()(oe()(t.prototype),"unJoinStore",this)&&se()(oe()(t.prototype),"unJoinStore",this).call(this,e),e.uncacheRelatedRecord(n)),r.length||(n.meta.removed=!0)}},{key:"isPartOfStore",value:function(e){return e?e.indexOf(this)>=0:this.stores.length>0}},{key:"instanceMeta",value:function(e){var t=this.meta,n=e.id||e;return t.map||(t.map={}),t.map[n]||(t.map[n]={})}},{key:"indexPath",get:function(){for(var e=[],t=this;t&&!t.isRoot;t=t.parent)e.unshift(t.parentIndex+1);return e}},{key:"subclass",get:function(){return new this.constructor(Object.setPrototypeOf({id:void 0},this.data),this.stores[0],null,!0)}},{key:"fields",get:function(){return this.constructor.internalFields||this.constructor.fields}},{key:"fieldNames",get:function(){return Object.keys(this.data)}},{key:"isPersistable",get:function(){return!0}},{key:"isModified",get:function(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}},{key:"modifications",get:function(){var e=this;if(!e.isModified)return null;var t={};return Object.keys(e.meta.modified).forEach((function(n){var r=e.getFieldPersistentValue(n);void 0!==r&&(t[n]=r)})),t[e.constructor.idField]=e.id,t}},{key:"modificationData",get:function(){var e=this,t=e.constructor.fieldMap;if(!e.isModified)return null;var n={};return Object.keys(e.meta.modified).forEach((function(r){var i=t[r];if(i){var o=e.getFieldPersistentValue(r);void 0!==o&&(n[i.dataSource]=o)}})),n[e.constructor.idField]=e.id,n}},{key:"persistableData",get:function(){var e=this,t={};return Object.keys(e.data).forEach((function(n){var r=e.getFieldPersistentValue(n);void 0!==r&&(t[n]=r)})),t}},{key:"isCommitting",get:function(){return Boolean(this.meta.committing)}},{key:"internalId",get:function(){return this._internalId}},{key:"isPhantom",get:function(){return""===this.id||null==this.id||this.hasGeneratedId}},{key:"isModel",get:function(){return!0}},{key:"hasGeneratedId",get:function(){return this.id&&"string"==typeof this.id&&this.id.startsWith("_generated")}},{key:"json",get:function(){return JSON.stringify(this.data)}},{key:"isBatchUpdating",get:function(){return Boolean(this.batching)}},{key:"firstStore",get:function(){return this.stores.length>0&&this.stores[0]}},{key:"isValid",get:function(){return!0}}],[{key:"processData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=this.fieldMap,o=this.defaultValues,a=r||{},s=a.useRawData,l=void 0===s?{enabled:!1}:s,u=l.enabled?e:Object.assign({},e);if(!(n=n||l.disableDefaultValue))for(t in o)void 0===u[t]&&(u[t]=o[t]);if(!l.disableTypeConversion)for(t in i){var c=i[t],d=c.name,h=c.dataSource,f=h!==d&&!kt.pathExists(e,h)&&d in e,g=!l.disableTypeConversion&&c.convert;if(f||g){var v=f?e[d]:e[h];(!n||f&&d in e||!f&&h in e)&&(kt.setPath(u,h,g?c.convert(v):v),f&&delete u[d])}}return u}},{key:"exposeProperties",value:function(e){var t=this,n=t.superclass,r=t.hasOwnProperty("fields")&&t.fields;if(n.exposeProperties&&!n.hasOwnProperty("fieldMap")&&n.exposeProperties(),t.hasOwnProperty("propertiesExposed")||(t.defaultValues=Object.assign({},n.defaultValues,t.hasOwnProperty("defaults")?t.defaults:null),t.fieldMap=Object.setPrototypeOf({},n.fieldMap||hi),t.fieldDataSourceMap=Object.setPrototypeOf({},n.fieldDataSourceMap||hi),t.propertiesExposed=Object.setPrototypeOf({},n.propertiesExposed||hi),t.hasOwnProperty("idField")&&(t.addField({name:"id",dataSource:t.idField}),t.propertiesExposed[t.idField]=!0),r&&r.length&&r.map(t.addField,t)),t.autoExposeFields&&e&&!t.hasOwnProperty("propertiesExposedForData")){for(var i in e)t.propertiesExposed[i]||t.addField({name:i,dataSource:i,fromData:!0});t.propertiesExposedForData=!0}t.exposeRelations()}},{key:"addField",value:function(e){if(null!=e){"string"==typeof e&&(e={name:e});var t=this,n=t.propertiesExposed,r=t.defaultValues,i=e.name,o=e.dataSource||(e.dataSource=i);return e.hasOwnProperty("persist")||(e.persist=!0),"date"===e.type&&(e.convert=fi),t.fieldMap[i]=e,t.fieldDataSourceMap[o]||(t.fieldDataSourceMap[o]=e),-1===o.indexOf(".")?n[o]=!0:(e.complexMapping=!0,n[o.split(".")[0]]=!0),"defaultValue"in e&&(r[o]=e.defaultValue),t.createFieldProperty(i,o,e),e}}},{key:"removeField",value:function(e){var t=this.fieldMap[e];if(t){var n=t.dataSource;delete this.fieldMap[e],delete this.fieldDataSourceMap[n],delete this.prototype[e],this._internalFields=null}}},{key:"createFieldProperty",value:function(e,t,n){di[t]||e in this.prototype||Object.defineProperty(this.prototype,e,{enumerable:!0,configurable:!0,get:function(){return this.get(e)},set:n&&n.readOnly?vi:function(t){this.set(e,t)}})}},{key:"exposeRelations",value:function(){var e=this;e.hasOwnProperty("relationsExposed")||e.relationConfig&&(e.relationsExposed=!0,e.relations=[],e.relationConfig.forEach((function(t){e.relations.push(t);var n=t.relationName;Reflect.ownKeys(e.prototype).includes(n)||Object.defineProperty(e.prototype,n,{enumerable:!0,get:function(){return this.getForeign(n)},set:function(e){this.setForeign(n,e,t)}})})))}},{key:"getFieldDefinition",value:function(e){return this.fieldMap[e]}},{key:"processField",value:function(e,t){var n=this.fieldMap[e];return n&&n.convert?n.convert(t):t}},{key:"asId",value:function(e){return e&&e.isModel?e.id:e}},{key:"idField",set:function(e){this._assignedIdField=!0,this._idField=e},get:function(){return this._idField}},{key:"childrenField",set:function(e){this._childrenField=e},get:function(){return this._childrenField||"children"}},{key:"autoExposeFields",get:function(){return!0}},{key:"fields",get:function(){return[]}},{key:"internalFields",get:function(){var e=this.fieldMap,t=this._internalFields;if(this.hasOwnProperty("fieldMap")&&!t)for(var n in t=this._internalFields=[],e)t.push(e[n]);return t}}]),t}(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"ingestChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stores,n=this.inProcessChildren,r=this.constructor,i=t[0];if(!0===e)return!!n||[];if(e){Array.isArray(e)||(e=[e]);for(var o,a=0,s=e.length,l=[];a<s;a++)o=(o=e[a])instanceof mi?o:i?i.createRecord(o):new r(o,null,null,!0),l.push(o);return l}}},{key:"processChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stores,t=this,n=t.meta;t.inProcessChildren=!0;var r=t.ingestChildren(t.data[t.constructor.childrenField],e);r&&(r.length?(n.isLeaf=!1,!0===t.children&&(t.children=[]),t.appendChild(r)):!0===r?(n.isLeaf=!1,t.children=!0):t.isRoot||(n.isLeaf=t.constructor.convertEmptyParentToLeaf.onLoad)),t.inProcessChildren=!1}},{key:"ancestorsExpanded",value:function(e){var t=this.parent;return!t||t.isExpanded(e)&&t.ancestorsExpanded(e)}},{key:"isExpanded",value:function(e){var t=this.instanceMeta(e.id);return t.hasOwnProperty("collapsed")||(t.collapsed=!this.expanded),!t.collapsed}},{key:"getDescendantCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.firstStore,n=this.children;return!n||!Array.isArray(n)||e&&!this.isExpanded(t)?0:n.reduce((function(t,n){return t+n.getDescendantCount(e)}),n.length)}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.children;t||e.call(this,this);for(var r=0,i=n&&n.length;r<i;r++)n[r].traverse(e)}},{key:"traverseBefore",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.children,r=0,i=n&&n.length;r<i;r++)n[r].traverse(e);t||e.call(this,this)}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=!0;return t||(r=!1!==e.call(n,n)),r&&n.isLoaded&&(r=n.children.every((function(t){return t.traverseWhile(e)}))),r}},{key:"bubble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;for(t||e.call(n,n);n.parent;)n=n.parent,e.call(n,n)}},{key:"bubbleWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=!0;for(t||(r=e.call(n,n));r&&n.parent;)n=n.parent,r=e.call(n,n);return r}},{key:"contains",value:function(e){return e&&"object"===U()(e)&&(e=e.id),!this.traverseWhile((function(t){return t.id!=e}))}},{key:"getTopParent",value:function(e){var t;return e?(t=[],this.bubbleWhile((function(e){return t.push(e),e.parent&&!e.parent.isRoot}))):(t=null,this.bubbleWhile((function(e){return e.parent||(t=e),e.parent&&!e.parent.isRoot}))),t}},{key:"appendChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.insertChild(e,null,t)}},{key:"insertChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e){var r=e;e=t,t=this.children[r]}var i=this,o=i.isLeaf,a=Array.isArray(e);if(Array.isArray(e)||(e=[e]),!n&&!i.stores.every((function(t){return!1!==t.trigger("beforeAdd",{records:e,parent:i})})))return null;e=i.ingestChildren(e);var s=t?t.parentIndex:i.children?i.children.length:0,l=i.beforeInsertChild?i.beforeInsertChild(e):void 0,u=i.internalAppendInsert(e,t,n);return o&&u.length&&(i.meta.isLeaf=!1),i.isLeaf===o||i.root.isLoading||n||i.stores.forEach((function(e){var t={isLeaf:{value:!1,oldValue:!0}};e.trigger("update",{record:i,changes:t}),e.trigger("change",{action:"update",record:i,changes:t})})),i.afterInsertChild&&i.afterInsertChild(s,e,l,u),a||!u?u:u[0]}},{key:"internalAppendInsert",value:function(e,t,n){var r,i,o,a,s=this,l=s.stores,u=s.root,c=u.firstStore,d={};if(t&&t.parent!==s&&(t=null),s.children){var h=s.children,f=t?t.parentIndex:h.length;if(h[i=f]===e[0]||h[i=f-1]===e[0])for(r=!0,o=0;r&&o<e.length;o++)e[o]!==h[i+o]&&(r=!1)}if(r)return e;for(o=0;o<e.length;o++){var g=e[o],v=g.parent;if(d[g.id]=g.root===u,c&&g.traverse((function(e){e.root===u&&(d[e.id]=!0)})),v&&!1===v.removeChild(g,d[g.id]))a||(e=e.slice(),a=!0),e.splice(o--,1);else{var m=g.constructor.parentIdField,p=s.isAutoRoot?null:s.id;if(g.parent=s,g.data[m]=p,!s.inProcessChildren&&!s.isLoading){var y={parentId:p},k=g.meta.modified,b=v?v.id:null,w=$()({},m,{value:s.id,oldValue:b});k[m]===s.id?delete k[m]:"parentId"in k||(k[m]=b),g.afterChange(y,w)}}}if(e.length){var S=s.addToChildren(s.children||(s.children=[]),t,e);s.addToChildren(s.unfilteredChildren,t,e,!0),l.forEach((function(t){t.isChained||(e.forEach((function(e){e.instanceMeta(t.id).collapsed=!e.expanded,e.joinStore(t)})),t.onNodeAddChild(s,e,S,d,n))}))}return e}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isLeaf,o=r.children,a=r.stores;if(Array.isArray(e)||(e=[e]),e=e.filter((function(e){return e.parent===r})),!n){var s=!0,l=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;if(!h.isChained&&!1===h.trigger("beforeRemove",{parent:r,records:e,isMove:t}))return!1}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}var f=r.beforeRemoveChild?r.beforeRemoveChild(e,t):void 0,g=!0,v=!1,m=void 0;try{for(var p,y=function(){var e=p.value,i=r.removeFromChildren(o,e);r.removeFromChildren(r.unfilteredChildren,e,!0),a.forEach((function(o){o.isChained||o.onNodeRemoveChild(r,[e],i,t,n)})),e.parent=e.parentIndex=e.unfilteredIndex=e.nextSibling=e.previousSibling=null},k=e[Symbol.iterator]();!(g=(p=k.next()).done);g=!0)y()}catch(e){v=!0,m=e}finally{try{g||null==k.return||k.return()}finally{if(v)throw m}}o.length||!r.constructor.convertEmptyParentToLeaf.onRemove||r.isRoot||(r.meta.isLeaf=!0),r.isLeaf===i||n||r.stores.forEach((function(e){var t={isLeaf:{value:!0,oldValue:!1}};e.trigger("update",{record:r,changes:t}),e.trigger("change",{action:"update",record:r,changes:t})})),r.afterRemoveChild&&r.afterRemoveChild(e,f,t)}},{key:"clearChildren",value:function(){var e=this,t=e.children,n=e.stores;t&&(e.children=[],e.unfilteredChildren&&(e.unfilteredChildren=[]),n.forEach((function(n){n.isChained||n.onNodeRemoveChild(e,t,0)})))}},{key:"clear",value:function(){var e=this,t=e.stores,n=e.children&&e.children.slice();if(e.isRoot&&n){var r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(!l.isChained&&!1===l.trigger("beforeRemove",{parent:e,records:n,isMove:!1,removingAll:!0}))return!1}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}e.children.length=0,t.forEach((function(e){n.forEach((function(t){t.stores.includes(e)&&t.unJoinStore(e),t.parent=t.parentIndex=t.nextSibling=t.previousSibling=null})),e.storage.suspendEvents(),e.storage.clear(),e.storage.resumeEvents(),e.added.clear(),e.modified.clear(),e.trigger("removeAll"),e.trigger("change",{action:"removeall"})}))}}},{key:"updateChildrenIndex",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?"unfilteredIndex":"parentIndex",r=null,i=0;i<e.length;i++){var o=e[i];o[n]=i,t||(o.previousSibling=r,r&&(r.nextSibling=o),i===e.length-1&&(o.nextSibling=null),r=o)}}},{key:"addToChildren",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){var i=r?"unfilteredIndex":"parentIndex",o=t?t[i]:e.length;return e.splice.apply(e,[o,0].concat(G()(n))),this.updateChildrenIndex(e,r),o}}},{key:"removeFromChildren",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var r=n?"unfilteredIndex":"parentIndex",i=t[r];return i>-1&&(e.splice(i,1),this.updateChildrenIndex(e,n)),i}}},{key:"expanded",get:function(){return this.data.expanded}},{key:"childLevel",get:function(){return this.parent?this.parent.childLevel+1:this.isRoot?-1:0}},{key:"isLeaf",get:function(){return!1!==this.meta.isLeaf&&!this.isRoot}},{key:"isParent",get:function(){return!this.isLeaf}},{key:"isLoaded",get:function(){return this.isParent&&Array.isArray(this.children)}},{key:"descendantCount",get:function(){return this.getDescendantCount()}},{key:"visibleDescendantCount",get:function(){return this.getDescendantCount(!0)}},{key:"allChildren",get:function(){var e=this.children;return e?e.reduce((function(e,t){return e.push(t),e.push.apply(e,t.allChildren),e}),[]):[]}},{key:"firstChild",get:function(){var e=this.children;return e&&e.length&&e[0]||null}},{key:"lastChild",get:function(){var e=this.children;return e&&e.length&&e[e.length-1]||null}},{key:"previousSiblingsTotalCount",get:function(){for(var e=this.previousSibling,t=this.parentIndex;e;)t+=e.descendantCount,e=e.previousSibling;return t}},{key:"root",get:function(){return this.parent&&this.parent.root||this}},{key:"parentId",get:function(){return this.parent&&!this.parent.isRoot?this.parent.id:null},set:function(e){var t=this,n=t.parent,r=e&&t.firstStore.getById(e);r!==n&&(n||r)&&(t.isBatchUpdating?t.meta.batchChanges.parentId=e:r?r.appendChild(t):t.parent.removeChild(t))}}],[{key:"convertEmptyParentToLeaf",set:function(e){!0===e?e={onLoad:!0,onRemove:!0}:!1===e&&(e={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=e},get:function(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}},{key:"parentIdField",set:function(e){this._parentIdField=e,Object.defineProperty(this.prototype,e,{set:function(e){this.parentId=e},get:function(){return this.parentId}})},get:function(){return this._parentIdField||"parentId"}}]),t}(e||z)}(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"joinStore",value:function(e){se()(oe()(t.prototype),"joinStore",this)&&se()(oe()(t.prototype),"joinStore",this).call(this,e),this.stm||(this.stm=e.stm)}},{key:"unJoinStore",value:function(e){this.stm===e.stm&&(this.stm=null),se()(oe()(t.prototype),"unJoinStore",this)&&se()(oe()(t.prototype),"unJoinStore",this).call(this,e)}},{key:"beforeSet",value:function(e,n,r,i){var o=this,a=se()(oe()(t.prototype),"beforeSet",this)?se()(oe()(t.prototype),"beforeSet",this).call(this,e,n,r,i):[],s=this.stm;if(s&&!s.disabled){var l,u;if("object"==U()(e)){var c=Object.keys(e).reduce((function(t,n){return t[0][n]=e[n],t[1][n]=o.get(n),t}),[{},{}]),d=fe()(c,2);l=d[0],u=d[1]}else l=$()({},e,n),u=$()({},e,this.get(e));a.push([l,u])}return a}},{key:"afterSet",value:function(e,n,r,i,o,a){var s=this.stm;if(s&&!s.disabled){var l=o.pop();if(a){var u=fe()(l,2),c=u[0],d=u[1],h=Object.keys(a).reduce((function(e,t){return e[0][t]=c[t],e[1][t]=d[t],e}),[{},{}]),f=fe()(h,2),g=f[0],v=f[1];s.onModelUpdate(this,g,v)}}se()(oe()(t.prototype),"afterSet",this)&&se()(oe()(t.prototype),"afterSet",this).call(this,e,n,r,i,o,a)}},{key:"beforeInsertChild",value:function(e){var n=this,r=se()(oe()(t.prototype),"beforeInsertChild",this)?se()(oe()(t.prototype),"beforeInsertChild",this).call(this,e):[],i=this.stm;return i&&!i.disabled&&r.push(e.reduce((function(e,t){return t.root===n.root&&e.set(t,{parent:t.parent,index:t.parent?t.parentIndex:void 0}),e}),new Map)),r}},{key:"afterInsertChild",value:function(e,n,r,i){var o=this.stm;if(o&&!o.disabled){var a=r.pop();i&&o.onModelInsertChild(this,e,i,a)}se()(oe()(t.prototype),"afterInsertChild",this)&&se()(oe()(t.prototype),"afterInsertChild",this).call(this,e,n,r,i)}},{key:"beforeRemoveChild",value:function(e,n){var r=se()(oe()(t.prototype),"beforeRemoveChild",this)?se()(oe()(t.prototype),"beforeRemoveChild",this).call(this,e,n):[],i=this.stm;return!i||i.disabled||n||r.push(e.reduce((function(e,t){return e.set(t,t.parentIndex),e}),new Map)),r}},{key:"afterRemoveChild",value:function(e,n,r){var i=this.stm;if(i&&!i.disabled&&!r){var o=n.pop();e&&e.length&&i.onModelRemoveChild(this,e,o)}se()(oe()(t.prototype),"afterRemoveChild",this)&&se()(oe()(t.prototype),"afterRemoveChild",this).call(this,e,n,r)}},{key:"stm",get:function(){return this[ci]},set:function(e){this[ci]=e}}],[{key:"defaultConfig",get:function(){return{stm:null}}}]),t}(si||z)));mi._idField="id",mi._internalIdCounter=1,mi._assignedIdField=!1,mi.exposeProperties(),mi._$name="Model";var pi=function(e){return{mixes:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce((function(e,t){return t(e)}),e||z)}}},yi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"add",value:function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return 1===r.length&&Array.isArray(r[0])&&(r=r[0]),(e=se()(oe()(t.prototype),"add",this)).call.apply(e,[this].concat(G()(r.filter((function(e){return e.isPersistable})))))}}]),t}(Sr);yi._$name="StoreBag";var ki={add:1,replace:1},bi=function(e,t){return-1!==String(e).toLowerCase().indexOf(t)},wi={string:bi,number:bi,boolean:bi,date:function(e,t){return e instanceof Date&&t instanceof Date?String(e)===String(t):-1!==String(e.getMonth()+1).indexOf(t)||-1!==String(e.getDate()).indexOf(t)||-1!==String(e.getFullYear()).indexOf(t)}},Si=function(){return!0},Ci=n(7),Ei=n.n(Ci),xi=n(16),Di=n.n(xi),Ti=Object.freeze([]),Ri=function(){function e(){C()(this,e)}return x()(e,null,[{key:"preWalk",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o.pop()),(i=t(r))&&o.push.apply(o,i.slice().reverse())}},{key:"preWalkWithParent",value:function(e,t,n){for(var r=[{node:e,parent:null}],i=function(){var e=r.pop(),i=e.parent,o=e.node;n(i,o);var a=t(o);a&&r.push.apply(r,G()(a.slice().reverse().map((function(e){return{node:e,parent:o}}))))};r.length;)i()}},{key:"preWalkUnordered",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o[o.length-1]),(i=t(r))?o.splice.apply(o,[o.length-1,1].concat(G()(i))):o.length=o.length-1}},{key:"postWalk",value:function(e,t,n){for(var r,i,o=new Map,a=[e];a.length;)r=a[a.length-1],o.has(r)?(n(r),a.pop()):((i=t(r))&&(a=a.concat(i.slice().reverse())),o.set(r,r))}},{key:"prePostWalk",value:function(e,t,n,r){for(var i,o,a=new Map,s=[e];s.length;)i=s[s.length-1],a.has(i)?(r(i),s.pop()):(n(i),(o=t(i))&&(s=s.concat(o.slice().reverse())),a.set(i,i))}}]),e}();Ri._$name="WalkHelper";var Mi=Symbol("STM_PROP"),Fi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;Object.assign(n,{added:new yi,removed:new yi,modified:new yi,idRegister:{},internalIdRegister:{}}),se()(oe()(t.prototype),"construct",this).call(this,e),n.initRelations()}},{key:"doDestroy",value:function(){for(var e,n=this,r=n.registeredRecords,i=r.length-1;i>=0;i--)(e=r[i])&&!e.isDestroyed&&e.unJoinStore(n);n.storage.destroy(),delete t.storeMap[n.id],n.stm&&n.stm.removeStore(n),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"beginBatch",value:function(){this.suspendEvents()}},{key:"endBatch",value:function(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}},{key:"onDataChange",value:function(e){var n,r,i=e.source,o=e.action,a=e.added,s=e.removed,l=e.replaced,u=e.oldCount,c=e.item,d=e.from,h=e.to,f=this,g=a&&a.length,v=s&&s.length;if(f._idMap=null,g&&a.forEach((function(e){e.joinStore(f)})),l&&l.forEach((function(e){var t=fe()(e,2),n=t[0],r=t[1];n.unJoinStore(f),r.joinStore(f)})),se()(oe()(t.prototype),"onDataChange",this).apply(this,arguments),!f.isTree){if(g){var m=!0,p=!1,y=void 0;try{for(var k,b=a[Symbol.iterator]();!(m=(k=b.next()).done);m=!0)(n=k.value).joinStore(f)}catch(e){p=!0,y=e}finally{try{m||null==b.return||b.return()}finally{if(p)throw y}}f.added.add(a),f.removed.remove(a),(r=!f.filterParamName&&f.filtered&&f.reapplyFilterOnAdd)&&f.filter({silent:!0})}if(v){var w=!0,S=!1,C=void 0;try{for(var E,x=s[Symbol.iterator]();!(w=(E=x.next()).done);w=!0)(n=E.value).unJoinStore(f),f.added.includes(n)?f.added.remove(n):f.removed.add(n)}catch(e){S=!0,C=e}finally{try{w||null==x.return||x.return()}finally{if(S)throw C}}f.modified.remove(s),(r=!f.filterParamName&&f.filtered)&&f.filter({silent:!0})}}switch(o){case"clear":f.relationCache={},f.updateDependentStores("removeall"),f.trigger("removeAll"),f.trigger("change",{action:"removeall"});break;case"splice":if(g){f.updateDependentStores("add",a);var D=a.reduce((function(e,t){var n=t.meta.previousIndex;return n>-1&&n<e&&(e=n),e}),a[0].meta.previousIndex),T=i.indexOf(a[0],!i.autoFilter),R={records:a,index:T};D>-1&&(R.oldIndex=D),f.trigger("add",R),f.trigger("change",Object.assign({action:"add"},R)),r&&f.triggerFilterEvent({action:"filter",filters:f.filters,oldCount:u,records:f.storage.allValues})}s.length&&(f.updateDependentStores("remove",s),f.trigger("remove",{records:s}),f.trigger("change",{action:"remove",records:s})),l.length&&(f.trigger("replace",{records:l,all:f.records.length===l.length}),f.trigger("change",{action:"replace",replaced:l,all:f.records.length===l.length}));break;case"filter":f.isGrouped?f.group():f.isSorted&&f.performSort();break;case"move":for(var M=f.storage.allValues,F=Math.min(d,h);F<=Math.max(d,h);F++)M[F].parentIndex=F;f.trigger("move",{record:c,from:d,to:h}),f.trigger("change",{action:o,record:c,from:d,to:h})}}},{key:"onModelChange",value:function(e,t,n,r,i){var o=this,a=e.constructor.idField,s={record:e,changes:n,batch:null!=e.batching,fromRelationUpdate:i};if(e.isModified?o.modified.includes(e)||o.added.includes(e)||(o.modified.add(e),o.autoCommit&&o.commit()):o.modified.remove(e),!r){if(a in n){var l=t[a],u=l.oldValue,c=l.value;o.updateDependentRecordIds(u,c),o.onRecordIdChange(e,u,c),o.trigger("idChange",{store:o,record:e,oldValue:u,value:c})}o.onUpdateRecord(e,n),o.trigger("update",s),o.trigger("change",Object.assign({action:"update"},s))}}},{key:"buildRootNode",value:function(){return{}}},{key:"loadData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dataset",n=this,r=n.storage,i=n.allowNoId,o=n.modelClass.fieldMap.id.dataSource;if(n.allCount&&n.clear(!1),n._idMap=null,e){n.storeCollapsedGroups();var a=!(e[0]instanceof mi);if(a){n.modelClass.exposeProperties(e[0]);for(var s=e.length,l=new Array(s),u=0;u<s;u++){var c=e[u];if(!i&&null==c[o])throw new Error("Id required but not found on row ".concat(u));l[u]=n.createRecord(c,!0),l[u].parentIndex=u}r.replaceValues(l,!0,!0)}else r.replaceValues(e.slice(),!0,!0);if(n.storage.allValues.forEach((function(e){e.joinStore(n)})),n.prepareGroupRecords(),n.restoreCollapsedGroups(),!n.filterParamName&&n.isFiltered&&n.filter({silent:!0}),n.isGrouped&&n.group(null,null,!1,!n.sorters.length,!0),!n.sortParamName&&n.sorters.length&&n.sort(null,null,!1,!0),!n.useRawData.disableDuplicateIdCheck){var d=n.idMap;if(Object.keys(d).length<n.storage.values.length){var h=[];throw n.storage.values.forEach((function(e){return d[e.id]?delete d[e.id]:h.push(e)})),new Error("Id collision on ".concat(h.map((function(e){return e.id}))))}}var f={action:t,data:e,records:n.storage.values};n.updateDependentStores(f.action,f.records),n.trigger("refresh",f),n.trigger("change",f)}else n._data=null}},{key:"getRange",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n?this.storage.allValues:this.storage.values).slice(e,t)}},{key:"createRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new this.modelClass(e,this,null,t)}},{key:"refreshData",value:function(){this.filter(),this.sort()}},{key:"onRecordIdChange",value:function(e,t,n){var r=this,i=r._idMap,o=r.idRegister;r.storage._indicesInvalid=!0,i&&(delete i[t],i[n]=e),r.added.changeId(t,n),r.removed.changeId(t,n),r.modified.changeId(t,n),delete o[t],o[n]=e,e.index=r.storage.indexOf(e)}},{key:"onUpdateRecord",value:function(e,t){var n=t.internalId,r=this.internalIdRegister;n&&(this.storage._indicesInvalid=!0,delete r[n.oldValue],r[n.value]=e),this.reapplyFilterOnUpdate&&this.isFiltered&&this.filter()}},{key:"getCount",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.count:this.originalCount}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.storage.getAt(e,t)}},{key:"register",value:function(e){var t=this.isTree&&this.idRegister[e.id];if(t&&t!==e)throw new Error("Id collision on ".concat(e.id));this.idRegister[e.id]=e,this.internalIdRegister[e.internalId]=e}},{key:"unregister",value:function(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}},{key:"getById",value:function(e){return e&&e.isModel?e:this.idRegister[e]}},{key:"isVisible",value:function(e){return this.isAvailable(e)}},{key:"isAvailable",value:function(e){var t=this.getById(e);return t&&this.storage.includes(t)||!1}},{key:"getByInternalId",value:function(e){return this.internalIdRegister[e]}},{key:"includes",value:function(e){return this.isTree?null!=this.idRegister[mi.asId(e)]:this.indexOf(e)>-1}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=mi.asId(e);if(null==n)return-1;if(this.isTree)return this.storage.indexOf(n);var r=this.idMap[n];return r?r[t?"visibleIndex":"index"]:-1}},{key:"allIndexOf",value:function(e){var t=this;if(this.isTree){var n=this.getById(e),r=-1;return n&&n.bubble((function(e){e.parent?r+=e.parentIndex+1:e===t.rootNode&&t.rootVisible&&(r+=1)})),r}return this.storage.indexOf(e,!0)}},{key:"getDistinctValues",value:function(e){var t,n=[],r={};return this.forEach((function(i){i.meta.specialRow||i.isRoot||(t=i.get(e),r[t]||(n.push(t),r[t]=1))})),n}},{key:"getValueCount",value:function(e,t){var n=0;return this.forEach((function(r){kt.isEqual(r.get(e),t)&&n++})),n}},{key:"toJSON",value:function(){return(this.isTree?this.rootNode.children:this).map((function(e){return e.toJSON()}))}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=function(n,r){if(!n.isRoot&&!n.meta.specialRow)return e.call(t,n,r)};if(this.isTree)this.rootNode.traverseWhile(n);else for(var r=this.storage.values,i=0;i<r.length;i++)if(!1===n(r[i],i))return}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return this.storage.values.map(e,t)}},{key:"reduce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return n!==this&&(e=e.bind(n)),this.storage.values.reduce(e,t,n)}},{key:Symbol.iterator,value:function(){return this.storage.values[Symbol.iterator]()}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=this;if(r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){var i=e;e=function(e){r.chainedFilterFn(e)&&i(e)}}t.traverse(e,n)}else{var o=!0,a=!1,s=void 0;try{for(var l,u=r.storage[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c.traverse(e)}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}}}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=this;if(r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){var i=e;e=function(e){r.chainedFilterFn(e)&&i(e)}}t.traverseWhile(e,n)}else{var o=!0,a=!1,s=void 0;try{for(var l,u=r.storage[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(!1===c.traverse(e))break}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}}}},{key:"getNext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(o>=i.length-1){if(!t)return null;o=-1}var a=i[o+1];return n&&a&&a.meta.specialRow?r.getNext(i[o+1],t,!0):a}},{key:"getPrev",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(0===o){if(!t)return null;o=i.length}var a=i[o-1];return n&&a&&a.meta.specialRow?r.getNext(i[o+1],t,!0):a}},{key:"getAdjacent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t?this.getNext(e,n,r):this.getPrev(e,n,r)}},{key:"getNextLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(o>=r.length-1){if(!t)return null;o=-1}return r[o+1]}},{key:"getPrevLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(0===o){if(!t)return null;o=r.length}return r[o-1]}},{key:"getAdjacentLeaf",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?this.getNextLeaf(e,n):this.getPrevLeaf(e,n)}},{key:"makeChained",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return new this.constructor(Object.assign(n||{},{tree:!1,autoTree:!1,masterStore:this,chainedFilterFn:e,chainedFields:t}))}},{key:"chain",value:function(){return this.makeChained.apply(this,arguments)}},{key:"storage",set:function(e){var t=this;e&&e.isCollection?t._storage=e:t._storage=new Un(e),t._storage.autoFilter=t.reapplyFilterOnAdd;var n=!0,r=!1,i=void 0;try{for(var o,a=t._storage[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value.joinStore(t)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t._storage.on({change:"onDataChange",thisObj:t})},get:function(){return this._storage||(this.storage={}),this._storage}},{key:"allRecords",get:function(){var e=this;if(e.isTree){var t=e.collectDescendants(e.rootNode).all;return e.rootVisible&&t.unshift(e.rootNode),t}return e.isGrouped?e.collectGroupRecords():e.storage.allValues}},{key:"idMap",get:function(){var e=this.storage.values,t=!this._idMap,n=this._idMap||(this._idMap={});if(t)for(var r,i=0,o=0;i<e.length;i++)n[(r=e[i]).id]={index:i,visibleIndex:o,record:r},r.meta.specialRow||o++;return n}},{key:"modelClass",get:function(){return this._modelClass},set:function(e){var t=this.fields,n=null;t&&t.length?(n=function(e){function n(){return C()(this,n),re()(this,oe()(n).apply(this,arguments))}return ue()(n,e),x()(n,null,[{key:"fields",get:function(){return t}}]),n}(e)).exposeProperties():n=this.preventSubClassingModel?e:function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),t}(e),n.exposeRelations(),this._modelClass=n}},{key:"storeId",set:function(e){this.id=e},get:function(){return this.id}},{key:"id",set:function(e){this._id&&delete t.storeMap[this._id],this._id=!0===e?Z.generateId("store-"):e,e&&(t.storeMap[e]=this)},get:function(){return this._id}},{key:"tree",get:function(){return this._tree},set:function(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode())}},{key:"rootNode",get:function(){return this.masterStore?this.masterStore.rootNode:this._rootNode},set:function(e){var t=this,n=t._rootNode;e!==n&&(n&&t.clear(!1),e instanceof mi?(e.instanceMeta(t).collapsed=!1,t._rootNode=e):(t._rootNode=e=new t.modelClass(Object.assign($()({expanded:!0},t.modelClass.idField,"".concat(t.id,"-rootNode")),e),t,null,!0),e.isAutoRoot=!0),t._tree=!0,e.isRoot=!0,e.joinStore(t),(e.children&&e.children.length||t.rootVisible)&&(e.isLoading=!0,t.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),t.trigger("rootChange",{oldRoot:n,rootNode:e}))}},{key:"data",set:function(e){var t=this;if(t._thisIsAUsedExpression(t.plugins),t.processConfiguredListeners(),t.tree=!t.isChained&&(t.tree||Boolean(t.autoTree&&e&&e.some((function(e){return e[t.modelClass.childrenField]})))),t.syncDataOnLoad&&t._data)t.syncDataset(e);else{if(t._data=e,t.tree){var n=t.rootNode;n.clearChildren(),n.isLoading=!0,n.appendChild(e),t.updateDependentStores("dataset",[n]),n.isLoading=!1}else t.loadData(e);t.added.clear(),t.removed.clear(),t.modified.clear()}},get:function(){return this._data}},{key:"useRawData",get:function(){return this._useRawData},set:function(e){this._useRawData=!0===e?{enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:e?Object.assign(e,{enabled:!0}):{enabled:!1}}},{key:"originalCount",get:function(){return this.storage.totalCount}},{key:"count",get:function(){return this.storage.count}},{key:"allCount",get:function(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}},{key:"records",get:function(){return this.storage.values}},{key:"first",get:function(){return this.storage.values[0]}},{key:"last",get:function(){return this.storage.values[this.storage.values.length-1]}},{key:"registeredRecords",get:function(){return Object.values(this.idRegister)}},{key:"json",get:function(){return JSON.stringify(this,null,4)}}],[{key:"getStore",value:function(e,n){if(e instanceof t)return e;if(this.storeMap[e])return this.storeMap[e];if(Array.isArray(e)){var r,i=e.map((function(e){return e instanceof mi?r=e.constructor:"string"==typeof e&&(e={text:e}),e}));e={autoCreated:!0,data:i,modelClass:r||function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),t}(mi),allowNoId:!0},n||(n=t)}return n?new n(e):void 0}},{key:"properties",get:function(){return{relationCache:{},dependentStoreConfigs:new Map}}},{key:"defaultConfig",get:function(){return{storeId:null,id:!0,fields:null,autoTree:!0,modelClass:mi,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}},{key:"stores",get:function(){return Object.values(this.storeMap)}}]),t}(pi(z).mixes(ze,li,ui,(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"traverseFilter",value:function(e){var t=this,n=!e.isRoot&&t.filtersFunction(e),r=!1,i=e.unfilteredChildren||e.children;return i&&i.length?(e.unfilteredChildren||(e.unfilteredChildren=e.children.slice()),e.children=e.unfilteredChildren.filter((function(e){return t.traverseFilter(e)})),e.children.length&&(r=!0),n||r):n}},{key:"traverseClearFilter",value:function(e){var t=this;e.children&&(e.children=e.unfilteredChildren||e.children,e.children.forEach((function(e){return t.traverseClearFilter(e)})))}},{key:"processFieldFilter",value:function(e,t){"string"==typeof e&&(e={property:e,value:t}),(e=e instanceof On?e:new On(e)).owner=this,this.filters.add(e)}},{key:"filter",value:function(e){var t=this,n=t.filters,r=!1;if(e){var i=U()(e);if("object"===i&&("silent"in e||"replace"in e)&&(r=e.silent,e.replace&&n.clear(),e=e.filters,i=U()(e)),e&&(t.isConfiguring=!0,Array.isArray(e)?e.forEach(t.processFieldFilter,t):"function"===i?n.add(new On(e)):"string"===i?t.processFieldFilter(e,arguments[1]):t.processFieldFilter(e),t.isConfiguring=!1,!t.isFiltered))return}t.filtersFunction=null,t.performFilter(r)}},{key:"performFilter",value:function(e){var t=this,n=t.storage,r=t.filters,i=t.rootNode,o=t.count;t.tree?(t.isFiltered?t.traverseFilter(i):t.traverseClearFilter(i),n.replaceValues(t.collectDescendants(i).visible,!0)):t.isFiltered?n.addFilter({id:"primary-filter",filterBy:t.filtersFunction}):n.filters.clear(),t.afterPerformFilter(e?null:{action:"filter",filters:r,oldCount:o,records:t.storage.values})}},{key:"afterPerformFilter",value:function(e){this.resetRelationCache(),e&&this.triggerFilterEvent(e)}},{key:"triggerFilterEvent",value:function(e){this.trigger("filter",e),this.filterParamName||(this.trigger("refresh",e),this.trigger("change",e))}},{key:"filterBy",value:function(e){this.filter(e)}},{key:"removeFieldFilter",value:function(e,t){var n=this.filters.getBy("property",e);n&&(this.filters.remove(n),this._filtersFunction=null,t||this.filter())}},{key:"clearFilters",value:function(e){this.filters.clear(),this.filter(void 0,void 0,e)}},{key:"convertFilterToString",value:function(e){var t=this.filters.getBy("property",e),n="";return t&&!t.filterBy&&(n=String(t)),n}},{key:"filters",set:function(e){var t=this,n=t.filters;if(n.clear(),t._filtersFunction=null,e){if("Object"===e.constructor.name)for(var r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];"filterBy"===o[0]&&"function"==typeof o[1]?n.add(new On({filterBy:o[1]})):n.add(new On("Object"===o[1].constructor.name?Object.assign({property:o[0]},o[1]):{property:o[0],value:o[1]}))}else Array.isArray(e)?n.add.apply(n,G()(e.map((function(e){return e instanceof On?e:new On(e)})))):e.isCollection?n.add.apply(n,G()(e.values)):n.add(new On({filterBy:e}));n.forEach((function(e){return e.owner=t}))}},get:function(){return this._filters||(this._filters=new Un({extraKeys:["property"]}))}},{key:"filtersFunction",set:function(e){this._filtersFunction=e},get:function(){var e=this,t=e.filters,n=e.isGrouped;if(!e._filtersFunction)if(t.count){var r=On.generateFiltersFunction(t);e._filtersFunction=function(e){return n&&e.meta.specialRow?e.groupChildren.some(r):r(e)}}else e._filtersFunction=kn.returnTrue;return e._filtersFunction}},{key:"isFiltered",get:function(){return this.filters.values.some((function(e){return!e.disabled}))}},{key:"latestFilterField",get:function(){return this.filters.last?this.filters.last.property:null}},{key:"filtered",get:function(){return this.storage.isFiltered}},{key:"filterState",get:function(){return this.filters.values.map((function(e){return kt.cleanupProperties(e.config)}))}}],[{key:"defaultConfig",get:function(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(arguments.length>2&&arguments[2],this),r=n.storage;if((e=(Array.isArray(e)?e:[e]).reduce((function(e,t){return(t=n.getById(t))&&e.push(t),e}),[])).length){if(n.tree){for(var i=e.reduce((function(e,t){var n=t.parent;return n&&(e[n.id]||(e[n.id]=[n,[]]),e[n.id][1].push(t)),e}),{}),o=0,a=Object.values(i);o<a.length;o++){var s=a[o];s[0].removeChild(s[1],!1,t)}return e}if(n.isGrouped){var l=r.count,u=[],c=new Set,d=!0,h=!1,f=void 0;try{for(var g,v=e[Symbol.iterator]();!(d=(g=v.next()).done);d=!0){var m=g.value,p=m.instanceMeta(n),y=p.groupParent;y&&y.meta.collapsed&&u.push(m),He.remove(y.groupChildren,m),y.meta.childCount--,c.add(y)}}catch(e){h=!0,f=e}finally{try{d||null==v.return||v.return()}finally{if(h)throw f}}var k=!0,b=!1,w=void 0;try{for(var S,C=c[Symbol.iterator]();!(k=(S=C.next()).done);k=!0){var E=S.value;n.onModelChange(E,{},{})}}catch(e){b=!0,w=e}finally{try{k||null==C.return||C.return()}finally{if(b)throw w}}u.length&&r.trigger("change",{action:"splice",removed:u,added:[],replaced:[],oldCount:l})}if(!e.length||!t&&!1===n.trigger("beforeRemove",{records:e}))return null;t&&n.suspendEvents(),r.remove(e),t&&n.resumeEvents(),n.autoCommit&&n.commit()}return e}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.storage;if(t.storage.totalCount){if(e&&!1===t.trigger("beforeRemove",{records:n.allValues,removingAll:!0}))return null;if(!e){for(var r,i=t.registeredRecords,o=i.length-1;o>=0;o--)(r=i[o])&&!r.isDestroyed&&r.unJoinStore(t);t.removed.clear()}e||n.suspendEvents(),n.clear(),e||n.resumeEvents(),t.added.clear(),t.modified.clear()}}},{key:"removeAll",value:function(e){var t=this,n=t.storage;if(e){n.suspendEvents();for(var r,i=t.registeredRecords,o=i.length-1;o>=0;o--)(r=i[o])&&!r.isDestroyed&&r.unJoinStore(t)}t.tree?t.rootNode.clear():t.clear(),e&&n.resumeEvents()}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.storage,i=[];if(Array.isArray(e)){if(!e.length)return}else e=[e];if(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree){var o=new Map,a=[];return e.forEach((function(e){var t=e[n.modelClass.parentIdField];o.has(t)||o.set(t,[]),o.get(t).push(e)})),o.forEach((function(e,r){var i=null==r?n.rootNode:n.getById(r);if(!i)throw new Error("Parent node with id ".concat(r," not found, cannot add children."));a.push.apply(a,G()(i.appendChild(e,t)))})),a}return t||!1!==n.trigger("beforeAdd",{records:e})?(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree?n.rootNode.appendChild(e):(e.forEach((function(e){i.push(e instanceof mi?e:n.createRecord(e))})),t&&n.suspendEvents(),r.add(i),t&&n.resumeEvents(),n.autoCommit&&n.commit(),i)):null}},{key:"insert",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this,s=a.storage,l=[],u=a.getAt(e),c=s.values,d=[];if(Array.isArray(t)||(t=[t]),!1===a.trigger("beforeAdd",{records:t}))return null;if(c[r=e]===t[0]||c[r=e-1]===t[0])for(n=!0,i=0;n&&i<t.length;i++)t[i]!==c[r+i]&&(n=!1);if(!n){if(t.forEach((function(t){var n=t instanceof mi?t:a.createRecord(t),r=s.indexOf(n);n.children&&n.children.length&&a.autoTree&&(a.tree=!0),l.push(n),r>-1&&(r<e&&u&&e--,d.push(r)),n.meta.previousIndex=r})),a.tree){var h=a.rootNode;return h.insertChild(t,h.children&&h.children[e])}return a.suspendEvents(),a.storage.remove(d),a.resumeEvents(),o&&a.suspendEvents(),s.splice.apply(s,[e,0].concat(l)),o&&a.resumeEvents(),a.autoCommit&&a.commit(),l}}},{key:"move",value:function(e,t){this.storage.move(e,t)}},{key:"setMultiple",value:function(e,t,n){var r=this,i=[],o=[];r.forEach((function(r){e(r)&&(o.push(r.set(t,n,!0)),i.push(r))})),r.trigger("updateMultiple",{records:i,all:r.records.length===i.length}),r.trigger("change",{action:"updatemultiple",records:i,all:r.records.length===i.length}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}},{key:"setAll",value:function(e,t){var n=this,r=[];n.forEach((function(n){r.push(n.set(e,t,!0))})),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}},{key:"acceptChanges",value:function(){var e=this;e.added.forEach((function(e){return e.clearChanges(!1)})),e.modified.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.modified.clear(),e.removed.clear()}},{key:"commit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.changes;return this.callPreventable("commit",{changes:n},(function(){return e.acceptChanges(),n}),[],t)}},{key:"clearChanges",value:function(){var e=this;e.remove(e.added.values,!0),e.modified.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.modified.clear(),e.removed.clear(),e.trigger("change",{action:"clearchanges"})}},{key:"applyChangesFromStore",value:function(e){var t=this,n=e.changes;n&&(n.added&&t.add(n.added),n.removed&&t.remove(n.removed.map((function(e){return e.id}))),n.modified&&n.modified.forEach((function(e){t.getById(e.id).set(e.modifications)})))}},{key:"changes",get:function(){var e=this;return e.added.count||e.modified.count||e.removed.count?{added:e.added.values.slice(),modified:e.modified.values.slice(),removed:e.removed.values.slice()}:null}},{key:"autoCommit",get:function(){return this._autoCommit},set:function(e){this._autoCommit=e,e&&this.changes&&this.commit()}}],[{key:"defaultConfig",get:function(){return{autoCommit:!1}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"initRelations",value:function(e){var t=this,n=t.modelClass.relations;e&&t.modelRelations&&t.modelRelations.forEach((function(e){e.storeDetacher&&e.storeDetacher()})),t.modelRelations&&0!==t.modelRelations.length&&!e||!n||(t.modelRelations=[],n&&n.forEach((function(e){var n=Object.assign({},e),r="string"==typeof n.store?t[n.store]:n.store;if(n.dependentStore=t,t.modelRelations.push(n),r){n.storeProperty=n.store,n.store=r;var i=r.dependentStoreConfigs;i.has(t)?i.get(t).push(n):i.set(t,[n]),n.collectionName&&r.initRelationCollection(n,t),r.count>0&&r.updateDependentStores("dataset",r.records)}})))}},{key:"initRelationCollection",value:function(e,t){var n=this,r=e.collectionName;n.collectionStores||(n.collectionStores={}),n.collectionStores[r]={store:t,config:e},n[r+"Store"]||(n[r+"Store"]=t),n.count>0&&n.initModelRelationCollection(r,n.records)}},{key:"initModelRelationCollection",value:function(e,t){var n=this;t.forEach((function(t){t.traverse((function(t){!(e in t)&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n.getCollection(this,e)},set:function(t){return n.setCollection(this,e,t)}})}))}))}},{key:"resetRelationCache",value:function(){this.relationCache={},this.forEach((function(e){return e.initRelations()}))}},{key:"updateRecordRelationCache",value:function(e,t){var n=this;t&&t.forEach((function(t){var r=t.related?t.related.id:e.get(t.config.fieldName);void 0!==r&&n.cacheRelatedRecord(e,r,t.config.relationName,r)}))}},{key:"getCollection",value:function(e,t){var n=this.collectionStores[t],r=n.config,i=n.store;return i.relationCache[r.relationName]&&i.relationCache[r.relationName][e.id]||[]}},{key:"setCollection",value:function(e,t,n){var r=this.collectionStores[t],i=r.config,o=r.store;o.relationCache[i.relationName]||(o.relationCache[i.relationName]={});var a=(o.relationCache[i.relationName][e.id]||[]).slice(),s=[],l=[];o.suspendEvents(),a.forEach((function(e){n.includes(e)||(e[i.fieldName]=null,o.remove(e),l.push(e))})),n.forEach((function(t){if(t instanceof mi)t.stores.includes(o)||(o.add(t),s.push(t));else{var n=o.add(t);t=fe()(n,1)[0],s.push(t)}t[i.fieldName]=e.id})),o.resumeEvents(),l.length&&(o.trigger("remove",{records:l}),o.trigger("change",{action:"remove",records:l})),s.length&&(o.trigger("add",{records:s}),o.trigger("change",{action:"add",records:s}))}},{key:"cacheRelatedRecord",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this,o=i.relationCache[n]||(i.relationCache[n]={});null!==r&&i.uncacheRelatedRecord(e,n,r),null!=t&&He.include(o[t]||(o[t]=[]),e)}},{key:"uncacheRelatedRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this;function i(t,n){var i=r.relationCache[t],o=i&&i[n];if(o){var a=o.indexOf(e);a>=0&&o.splice(a,1),0===o.length&&delete i[n]}}null!=n?i(t,n):e.meta.relationCache&&Object.entries(e.meta.relationCache).forEach((function(e){var t=fe()(e,2),n=t[0],r=t[1];i(n,r&&r.id)}))}},{key:"updateDependentStores",value:function(e,t){var n=this;this.dependentStoreConfigs.forEach((function(r){r.forEach((function(r){var i=r.dependentStore,o=i.relationCache[r.relationName];return"dataset"===e?(r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void i.forEach((function(e){var t=e.initRelation(r);t&&i.cacheRelatedRecord(e,t.id,r.relationName,t.id)}))):"removeall"===e?(i.forEach((function(e){e.removeRelation(r)})),void delete i.relationCache[r.relationName]):("add"===e&&r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void("add"!==e&&"remove"!==e||t.forEach((function(t){var n=o&&o[t.id];switch(e){case"remove":n&&n.forEach((function(e){return e.removeRelation(r)}));break;case"add":i.forEach((function(e){e.get(r.fieldName)==t.id&&(e.initRelation(r),i.cacheRelatedRecord(e,t.id,r.relationName))}))}}))))}))}))}},{key:"updateDependentRecordIds",value:function(e,t){this.dependentStoreConfigs&&this.dependentStoreConfigs.forEach((function(n){n.forEach((function(n){var r=n.dependentStore,i=r.relationCache[n.relationName],o=i&&i[e]&&i[e].slice();o&&o.forEach((function(i){i.set(n.fieldName,t,!1,!0),r.cacheRelatedRecord(i,t,n.relationName,e)}))}))}))}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"sum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t?t.reduce((function(t,n){if(n.meta.specialRow)return t;var r=Number(n[e]);return isNaN(r)?t:t+r}),0):0}},{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){return n[e]<t&&(t=n[e]),t}),t[0][e]):0}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){return n[e]>t&&(t=n[e]),t}),t[0][e]):0}},{key:"average",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;if(!t||!t.length)return 0;var n=0,r=t.reduce((function(t,r){if(r.meta.specialRow)return t;var i=parseFloat(r[e]);return isNaN(i)?t:(n++,t+i)}),0);return r/n}},{key:"groupSum",value:function(e,t){return this.sum(t,this.getGroupRecords(e))}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"search",value:function(e){var t,n,r,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.storage.values,l=s.length,u=[];if(null==e)return null;for("string"==typeof e&&(e=String(e).toLowerCase()),t=0;t<l;t++){n=s[t];var c=!0,d=!1,h=void 0;try{for(var f,g=(a||n.fieldNames)[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var v=f.value;i=(r=n[v])instanceof Date?"date":U()(r),o=wi[i],r&&o&&o(r,e)&&u.push({index:t,data:n,field:v,id:n.id})}}catch(e){d=!0,h=e}finally{try{c||null==g.return||g.return()}finally{if(d)throw h}}}return u}},{key:"findByField",value:function(e,t){var n,r,i,o=this.storage.values,a=o.length,s=[];for(null!=t&&(t=String(t).toLowerCase()),n=0;n<a;n++){r=o[n];var l=(i=r[e])instanceof Date?"date":U()(i),u={date:function(){return Boolean(i)&&i.toLocaleString().includes(t)},string:function(){return Boolean(i)&&i.toLowerCase().includes(t)},number:function(){return"number"==typeof i&&i.toString().includes(t)},object:function(){return i===t},undefined:function(){return i===t}};(null==t&&i===t||t&&u[l]())&&s.push({id:r.id,index:n,data:r})}return s}},{key:"find",value:function(e){return this.storage.values.find(e)}},{key:"findRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(n){return kt.isEqual(n[e],t)};return this.tree?this.query(r)[0]:(n?this.storage.allValues:this.storage.values).find(r)}},{key:"query",value:function(e){if(this.isTree){var t=[];return this.traverse((function(n){e(n)&&t.push(n)})),t}return this.storage.values.filter(e)}},{key:"some",value:function(e){return this.storage.values.some(e)}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"sort",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.allRecords,s=o.sorters?o.sorters.slice():[],l=null;if(e)if(Array.isArray(e))o.sorters=e.map((function(e){return"string"==typeof e?{field:e}:e}));else{var u="object"===U()(e)?e.field:e;if(n=o.sorters.find((function(e){return e.field===u})),null==t){var c=n&&("string"==typeof e&&n.field===e||"object"===U()(e)&&n.field===e.field);t=!c||!n.ascending}var d={field:u,ascending:t};"object"===U()(e)&&(d.fn=e.fn,d.useLocaleSort=e.useLocaleSort),r?n?(l=n.ascending,n.ascending=t):o.sorters.push(d):o.sorters=[d]}return i||!1!==o.trigger("beforeSort",{sorters:o.sorters,records:a,currentSorters:s})?o.performSort(i):(o.sorters=s,void(null!==l&&(n.ascending=l)))}},{key:"addSorter",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.sort(e,t,!0)}},{key:"removeSorter",value:function(e){var t=this.sorters.findIndex((function(t){return t.field==e}));t>-1&&(this.sorters.splice(t,1),this.sort())}},{key:"clearSorters",value:function(){this.sorters.length=0,this.sort()}},{key:"createSorterFn",value:function(e){var t=this.useLocaleSort;return function(n,r){for(var i=0;i<e.length;i++){var o=e[i],a=o.field,s=o.ascending,l=void 0===s||s,u=o.fn,c=void 0===u?null:u,d=o.useLocaleSort,h=void 0===d?t:d,f=l?1:-1;if(c){var g=c(n,r);if(null!==g)return g*f}var v=n[a],m=r[a];if(null==v)return-f;if(null==m)return f;if(h){if(!0===h)return String(v).localeCompare(m)*f;if("string"==typeof h)return String(v).localeCompare(m,h)*f;if("object"===U()(h))return String(v).localeCompare(m,h.locale,h)*f}if(v>m)return f;if(v<m)return-f}return 0}}},{key:"performSort",value:function(e){var t=this,n=t.rootNode,r=t.storage,i=t.sorters,o=t.createSorterFn(t.isGrouped?t.groupers.concat(i):i);t.isGrouped&&t.storeCollapsedGroups()&&r.replaceValues(t.removeHeadersAndFooters(r.values),!0),t.tree?(n.traverse((function(e){e.isLoaded&&e.isParent&&(e.children=e.children.sort(o),e.updateChildrenIndex(e.children))})),r.replaceValues(t.collectDescendants(n).visible,!0)):r.replaceValues(r.values.sort(o),!0),t.afterPerformSort(e)}},{key:"afterPerformSort",value:function(e){var t=this,n=t.storage;if(t._idMap=null,t.isGrouped&&(n.replaceValues(t.prepareGroupRecords(n.values),!0),t.restoreCollapsedGroups()),!e){var r={action:"sort",sorters:t.sorters,records:t.allRecords};t.trigger("sort",r),t.sortParamName||t.trigger("refresh",r)}}},{key:"isSorted",get:function(){return Boolean(this.sorters.length)||this.isGrouped}}],[{key:"defaultConfig",get:function(){return{sorters:[],useLocaleSort:null}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),this.on("change",this.onDataChanged)}},{key:"storeCollapsedGroups",value:function(){var e=this;return e.collapsedGroupsHash={},!(!e.groupRecords||!e.groupRecords.length)&&(e.groupRecords.forEach((function(t){e.expand(t)&&(e.collapsedGroupsHash[t.id]=!0)})),!0)}},{key:"restoreCollapsedGroups",value:function(){var e=this;Object.keys(e.collapsedGroupsHash).forEach((function(t){return e.collapse(e.getById(t))}))}},{key:"onDataChange",value:function(e){var n=e.source,r=e.action,i=e.removed,o=this,a=o.groupers;if(a){var s=n.values;a.length?"splice"===r&&i&&i.length&&(o.storeCollapsedGroups()&&o.storage.replaceValues(o.removeHeadersAndFooters(s),!0),o.storage.replaceValues(o.prepareGroupRecords(s),!0),o.restoreCollapsedGroups()):n.replaceValues(o.removeHeadersAndFooters(s),!0)}se()(oe()(t.prototype),"onDataChange",this)&&se()(oe()(t.prototype),"onDataChange",this).apply(this,arguments)}},{key:"collapse",value:function(e){return!(!e||e.meta.collapsed)&&(this.excludeGroupRecords(e),e.meta.collapsed=!0,!0)}},{key:"expand",value:function(e){return!(!e||!e.meta.collapsed)&&(this.includeGroupRecords(e),e.meta.collapsed=!1,!0)}},{key:"removeHeadersAndFooters",value:function(e){var t=this;return e.filter((function(e){return!e.meta.specialRow||(t.unregister(e),!1)}),!0)}},{key:"prepareGroupRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.registeredRecords,t=this;if(e=t.removeHeadersAndFooters(e),!t.isGrouped)return e;var n=[],r=t.groupers[0].field,i=[],o=null,a=null,s=0;function l(){var e=a.meta.groupRowFor,r="group-footer-".concat("number"==typeof e?e:A.createId(e)),o=t.getById(r)||new t.modelClass({id:r},t,{specialRow:!0,groupFooterFor:e,groupRecord:a});return t.register(o),o.groupChildren=a.groupChildren,i.push(o),n.push(o),t.allRecords.push(o),a.groupChildren.push(o),s++,o}return e.forEach((function(e){var u=e[r],c="group-header-".concat("number"==typeof u?u:A.createId(u));!e.groupChildren||e.groupChildren.length?(kt.isEqual(u,o)||(a&&(t.useGroupFooters&&l(),a.meta.childCount=s),a=t.getById(c)||new t.modelClass({id:c},t,{specialRow:!0,groupRowFor:u,groupField:r}),t.register(a),a.groupChildren=[],n.push(a),t.allRecords.push(a),i.push(a),o=u,s=0),e.instanceMeta(t.id).groupParent=a,n.push(e),a.groupChildren.push(e),s++):t.unregister(e)})),a&&(a.meta.childCount=s,t.useGroupFooters&&l()),t.groupRecords=i,n}},{key:"group",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this;if(r?a.groupers.push(n={field:e,ascending:t,complexMapping:e.includes(".")}):e&&(null==t&&(t=!a.groupInfo||a.groupInfo.field!==e||!a.groupInfo.ascending),a.groupInfo=n={field:e,ascending:t,complexMapping:e.includes(".")},a.groupers=[a.groupInfo]),n){var s=a.modelClass.prototype;n.complexMapping&&!s.hasOwnProperty(e)&&Object.defineProperty(s,e,{get:function(){return kt.getPath(this,e)}})}!1!==i&&a.sort(null,null,!1,!0),o||(a.trigger("group",{isGrouped:a.isGrouped,groupers:a.groupers,records:a.storage.values}),a.trigger("refresh",{action:"group",isGrouped:a.isGrouped,groupers:a.groupers,records:a.storage.values}))}},{key:"addGrouper",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.group(e,t,!0)}},{key:"removeGrouper",value:function(e){var t=this.groupers.findIndex((function(t){return t.field===e}));t>-1&&(this.groupers.splice(t,1),this.group())}},{key:"clearGroupers",value:function(){this.groupers=null}},{key:"isRecordInGroup",value:function(e,t){if(!this.isGrouped)return null;return e[this.groupers[0]&&this.groupers[0].field]===t&&!e.meta.specialRow}},{key:"isInCollapsedGroup",value:function(e){var t=e.instanceMeta(this).groupParent;return t&&t.meta.collapsed}},{key:"getGroupRecords",value:function(e){var t=this;return t.isGrouped?t.storage.values.filter((function(n){return t.isRecordInGroup(n,e)})):null}},{key:"getGroupTitles",value:function(){return this.isGrouped?this.getDistinctValues(this.groupers[0]&&this.groupers[0].field):null}},{key:"onDataChanged",value:function(e){this.isGrouped&&(!e.changes&&ki[e.action]||e.changes&&this.groupers.some((function(t){return t.field in e.changes})))&&this.sort()}},{key:"internalIncludeExcludeGroupRecords",value:function(e,t){var n=this,r=n.indexOf(e),i=n.id;if(-1!==r&&!(e.meta.collapsed&&!t||!e.meta.collapsed&&t)){if(e.groupChildren.forEach((function(e){return e.instanceMeta(i).hiddenByCollapse=!t})),t){var o,a=e.groupChildren.filter((function(e){return!n.isAvailable(e)}));(o=n.storage.values).splice.apply(o,[r+1,0].concat(G()(a)))}else n.storage.values.splice(r+1,e.groupChildren.length);n.storage._indicesInvalid=!0,n._idMap=null}}},{key:"excludeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!1)}},{key:"includeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!0)}},{key:"collectGroupRecords",value:function(){return this.records.reduce((function(e,t){return t.meta.specialRow&&(e.push(t),"groupRowFor"in t.meta&&e.push.apply(e,t.groupChildren)),e}),[])}},{key:"groupers",get:function(){return this._groupers},set:function(e){var t=this;e&&e.length?t._groupers=e:t.groupers&&(delete t._groupers,t.groupRecords.forEach((function(e){e.meta.collapsed&&t.includeGroupRecords(e)})),t.storage.replaceValues(t.removeHeadersAndFooters(t.registeredRecords),!0),t.group(null,null,null,!1),"groupRecords"in t&&delete t.groupRecords)}},{key:"isGrouped",get:function(){return Boolean(this.groupers&&this.groupers.length)}}],[{key:"defaultConfig",get:function(){return{groupers:null}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.masterStore&&(n.methodNamesToRelay.forEach((function(e){return n[e]=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.relayToMaster(e,r)}})),n.masterStore.on({change:n.onMasterDataChanged,prio:1,thisObj:n}),n.masterStore.chainedStores||(n.masterStore.chainedStores=[]),n.masterStore.chainedStores.push(n),n.fillFromMaster())}},{key:"updateChainedStores",value:function(){this.chainedStores&&this.chainedStores.forEach((function(e){return e.fillFromMaster()}))}},{key:"fillFromMaster",value:function(){var e=this,t=e.masterStore;if(!e.isChained)throw new Error("fillFromMaster only allowed on chained store");if(e.keepUncommittedChanges){if(e.isTree)throw new Error("Cannot use keepUncommittedChanges on a chained tree store");e.data=[].concat(e.added.values.filter((function(t){return!e.removed.includes(t)})),t.allRecords.filter((function(t){return!e.removed.includes(t)&&!e.added.includes(t)&&e.chainedFilterFn(t)})))}else t.isTree?(e.idRegister={},e.internalIdRegister={},t.allRecords.filter(e.chainedFilterFn).forEach((function(t){t.stores.includes(e)?e.register(t):t.joinStore(e)})),e.data=e.doIncludeExclude(e.getChildren(e.masterStore.rootNode),!0)):e.data=t.allRecords.filter(e.chainedFilterFn)}},{key:"commitToMaster",value:function(){var e=this,t=e.masterStore;if(!e.isChained)throw new Error("commitToMaster only allowed on chained store");return t.beginBatch(),t.remove(e.removed.values),t.add(e.added.values),t.endBatch(),e.commit()}},{key:"relayToMaster",value:function(e,t){var n;if("remove"!==e||4!==t.length||!0!==t[3])return(n=this.masterStore)[e].apply(n,G()(t))}},{key:"onMasterDataChanged",value:function(e){var t=e.action,n=e.changes;if("update"===t&&!(this.chainedFields&&this.chainedFields.some((function(e){return e in n}))))return;this.fillFromMaster()}},{key:"isChained",get:function(){return Boolean(this.masterStore)}},{key:"chainedFilterFn",set:function(e){this._chainedFilterFn=this.thisObj?e.bind(this.thisObj):e},get:function(){return this._chainedFilterFn||Si}},{key:"methodNamesToRelay",get:function(){var e=this,t=Array.isArray(this.doRelayToMaster),n=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter((function(t){return!n||!e.dontRelayToMaster.includes(t)}))||[]}}],[{key:"defaultConfig",get:function(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert","removeAll"],dontRelayToMaster:[],keepUncommittedChanges:!1}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getState",value:function(){var e=this,t={};return e.sorters&&e.sorters.length&&(t.sorters=e.sorters.slice()),e.groupers&&e.groupers.length&&(t.groupers=e.groupers.slice()),e.filters&&e.filters.values.length&&(t.filters=e.filterState),t}},{key:"applyState",value:function(e){var t=this;"sorters"in e&&(t.sorters=e.sorters.slice()),"groupers"in e&&(t.groupers=e.groupers.slice()),("sorters"in e||"groupers"in e)&&t.sort(),"filters"in e&&(t.filters=e.filters.slice(),t.filter())}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r;return ue()(t,e),x()(t,[{key:"loadChildren",value:(r=Di()(Ei.a.mark((function e(t){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"onNodeAddChild",value:function(e,t,n,r){var i,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this,s=e===a.rootNode&&e.isLoading,l=a.storage,u=[],c=[],d=t[0].previousSibling;if(a.collectDescendants(t,u,c,!(e.isExpanded(a)&&e.ancestorsExpanded(a))),!s&&c.length){var h=!0,f=!1,g=void 0;try{for(var v,m=c[Symbol.iterator]();!(h=(v=m.next()).done);h=!0){var p=v.value;a.modified.includes(p)||r[p.id]||(a.added.add(p),a.removed.remove(p))}}catch(e){f=!0,g=e}finally{try{h||null==m.return||m.return()}finally{if(f)throw g}}}if(s&&a.rootVisible&&(u.unshift(e),c.unshift(e)),u.length&&(i=0!==n&&d?l.indexOf(d)+d.getDescendantCount(!0,a):l.indexOf(e),l.suspendEvents(),a.storage.splice(++i,0,u),l.resumeEvents()),a.updateDependentStores("add",t),s&&u.length){if(a.sorters.length&&a.sort(null,null,!1,!0),!o){var y={action:"dataset",data:a._data,records:u};a.trigger("refresh",y),a.trigger("change",y)}}else if(!o){var k={action:"add",parent:e,isChild:!0,isMove:r,records:t,allRecords:c,index:i};a.trigger("add",k),a.trigger("change",k)}}},{key:"onNodeRemoveChild",value:function(e,t,n,r,i){var o=this,a=o.storage,s=[],l=[];if(o.collectDescendants(t,s,l,!(e.isExpanded(o)&&e.ancestorsExpanded(o))),!r){var u=!0,c=!1,d=void 0;try{for(var h,f=t[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){h.value.unJoinStore(o)}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}if(l.length){var g=!0,v=!1,m=void 0;try{for(var p,y=l[Symbol.iterator]();!(g=(p=y.next()).done);g=!0){var k=p.value;k.stores.includes(o)&&k.unJoinStore(o),o.added.includes(k)?o.added.remove(k):o.removed.add(k)}}catch(e){v=!0,m=e}finally{try{g||null==y.return||y.return()}finally{if(v)throw m}}o.modified.remove(l)}}if(s.length?(n=a.indexOf(s[0]))>-1&&(a.suspendEvents(),a.splice(n,s.length),a.resumeEvents()):n=-1,!i){var b={action:"remove",parent:e,isChild:!0,isMove:r,records:t,allRecords:l,index:n};o.trigger("remove",b),o.trigger("change",b)}}},{key:"collectDescendants",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=Array.isArray(e)?e:i.getChildren(e);if(o)for(var a,s=0,l=o.length;s<l;s++)a=o[s],r||t.push(a),n.push(a),i.collectDescendants(a,t,n,r||!a.isExpanded(i));return{visible:t,all:n}}},{key:"getChildren",value:function(e){return e.children&&e.children.length?this.isChained?e.children.filter(this.chainedFilterFn):e.children:Ti}},{key:"internalToggleTreeSubRecords",value:function(e,t){var n=this,r=n.storage,i=r.indexOf(e),o=n.doIncludeExclude(n.getChildren(e),t);if(o.length&&!1!==i){if(r.suspendEvents(),t){r.splice.apply(r,[i+1,0].concat(G()(o)));var a={action:"add",isExpand:!0,records:o,index:i+1};n.trigger("add",a),n.trigger("change",a)}else{r.splice(i+1,o.length);var s={action:"remove",isCollapse:!0,records:o,index:i+1};n.trigger("remove",s),n.trigger("change",s)}r.resumeEvents()}}},{key:"doIncludeExclude",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this,i=e&&e.length,o=0;o<i;o++){var a=e[o];if(!r.isChained||r.chainedFilterFn(a)){var s=a.instanceMeta(r.id);t?n.push(a):s.hidden||n.push(a),s.hidden=!t,a.isExpanded(r)&&r.doIncludeExclude(r.getChildren(a),t,n)}}return n}},{key:"toggleCollapse",value:(n=Di()(Ei.a.mark((function e(t,n){var r,i,o,a;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this).getById(t),o=i.instanceMeta(r),void 0===n&&(n=!o.collapsed),o.isLoadingChildren||i.isLeaf||i.isExpanded(r)!==n){e.next=28;break}if(r.trigger("beforeToggleNode",{record:i,collapse:n}),o.collapsed=n,!o.collapsed){e.next=10;break}return r.onNodeCollapse(i),e.abrupt("return",!0);case 10:if(r.onNodeExpand(i),a=!0,i.isLoaded){e.next=27;break}return o.isLoadingChildren=!0,e.prev=14,e.next=17,r.loadChildren(i);case 17:e.next=24;break;case 19:e.prev=19,e.t0=e.catch(14),o.collapsed=!0,a=!1,r.trigger("loadChildrenException",{record:i,exception:e.t0});case 24:return e.prev=24,o.isLoadingChildren=!1,e.finish(24);case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this,[[14,19,24,27]])}))),function(e,t){return n.apply(this,arguments)})},{key:"onNodeCollapse",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!1)}},{key:"onNodeExpand",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!0)}},{key:"isTree",get:function(){return this.tree||this.masterStore&&this.masterStore.tree}},{key:"leaves",get:function(){var e=[];return this.isTree?(this.traverse((function(t){t.isLeaf&&e.push(t)})),e):(this.allRecords.forEach((function(t){t.isLeaf&&e.push(t),t.traverse((function(t){t.isLeaf&&e.push(t)}),!0)})),e)}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"add",value:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.stm;return this.tree||!i||i.disabled?n=se()(oe()(t.prototype),"add",this).call(this,e,r):(n=se()(oe()(t.prototype),"add",this).call(this,e,r))&&n.length&&i.onStoreModelAdd(this,n,r),n}},{key:"insert",value:function(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.stm;if(this.tree||!a||a.disabled)r=se()(oe()(t.prototype),"insert",this).call(this,e,n,o);else{var s=(Array.isArray(n)?n:[n]).reduce((function(e,t){var n=t instanceof mi?i.indexOf(t):void 0;return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);(r=se()(oe()(t.prototype),"insert",this).call(this,e,n))&&r.length&&(e=this.indexOf(r[0]),a.onStoreModelInsert(this,e,r,s,o))}return r}},{key:"remove",value:function(e){var n,r=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,a=this.stm;if(this.tree||!a||a.disabled)n=se()(oe()(t.prototype),"remove",this).call(this,e,i,o);else{var s=(Array.isArray(e)?e:[e]).map((function(e){return r.getById(e)})).filter((function(e){return!!e})),l=s.reduce((function(e,t){var n=r.indexOf(t);return void 0!==n&&-1!=n&&e.set(t,n),e}),new Map);(n=se()(oe()(t.prototype),"remove",this).call(this,e,i,o))&&n.length&&a.onStoreModelRemove(this,n,l,i)}return n}},{key:"removeAll",value:function(e){var n=this.stm;if(n&&!n.disabled){var r=this.tree,i=this.rootNode,o=this.allRecords,a=o.length,s=r?i.children.slice():o.slice();se()(oe()(t.prototype),"removeAll",this).call(this,e),a&&0===this.count&&n.onStoreRemoveAll(this,s,e)}else se()(oe()(t.prototype),"removeAll",this).call(this,e)}},{key:"stm",get:function(){return this[Mi]},set:function(e){var t=this;t.stm!=e&&(t.stm&&t.stm.hasStore(t)&&t.stm.removeStore(t),t[Mi]=e,t.stm&&!t.stm.hasStore(t)&&t.stm.addStore(t))}}],[{key:"defaultConfig",get:function(){return{stm:null}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"syncDataset",value:function(e){var t=this,n=t.storage,r=t.tree?t.syncTreeDataset(e):t.syncFlatDataset(e),i=r.toAdd,o=r.toRemove,a=r.updated,s=t.syncDataOnLoad.threshold,l=!1;if(s&&("string"==typeof s&&(s=parseInt(s,10)/100*t.count),l=i.length+o.length+a.length>s),t.tree){if(i.length)t.add(i,l).forEach((function(e){delete e.data.parentId,delete e.originalData.parentId,e.meta.modified&&delete e.meta.modified.parentId}));t.remove(o,l)}else l&&n.suspendEvents(),n.splice(t.count-o.length,o,i),l&&n.resumeEvents();s&&!l&&a.forEach((function(e){var n=e.record,r=e.toSet,i=e.wasSet;return t.onModelChange(n,r,i)})),t.acceptChanges();var u={added:i,removed:o,updated:a,thresholdSurpassed:l};l&&this.trigger("refresh",{action:"batch",data:e,records:n.values,syncInfo:u}),t.isFiltered&&t.filter(),t.isGrouped?t.group():t.isSorted&&t.sort(),t.trigger("loadSync",u)}},{key:"syncFlatDataset",value:function(e){if(e){var t=this,n=t.modelClass.idField,r=[],i=[],o=[],a={},s=t.syncDataOnLoad.threshold,l=0;return e.forEach((function(e){var r=e[n],u=t.getById(r);if(u){var c=u.set(e,null,Boolean(s));c&&o.push({record:u,wasSet:c,toSet:e}),l++}else i.push(t.createRecord(e));a[r]=1})),l<t.allCount&&t.forEach((function(e){a[e.id]||r.push(e)})),{toAdd:i,toRemove:r,updated:o}}}},{key:"syncTreeDataset",value:function(e){if(e){var t=this,n=t.modelClass,r=n.idField,i=n.parentIdField,o=[],a=[],s=[],l={},u=t.syncDataOnLoad.threshold;return Ri.preWalkWithParent({isRoot:!0,children:e},(function(e){return e.children}),(function(e,n){if(e){var o=n[r],c=t.getById(o);if(c){var d=c.set(n,null,Boolean(u));d&&s.push({record:c,wasSet:d,toSet:n})}else n[i]=e[r],a.push(n);l[o]=1}})),t.traverse((function(e){l[e.id]||o.push(e)})),{toAdd:a,toRemove:o,updated:s}}}}],[{key:"defaultConfig",get:function(){return{syncDataOnLoad:null}}}]),t}(e||z)})));Fi.storeMap={},Fi._$name="Store";var _i=function(e,t){return Array.isArray(t[1])?t[1].forEach((function(n){return e.push(t[0]+"="+n)})):e.push(t[0]+"="+t[1]),e},Ai=new Promise((function(e){return e()})),Ii=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i,o;return ue()(t,e),x()(t,[{key:"afterConstruct",value:function(e){se()(oe()(t.prototype),"afterConstruct",this).call(this,e),this.autoLoad&&this.load().catch((function(){}))}},{key:"buildQueryString",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Object.entries(Object.assign.apply(Object,[{}].concat(t))).reduce(_i,[]).join("&");return r?"?"+r:""}},{key:"performSort",value:function(e){var n=this;if(n.sortParamName){var r=n.groupRecords,i={};return n.isGrouped&&r&&r.length&&r.forEach((function(e){e.meta.collapsed&&(n.includeGroupRecords(e),i[e.id]=!0)})),n.internalLoad({},"",(function(t){n.data=t.data,n.afterPerformSort(e,i)}))}se()(oe()(t.prototype),"performSort",this).call(this,e)}},{key:"performFilter",value:function(e){var n=this;if(n.filterParamName){var r=n.count,i=n.filters;return n.currentPage=1,n.internalLoad({},"",(function(t){n.data=t.data,n.afterPerformFilter(e?null:{action:"filter",filters:i,oldCount:r,records:n.storage.values})}))}se()(oe()(t.prototype),"performFilter",this).call(this)}},{key:"encodeFilterParams",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.property,u=s.operator,c=s.value,d=s.caseSensitive;t.push({field:l,operator:u,value:c,caseSensitive:d})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return JSON.stringify(t)}},{key:"encodeSorterParams",value:function(e){return JSON.stringify(e.map((function(e){return e})))}},{key:"internalLoad",value:function(e,t,n){var r=this,i=Object.assign({},r.params,e),o={action:"read"+t,params:i};return r.readUrl?new Promise((function(e,a){if(!1===r.trigger("beforeLoad"+t,o))return a(!1);if(r._isLoading=!0,r.trigger("load".concat(t,"Start"),o),r.trigger("beforeRequest",o),r.filterParamName&&r.isFiltered&&(i[r.filterParamName]=r.encodeFilterParams(r.filters.values)),r.sortParamName&&r.isSorted&&(i[r.sortParamName]=r.encodeSorterParams(r.groupers?r.groupers.concat(r.sorters):r.sorters)),r.isPaged){if(!i[r.pageParamName]&&!i[r.pageStartParamName]){var s=Math.min(r.currentPage||1,r.allCount?r.lastPage:1/0);r.pageParamName?i[r.pageParamName]=s:i[r.pageStartParamName]=(s-1)*r.pageSize}i[r.pageSizeParamName]=r.pageSize}Pe.get(r.readUrl+r.buildQueryString(i),Object.assign({headers:r.headers,parseJson:!0},r.fetchOptions)).then((function(s){var l=s.parsedJson,u=Array.isArray(l),c=u||l&&!1!==l.success;if(r._isLoading=!1,o.response=s,o.json=l,c){if(r.responseTotalProperty in l&&(r.remoteTotal=parseInt(l[r.responseTotalProperty],10)),r.isPaged){if(!(r.remoteTotal>=0))throw new Error("A paged store must receive its responseTotalProperty in each data packet");var d=r.pageParamName?i[r.pageParamName]:i[r.pageStartParamName]/r.pageSize+1;r.currentPage=Math.min(d,r.lastPage)}o.data=u?l:l[r.responseDataProperty],n(o),r.trigger("load"+t,o),e(o)}else o.exception=!0,o.exceptionType="server",r.trigger("exception",o),a(o);r.trigger("afterRequest",o)})).catch((function(e){r._isLoading=!1,o.exception=!0,e instanceof Response?(o.exceptionType=e.ok?"server":"network",o.response=e,o.error=e.error):(o.exceptionType="server",o.error=e),r.trigger("exception",o),a(o),r.trigger("afterRequest",o)}))})):null}},{key:"load",value:function(e){var t=this;return t.isPaged?t.loadPage((t.currentPage||0)+1,e):t.internalLoad(e,"",(function(e){t.data=e.data}))}},{key:"loadChildren",value:(o=Di()(Ei.a.mark((function e(t){var n;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.abrupt("return",n.internalLoad($()({},n.parentIdParamName,t.id),"Children",(function(e){e.parentRecord=t,t.data[t.constructor.childrenField]=e.data,t.processChildren(t.stores)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"loadPage",value:(i=Di()(Ei.a.mark((function e(t,n){var r,i;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.allCount&&(t=Math.min(t,this.lastPage)),(i=(r=this).pageParamName?$()({},r.pageParamName,t):$()({},r.pageStartParamName,(t-1)*r.pageSize))[r.pageSizeParamName]=r.pageSize,e.abrupt("return",r.internalLoad(Object.assign(i,n),"Page",(function(e){r.loadData(e.data,"pageLoad")})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"nextPage",value:(r=Di()(Ei.a.mark((function e(t){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&this.currentPage!==this.lastPage?this.loadPage(this.currentPage+1,t):Ai);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"previousPage",value:(n=Di()(Ei.a.mark((function e(t){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&1!==this.currentPage?this.loadPage(this.currentPage-1,t):Ai);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"commit",value:function(){var e=this,t=e.changes,n=[];if(e.commitPromise)return!1;if(!t)return Ai;if([].concat(G()(t.added),G()(t.modified),G()(t.removed)).forEach((function(e){return e.meta.committing=!0})),!e.disabled&&!1!==e.trigger("beforeCommit",{changes:t})){var r={action:"commit",exception:!1,changes:t},i=e.commitRemoved(r);return i&&n.push(i),(i=e.commitAdded(r))&&n.push(i),(i=e.commitModified(r))&&n.push(i),n.length?(i=1===n.length?n[0]:Promise.all(n),e.commitPromise=new Promise((function(n,o){i.then((function(){e.commitPromise=null,r.exception?(e.trigger("exception",r),o(r)):(e.trigger("commit",{changes:t}),n(r))})).catch((function(){e.commitPromise=null,o(r)}))}))):(e.modified.forEach((function(e){return e.clearChanges(!1)})),e.modified.clear(),e.added.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.removed.clear(),e.trigger("commit",{changes:t}),Ai)}}},{key:"commitAdded",value:function(e){var t=this,n=t.added,r={action:"create",params:t.params};return n.count&&t.createUrl?new Promise((function(i){var o=n.values.map((function(e){return e.persistableData}));e.create=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}Pe.post(t.createUrl+t.buildQueryString(t.params),a,Object.assign({headers:t.headers,parseJson:!0},t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),l=s||a&&!1!==a.success;r.json=a,r.response=o,l?(t.processReturnedData(n.values,s?a:a[t.responseDataProperty]),n.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"commitModified",value:function(e){var t=this,n=t.modified,r={action:"update",params:t.params};return n.count&&t.updateUrl?new Promise((function(i){var o=n.map((function(e){return t.writeAllFields?e.persistableData:e.modificationData}));e.update=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}Pe.post(t.updateUrl+t.buildQueryString(t.params),a,Object.assign({headers:t.headers,parseJson:!0},t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),l=s||a&&!1!==a.success;r.json=a,r.response=o,l?(t.processReturnedData(t.modified.values,s?a:a[t.responseDataProperty],!0),n.clear(),t.trigger("commitModified"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"processReturnedData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.modelClass,o=i.fieldMap.id.dataSource;t.forEach((function(t,r){var a=e[r];a.clearChanges(!1),a.syncId(t[o]),Object.assign(e[r].data,i.processData(t,n))}))}},{key:"commitRemoved",value:function(e){var t=this,n=t.removed,r={action:"delete",params:t.params};return n.count&&t.deleteUrl?new Promise((function(i){e.delete=r;var o=r.body={ids:n.map((function(e){return e.id}))};if(t.trigger("beforeRequest",r),t.sendAsFormData){var a=new FormData;a.append("id",JSON.stringify(o.ids)),o=a}Pe.post(t.deleteUrl+t.buildQueryString(t.params),o,Object.assign({headers:t.headers,parseJson:!0},t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a)||a&&!1!==a.success;r.json=a,r.response=o,s?(n.forEach((function(e){return e.meta.committing=!1})),n.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"isLoading",get:function(){return this._isLoading}},{key:"isCommitting",get:function(){return Boolean(this.commitPromise)}},{key:"pageParamName",set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e},get:function(){return this._pageParamName}},{key:"pageStartParamName",set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e},get:function(){return this._pageStartParamName}},{key:"isPaged",get:function(){return this.pageParamName||this.pageStartParamName}},{key:"allCount",get:function(){return"remoteTotal"in this?this.remoteTotal:se()(oe()(t.prototype),"allCount",this)}},{key:"lastPage",get:function(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}}],[{key:"defaultConfig",get:function(){return{headers:null,fetchOptions:null,sendAsFormData:!1,writeAllFields:!1,parentIdParamName:"id",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50}}}]),t}(Fi);function Li(){var e=Lr()(['<input type="','"\n            reference="input"\n            class="','"\n            name="','"\n            id="','"\n            ',"\n            ","/>"]);return Li=function(){return e},e}Ii._$name="AjaxStore";var Oi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"inputTemplate",value:function(){var e=this,t="inputWidth"in e?'style="width:'.concat(rn.setLength(e.inputWidth),'"'):"";return Hr.tpl(Li(),e.inputType||"text",e.inputCls||"",e.name||e.id,e.id+"_input",t,e.attributeString)}},{key:"value",set:function(e){fn()(oe()(t.prototype),"value","TextField"===this.$name&&null==e?"":e,this,!0)},get:function(){return se()(oe()(t.prototype),"value",this)}},{key:"placeholder",set:function(e){this._placeholder=e,this.input&&(this.input.placeholder=e)},get:function(){return this._placeholder}}],[{key:"defaultConfig",get:function(){return{attributes:["placeholder","autoComplete","minLength","maxLength","tabIndex"],localizableProperties:["label","title","placeholder"]}}},{key:"$name",get:function(){return"TextField"}}]),t}(ri);Oi._$name="TextField",X.register("textfield",Oi),X.register("text",Oi);var Pi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.globalTapListener&&this.globalTapListener(),this.picker=null,se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"finalizeInit",value:function(){se()(oe()(t.prototype),"finalizeInit",this).call(this);var e=this,n=e.element;!1===e.editable?(n.classList.add("b-not-editable"),Ln.on({element:e.input,click:"onTriggerClick",thisObj:e})):e.globalTapListener=ir.on({globaltap:"showKeyboard",thisObj:e})}},{key:"createPicker",value:function(){throw new Error("createPicker must be implemented in PickerField subclass implementations")}},{key:"onEditComplete",value:function(){se()(oe()(t.prototype),"onEditComplete",this).call(this),this.autoClosePicker()}},{key:"onElementResize",value:function(e){this.pickerVisible&&this.picker.requestAnimationFrame(this.picker.realign,null,this.picker),se()(oe()(t.prototype),"onElementResize",this).call(this,e)}},{key:"internalOnKeyPress",value:function(e){var n=this,r=!0;if("keydown"===e.type&&!n.disabled)if(n.pickerVisible){var i=n.picker;"Escape"===e.key?(e.stopImmediatePropagation(),n.hidePicker(),r=!1):i.onInternalKeyDown?i.onInternalKeyDown(e):"ArrowDown"===e.key&&i.focusable&&i.focus()}else"ArrowDown"===e.key&&n.onTriggerClick(e);r&&se()(oe()(t.prototype),"internalOnKeyPress",this).call(this,e)}},{key:"onFocusIn",value:function(e){se()(oe()(t.prototype),"onFocusIn",this).call(this,e),this.autoExpand&&(this.minChars=0,this.onTriggerClick(e))}},{key:"onFocusOut",value:function(e){this.autoClosePicker(),se()(oe()(t.prototype),"onFocusOut",this).call(this,e)}},{key:"onTriggerClick",value:function(e){this.disabled||this.togglePicker("key"in e)}},{key:"showKeyboard",value:function(e){var t=e.event,n=this.input;rn.isTouchEvent&&document.activeElement===n&&t.target===n&&(ir.suspendFocusEvents(),n.blur(),n.focus(),ir.resumeFocusEvents())}},{key:"togglePicker",value:function(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}},{key:"showPicker",value:function(e){var t=this,n=t.picker;t.pickerHideShowListenersAdded||(n.on({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),n.autoClose=t.autoClose,n.show(),n.isVisible&&e&&t.focusPicker()}},{key:"onPickerShow",value:function(){var e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=ir.on({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=Ln.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}},{key:"onPickerHide",value:function(){var e=this;e.pickerVisible=!1,e.element.classList.remove("b-open"),e.trigger("togglePicker",{show:!1}),e.pickerTapOutRemover&&e.pickerTapOutRemover(),e.pickerKeyDownRemover&&e.pickerKeyDownRemover()}},{key:"onPickerTapOut",value:function(e){var t=e.event;this.owns(t.target)||this.autoClosePicker()}},{key:"onPickerKeyDown",value:function(e){if("Tab"===e.key){var t=document.activeElement,n=new KeyboardEvent("keydown",e);this.input.dispatchEvent(n),n.defaultPrevented&&e.preventDefault(),document.activeElement===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}},{key:"autoClosePicker",value:function(){this.autoClose&&this.hidePicker()}},{key:"hidePicker",value:function(){this.pickerVisible&&this.picker.hide()}},{key:"focusPicker",value:function(){}},{key:"focus",value:function(){var e=this.input;rn.isTouchEvent&&this.editable&&(e.readOnly=!0,setTimeout((function(){return e.readOnly=!1}),500)),se()(oe()(t.prototype),"focus",this).call(this)}},{key:"picker",get:function(){var e=this._picker;return e instanceof vr||(this.picker=e=this.createPicker(e||{})),e},set:function(e){var t=this._picker;t&&t.destroy&&(t.hide(),t.destroy()),this._picker=e}}],[{key:"$name",get:function(){return"PickerField"}},{key:"defaultConfig",get:function(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:null,inputType:"text",monitorResize:!0}}}]),t}(Oi);Pi._$name="PickerField";var Hi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onKeyDown",value:function(e){var t=this,n=t.ownerCmp,r=t.activeItem,i=t.target.querySelector(t.itemSelector),o=e.key.trim()||e.code,a="".concat(e.ctrlKey?"CTRL+":"").concat(e.shiftKey?"SHIFT+":"").concat(e.altKey?"ALT+":"").concat(o);if(i&&t.target.offsetParent){if(null==t.inlineFlow){var s=i.parentNode,l=rn.getStyleValue(i,"position"),u=rn.getStyleValue(i,"display"),c=rn.getStyleValue(i,"float");t.inlineFlow="absolute"===l||"inline"===u||"inline-block"===u||"left"===c||"right"===c||"flex"===rn.getStyleValue(s,"display")&&"row"===rn.getStyleValue(s,"flex-direction"),t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown")}if(t.processEvent&&!(e=t.processEvent.call(n,e)))return;if(r)switch(o){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigateNext(e);break;default:var d=t.keys&&t.keys[a];d&&!t.disabled?t.callback(d,t.thisObj||n,[e]):n.onInternalKeyDown&&n.onInternalKeyDown(e)}else t.activeItem=t.previousActiveItem||t.getDefaultNavigationItem(e);t.activeItem!==r&&t.trigger("navigate",{event:e,item:t.activeItem})}}},{key:"getDefaultNavigationItem",value:function(e){var t=this.target,n=this.itemSelector,r=this.prevKey,i=this.nextKey;return 4&t.compareDocumentPosition(e.target)&&e.key===r?t.querySelector("".concat(n,":last-of-type")):2&t.compareDocumentPosition(e.target)&&e.key===i?t.querySelector("".concat(n)):void 0}},{key:"navigatePrevious",value:function(e){var t=this,n=t.previous;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:50}).then((function(){t.activeItem=n,t.trigger("navigate",{event:e,item:t.activeItem})}))}},{key:"navigateNext",value:function(e){var t=this,n=t.next;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:50}).then((function(){t.activeItem=n,t.trigger("navigate",{event:e,item:t.activeItem})}))}},{key:"onTargetFocusIn",value:function(e){e.target.matches(this.itemSelector)&&(this.skipScrollIntoView=!0,this.activeItem=e.target,this.skipScrollIntoView=!1)}},{key:"onTargetFocusOut",value:function(e){e.relatedTarget&&this.target.contains(e.relatedTarget)||(this.activeItem=null)}},{key:"onTargetMouseDown",value:function(e){if(!1===this.ownerCmp.itemsFocusable)this.onFocusGesture(e);else{var t=e.target.closest(this.itemSelector);t&&(event.preventDefault(),rn.focusWithoutScrolling(t))}}},{key:"onTargetClick",value:function(e){var t=this;t.disabled||(t.skipScrollIntoView=!0,t.processEvent&&(e=t.processEvent.call(t.ownerCmp,e)),e&&(t.activeItem=e.target.closest(t.itemSelector),t.trigger("navigate",{event:e,item:t.activeItem})),t.skipScrollIntoView=!1)}},{key:"onFocusGesture",value:function(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&!1===this.ownerCmp.itemsFocusable)&&e.preventDefault()}},{key:"acceptNode",value:function(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},{key:"onTargetChildListChange",value:function(){var e=this.activeItem;e&&!this.target.contains(e)&&(this.activeItem=this.target.querySelector("".concat(this.itemSelector,'[data-id="').concat(e.dataset.id,'"]')))}},{key:"itemSelector",set:function(e){this._itemSelector=e},get:function(){return this._itemSelector||".".concat(this.ownerCmp.itemCls)}},{key:"owner",get:function(){return this.ownerCmp}},{key:"previous",get:function(){var e=this.treeWalker;if(e.currentNode=this.activeItem,e.previousNode(),e.currentNode!==this.activeItem)return e.currentNode}},{key:"next",get:function(){var e=this.treeWalker;if(e.currentNode=this.activeItem,e.nextNode(),e.currentNode!==this.activeItem)return e.currentNode}},{key:"activeItem",get:function(){return this._activeItem},set:function(e){var t=this,n=t.ownerCmp,r=t.activeItem,i=r&&t.target.contains(r);if(i&&(t.previousActiveItem=r),null!=e){if(n.getItem&&(e=t.ownerCmp.getItem(e)),!e)return;if(t.skipScrollIntoView||n.scrollable.scrollIntoView(e,{block:"nearest",focus:rn.isFocusable(e)&&e!==document.activeElement,silent:t.scrollSilently}),e===r&&i)return;r&&t.activeItem.classList.remove(t.focusCls),e.classList.add(t.focusCls),t._activeItem=e}else r&&(r.classList.remove(t.focusCls),r===document.activeElement&&t.ownerCmp.revertFocus()),t._activeItem=null}},{key:"target",get:function(){return this._target},set:function(e){var t=this,n={element:e,thisObj:t,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:"onTargetMouseDown",click:"onTargetClick"};t._target=e,t.hasOwnProperty("acceptNode")||(t.acceptNode=t.acceptNode.bind(t),t.acceptNode.acceptNode=t.acceptNode),Ln.on(n),t.treeWalker=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,t.acceptNode,!1),t.keyEventTarget||(t.keyEventTarget=e),(t.targetMutationMonitor=new MutationObserver(t.onTargetChildListChange.bind(t))).observe(e,{childList:!0})}},{key:"keyEventTarget",get:function(){return this._keyEventTarget},set:function(e){this._keyEventTarget=e,Ln.on({element:e,keydown:"onKeyDown",thisObj:this})}}],[{key:"defaultConfig",get:function(){return{ownerCmp:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null}}}]),t}(ze(z));function Ni(){var e=Lr()(["","",""]);return Ni=function(){return e},e}function Bi(){var e=Lr()(['<div class="','" data-index="','" data-id="','" ',">\n            ","\n            </div>"]);return Bi=function(){return e},e}function zi(){var e=Lr()(["",""]);return zi=function(){return e},e}Hi._$name="Navigator";var ji=document.createRange(),Vi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n,r=this;Array.isArray(e)&&(e={items:e});for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(n=se()(oe()(t.prototype),"construct",this)).call.apply(n,[this,e].concat(o));var s=r.element,l=s.classList,u={change:"onStoreChange",refresh:"onStoreRefresh",thisObj:r};r.multiSelect&&l.add("b-multiselect"),r.store.count?r.refresh():l.add("b-empty"),Ln.on({element:s,delegate:r.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:r}),r.store.readUrl&&(u.beforeLoad="onBeforeStoreLoad",u.afterRequest="onAfterStoreRequest"),r.storeDetacher=r.store.on(u)}},{key:"doDestroy",value:function(){this.storeDetacher&&this.storeDetacher(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"contentTpl",value:function(){var e=this;return Hr.tpl(zi(),this.store.records.map((function(t,n){return e.itemWrapperTpl(t,n)})))}},{key:"itemWrapperTpl",value:function(e,t){return Hr.tpl(Bi(),this.getItemClasses(e,t),t,e.id,this.itemsFocusable?'tabindex="-1"':"",this.itemContentTpl(e,t))}},{key:"itemContentTpl",value:function(e,t){return Hr.tpl(Ni(),this.multiSelect?'<div class="b-selected-icon b-icon b-icon-check"></div>':"",this.itemTpl(e,t))}},{key:"getItemClasses",value:function(e){var t=this,n=t._navigator&&t._navigator.activeItem,r=n&&n.dataset.id==e.id,i=t.selected.includes(e);return"".concat(t.itemCls," ").concat(e.cls||""," ").concat(i?t.selectedCls:""," ").concat(r?t.navigator.focusCls:"")}},{key:"onBeforeStoreLoad",value:function(){this.mask(this.L("loading"))}},{key:"onAfterStoreRequest",value:function(){this.unmask()}},{key:"onStoreChange",value:function(e){e.source;var t=e.action,n=e.records,r=e.record;switch(t){case"remove":this.selected.remove(n);break;case"clear":this.selected.clear();break;case"update":return void this.refreshItem(r)}this.refresh()}},{key:"onStoreRefresh",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;if(e.isVisible){var t=e.navigator.activeItem;e.paintListener=null,e.clearItems().insertNode(rn.createElementFromTemplate(e.contentTpl(),{fragment:!0})),t&&e.restoreActiveItem(t),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty")}else e.paintListener||(e.paintListener=e.on({paint:"refresh",thisObj:e,once:!0}))}},{key:"clearItems",value:function(){var e=this,t=e.contentElement.querySelector(e.itemSelector),n=e.contentElement.lastChild;if(t){var r=e.contentElement.querySelectorAll("".concat(e.itemSelector,":not(.b-mask)"));ji.setStartBefore(t),ji.setEndAfter(r[r.length-1]),ji.deleteContents()}else n?(ji.setStartAfter(n),ji.setEndAfter(n)):(ji.setStart(e.contentElement,0),ji.setEnd(e.contentElement,0));return ji}},{key:"refreshItem",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r],a=this.getItem(o);if(a){var s=this.store.indexOf(o),l=rn.createElementFromTemplate(this.itemWrapperTpl(o,s));rn.sync(l,a)}}}},{key:"getItem",value:function(e){if(null!=e)return"number"==typeof e?this.contentElement.querySelector('[data-index="'.concat(e,'"]')):(1===e.nodeType&&(e=e.dataset.id),null!=e.id&&(e=e.id),this.contentElement.querySelector('[data-id="'.concat(e,'"]')))}},{key:"getRecord",value:function(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}},{key:"alignTo",value:function(){var e;fn()(oe()(t.prototype),"minHeight",this.minAlignHeight,this,!0);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=se()(oe()(t.prototype),"alignTo",this)).call.apply(e,[this].concat(r))}},{key:"hide",value:function(){var e;this.navigator.activeItem=null;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=se()(oe()(t.prototype),"hide",this)).call.apply(e,[this].concat(r))}},{key:"show",value:function(){var e=this.refreshCount,n=this.navigator.previousActiveItem;fn()(oe()(t.prototype),"minHeight",this._minHeight,this,!0),se()(oe()(t.prototype),"show",this).call(this),this.refreshCount===e&&this.restoreActiveItem(n,!0)}},{key:"restoreActiveItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.navigator.previousActiveItem,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nearest",n=this,r=n.navigator,i=n.lastAlignSpec;if(null!=e){if("string"!=typeof t){var o=i?i.zone:1;t=1&o?"nearest":o?"start":"end"}(e=n.getItem(e))&&(n.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}},{key:"onMouseOver",value:function(e){var t=e.currentTarget;!rn.isTouchEvent&&t&&this.navigator&&this.activateOnMouseover&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[t],cancelOutstanding:!0})}},{key:"handleMouseOver",value:function(e){this.navigator.activeItem=e}},{key:"onClick",value:function(e){var t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}},{key:"onInternalKeyDown",value:function(e){var t=this.navigator.activeItem;switch(e.key){case" ":if(!e.target.readOnly)break;case"Enter":t&&(this.onItemClick(t,e),e.stopImmediatePropagation(),e.preventDefault())}}},{key:"onItemClick",value:function(e,t){var n=this,r=parseInt(e.dataset.index),i=n.store.getAt(r),o=n.selected,a=o.includes(i);n.trigger("item",{item:e,record:i,index:r,event:t}),e.contains(t.target.closest("[data-noselect]"))||(n.multiSelect?o[a?"remove":"add"](i):o.splice(0,o.count,i)),n.lastClicked=i}},{key:"onSelectionChange",value:function(e){var t,n,r=e.action,i=e.removed,o=e.added,a=(e.replaced,this.selectedCls);if("clear"===r){var s=!0,l=!1,u=void 0;try{for(var c,d=this.element.querySelectorAll(".".concat(a))[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)(n=c.value).classList.remove(a)}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}else{var h=!0,f=!1,g=void 0;try{for(var v,m=i[Symbol.iterator]();!(h=(v=m.next()).done);h=!0)t=v.value,(n=this.getItem(t))&&n.classList.remove(a)}catch(e){f=!0,g=e}finally{try{h||null==m.return||m.return()}finally{if(f)throw g}}var p=!0,y=!1,k=void 0;try{for(var b,w=o[Symbol.iterator]();!(p=(b=w.next()).done);p=!0)t=b.value,(n=this.getItem(t))&&n.classList.add(a)}catch(e){y=!0,k=e}finally{try{p||null==w.return||w.return()}finally{if(y)throw k}}}}},{key:"items",set:function(e){this.store&&this.store.autoCreated&&this.store.destroy(),this.store=Fi.getStore(e)}},{key:"selected",set:function(e){e&&e instanceof Un||(e=new Un(e)),this._selected=e,e.on({change:"onSelectionChange",thisObj:this})},get:function(){return this._selected}},{key:"itemSelector",get:function(){return".".concat(this.itemCls)}},{key:"store",get:function(){return this._thisIsAUsedExpression(this.items),this._store},set:function(e){e instanceof Fi||(e=new Fi(e)),this._store=e}},{key:"navigator",get:function(){return this._navigator},set:function(e){var t=this.element;this._navigator=t?new(e.class||Hi)(Object.assign({ownerCmp:this,target:t,keyEventTarget:t},e)):e}},{key:"minHeight",get:function(){return se()(oe()(t.prototype),"minHeight",this)},set:function(e){fn()(oe()(t.prototype),"minHeight",this._minHeight=e,this,!0)}},{key:"minAlignHeight",get:function(){var e=this.element.lastElementChild,t=this.minHeight;if(null!=t)return this.store.count?Math.min(e.offsetTop+e.offsetHeight,t):0}}],[{key:"$name",get:function(){return"List"}},{key:"defaultConfig",get:function(){return{itemCls:"b-list-item",selectedCls:"b-selected",items:null,store:null,navigator:!0,scrollable:{x:!1,y:!0},itemsFocusable:!0,multiSelect:!1,itemTpl:function(e){return e.text},selected:{},activateOnMouseover:null}}}]),t}(vr);function Wi(){var e=Lr()(["","\n            ","\n            ",""]);return Wi=function(){return e},e}Vi.prototype.navigatorClass=Hi,Vi._$name="List",X.register("list",Vi);var Gi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"itemContentTpl",value:function(e,t){return Hr.tpl(Wi(),this.iconTpl?this.iconTpl(e):"",this.itemTpl(e,t),this.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':"")}},{key:"onInternalKeyDown",value:function(e){"Delete"===e.key||"Backspace"===e.key&&this.selected.count?this.callback(this.closeHandler,this.owner,[this.selected.values,{isKeyEvent:!0}]):se()(oe()(t.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"onClick",value:function(e){var n=this,r=e.target.closest(".".concat(n.itemCls));if(n.closable&&e.target.classList.contains("b-close-icon")){var i=n.store.getAt(parseInt(r.dataset.index));n.callback(n.closeHandler,n.owner,[[i]])}else se()(oe()(t.prototype),"onClick",this).call(this,e)}}],[{key:"$name",get:function(){return"ChipView"}},{key:"defaultConfig",get:function(){return{itemCls:"b-chip",closable:!0,iconTpl:null,closeHandler:null}}}]),t}(Vi);Gi._$name="ChipView",X.register("chipview",Gi);var Yi=Symbol("Combo.queryAll"),Ui=Symbol("Combo.queryLast"),qi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"afterConfigure",value:function(){se()(oe()(t.prototype),"afterConfigure",this).call(this),"_value"in this||(this._value=this.valueField===this.displayField?"":null)}},{key:"encodeFilterParams",value:function(e){return e.map((function(e){return e.value}))}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,r=[this.chipView,this._picker];n<r.length;n++){var i=r[n];if(i){if(!1===e(i))return;t&&i.eachWidget&&i.eachWidget(e,t)}}}},{key:"onChipViewMousedown",value:function(e){e.preventDefault(),this.containsFocus||this.focus()}},{key:"onChipClose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t.isKeyEvent&&""===this.input.value||!t.isKeyEvent)&&this.valueCollection.remove(e)}},{key:"syncInputFieldValue",value:function(e){this.multiSelect||se()(oe()(t.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"onEditComplete",value:function(){var e=this,n=e.valueCollection.count;se()(oe()(t.prototype),"onEditComplete",this).call(this),n&&(e.clearError("validateFilter"),e.syncInputFieldValue()),e.required&&!n&&e.setError("fieldRequired")}},{key:"onTriggerClick",value:function(){var e=this;if(e.pickerVisible)e.hidePicker();else if(!e.readOnly&&!e.disabled)switch(e.triggerAction){case Yi:e.doFilter(null);break;case Ui:e.doFilter(e.lastQuery);break;default:e.doFilter(e.input.value)}}},{key:"internalOnInput",value:function(e){var t=this,n=t.input.value.length;t.editable&&(t.updateEmpty(),n>=t.minChars?t.filterList(t.input.value):(t.validateFilter&&!t.filterParamName&&t[n?"setError":"clearError"]("validateFilter"),t.hidePicker()),t.trigger("input",{value:t.input.value,event:e}))}},{key:"filterList",value:function(e){this.doFilter(e)}},{key:"doFilter",value:function(e){var t=this,n=t.store,r=t.filterParamName,i=null==e||""==e;t.lastQuery=e,t.primaryFilter.setConfig({value:e,disabled:i}),r&&n.clear(!0),n.filter(),t.showPicker(),n.count?i||(t.picker.navigator.activeItem=0):r||i||!t.validateFilter||t.setError("validateFilter")}},{key:"onRemoteFilter",value:function(){var e=this,t=e._picker;e.store.count?t&&(t.navigator.activeItem=0):e.validateFilter&&e.setError("validateFilter"),e.filterSelected&&e.valueCollection.count&&(e.store.storage.onFiltersChanged(),t&&t.refresh())}},{key:"onValueCollectionChange",value:function(e){var t=e.source,n=this,r=n.multiSelect,i="hidePickerOnSelect"in n?n.hidePickerOnSelect:!r,o=r?t.values.slice():t.first,a=t.values.slice(),s=n._isUserAction||i&&n.pickerVisible||!1,l=n._value;i&&n.hidePicker(),!t.count&&n.required?n.setError("fieldRequired"):(n.clearError("fieldRequired"),n.clearError("validateFilter")),n.validateFilter&&o&&n.clearError("validateFilter"),n.filterSelected&&(n.filterParamName?(n.store.storage.onFiltersChanged(),n._picker&&n._picker.refresh()):n.store.filter()),n._value=null;var u=n._value=n.value;n.syncInputFieldValue(),n.updateEmpty(),n.isConfiguring||(n.trigger("change",{value:u,oldValue:l,userAction:s,valid:n.isValid}),n.trigger("select",{record:o,records:a,userAction:n.containsFocus}),"select"===n.defaultAction&&n.trigger("action",{value:u,record:o,records:a}))}},{key:"onValueCollectionNoChange",value:function(e){var t=e.toAdd;!this.multiSelect&&t.length&&this.pickerVisible&&this.picker.hide()}},{key:"showPicker",value:function(){var e=this,n=e.picker;se()(oe()(t.prototype),"showPicker",this).call(this),e.overlayAnchor&&!n.align.offset&&(n.align.offset=-n.anchorSize[1],n.realign()),!e.multiSelect&&e.selected&&n.restoreActiveItem(e.selected,!0),e.input.focus()}},{key:"createPicker",value:function(e){var t=this,n=t.multiSelect,r=t.pickerWidth||e.width,i=new Vi(kt.merge({owner:t,floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,store:t.store,selected:t.valueCollection,multiSelect:n,cls:t.listCls,itemTpl:t.listItemTpl||function(e){return e[t.displayField]},forElement:t[t.pickerAlignElement],align:{align:"t-b",axisLock:!0,matchSize:null==r,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},width:r,navigator:{keyEventTarget:t.input},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},e));return i.element.dataset.emptyText=t.emptyText||t.L("No results"),i}},{key:"onPickerHide",value:function(){se()(oe()(t.prototype),"onPickerHide",this).call(this),this.multiSelect&&this.clearTextOnPickerHide&&(this.input.value="")}},{key:"element",set:function(e){var n=this;fn()(oe()(t.prototype),"element",e,this,!0),n.multiSelect&&(n.element.classList.add("b-multiselect"),n.chipView=new $i(kt.assign({parent:n,insertBefore:n.input,store:n.chipStore=new Fi({storage:n.valueCollection}),navigator:{class:Xi,keyEventTarget:n.input}},n.chipView)),n.chipView.element.appendChild(n.input),Ln.on({element:n.chipView.element,mousedown:"onChipViewMousedown",thisObj:n}))},get:function(){return se()(oe()(t.prototype),"element",this)}},{key:"filterParamName",set:function(e){this._filterParamName=e,!1!==this.hideTrigger&&(this.hideTrigger=Boolean(e))},get:function(){return this._filterParamName}},{key:"hideTrigger",set:function(e){this._hideTrigger=e,this.element.classList[e?"add":"remove"]("b-hide-trigger")},get:function(){return this._hideTrigger}},{key:"keyStrokeFilterDelay",set:function(e){e&&(this.filterList=this.buffer(this.doFilter,e)),this._keyStrokeFilterDelay=e},get:function(){return this._keyStrokeFilterDelay}},{key:"minChars",set:function(e){this._minChars=e},get:function(){return"_minChars"in this?this._minChars:this.filterParamName?4:1}},{key:"items",set:function(e){var t=this;if(null==e){if(t.store&&!t.store.isItemStore)return;e=[]}if(e instanceof Fi)return t.store=e;var n,r,i=t.displayField,o=t.valueField;if(Array.isArray(e)?r=e.map((function(e){var r,a,s=e;e instanceof mi?(n=e.constructor,o||(t.valueField=o=n.idField)):"string"==typeof e||"number"==typeof e?(o||(t.valueField=o=t.displayField),r={},$()(r,o,e),$()(r,i,e),s=r):(o||(t.valueField=o="value"),Array.isArray(e)&&(a={},$()(a,o,e[0]),$()(a,i,e[1]),s=a));return s.selected&&(t.value=s),s})):(o||(t.valueField=o="value"),r=[],Object.entries(e).forEach((function(e){var t,n=fe()(e,2),a=n[0],s=n[1];r.push((t={},$()(t,o,a),$()(t,i,s),t))}))),t.store)t.store.data=r;else{var a=o===i?{name:"value",dataSource:i}:o;t.store=new Fi({isItemStore:!0,data:r,idField:o,modelClass:n||function(e){function n(){return C()(this,n),re()(this,oe()(n).apply(this,arguments))}return ue()(n,e),x()(n,null,[{key:"idField",get:function(){return t.valueField},set:function(e){fn()(oe()(n),"idField",e,this,!0)}},{key:"fields",get:function(){return[a,i]}}]),n}(mi)})}},get:function(){return this.store.allRecords}},{key:"value",set:function(e){var t=this;if(e!==t.value){if(!t.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiselect Combo");t._thisIsAUsedExpression(t.items);var n,r=t.valueField,i=t.displayField,o=t.store,a=t.valueCollection;if(t.filterParamName){if(null!=e){var s=t.isConfiguring;return t.primaryFilter.setConfig({value:e,disabled:!1}),o.performFilter(!0).then((function(){var e=t.isConfiguring;t.isConfiguring=s,a.splice(0,a.count,o.allRecords),t.isConfiguring=e}))}}else o.filtered&&(t.primaryFilter.disabled=!0,o.filter());if(null!=e){for(var l=Array.isArray(e)?e.slice():[e],u=0,c=l.length;u<c;u++){var d=l[u];if(d instanceof mi)o.storage.includes(d)||o.add(d);else{var h=d instanceof Object;h&&(d=d[r]),(n=o.storage.getBy(i,d)||o.storage.getBy(r,d))?(h&&n.set(l[u]),l[u]=n):(l.splice(u,1),c--,u--)}}var f=a.generation;a.splice(0,a.count,l),a.generation===f&&t.syncInputFieldValue(),l.length||(t._value=e)}else if(a.count)a.clear();else{var g=t._value;t._value=null,t.syncInputFieldValue(),t.updateEmpty(),t.isConfiguring||t.trigger("change",{value:e,oldValue:g,userAction:t._isUserAction,valid:t.isValid})}}else t.syncInputFieldValue(!0)},get:function(){var e=this;return e.multiSelect?e.valueCollection.map((function(t){return t[e.valueField]})):e.valueCollection.count?e.valueCollection.first[e.valueField]:e._value}},{key:"isEmpty",get:function(){return 0===this.valueCollection.count}},{key:"isValid",get:function(){var e=this;return e.isConfiguring||!e.required||e.valueCollection.count?e.clearError("fieldRequired",!0):e.setError("fieldRequired",!0),se()(oe()(t.prototype),"isValid",this)}},{key:"inputValue",get:function(){var e=this,t=e.value;return t=e.selected?e.selected[e.displayField]:t,e.displayValueRenderer&&(t=this.displayValueRenderer(e.selected)),null==t?"":t}},{key:"displayValueRenderer",set:function(e){this._displayValueRenderer=e},get:function(){return this._displayValueRenderer}},{key:"valueCollection",get:function(){return this._valueCollection||(this._valueCollection=new Un({listeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),this._valueCollection}},{key:"store",set:function(e){var t=this,n=t.filterParamName,r=[],i={thisObj:this};if(Array.isArray(e))return t.initialConfig.store=null,t.items=e;if(!e||e instanceof Fi||(e=new(e.readUrl?Ii:Fi)(e)),n&&(e.filterParamName=n,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams),i.filter="onRemoteFilter"),t.valueField||(t.valueField=e.modelClass.idField),!t.primaryFilter){t.primaryFilter=new On({id:"primary",property:t.displayField,operator:t.filterOperator,disabled:!0,caseSensitive:t.caseSensitive})}r.push(t.primaryFilter),n?t.filterSelected&&(e.storage.autoFilter=!0,e.storage.addFilter({id:"".concat(t.id,"-selected-filter"),filterBy:function(e){return!t.valueCollection.includes(e)}})):t.filterSelected&&(t.selectedItemsFilter=function(e){return!t.valueCollection.includes(e)},r.push(t.selectedItemsFilter),e.reapplyFilterOnAdd=!0),e.filter(r),t._store=e,e.storage.addIndex(t.displayField),e.storage.addIndex(t.valueField),t.displayValueRenderer&&(i.change="syncInputFieldValue",t.syncInputFieldValue()),e.on(i)},get:function(){return this._store}},{key:"record",get:function(){return this.selected}},{key:"records",get:function(){return this.valueCollection.values.slice()}},{key:"selected",get:function(){return this.valueCollection.first}}],[{key:"$name",get:function(){return"Combo"}},{key:"defaultConfig",get:function(){return{items:null,store:null,valueField:null,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:null,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:Yi,filterOperator:"startsWith",caseSensitive:!1,multiSelect:null,hidePickerOnSelect:null,chipView:null,filterSelected:null,emptyText:null,value:null,validateFilter:!0,clearTextOnPickerHide:!0}}}]),t}(Pi);qi.queryAll=Yi,qi.queryLast=Ui;var $i=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"defaultConfig",get:function(){return{cls:"b-combo-chip-list",itemsFocusable:!1,multiSelect:!0,closeHandler:"up.onChipClose",itemTpl:function(e){return e[this.owner.displayField]}}}}]),t}(Gi),Xi=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onTargetClick",value:function(e){var n=e.target.closest(this.itemSelector);!n||e.shiftKey||n.contains(e.target.closest("[data-noselect]"))||this.ownerCmp.selected.clear(),fn()(oe()(t.prototype),"activeItem",n,this,!0)}},{key:"onKeyDown",value:function(e){"Enter"!==e.key&&se()(oe()(t.prototype),"onKeyDown",this).call(this,e)}},{key:"navigatePrevious",value:function(e){var n=this.ownerCmp;n.navigator.activeItem&&!e.shiftKey&&n.selected.clear(),this.previous?se()(oe()(t.prototype),"navigatePrevious",this).call(this,e):this.activeItem=null}},{key:"navigateNext",value:function(e){var n=this.ownerCmp;n.navigator.activeItem&&!e.shiftKey&&n.selected.clear(),this.next?se()(oe()(t.prototype),"navigateNext",this).call(this,e):this.activeItem=null}},{key:"activeItem",set:function(e){var n=this.ownerCmp;e=n.getItem(e),fn()(oe()(t.prototype),"activeItem",e,this,!0),e&&n.selected.add(n.getRecord(e))},get:function(){return se()(oe()(t.prototype),"activeItem",this)}}],[{key:"defaultConfig",get:function(){return{allowShiftKey:!0}}}]),t}(Hi);qi._$name="Combo",X.register("combo",qi),X.register("combobox",qi),X.register("dropdown",qi);var Ki=function(){function e(t){C()(this,e);var n=t.date,r=t.weekStartDay,i=t.sixWeeks;this.constructor.updateDayNumbers(r),this.sixWeeks=i,this.date=n}return x()(e,[{key:"eachDay",value:function(e){for(var t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}},{key:"eachWeek",value:function(e){for(var t=this,n=t.weekCount,r=t.startDayOfMonth,i=0;i<n;i++){for(var o=[],a=t.getWeekNumber(new Date(t.year,t.month,Math.max(r,1))),s=0;s<7;s++,r++)o.push(new Date(t.year,t.month,r));e(a,o)}}},{key:"getWeekNumber",value:function(t){var n=this,r=n.weekStartDay;if((t=vt.clearTime(t))<n.startDate||t>n.endDate)return new e({date:t,weekStartDay:r}).getWeekNumber(t);var i=Math.floor((t-n.weekBase)/864e5/7),o=t.getFullYear();if(!i){var a=new Date(n.year,0,0);return new e({date:a,weekStartDay:r}).getWeekNumber(a)}return 53!==i||n.has53weeks||(i=1,o++),[o,i]}},{key:"date",set:function(t){var n="string"==typeof t;if(t=new Date(t),n){if(isNaN(t))throw new Error("CalendarPanel date ingestion must be passed a Date, or a valid argument to the Date constructor");t=vt.add(t,t.getTimezoneOffset(),"minute")}var r=this,i=vt.getFirstDateOfMonth(t),o=vt.getLastDateOfMonth(i),a=r.dayNumbers[i.getDay()],s=r.dayNumbers[o.getDay()];if(r._date=t,r.startDayOfMonth=1-a,r.endDayOfMonth=o.getDate()+(6-s),r.sixWeeks)for(;r.weekCount<6;)r.endDayOfMonth+=7;var l=new Date(r.year,0,1),u=new Date(r.year,1,31),c=r.month?new e({date:l,weekStartDay:r.weekStartDay}):r;r.dayNumbers[l.getDay()]>3?r.weekBase=c.startDate:r.weekBase=new Date(r.year,0,c.startDayOfMonth-7),r.has53weeks=u.getDay()<4},get:function(){return this._date}},{key:"year",set:function(e){this.date.setFullYear(e),this.date=this.date},get:function(){return this.date.getFullYear()}},{key:"month",set:function(e){this.date.setMonth(e),this.date=this.date},get:function(){return this.date.getMonth()}},{key:"dayCount",get:function(){return this.endDayOfMonth+1-this.startDayOfMonth}},{key:"weekCount",get:function(){return this.dayCount/7}},{key:"startDate",get:function(){return new Date(this.year,this.month,this.startDayOfMonth)}},{key:"endDate",get:function(){return new Date(this.year,this.month,this.endDayOfMonth)}}],[{key:"applyLocale",value:function(){this.updateDayNumbers()}},{key:"updateDayNumbers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt.weekStartDay,t=this.prototype,n=t.dayNumbers=[],r=t.canonicalDayNumbers=[];t.weekStartDay=e;for(var i=0;i<7;i++){var o=(e+i)%7;r[i]=o,n[o]=i}}}]),e}();je.on({locale:"applyLocale",thisObj:Ki}),Ki._$name="Month";var Ji=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){je.on({locale:Qi}),Qi(),se()(oe()(t.prototype),"construct",this).call(this,e),this.refresh()}},{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"ingestDate",value:function(e){if(!(e instanceof Date)){if(e=new Date(e),isNaN(e))throw new Error("CalendarPanel date ingestion must be passed a Date, or a valid argument to the Date constructor");var t=e.getTimezoneOffset();t&&(e=vt.add(e,t,"minute"))}return vt.clearTime(e)}},{key:"refresh",value:function(){var e=this,t=vt.clearTime(new Date),n=e.cellElements,r=e.weekElements,i=e.date,o=e.month,a=e.cellCls,s=e.disabledCls,l=e.otherMonthCls,u=e.weekendCls,c=e.todayCls;if(!i)return e.date=t;for(var d=0,h=n.length;d<h;d++)n[d].className=n[d].innerHTML="";for(var f=0;f<7;f++){var g=e.weekdayCells[f];g.className=g.innerHTML="",e.headerRenderer?e.headerRenderer(g,f):g.innerHTML=eo[e.canonicalDayNumbers[f]],g.classList.add("b-calendar-day-header")}var v=0,m=0;o.eachWeek((function(n,i){var d=r[v].children;d[0].className="b-week-number-cell",e.weekRenderer?e.weekRenderer(d[0],n):d[0].innerHTML=n[1];for(var h=0;h<7;h++){var f=i[h],g=f.getDay(),p=d[h+1],y=p.classList;y.add(a),e.isDisabledDate(f)&&y.add(s),f.getMonth()!==o.month&&y.add(l),0!==g&&6!==g||y.add(u),f.getTime()===t.getTime()&&y.add(c),p.dataset.date=vt.format(f,"YYYY-MM-DD"),p.dataset.cellIndex=m,e.cellRenderer?e.cellRenderer(p,f):p.innerHTML=f.getDate(),m++}v++})),e.floating&&(e.isAligning||e.realign())}},{key:"isDisabledDate",value:function(e){var t=e.getDay(),n=this.disabledDates;if(this.disableWeekends&&(0===t||6===t))return!0;if(n){if("function"==typeof n)return n(e);if(Array.isArray(n))return n.some((function(t){return vt.clearDate(t,!0).getTime()===vt.clearDate(e,!0).getTime()}))}}},{key:"onTipOverCell",value:function(e){var t=e.source,n=e.target;t.date=vt.parse(n.dataset.date,"YYYY-MM-DD")}},{key:"tip",set:function(e){this._tip=new Ur(Object.assign({forElement:this.element,forSelector:".b-calendar-cell"},e)),this._tip.on({pointerOver:"onTipOverCell",thisObj:this})},get:function(){return this._tip}},{key:"element",get:function(){return se()(oe()(t.prototype),"element",this)},set:function(e){fn()(oe()(t.prototype),"element",e,this,!0),this.weekElements=Array.from(this.element.querySelectorAll(".b-calendar-week")),this.cellElements=Array.from(this.element.querySelectorAll(".b-calendar-week > div"))}},{key:"date",set:function(e){var t=this;e=t._date=t.ingestDate(e),t.month&&t.month.month===e.getMonth()||(t.month=new Ki({date:e,weekStartDay:t.weekStartDay,sixWeeks:t.sixWeeks})),t.refresh()},get:function(){return this._date}},{key:"month",set:function(e){e instanceof Ki?this._month=e:(this.month.month=e,this.refresh())},get:function(){return this._month}},{key:"year",set:function(e){this.month.year=e,this.refresh()},get:function(){return this.month.year}},{key:"showWeekNumber",set:function(e){this.element.classList[e?"add":"remove"]("b-show-week-number"),this.floating&&(this.isAligning||this.realign())}},{key:"bodyConfig",get:function(){var e=se()(oe()(t.prototype),"bodyConfig",this),n=[];e.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",children:this.dayNameCells},{className:"b-weeks-container",reference:"weeksElement",children:n}];for(var r=0;r<6;r++){for(var i={className:"b-calendar-row b-calendar-week",children:[]},o=0;o<8;o++)i.children.push({});n.push(i)}return e}},{key:"weekStartDay",set:function(e){var t=this;t.dayNames=[],t.dayNumbers=[],t.canonicalDayNumbers=[],t._weekStartDay=null!=e?e:vt.weekStartDay;for(var n=0;n<7;n++){var r=(t._weekStartDay+n)%7;t.canonicalDayNumbers[n]=r,t.dayNumbers[r]=n,t.dayNames[n]=eo[r]}},get:function(){return this.hasOwnProperty("_weekStartDay")||(this.weekStartDay=void 0),this._weekStartDay}},{key:"dayNameCells",get:function(){var e=document.createElement("div"),t=[e],n=this.weekdayCells=[];e.className="b-week-number-cell",this._thisIsAUsedExpression(this.weekStartDay);for(var r=0;r<7;r++){var i=document.createElement("div");t.push(i),n.push(i)}return t}}],[{key:"$name",get:function(){return"CalendarPanel"}},{key:"defaultConfig",get:function(){return{weekStartDay:null,sixWeeks:!0,showWeekNumber:!1,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,tip:null,cellCls:"b-calendar-cell",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today"}}}]),t}(_r);function Qi(){eo.length=0;for(var e=2;e<9;e++)Zi.setDate(e),eo.push(vt.format(Zi,"ddd"))}var Zi=new Date("2000-01-01T00:00:00"),eo=[];Ji._$name="CalendarPanel",X.register("calendarpanel",Ji);var to=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"$name",get:function(){return"Fit"}},{key:"defaultConfig",get:function(){return{containerCls:"b-fit-container",itemCls:"b-fit-item"}}}]),t}(pr);to._$name="Fit",pr.registerLayout(to);var no=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n;return ue()(t,e),x()(t,[{key:"afterConfigure",value:function(){var e=this;se()(oe()(t.prototype),"afterConfigure",this).call(this),(e.completeKey||e.cancelKey)&&Ln.on({element:e.element,keydown:"onKeyDown",thisObj:e}),je.on({locale:"onLocaleChange",thisObj:e})}},{key:"onLocaleChange",value:function(){var e=this.inputField;e&&!e.isDestroyed&&e.syncInputFieldValue(!0)}},{key:"startEdit",value:function(e){var t=e.target,n=e.align,r=void 0===n?"t0-t0":n,i=e.hideTarget,o=void 0!==i&&i,a=e.matchSize,s=void 0===a||a,l=e.matchFont,u=void 0===l||l,c=e.fitTargetContent,d=void 0!==c&&c,h=e.value,f=e.record,g=e.field,v=void 0===g?this.inputField.name:g,m=e.focus,p=void 0===m||m,y=this,k=y.inputField,b=t instanceof Oe?t:Oe.inner(t),w=rn.getStyleValue(t,"font-size"),S=rn.getStyleValue(t,"font-family");if(!1!==y.trigger("beforestart",{value:h})){if(f&&v&&void 0===h&&(y.record=f,y.dataField=v,h=f[v]),s&&(y.width=b.width,y.height=b.height),k.input&&(u?(k.input.style.fontSize=w,k.input.style.fontFamily=S):k.input.style.fontSize=k.input.style.fontFamily=""),k.clearError&&k.clearError(),k.value=h,k.initialValue=k.value,y.showBy({target:t,align:r}),d){var C=k.input.scrollWidth-k.input.clientWidth;C>0&&(y.width+=C+rn.scrollBarWidth)}return p&&y.inputField.focus&&y.inputField.focus(),1===t.nodeType&&(t.classList.add("b-editing"),o&&t.classList.add("b-hide-visibility")),y.trigger("start",{value:k.value}),y.oldValue=k.value,Array.isArray(y.oldValue)&&(y.oldValue=y.oldValue.slice()),!0}return!1}},{key:"refreshEdit",value:function(){if(this.isVisible){var e=this.record,t=this.dataField,n=this.inputField;if(e&&t){var r=e[t];kt.isEqual(n.value,r)||(n.value=r)}}}},{key:"onKeyDown",value:function(e){var t=this;switch(e.key){case t.completeKey:t.completeEdit(),e.stopImmediatePropagation();break;case t.cancelKey:t.cancelEdit(),e.stopImmediatePropagation()}t.trigger("keydown",{event:e})}},{key:"onFocusOut",value:function(e){if(se()(oe()(t.prototype),"onFocusOut",this).call(this,e),!this.isFinishing){var n=this["".concat(this.blurAction,"Edit")];n&&n.call(this)}}},{key:"completeEdit",value:(n=Di()(Ei.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,d,h;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).inputField,i=n.oldValue,o=n.record,a=r.invalidAction||(!1===r.allowInvalid?"block":n.invalidAction),s=r.value,r.isValid){e.next=12;break}if("block"!==a){e.next=7;break}return r.focus&&r.focus(),e.abrupt("return",!1);case 7:if("revert"!==a){e.next=10;break}return n.cancelEdit(),e.abrupt("return",!0);case 10:e.next=33;break;case 12:if(!kt.isEqual(s,i)){e.next=17;break}return n.cancelEdit(),e.abrupt("return",!0);case 17:if(l={inputField:r,record:o,value:s,oldValue:i},!1!==n.trigger("beforeComplete",l)){e.next=22;break}r.focus&&r.focus(),e.next=33;break;case 22:if(t||(t=l.finalize||l.editorContext&&l.editorContext.finalize),!t){e.next=31;break}return e.next=26,t(l);case 26:return!0===(u=e.sent)?n.onEditComplete():(r.setError&&(c=u||r.L("invalidValue"),d=function(){h(),r.clearError(c)},h=r.on({change:d,input:d}),r.setError(c)),"block"===a?r.focus&&r.focus():"revert"===a&&(r.value=i,u=!0),u=!1),e.abrupt("return",u);case 31:return n.onEditComplete(),e.abrupt("return",!0);case 33:return e.abrupt("return",!1);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"cancelEdit",value:function(){var e=this,t=e.inputField,n=e.oldValue,r=e.lastAlignSpec.target,i=t.value;e.isFinishing||!1===e.trigger("beforeCancel",{value:i,oldValue:n})||(e.isFinishing=!0,e.hide(),e.trigger("cancel",{value:i,oldValue:n}),1===r.nodeType&&(r.classList.remove("b-editing"),r.classList.remove("b-hide-visibility")),e.isFinishing=!1)}},{key:"onEditComplete",value:function(){var e=this,t=e.record,n=e.dataField,r=e.inputField,i=e.oldValue,o=e.lastAlignSpec.target,a=r.value;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){var s="set".concat(A.capitalizeFirstLetter(n));t[s]?t[s](a):t[n]=a}e.trigger("complete",{value:a,oldValue:i}),1===o.nodeType&&(o.classList.remove("b-editing"),o.classList.remove("b-hide-visibility")),e.isFinishing=!1}}},{key:"doDestroy",value:function(){this.createdInputField&&this.inputField.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onInputFieldChange",value:function(){this.containsFocus&&this.completeEdit()}},{key:"allowInvalid",set:function(e){this._allowInvalid=e,me.invalidAction=e?"allow":"block"},get:function(){return this._allowInvalid}},{key:"owner",set:function(e){this._owner=e},get:function(){return this._owner||Z.fromElement(this.element.parentNode)}},{key:"inputField",set:function(e){var t=this;t._inputField&&t._inputField.destroy(),"string"==typeof e&&(e={type:e}),e instanceof vr?t._inputField=e:(t._inputField=te.createWidget(e),t.createdInputField=!0),t.completeOnChange&&t._inputField.on({change:"onInputFieldChange",thisObj:t}),t._inputField.parent=t,t.removeAll(),t.add(e)},get:function(){return this.items[0]}}],[{key:"$name",get:function(){return"Editor"}},{key:"defaultConfig",get:function(){return{positioned:!0,hidden:!0,layout:"fit",inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",allowInvalid:null,invalidAction:"block",completeOnChange:null}}}]),t}(Dr);no._$name="Editor",X.register("editor",no);var ro=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;je.on({locale:"onLocaleChange",thisObj:n}),n.selection=[],n.refresh=n.createOnFrame(n.refresh),se()(oe()(t.prototype),"construct",this).call(this,e),n.element.setAttribute("aria-activedescendant","".concat(n.id,"-active-day")),Ln.on({element:n.element,mouseover:"onPickerMouseover",mousedown:"onPickerMousedown",click:"onPickerClick",keydown:"onPickerKeyDown",thisObj:n})}},{key:"doDestroy",value:function(){this._yearEditor&&this._yearEditor.destroy(),this._monthEditor&&this._monthEditor.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"eachWidget",value:function(e,t){var n=this.items||[];this._yearEditor&&n.unshift(this._yearEditor),this._monthEditor&&n.unshift(this._monthEditor);for(var r=0;r<n.length;r++){var i=n[r];if(!1===e(i))return;t&&i.eachWidget&&i.eachWidget(e,t)}}},{key:"refresh",value:function(){var e=this,n=rn.scrollBarWidth;se()(oe()(t.prototype),"refresh",this).call(this),e.monthElement.style.minWidth="calc(".concat(e.maxMonthLength+1,"ch + ").concat(n,"px)"),e.monthElement.innerHTML=vt.format(e.month.date,"MMMM"),e.yearElement.style.minWidth=n?"calc(3ch + ".concat(n,"px"):"7ch",e.yearElement.innerHTML=vt.format(e.month.date,"YYYY")}},{key:"cellRenderer",value:function(e,t){var n=this,r=n.activeCls,i=n.selectedCls,o=e.classList;e.innerHTML=t.getDate(),e.setAttribute("aria-label",vt.format(t,"MMMM D, YYYY")),n.isActiveDate(t)&&(o.add(r),e.id="".concat(n.id,"-active-day")),n.isSelectedDate(t)&&o.add(i),n.minDate&&t<n.minDate?o.add(n.outOfRangeCls):n.maxDate&&t>n.maxDate&&o.add(n.outOfRangeCls)}},{key:"onPickerMousedown",value:function(e){e.preventDefault()}},{key:"onPickerMouseover",value:function(e){if(this.editOnHover&&rn.up(e.target,".b-editable"))return this.onEditGesture(e)}},{key:"onPickerClick",value:function(e){var t=this,n=e.target,r=rn.up(n,".".concat(t.cellCls,":not(.").concat(t.disabledCls,"):not(.").concat(t.outOfRangeCls,")")),i=rn.up(n,".b-editable");return r?t.onCellClick(e):t.editOnHover&&!rn.isTouchEvent||!i?(t._monthEditor&&!t._monthEditor.owns(e)&&t._monthEditor.cancelEdit(),void(t._yearEditor&&!t._yearEditor.owns(e)&&t._yearEditor.cancelEdit())):t.onEditGesture(e)}},{key:"onCellClick",value:function(e){this.onDateActivate(vt.parse(e.target.dataset.date,"YYYY-MM-DD"),e)}},{key:"onEditGesture",value:function(e){var t=this,n=t.month,r=e.target;r===t.monthElement?t.monthEditor.startEdit({target:r,value:n.month,fitTargetContent:!1,hideTarget:!0}):r===t.yearElement&&(t.yearEditor.minWidth="calc(50px + ".concat(rn.scrollBarWidth,"px)"),t.yearEditor.startEdit({target:r,value:n.year,fitTargetContent:!0,hideTarget:!0}))}},{key:"onDateActivate",value:function(e,t){var n=this,r=n.lastClickedDate,i=n.selection;n.activeDate=e,n.lastClickedDate=e,n.multiSelect?n.multiRange||r&&e.getTime()===r.getTime()||(r&&t.shiftKey?(i[1]=e,i.sort()):(i.length=0,i[0]=e),n.trigger("selectionChange",{selection:i})):n.value&&n.value.getTime()===e.getTime()?n.hide():n.value=e}},{key:"onPickerKeyDown",value:function(e){var t=this,n=e.key.trim()||e.code,r=t.activeDate,i=new Date(r);if(r){do{switch(n){case"Escape":t.hide();break;case"ArrowLeft":e.preventDefault(),e.ctrlKey?i.setMonth(i.getMonth()-1):i.setDate(i.getDate()-1);break;case"ArrowUp":e.preventDefault(),i.setDate(i.getDate()-7);break;case"ArrowRight":e.preventDefault(),e.ctrlKey?i.setMonth(i.getMonth()+1):i.setDate(i.getDate()+1);break;case"ArrowDown":e.preventDefault(),i.setDate(i.getDate()+7);break;case"Enter":t.onDateActivate(r,e)}}while(t.isDisabledDate(i)&&!t.focusDisabledDates);if(t.minDate&&i<t.minDate)return;if(t.maxDate&&i>t.maxDate)return;t.activeDate=i}}},{key:"gotoPrevMonth",value:function(){var e=this.date;e.setMonth(e.getMonth()-1),this.date=e}},{key:"gotoNextMonth",value:function(){var e=this.date;e.setMonth(e.getMonth()+1),this.date=e}},{key:"isActiveDate",value:function(e){return this.activeDate&&this.ingestDate(e).getTime()===this.activeDate.getTime()}},{key:"isSelectedDate",value:function(e){return this.selection.some((function(t){return t.getTime()===e.getTime()}))}},{key:"onMonthPicked",value:function(e){var t=e.value;this.month=t}},{key:"onYearPicked",value:function(e){var t=e.value;this.year=t}},{key:"onLocaleChange",value:function(){this._monthEditor&&(this._monthEditor.doDestroy(),this._monthEditor=null),this._yearEditor&&(this._yearEditor.doDestroy(),this._yearEditor=null),this._maxMonthLength=0}},{key:"focusElement",get:function(){return this.element}},{key:"minDate",set:function(e){this._minDate=e?this.ingestDate(e):null,this.refresh()},get:function(){return this._minDate}},{key:"maxDate",set:function(e){this._maxDate=e?this.ingestDate(e):null,this.refresh()},get:function(){return this._maxDate}},{key:"activeDate",set:function(e){var t=this;t._activeDate=e?t.ingestDate(e):vt.clearTime(new Date),t.month.month!==t._activeDate.getMonth()&&(t.month.date=t._activeDate),t.refresh()},get:function(){return this._activeDate}},{key:"value",set:function(e){var t,n=this,r=n.selection;e?(e=n.ingestDate(e),n.value&&e.getTime()===n.value.getTime()||(r.length=0,r[0]=e,t=!0),n.date=e):(t=r.length,r.length=0,n.date=new Date),t&&n.trigger("selectionChange",{selection:r})},get:function(){return this.selection[this.selection.length-1]}},{key:"monthEditor",get:function(){var e=this;return e._monthEditor||(e._monthEditor=new no({owner:e,appendTo:e.element,inputField:e.monthInput=new qi({editable:!1,autoExpand:!e.editOnHover,items:e.monthItems,highlightExternalChange:!1,picker:{align:{align:"t0-b0"},cls:"b-month-picker-list",scrollable:{overflowX:!1}}}),completeOnChange:!0,listeners:{complete:"onMonthPicked",thisObj:e}})),e._monthEditor}},{key:"yearEditor",get:function(){var e=this;return e._yearEditor||(e._yearEditor=new no({owner:e,appendTo:e.element,inputField:e.yearInput=new qi({editable:!1,autoExpand:!e.editOnHover,items:e.yearItems,highlightExternalChange:!1,picker:{cls:"b-year-picker-list",scrollable:{overflowX:!1}}}),completeOnChange:!0,listeners:{complete:"onYearPicked",thisObj:e}})),e._yearEditor}},{key:"monthItems",get:function(){return vt.getMonthNames().map((function(e,t){return[t,e]}))}},{key:"yearItems",get:function(){for(var e=[],t=(new Date).getFullYear(),n=t-20;n<t+21;n++)e.push(n);return e}},{key:"maxMonthLength",get:function(){if(!this._maxMonthLength){this._maxMonthLength=0;for(var e=0,t=this.monthItems;e<12;e++)this._maxMonthLength=Math.max(this._maxMonthLength,t[e][1].length)}return this._maxMonthLength}}],[{key:"$name",get:function(){return"DatePicker"}},{key:"defaultConfig",get:function(){return{focusable:!0,tools:{prevMonth:{align:"start",cls:"b-icon b-icon-angle-left",handler:"gotoPrevMonth"},nextMonth:{align:"end",cls:"b-icon b-icon-angle-right",handler:"gotoNextMonth"}},header:{title:'<div class="b-editable b-datepicker-month" reference="monthElement"></div> <div class="b-editable b-datepicker-year" reference="yearElement"></div>',titleAlign:"center"},minDate:null,maxDate:null,outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date",focusDisabledDates:null,multiSelect:!1,editOnHover:!0}}}]),t}(Ji);function io(){var e=Lr()(['<input type="','"\n            reference="input"\n            class="','"\n            min="','"\n            max="','"\n            placeholder="','"\n            name="','"\n            id="','"/>']);return io=function(){return e},e}ro._$name="DatePicker",X.register("datepicker",ro);var oo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"inputTemplate",value:function(){var e=this;return Hr.tpl(io(),e.inputType||"text",e.inputCls||"",e.min,e.max,e.placeholder,e.name||e.id,e.id+"_input")}},{key:"createPicker",value:function(e){var t=this;return e=new ro(Object.assign({owner:t,forElement:t[t.pickerAlignElement],floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},value:t.value,minDate:t.min,maxDate:t.max,onSelectionChange:function(e){var n=e.selection,r=e.source;r.isVisible&&(t._isUserAction=!0,t.value=n[0],t._isUserAction=!1,r.hide())}},e)),t.calendarContainerCls&&e.element.classList.add(t.calendarContainerCls),e}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=vt.add(e.value,-1*e._step.magnitude,e._step.unit);(!t||t.getTime()<=n)&&(e.value=n)}}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=vt.add(e.value,e._step.magnitude,e._step.unit);(!t||t.getTime()>=n)&&(e.value=n)}}},{key:"showPicker",value:function(e){this.picker.value=this.picker.activeDate=this.value,se()(oe()(t.prototype),"showPicker",this).call(this,e)}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"transformDateValue",value:function(e){return null!=e&&("Date"!==e.constructor.name&&(e="string"==typeof e?vt.parse(e,this.format)||vt.parse(e,this.fallbackFormat):new Date(e)),e&&"Date"===e.constructor.name&&!isNaN(e.valueOf()))?vt.clearTime(e):null}},{key:"hasChanged",value:function(e,n){return e&&e.getTime&&n&&n.getTime?e.getTime()!==n.getTime():se()(oe()(t.prototype),"hasChanged",this).call(this,e,n)}},{key:"updateLocalization",value:function(){se()(oe()(t.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}},{key:"internalOnKeyPress",value:function(e){se()(oe()(t.prototype),"internalOnKeyPress",this).call(this,e),"Enter"===e.key&&this.isValid&&this.picker.hide()}},{key:"triggers",set:function(e){fn()(oe()(t.prototype),"triggers",kt.assign(e,this.stepTriggers),this,!0)},get:function(){return se()(oe()(t.prototype),"triggers",this)}},{key:"isValid",get:function(){var e=this,n=e.min,r=e.max;e.clearError("minimumValueViolation",!0),e.clearError("maximumValueViolation",!0);var i=e.value;if(i){if(i=i.getTime(),n&&n.getTime()>i)return e.setError("minimumValueViolation",!0),!1;if(r&&r.getTime()<i)return e.setError("maximumValueViolation",!0),!1}return se()(oe()(t.prototype),"isValid",this)}},{key:"min",set:function(e){var t=this;t._min=t.transformDateValue(e),t.input&&(t.input.min=t._min),t._picker&&(t._picker.minDate=t._min),t.updateInvalid()},get:function(){return this._min}},{key:"max",set:function(e){var t=this;t._max=t.transformDateValue(e),t.input&&(t.input.max=t._max),t._picker&&(t._picker.maxDate=t._max),t.updateInvalid()},get:function(){return this._max}},{key:"value",set:function(e){var n=this,r=n.value,i=n._picker,o=n.transformDateValue(e);!e||o?(n.clearError("invalidDate"),n.hasChanged(r,o)?(i&&!n.inputting&&(i.value=o),fn()(oe()(t.prototype),"value",o,this,!0)):n.inputting||n.syncInputFieldValue()):n.setError("invalidDate")},get:function(){return se()(oe()(t.prototype),"value",this)}},{key:"step",set:function(e){var t=this;t.element.classList[e?"add":"remove"]("b-show-steppers"),"number"==typeof e?e={magnitude:e,unit:t._step?t._step.unit:"day"}:"object"!==U()(e)&&(e=vt.parseDuration(e)),e&&e.magnitude&&e.unit&&(e.magnitude=Math.abs(e.magnitude),t._step=e,t.updateInvalid())},get:function(){return this._step}},{key:"inputValue",get:function(){var e=this.value;return e?vt.format(e,this.format):""}},{key:"format",set:function(e){this._format=e,this.syncInputFieldValue(!0)},get:function(){return this._format}}],[{key:"$name",get:function(){return"DateField"}},{key:"defaultConfig",get:function(){return{format:"L",fallbackFormat:"YYYY-MM-DD",pickerFormat:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200}},stepTriggers:{back:{cls:"b-icon-angle-left b-step-trigger",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon-angle-right b-step-trigger",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:null,picker:null}}}]),t}(Pi);function ao(){var e=Lr()(['\n            <input type="number"\n                reference="input"\n                value="','"\n                name="','"\n                id="','_input"\n                step="any"\n                ',"\n                ","/>\n            "]);return ao=function(){return e},e}oo._$name="DateField",X.register("datefield",oo),X.register("date",oo);var so=/[.,]/,lo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.input.addEventListener("dblclick",(function(){n.select()})),"number"==typeof n.changeOnSpin&&(n.bufferedSpinChange=n.buffer(n.triggerChange,n.changeOnSpin))}},{key:"inputTemplate",value:function(){var e=this,t="inputWidth"in e?'style="width:'.concat(e.inputWidth).concat("number"==typeof e.inputWidth?"px":"",'"'):"";return Hr.tpl(ao(),e._value,e.name||e.id,e.id,t,e.attributeString)}},{key:"internalOnKeyPress",value:function(e){"keydown"===e.type&&("ArrowUp"===e.key?(this.doSpinUp(),e.preventDefault()):"ArrowDown"===e.key&&(this.doSpinDown(),e.preventDefault())),se()(oe()(t.prototype),"internalOnKeyPress",this).call(this,e)}},{key:"doSpinUp",value:function(){var e=this,t=e.min,n=e.max,r=(e.value||0)+e.step;!isNaN(t)&&r<t&&(r=t),(isNaN(n)||r<=n)&&e.applySpinChange(r)}},{key:"doSpinDown",value:function(){var e=this,t=e.min,n=e.max,r=(e.value||0)-e.step;!isNaN(n)&&r>n&&(r=n),(isNaN(t)||r>=t)&&e.applySpinChange(r)}},{key:"applySpinChange",value:function(e){var t=this;t._isUserAction=!0,!0!==t.changeOnSpin&&(t.silenceChange=!0,t.bufferedSpinChange&&t.bufferedSpinChange(null,!0)),t.value=e,t._isUserAction=!1,t.silenceChange=!1}},{key:"triggerChange",value:function(){this.silenceChange||se()(oe()(t.prototype),"triggerChange",this).apply(this,arguments)}},{key:"internalOnInput",value:function(e){var n=this.input,r=this.formatValue(n.value);n.value!==r&&(n.value=r),se()(oe()(t.prototype),"internalOnInput",this).call(this,e)}},{key:"formatValue",value:function(e){return t.formatValue(e,this.leadingZeroes,this.decimalPrecision)}},{key:"step",set:function(e){this.element.classList[e?"remove":"add"]("b-hide-spinner"),this._step=e},get:function(){return this._step}},{key:"min",set:function(e){this._min=e,this.input&&(this.input.min=e)},get:function(){return this._min}},{key:"max",set:function(e){this._max=e,this.input&&(this.input.max=e)},get:function(){return this._max}},{key:"value",set:function(e){var n,r=this;e||0===e?("number"!=typeof e&&(e="string"==typeof e?parseFloat(e):Number(e),(n=isNaN(e))&&(e="")),n||null==r.decimalPrecision||(e=kt.round(e,r.decimalPrecision))):e=r.clearable?void 0:0;r.value!==e&&(fn()(oe()(t.prototype),"value",e,this,!0),r.leadingZeroes&&(r.input.value=r.formatValue(e.toString())))},get:function(){return se()(oe()(t.prototype),"value",this)}}],[{key:"formatValue",value:function(e,t,n){if("string"!=typeof e)return e;var r=e.split(so),i=fe()(r,2),o=i[0],a=i[1];return n&&a&&a.length>n&&(a=a.substr(0,n)),t&&o&&o.length<t&&(o=o.padStart(t,"0")),[o,a].filter((function(e){return e})).join(".")}},{key:"$name",get:function(){return"NumberField"}},{key:"defaultConfig",get:function(){return{min:null,max:null,step:1,value:0,decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},attributes:["placeholder","autoComplete","min","max","tabIndex"],changeOnSpin:!0}}}]),t}(ri);function uo(){var e=Lr()(['\n            <div class="','">\n                <input type="range"\n                   reference="input"\n                   id="','_input"\n                   min="','"\n                   max="','"\n                   step="','"\n                   value="','">\n                <label reference="label" for="','_input">',"</label>\n            </div>\n        "]);return uo=function(){return e},e}lo._$name="NumberField",X.register("numberfield",lo),X.register("number",lo);var co=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.updateLabel(),n.showTooltip&&(n.tip=new Ur({forElement:n.input,anchor:!1,align:"b-t",axisLock:!0})),n.input.addEventListener("input",n.onInternalInput.bind(n)),n.input.addEventListener("change",n.onInternalChange.bind(n)),n.input.addEventListener("mouseover",n.onInternalMouseOver.bind(n)),n.input.addEventListener("mouseout",n.onInternalMouseOut.bind(n))}},{key:"template",value:function(e){return Hr.tpl(uo(),e.text?"b-text b-has-label":"",e.id,e.min,e.max,e.step,e.value,e.id,e.text)}},{key:"onInternalInput",value:function(e){var t=this;t._value=parseInt(t.input.value),t.updateUI(),t.trigger("input",{value:t.value})}},{key:"onInternalChange",value:function(e){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}},{key:"onInternalMouseOver",value:function(e){this.updateLabel(),this.tip&&this.tip.showBy({target:this.calcThumbPosition(),offset:5})}},{key:"onInternalMouseOut",value:function(e){this.tip&&this.tip.hide()}},{key:"triggerChange",value:function(e){this.trigger("change",{value:this.value,userAction:e})}},{key:"updateLabel",value:function(){this.text=this._text}},{key:"updateTooltipPosition",value:function(){this.tip&&this.tip.alignTo({target:this.calcThumbPosition(),offset:5})}},{key:"updateUI",value:function(){this.updateLabel(),this.updateTooltipPosition()}},{key:"calcThumbPosition",value:function(){var e=this,t=Oe.from(e.input),n=(t.width-e.thumbSize)*e.calcPercentProgress()/100;return new Oe(t.x+n,t.y+t.height/2-e.thumbSize/2,e.thumbSize,e.thumbSize)}},{key:"calcPercentProgress",value:function(){return(this.value-this.min)/(this.max-this.min)*100}},{key:"focusElement",get:function(){return this.input}},{key:"text",get:function(){return this._text},set:function(e){var t=this;t._text=e,t.label&&(t.showValue&&(e=e?"".concat(e," (").concat(t.value,")"):t.value),t.label.innerHTML=e),t.tip&&(t.tip.html=t.value)}},{key:"value",get:function(){return this.input?parseInt(this.input.value):this._value},set:function(e){var t=this;t._value!==e&&(t.input&&(t.input.value=e,t.updateUI(),t.triggerChange(!1)),t._value=e)}},{key:"min",get:function(){return this.input?this.input.min:this._min},set:function(e){var t=this;t.input&&(t.input.min=e,t._value<e&&(t.value=e,t.trigger("input",{value:t.value}))),t._min=e}},{key:"max",get:function(){return this.input?this.input.max:this._max},set:function(e){var t=this;t.input&&(t.input.max=e,t._value>e&&(t.value=e,t.trigger("input",{value:t.value}))),t._max=e}},{key:"step",get:function(){return this.input?this.input.step:this._step},set:function(e){this.input&&(this.input.step=e),this._step=e}}],[{key:"$name",get:function(){return"Slider"}},{key:"defaultConfig",get:function(){return{text:"",showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:null,thumbSize:20,localizableProperties:["text"]}}}]),t}(vr);co._$name="Slider",X.register("slider",co);var ho=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"],fo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"setActiveItem",value:function(e){var t=this,n=t.owner,r=n.contentElement,i=n.items,o=e instanceof vr,a=parseInt(r.dataset.activeIndex),s=i[a],l=n.items[e=o?e=i.indexOf(e):parseInt(e)],u={prevActiveIndex:a,prevActiveItem:s};if(l&&l!==s){var c=s.element,d=l&&l.element;if(u.activeIndex=e,u.activeItem=l,t.animateDetacher){var h,f=t.animateDetacher.event;t.animateDetacher(),f.prevActiveItem.element.classList.remove(ho),(h=f.activeItem.element.classList).remove.apply(h,["b-active"].concat(ho)),t.animateDetacher=null}u.promise=new Promise((function(n,i){c&&t.animateCardChange?(c.classList.add(e>a?"b-slide-out-left":"b-slide-out-right"),d.classList.add("b-active",e<a?"b-slide-in-left":"b-slide-in-right"),l.triggerPaint(),t.animateDetacher=Ln.on({element:d,animationend:function(){var i,o;(t.animateDetacher=null,(i=d.classList).remove.apply(i,ho),c)&&(o=c.classList).remove.apply(o,["b-active"].concat(ho));r.dataset.activeIndex=e,l.focus(),n(u)},once:!0}),t.animateDetacher.reject=i,t.animateDetacher.event=u):(c&&c.classList.remove("b-active"),d.classList.add("b-active"),r.dataset.activeIndex=e,l.focus(),l.triggerPaint(),n(u))}))}return u}},{key:"renderChildren",value:function(){var e=this.owner,n=e.activeIndex;ge.isIE11&&(this.animateCardChange=!1),e.items&&null!=n&&e.items[n]&&(e.contentElement.dataset.activeIndex=n,e.items[n].element.classList.add("b-active")),se()(oe()(t.prototype),"renderChildren",this).call(this)}},{key:"activeIndex",get:function(){return parseInt(this.owner.contentElement.dataset.activeIndex)}},{key:"activeItem",get:function(){return this.owner.items[parseInt(this.owner.contentElement.dataset.activeIndex)]}}],[{key:"$name",get:function(){return"Card"}},{key:"defaultConfig",get:function(){return{containerCls:"b-card-container",itemCls:"b-card-item",animateCardChange:!0}}}]),t}(pr);function go(){var e=Lr()(['\n                <div>\n                    <div class="b-tabpanel-tabs" reference="tabStrip">\n                        ','\n                    </div>\n                    <div class="b-tabpanel-body" reference="tabPanelBody" data-activeIndex="','">\n                    </div>\n                </div>\n            ']);return go=function(){return e},e}fo._$name="Card",pr.registerLayout(fo);var vo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.items.forEach((function(e,t){e.titleElement=n.element.querySelector('div.b-tabpanel-tab[data-index="'.concat(t,'"] span'))})),Ln.on({element:n.tabStrip,delegate:".b-tabpanel-tab",click:"onTabElementClick",thisObj:n})}},{key:"onTabElementClick",value:function(e){this.activeTab=e.currentTarget.dataset.index}},{key:"tabMinWidth",set:function(e){this._tabMinWidth=e,this.element&&rn.forEachSelector(this.element,".b-tabpanel-tab",(function(t){rn.setLength(t,"minWidth",e||null)}))},get:function(){return this._tabMinWidth}},{key:"tabMaxWidth",set:function(e){this._tabMaxWidth=e,this.element&&rn.forEachSelector(this.element,".b-tabpanel-tab",(function(t){rn.setLength(t,"maxWidth",e||null)}))},get:function(){return this._tabMaxWidth}},{key:"layout",set:function(e){fn()(oe()(t.prototype),"layout",e,this,!0),this.layout.animateCardChange=this.animateTabChange},get:function(){return se()(oe()(t.prototype),"layout",this)}},{key:"contentElement",get:function(){return this.tabPanelBody}},{key:"focusElement",get:function(){var e=this.items[this.activeTab||0];return e&&e.focusElement||this.tabStrip.children[this.activeTab]}},{key:"activeTab",set:function(e){var t=this;if(t.isConfiguring)t._activeTab=e;else{var n=t.layout.setActiveItem(e),r=n.promise,i=n.activeIndex;if(n.activeItem){var o=t.tabStrip,a=o.children[t._activeTab];t._activeTab=i,a&&a.classList.remove("b-active"),o.children[i].classList.add("b-active"),r.then((function(){t.trigger("tabchange",n)}))}}},get:function(){return this._activeTab}},{key:"activeIndex",get:function(){return this.activeTab}},{key:"activeItem",get:function(){return this.layout.activeItem}}],[{key:"$name",get:function(){return"TabPanel"}},{key:"defaultConfig",get:function(){return{template:function(e){return Hr.tpl(go(),e.items.map((function(t,n){return'\n                        <div tabindex="-1" data-index="'.concat(n,'" class="b-tabpanel-tab ').concat(n===e.activeIndex?"b-active":""," ").concat(t.cls||"",'" style="').concat(e.tabMinWidth?"min-width:"+rn.setLength(e.tabMinWidth)+";":""," ").concat(e.tabMaxWidth?"max-width:"+rn.setLength(e.tabMaxWidth)+";":"",'" >\n                            <span class="b-tabpanel-tab-title">').concat(t.title,"</span>\n                        </div>\n                        ")})),e.activeIndex)},itemCls:"b-tabpanel-item",defaultType:"container",activeTab:0,tabMinWidth:null,tabMaxWidth:null,animateTabChange:!0,layout:"card",suppressChildHeaders:!0}}}]),t}(Dr);function mo(){var e=Lr()(['<input type="text"\n                readOnly="readonly"\n                reference="displayElement"\n                placeholder="','"/>']);return mo=function(){return e},e}function po(){var e=Lr()(['<textarea\n                reference="input"\n                class="','"\n                placeholder="','"\n                name="','"\n                style="resize:','"\n                id="','"></textarea>']);return po=function(){return e},e}vo._$name="TabPanel",X.register("tabpanel",vo),X.register("tabs",vo);var yo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"startConfigure",value:function(e){this._thisIsAUsedExpression(this.inline),se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"inputTemplate",value:function(){var e=this;return e.inline?Hr.tpl(po(),e.inputCls||"",e.placeholder,e.name||e.id,e.resize,e.id+"_input"):Hr.tpl(mo(),e.placeholder)}},{key:"showPicker",value:function(){this.picker.width=this.pickerWidth||this[this.pickerAlignElement].offsetWidth,se()(oe()(t.prototype),"showPicker",this).call(this,!0)}},{key:"focusPicker",value:function(){this.input.focus()}},{key:"onPickerKeyDown",value:function(e){var n=this,r=n.input;switch(e.key.trim()||e.code){case"Escape":return void n.picker.hide();case"Enter":e.ctrlKey&&(n.syncInputFieldValue(),n.picker.hide())}n.input=n.displayElement;var i=se()(oe()(t.prototype),"onPickerKeyDown",this).call(this,e);return n.input=r,i}},{key:"syncInputFieldValue",value:function(e){this.displayElement&&(this.displayElement.value=this.inputValue),se()(oe()(t.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"createPicker",value:function(e){var t=this;e.width&&(t.pickerWidth=e.width),e=new vr(kt.merge({cls:"b-textareafield-picker",owner:t,floating:!0,scrollAction:"realign",forElement:t[t.pickerAlignElement],align:{align:"t-b",axisLock:!0,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},html:'<textarea id="'.concat(t.id+"_input",'" style="resize:').concat(t.resize,'">').concat(t.value,"</textarea>"),autoShow:!1},e));var n=t.input=e.element.querySelector("#".concat(t.id,"_input"));return t.inputListenerRemover=Ln.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyPress",keypress:"internalOnKeyPress",keyup:"internalOnKeyPress"}),e}},{key:"focusElement",get:function(){return this.inline||this._picker&&this._picker.isVisible?this.input:this.displayElement}},{key:"value",set:function(e){fn()(oe()(t.prototype),"value",null==e?"":e,this,!0)},get:function(){return se()(oe()(t.prototype),"value",this)}},{key:"inline",set:function(e){this._inline=e,e||this.triggers||(this.triggers={})},get:function(){return this._inline}},{key:"triggers",set:function(e){this.inline||((e||(e={})).expand={cls:"b-icon-picker",handler:"onTriggerClick"}),fn()(oe()(t.prototype),"triggers",e,this,!0)},get:function(){return se()(oe()(t.prototype),"triggers",this)}}],[{key:"$name",get:function(){return"TextAreaField"}},{key:"defaultConfig",get:function(){return{triggers:null,inline:!0,resize:"none"}}}]),t}(Pi);yo._$name="TextAreaField",X.register("textareafield",yo),X.register("textarea",yo);var ko=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n._pm=!1,n.fieldHours.on("change",n.onFieldChange,n),n.fieldMinutes.on("change",n.onFieldChange,n),n.buttonAM.on("click",n.onButtonAMClick,n),n.buttonPM.on("click",n.onButtonPMClick,n),Ln.on({element:n.element,keydown:"onPickerKeyDown",thisObj:n}),Ln.on({element:n.fieldHours.element,keydown:"onPickerKeyDown",thisObj:n}),Ln.on({element:n.fieldMinutes.element,keydown:"onPickerKeyDown",thisObj:n}),n.refresh()}},{key:"onFieldChange",value:function(){this._time&&(this.value=this.pickerToTime())}},{key:"onButtonAMClick",value:function(){this._pm=!1,this._time&&(this.value=this.pickerToTime())}},{key:"onButtonPMClick",value:function(){this._pm=!0,this._time&&(this.value=this.pickerToTime())}},{key:"onPickerKeyDown",value:function(e){var t=this;switch(e.key&&e.key.trim()||e.code){case"Escape":t.triggerTimeChange(t._initialValue),t.hide(),e.preventDefault();break;case"Enter":t.value=t.pickerToTime(),t.hide(),e.preventDefault()}}},{key:"pickerToTime",value:function(){var e=this,t=e._pm,n=e.fieldHours.value,r=new Date(e._time);return e._is24Hour||(t&&n<12&&(n+=12),t||12!==n||(n=0)),r.setHours(n),r.setMinutes(e.fieldMinutes.value),e._min&&(r=vt.max(e._min,r)),e._max&&(r=vt.min(e._max,r)),r}},{key:"triggerTimeChange",value:function(e){this.trigger("timeChange",{time:e})}},{key:"refresh",value:function(){var e=this;if(!e.isConfiguring){var t=e._time,n=e._is24Hour,r=t.getHours(),i=e._pm=r>=12,o=e.fieldHours;e.element.classList[n?"add":"remove"]("b-24h"),o.min=n?0:1,o.max=n?23:12,o.value=n?r:r%12||12,e.fieldMinutes.value=t.getMinutes(),e.buttonAM.pressed=!i,e.buttonPM.pressed=i,e.buttonAM.hidden=e.buttonPM.hidden=n}}},{key:"value",set:function(e){var n=this,r=!1;e&&n._time?e.getTime()!==n._time.getTime()&&(n._time=e,r=!0):(n._time=t.defaultConfig.value,r=!0),r&&(n.isVisible&&n.triggerTimeChange(n.value),n.refresh())},get:function(){return this._time}},{key:"format",set:function(e){this._format=e,this._is24Hour=vt.is24HourFormat(this._format),this.refresh()},get:function(){return this._format}},{key:"min",set:function(e){this._min=e},get:function(){return this._min}},{key:"max",set:function(e){this._max=e},get:function(){return this._max}},{key:"initialValue",set:function(e){this.value=e,this._initialValue=e},get:function(){return this._initialValue}},{key:"buttonAM",get:function(){return this.widgetMap.buttonAM}},{key:"buttonPM",get:function(){return this.widgetMap.buttonPM}},{key:"fieldHours",get:function(){return this.widgetMap.fieldHours}},{key:"fieldMinutes",get:function(){return this.widgetMap.fieldMinutes}}],[{key:"$name",get:function(){return"TimePicker"}},{key:"defaultConfig",get:function(){return{items:[{type:"number",ref:"fieldHours",min:0,max:23,highlightExternalChange:!1},{html:"<label>:</label>"},{type:"number",ref:"fieldMinutes",min:0,max:59,highlightExternalChange:!1},{type:"button",text:"AM",toggleGroup:"am-pm",ref:"buttonAM",cls:"b-blue"},{type:"button",text:"PM",toggleGroup:"am-pm",ref:"buttonPM",cls:"b-blue"}],float:"1",autoShow:!1,trapFocus:!0,value:vt.getTime(0),format:null}}}]),t}(Ar);ko._$name="TimePicker",X.register("timepicker",ko);var bo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"createPicker",value:function(e){var t=this;return new ko(Object.assign({owner:t,floating:!0,forElement:t[t.pickerAlignElement],align:{align:"t0-b0",axisLock:!0,anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},value:t.value,format:t.format,onTimeChange:function(e){var n=e.time;t._isUserAction=!0,t.value=n,t._isUserAction=!1}},e))}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=vt.add(e.value,-1*e._step.magnitude,e._step.unit);(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=vt.add(e.value,e._step.magnitude,e._step.unit);(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"hasChanged",value:function(e,n){return e&&e.getTime&&n&&n.getTime?e.getTime()!==n.getTime():se()(oe()(t.prototype),"hasChanged",this).call(this,e,n)}},{key:"showPicker",value:function(e){var n=this,r=n.picker;r.initialValue=n.value,r.format=n.format,r.maxTime=n.max,r.minTime=n.min,n.value=r.value,se()(oe()(t.prototype),"showPicker",this).call(this,e)}},{key:"onPickerShow",value:function(){se()(oe()(t.prototype),"onPickerShow",this).call(this),this.pickerKeyDownRemover&&this.pickerKeyDownRemover()}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"transformTimeValue",value:function(e){return null!=e&&("Date"!==e.constructor.name&&(e="string"==typeof e?vt.parse(e,this.format):new Date(e)),e&&"Date"===e.constructor.name&&!isNaN(e.valueOf()))?((e=vt.clone(e)).setFullYear(1970,0,1),e):null}},{key:"updateLocalization",value:function(){se()(oe()(t.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}},{key:"isValid",get:function(){var e=this;e.clearError("minimumValueViolation",!0),e.clearError("maximumValueViolation",!0);var n=e.value;if(n){if(n=n.getTime(),e._min&&e._min.getTime()>n)return e.setError("minimumValueViolation",!0),!1;if(e._max&&e._max.getTime()<n)return e.setError("maximumValueViolation",!0),!1}return se()(oe()(t.prototype),"isValid",this)}},{key:"min",set:function(e){var t=this;t._min=t.transformTimeValue(e),t.input&&(t.input.min=t._min),t.updateInvalid()},get:function(){return this._min}},{key:"max",set:function(e){var t=this;t._max=t.transformTimeValue(e),t.input&&(t.input.max=t._max),t.updateInvalid()},get:function(){return this._max}},{key:"value",set:function(e){var n=this,r=n.value,i=n.transformTimeValue(e);!e||i?(n.clearError("invalidTime"),n.hasChanged(r,i)?(n.triggers.expand&&i&&(n.triggers.expand.element.firstElementChild.style.animationDelay=-(60*i.getHours()+i.getMinutes())/10+"s"),fn()(oe()(t.prototype),"value",i,this,!0)):n.inputting||n.syncInputFieldValue()):n.setError("invalidTime")},get:function(){return se()(oe()(t.prototype),"value",this)}},{key:"step",set:function(e){"number"==typeof e?e={magnitude:e,unit:this._step.unit}:"object"!==U()(e)&&(e=vt.parseDuration(e)),e&&e.magnitude&&e.unit&&(e.magnitude=Math.abs(e.magnitude),this._step=e,this.updateInvalid())},get:function(){return this._step}},{key:"format",set:function(e){this._format=e,this.syncInputFieldValue(!0)},get:function(){return this._format}},{key:"inputValue",get:function(){return vt.format(this.value,this.format)}}],[{key:"$name",get:function(){return"TimeField"}},{key:"defaultConfig",get:function(){var e=this;return{format:"LT",triggers:{back:{cls:"b-icon b-icon-angle-left",handler:"onBackClick",align:"start"},expand:{template:function(){return'<div class="b-align-'.concat(e.align||"end",'"><div class="b-icon-clock-live"></div></div>')},handler:"onTriggerClick",align:"end"},forward:{cls:"b-icon b-icon-angle-right",handler:"onForwardClick",align:"end"}},min:null,max:null,step:"5m"}}}]),t}(Pi);bo._$name="TimeField",X.register("timefield",bo),X.register("time",bo);var wo=function(){function e(){C()(this,e)}return x()(e,[{key:"createWidget",value:function(e){return X.createWidget(e.type,e)}},{key:"getClass",value:function(e){return X.getClass(e)}},{key:"appendWidget",value:function(e){return this.createWidget(e)}},{key:"appendWidgets",value:function(e,t){var n=this;return e.map((function(e){return n.appendWidget(kt.assign({},t||{},e))}))}},{key:"openPopup",value:function(e,t){return new Ar(kt.assign({forElement:e},"string"==typeof t?{html:t}:t))}},{key:"showContextMenu",value:function(e,t){var n=this;return n.currentContextMenu&&n.currentContextMenu.destroy(),e instanceof HTMLElement?t.forElement=e:Array.isArray(e)?t.forElement={target:V()(yn,G()(e))}:e instanceof yn&&(t.forElement={target:e}),n.currentContextMenu=new Wr(t),n.currentContextMenu.on("destroy",(function(){n.currentContextMenu=null})),n.currentContextMenu}},{key:"attachTooltip",value:function(e,t){return"string"==typeof t&&(t={html:t}),new Ur(Object.assign({forElement:e},t)),e}},{key:"hasTooltipAttached",value:function(e){return Ur.hasTooltipAttached(e)}},{key:"destroyTooltipAttached",value:function(e){return Ur.destroyTooltipAttached(e)}},{key:"mask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Loading";if(e)return e instanceof HTMLElement&&(e={element:e,text:t}),dn.mask(e,e.element)}},{key:"unmask",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.mask&&(t?e.mask.close():e.mask.hide())}},{key:"toast",value:function(e){return Gr.show(e)}},{key:"defaultStyle",set:function(e){this._defaultStyle=e},get:function(){return this._defaultStyle}}]),e}();te._adapter||(te.adapter=wo),wo._$name="BryntumWidgetAdapter";var So=function(){throw new Error("Abstract method call!")},Co=function(){throw new Error("Method cannot be called at this state!")},Eo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"canUndo",value:function(e){So()}},{key:"canRedo",value:function(e){So()}},{key:"onUndo",value:function(e){So()}},{key:"onRedo",value:function(e){So()}},{key:"onStartTransaction",value:function(e){So()}},{key:"onStopTransaction",value:function(e){So()}},{key:"onStopTransactionDelayed",value:function(e){So()}},{key:"onRejectTransaction",value:function(e){So()}},{key:"onEnable",value:function(e){So()}},{key:"onDisable",value:function(e){So()}},{key:"onAutoRecordOn",value:function(e){So()}},{key:"onAutoRecordOff",value:function(e){So()}},{key:"onResetQueue",value:function(e){So()}},{key:"onModelUpdate",value:function(e){So()}},{key:"onStoreModelAdd",value:function(e){So()}},{key:"onStoreModelInsert",value:function(e){So()}},{key:"onStoreModelRemove",value:function(e){So()}},{key:"onStoreModelRemoveAll",value:function(e){So()}},{key:"onModelInsertChild",value:function(e){So()}},{key:"onModelRemoveChild",value:function(e){So()}}]),t}(z);Eo._$name="StateBase";var xo=Symbol("STATE_PROP"),Do=Symbol("STORES_PROP"),To=Symbol("QUEUE_PROP"),Ro=Symbol("POS_PROP"),Mo=Symbol("TRANSACTION_PROP"),Fo=Symbol("TRANSACTION_TIMER_PROP"),_o=Symbol("AUTO_RECORD_PROP"),Ao=(Object.freeze([xo,Do,To,Ro,Mo,Fo,_o]),new Map),Io=function(e,t){Ao.set(e,t)},Lo=function(e){return"string"==typeof e&&(e=Ao.get(e)),e},Oo=function(e,t){var n,r,i=t.undo,o=t.redo;if(i&&!o)r={},$()(r,To,e[To].slice(e.position)),$()(r,Ro,0),n=r;else if(o&&!i)n=$()({},To,e[To].slice(0,e.position));else{var a;a={},$()(a,To,[]),$()(a,Ro,0),n=a}return[n,function(){e.notifyStoresAboutQueueReset(t)}]},Po=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){Co()}},{key:"onRedo",value:function(){Co()}},{key:"onEnable",value:function(e){return e.autoRecord?"autoreadystate":"readystate"}},{key:"onDisable",value:function(){Co()}},{key:"onAutoRecordOn",value:function(){return $()({},_o,!0)}},{key:"onAutoRecordOff",value:function(){return $()({},_o,!1)}},{key:"onStartTransaction",value:function(){Co()}},{key:"onStopTransaction",value:function(){Co()}},{key:"onStopTransactionDelayed",value:function(){Co()}},{key:"onRejectTransaction",value:function(){Co()}},{key:"onResetQueue",value:function(e,t){return Oo(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),t}(Eo)),Ho=Po;Io("disabledstate",Po);var No=Symbol("ACTION_QUEUE_PROP"),Bo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e;this[No]=[];for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=se()(oe()(t.prototype),"construct",this)).call.apply(e,[this].concat(r))}},{key:"addAction",value:function(e){this[No].push(e)}},{key:"undo",value:function(){for(var e=this[No],t=e.length-1;t>=0;--t)e[t].undo()}},{key:"redo",value:function(){for(var e=this[No],t=0,n=e.length;t<n;++t)e[t].redo()}},{key:"defaultConfig",get:function(){return{title:null}}},{key:"queue",get:function(){return this[No].slice(0)}},{key:"length",get:function(){return this[No].length}}]),t}(z);Bo._$name="Transaction";var zo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"canUndo",value:function(e){return 0<e.position&&e.position<=e.length}},{key:"canRedo",value:function(e){return 0<=e.position&&e.position<e.length}},{key:"onUndo",value:function(e,t){var n,r=e[To],i=e.position,o=Math.max(0,i-t);return[(n={},$()(n,xo,"restoringstate"),$()(n,Ro,o),n),function(){for(e.notifyStoresAboutStateRestoringStart();i!=o;)r[--i].undo();return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onRedo",value:function(e,t){var n,r=e[To],i=e.position,o=Math.min(r.length,i+t);return[(n={},$()(n,xo,"restoringstate"),$()(n,Ro,o),n),function(){e.notifyStoresAboutStateRestoringStart();do{r[i++].redo()}while(i!=o);return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onEnable",value:function(){Co()}},{key:"onDisable",value:function(){return"disabledstate"}},{key:"onAutoRecordOn",value:function(){var e;return e={},$()(e,xo,"autoreadystate"),$()(e,_o,!0),e}},{key:"onAutoRecordOff",value:function(){Co()}},{key:"onStartTransaction",value:function(e,t){var n,r=new Bo({title:t});return[(n={},$()(n,xo,"recordingstate"),$()(n,Mo,r),n),function(){e.notifyStoresAboutStateRecordingStart(r)}]}},{key:"onStopTransaction",value:function(){Co()}},{key:"onStopTransactionDelayed",value:function(){Co()}},{key:"onRejectTransaction",value:function(){Co()}},{key:"onResetQueue",value:function(e,t){return Oo(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),t}(Eo),jo=new zo,Vo=jo;Io("readystate",jo);var Wo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onEnable",value:function(){}},{key:"onDisable",value:function(e){var t,n=e[Mo];return e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},$()(t,xo,"disabledstate"),$()(t,Mo,null),t}},{key:"onAutoRecordOn",value:function(e){var t;return[(t={},$()(t,xo,"autorecordingstate"),$()(t,_o,!0),t),function(){e[xo].onStopTransactionDelayed(e)}]}},{key:"onAutoRecordOff",value:function(){Co()}},{key:"onStartTransaction",value:function(){Co()}},{key:"onStopTransaction",value:function(e,t){var n,r=e[Mo],i=e[Ro],o=e[To];return r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),o[i]=r,o.length=++i),[(n={},$()(n,xo,"readystate"),$()(n,Ro,i),$()(n,Mo,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onRejectTransaction",value:function(e){var t,n=e[Mo];return[(t={},$()(t,xo,"restoringstate"),$()(t,Mo,null),t),function(){return n.length&&n.undo(),["readystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onStopTransactionDelayed",value:function(){Co()}},{key:"onQueueReset",value:function(){Co()}},{key:"onModelUpdate",value:function(e,t,n,r){e[Mo].addAction(e.makeModelUpdateAction(t,n,r))}},{key:"onModelInsertChild",value:function(e,t,n,r,i,o){e[Mo].addAction(e.makeModelInsertChildAction(t,n,r,i,o))}},{key:"onModelRemoveChild",value:function(e,t,n,r){e[Mo].addAction(e.makeModelRemoveChildAction(t,n,r))}},{key:"onStoreModelAdd",value:function(e,t,n,r){e[Mo].addAction(e.makeStoreModelAddAction(t,n,r))}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e[Mo].addAction(e.makeStoreModelInsertAction(t,n,r,i,o))}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e[Mo].addAction(e.makeStoreModelRemoveAction(t,n,r,i))}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e[Mo].addAction(e.makeStoreRemoveAllAction(t,n,r))}}]),t}(Eo),Go=new Wo,Yo=Go;Io("recordingstate",Go);var Uo=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){Co()}},{key:"onRedo",value:function(){Co()}},{key:"onEnable",value:function(){Co()}},{key:"onDisable",value:function(){Co()}},{key:"onAutoRecordOn",value:function(){return $()({},_o,!0)}},{key:"onAutoRecordOff",value:function(){return $()({},_o,!1)}},{key:"onStartTransaction",value:function(){Co()}},{key:"onStopTransaction",value:function(){Co()}},{key:"onStopTransactionDelayed",value:function(){Co()}},{key:"onRejectTransaction",value:function(){Co()}},{key:"onQueueReset",value:function(){Co()}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),t}(Eo)),qo=Uo;Io("restoringstate",Uo);var $o=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onAutoRecordOn",value:function(){Co()}},{key:"onAutoRecordOff",value:function(){var e;return e={},$()(e,xo,"readystate"),$()(e,_o,!1),e}},{key:"onStartTransaction",value:function(e,t){var n,r=new Bo({title:t});return[(n={},$()(n,xo,"autorecordingstate"),$()(n,Mo,r),n),function(){e.notifyStoresAboutStateRecordingStart(r),e.stopTransactionDelayed()}]}},{key:"onModelUpdate",value:function(e,t,n,r){e.startTransaction(),e.onModelUpdate(t,n,r)}},{key:"onModelInsertChild",value:function(e,t,n,r,i){e.startTransaction(),e.onModelInsertChild(t,n,r,i)}},{key:"onModelRemoveChild",value:function(e,t,n,r){e.startTransaction(),e.onModelRemoveChild(t,n,r)}},{key:"onStoreModelAdd",value:function(e,t,n,r){e.startTransaction(),e.onStoreModelAdd(t,n,r)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e.startTransaction(),e.onStoreModelInsert(t,n,r,o)}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e.startTransaction(),e.onStoreModelRemove(t,n,r,i)}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e.startTransaction(),e.onStoreRemoveAll(t,n,r)}}]),t}(zo)),Xo=$o;Io("autoreadystate",$o);var Ko=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onDisable",value:function(e){var t,n=e[Mo],r=e[Fo];return r&&this.clearTimeout(r),e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},$()(t,xo,"disabledstate"),$()(t,Mo,null),$()(t,Fo,null),t}},{key:"onAutoRecordOn",value:function(e){Co()}},{key:"onAutoRecordOff",value:function(e){var t,n=e[Fo];return n&&this.clearTimeout(n),t={},$()(t,xo,"recordingstate"),$()(t,_o,!1),$()(t,Fo,null),t}},{key:"onStopTransaction",value:function(e,t){var n,r=e[Mo],i=e[Fo],o=e[Ro],a=e[To];return i&&this.clearTimeout(i),r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),a[o]=r,a.length=++o),[(n={},$()(n,xo,"autoreadystate"),$()(n,Ro,o),$()(n,Mo,null),$()(n,Fo,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onStopTransactionDelayed",value:function(e){var t,n=e[Fo];return n&&this.clearTimeout(n),n=this.setTimeout((function(){e.stopTransaction()}),e.autoRecordTransactionStopTimeout),t={},$()(t,xo,Ko),$()(t,Fo,n),t}},{key:"onRejectTransaction",value:function(e){var t,n=e[Mo],r=e[Fo];return r&&this.clearTimeout(r),[(t={},$()(t,xo,"restoringstate"),$()(t,Mo,null),$()(t,Fo,null),t),function(){return n.length&&n.undo(),["autoreadystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onModelUpdate",value:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=se()(oe()(t.prototype),"onModelUpdate",this)).call.apply(n,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelInsertChild",value:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=se()(oe()(t.prototype),"onModelInsertChild",this)).call.apply(n,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelRemoveChild",value:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=se()(oe()(t.prototype),"onModelRemoveChild",this)).call.apply(n,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelAdd",value:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=se()(oe()(t.prototype),"onStoreModelAdd",this)).call.apply(n,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelInsert",value:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=se()(oe()(t.prototype),"onStoreModelInsert",this)).call.apply(n,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelRemove",value:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=se()(oe()(t.prototype),"onStoreModelRemove",this)).call.apply(n,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreRemoveAll",value:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=se()(oe()(t.prototype),"onStoreRemoveAll",this)).call.apply(n,[this,e].concat(i)),e.stopTransactionDelayed()}}]),t}(de(Wo))),Jo=Ko;Io("autorecordingstate",Ko);var Qo=function(){throw new Error("Abstract method call!")},Zo=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){Qo()}},{key:"redo",value:function(){Qo()}},{key:"type",get:function(){return this.constructor.name}}]),t}(z);Zo._$name="ActionBase";var ea=Symbol("MODEL_PROP"),ta=Symbol("NEW_DATA_PROP"),na=Symbol("OLD_DATA_PROP"),ra=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){this.model.set(this.oldData)}},{key:"redo",value:function(){this.model.set(this.newData)}},{key:"type",get:function(){return"UpdateAction"}},{key:"model",get:function(){return this[ea]},set:function(e){this[ea]=e}},{key:"newData",get:function(){return this[ta]},set:function(e){this[ta]=Object.assign({},e)}},{key:"oldData",get:function(){return this[na]},set:function(e){this[na]=Object.assign({},e)}}],[{key:"defaultConfig",get:function(){return{model:void 0,newData:void 0,oldData:void 0}}}]),t}(Zo);ra._$name="UpdateAction";var ia=Symbol("PARENT_MODEL_PROP"),oa=Symbol("CHILD_MODELS_PROP"),aa=Symbol("INSERT_INDEX_PROP"),sa=Symbol("CONTEXT_PROP"),la=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){var r=t.get(e)||{},i=r.lhsParent,o=r.lhsIndex,a=t.get(n)||{},s=a.rhsParent,l=a.rhsIndex;return i&&i===s?o-l:0})),n.forEach((function(n){var r=t.get(n)||{},i=r.parent,o=r.index;i?i===e?i.insertChild(n,i.children[o+1]):i.insertChild(n,i.children[o]):e.removeChild(n)}))}},{key:"redo",value:function(){this.parentModel.insertChild(this.insertIndex,this.childModels)}},{key:"type",get:function(){return"InsertChildAction"}},{key:"parentModel",get:function(){return this[ia]},set:function(e){this[ia]=e}},{key:"childModels",get:function(){return this[oa]},set:function(e){this[oa]=e.slice(0)}},{key:"insertIndex",get:function(){return this[aa]},set:function(e){this[aa]=e}},{key:"context",get:function(){return this[sa]},set:function(e){this[sa]=e}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,insertIndex:void 0,context:void 0}}}]),t}(Zo);la._$name="InsertChildAction";var ua=Symbol("PARENT_MODEL_PROP"),ca=Symbol("CHILD_MODELS_PROP"),da=Symbol("CONTEXT_PROP"),ha=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){e.insertChild(t.get(n),n)}))}},{key:"redo",value:function(){this.parentModel.removeChild(this.childModels)}},{key:"type",get:function(){return"RemoveChildAction"}},{key:"parentModel",get:function(){return this[ua]},set:function(e){this[ua]=e}},{key:"childModels",get:function(){return this[ca]},set:function(e){this[ca]=e.slice(0)}},{key:"context",get:function(){return this[da]},set:function(e){this[da]=e}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,context:void 0}}}]),t}(Zo);ha._$name="RemoveChildAction";var fa=Symbol("STORE_PROP"),ga=Symbol("MODEL_LIST_PROP"),va=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){this.store.remove(this.modelList,this.silent)}},{key:"redo",value:function(){this.store.add(this.modelList,this.silent)}},{key:"type",get:function(){return"AddAction"}},{key:"store",get:function(){return this[fa]},set:function(e){this[fa]=e}},{key:"modelList",get:function(){return this[ga]},set:function(e){this[ga]=e.slice(0)}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,silent:!1}}}]),t}(Zo);va._$name="AddAction";var ma=Symbol("STORE_PROP"),pa=Symbol("MODEL_LIST_PROP"),ya=Symbol("INSERT_INDEX_PROP"),ka=Symbol("CONTEXT_PROP"),ba=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){var e=this.store,t=this.modelList,n=this.context,r=this.silent;t.sort((function(e,t){var r=n.get(e),i=n.get(t);return void 0!==r&&void 0!==i?r-i:0})),t.forEach((function(t){var i=n.get(t);void 0!==i?e.insert(i,t,r):e.remove(t,r)}))}},{key:"redo",value:function(){this.store.insert(this.insertIndex,this.modelList,this.silent)}},{key:"type",get:function(){return"InsertAction"}},{key:"store",get:function(){return this[ma]},set:function(e){this[ma]=e}},{key:"modelList",get:function(){return this[pa]},set:function(e){this[pa]=e.slice(0)}},{key:"insertIndex",get:function(){return this[ya]},set:function(e){this[ya]=e}},{key:"context",get:function(){return this[ka]},set:function(e){this[ka]=e}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,insertIndex:void 0,context:void 0,silent:!1}}}]),t}(Zo);ba._$name="InsertAction";var wa=Symbol("STORE_PROP"),Sa=Symbol("MODEL_LIST_PROP"),Ca=Symbol("CONTEXT_PROP"),Ea=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){var e=this.store,t=this.context,n=this.modelList,r=this.silent;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){var i=t.get(n);e.insert(i,n,r)}))}},{key:"redo",value:function(){this.store.remove(this.modelList,this.silent)}},{key:"type",get:function(){return"RemoveAction"}},{key:"store",get:function(){return this[wa]},set:function(e){this[wa]=e}},{key:"modelList",get:function(){return this[Sa]},set:function(e){this[Sa]=e.slice(0)}},{key:"context",get:function(){return this[Ca]},set:function(e){this[Ca]=e}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,context:void 0,silent:!1}}}]),t}(Zo);Ea._$name="RemoveAction";var xa=Symbol("STORE_PROP"),Da=Symbol("ALL_RECORDS_PROP"),Ta=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"undo",value:function(){var e=this.store,t=this.allRecords,n=this.silent;e.add(t,n)}},{key:"redo",value:function(){this.store.removeAll(this.silent)}},{key:"type",get:function(){return"RemoveAllAction"}},{key:"store",get:function(){return this[xa]},set:function(e){this[xa]=e}},{key:"allRecords",get:function(){return this[Da]},set:function(e){this[Da]=e.slice(0)}}],[{key:"defaultConfig",get:function(){return{store:void 0,allRecords:void 0,silent:!1}}}]),t}(Zo);Ta._$name="RemoveAllAction";var Ra=function(e,t,n){return new ra({model:e,newData:t,oldData:n})},Ma=function(e,t,n,r){return new la({parentModel:e,childModels:n,insertIndex:t,context:r})},Fa=function(e,t,n){return new ha({parentModel:e,childModels:t,context:n})},_a=function(e,t,n){return new va({store:e,modelList:t,silent:n})},Aa=function(e,t,n,r,i){return new ba({store:e,insertIndex:t,modelList:n,context:r,silent:i})},Ia=function(e,t,n,r){return new Ea({store:e,modelList:t,context:n,silent:r})},La=function(e,t,n){return new Ta({store:e,allRecords:t,silent:n})},Oa=function e(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var a=n.call.apply(n,[t[xo],t].concat(i));if("string"==typeof a)t[xo]=Lo(a);else if(a instanceof Eo)t[xo]=a;else if(Array.isArray(a)){var s=fe()(a,2),l=s[0],u=s[1];"string"==typeof l?t[xo]=Lo(l):l instanceof Eo?t[xo]=l:l&&"object"===U()(l)&&((t=Object.assign(t,l))[xo]=Lo(t[xo])),"function"==typeof u&&e.apply(void 0,[t,u].concat(i))}else a&&"object"===U()(a)&&((t=Object.assign(t,a))[xo]=Lo(t[xo]))},Pa=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e,n,r=this;Object.assign(r,(e={},$()(e,xo,Vo),$()(e,Do,[]),$()(e,To,[]),$()(e,Ro,0),$()(e,Mo,null),$()(e,Fo,null),$()(e,_o,!1),e));for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];(n=se()(oe()(t.prototype),"construct",this)).call.apply(n,[this].concat(o))}},{key:"doDestroy",value:function(){se()(oe()(t.prototype),"doDestroy",this).call(this),this.destroyProperties(xo)}},{key:"hasStore",value:function(e){return this[Do].includes(e)}},{key:"addStore",value:function(e){this.hasStore(e)||(this[Do].push(e),e.stm=this)}},{key:"removeStore",value:function(e){this.hasStore(e)&&(this[Do]=this[Do].filter((function(t){return t!==e})),e.stm=null)}},{key:"getStoreById",value:function(e){return this[Do].find((function(t){return t.id===e}))}},{key:"forEachStore",value:function(e){this[Do].forEach((function(t){return e(t,t.id)}))}},{key:"enable",value:function(){this.disabled=!1}},{key:"disable",value:function(){this.disabled=!0}},{key:"startTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Oa(this,this.state.onStartTransaction,e)}},{key:"stopTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Oa(this,this.state.onStopTransaction,e)}},{key:"stopTransactionDelayed",value:function(){Oa(this,this.state.onStopTransactionDelayed)}},{key:"rejectTransaction",value:function(){Oa(this,this.state.onRejectTransaction)}},{key:"undo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Oa(this,this.state.onUndo,e)}},{key:"undoAll",value:function(){this.undo(this.length)}},{key:"redo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Oa(this,this.state.onRedo,e)}},{key:"redoAll",value:function(){this.redo(this.length)}},{key:"resetQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{undo:!0,redo:!0};Oa(this,this.state.onResetQueue,e)}},{key:"resetUndoQueue",value:function(){this.resetQueue({undo:!0})}},{key:"resetRedoQueue",value:function(){this.resetQueue({redo:!0})}},{key:"notifyStoresAboutStateRecordingStart",value:function(e){var t=this;this.forEachStore((function(n){n.onStmRecordingStart&&n.onStmRecordingStart(t,e)})),this.trigger("recordingStart",{stm:this,transaction:e})}},{key:"notifyStoresAboutStateRecordingStop",value:function(e,t){var n=this;this.forEachStore((function(r){r.onStmRecordingStop&&r.onStmRecordingStop(n,e,t)})),this.trigger("recordingStop",{stm:this,transaction:e,reason:t})}},{key:"notifyStoresAboutStateRestoringStart",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStart&&t.onStmRestoringStart(e)})),this.trigger("restoringStart",{stm:this})}},{key:"notifyStoresAboutStateRestoringStop",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStop&&t.onStmRestoringStop(e)})),this.trigger("restoringStop",{stm:this})}},{key:"notifyStoresAboutQueueReset",value:function(e){var t=this;this.forEachStore((function(n){n.onStmQueueReset&&n.onStmQueueReset(t,e)})),this.trigger("queueReset",{stm:this,options:e})}},{key:"onModelUpdate",value:function(e,t,n){Oa(this,this.state.onModelUpdate,e,t,n)}},{key:"onModelInsertChild",value:function(e,t,n,r){Oa(this,this.state.onModelInsertChild,e,t,n,r)}},{key:"onModelRemoveChild",value:function(e,t,n){Oa(this,this.state.onModelRemoveChild,e,t,n)}},{key:"onStoreModelAdd",value:function(e,t,n){Oa(this,this.state.onStoreModelAdd,e,t,n)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i){Oa(this,this.state.onStoreModelInsert,e,t,n,r,i)}},{key:"onStoreModelRemove",value:function(e,t,n,r){Oa(this,this.state.onStoreModelRemove,e,t,n,r)}},{key:"onStoreRemoveAll",value:function(e,t,n){Oa(this,this.state.onStoreRemoveAll,e,t,n)}},{key:"state",get:function(){return this[xo]}},{key:"position",get:function(){return this[Ro]}},{key:"length",get:function(){return this[To].length}},{key:"stores",get:function(){return Array.from(this[Do])}},{key:"disabled",get:function(){return this.state===Ho},set:function(e){var t=this;t.disabled!=e&&Oa(t,e?t.state.onDisable:t.state.onEnable,t)}},{key:"isReady",get:function(){return this.state===Vo||this.state===Xo}},{key:"isRecording",get:function(){return this.state===Yo||this.state===Jo}},{key:"autoRecord",get:function(){return this[_o]},set:function(e){var t=this;t.autoRecord!=e&&Oa(t,e?t.state.onAutoRecordOn:t.state.onAutoRecordOff,t)}},{key:"transaction",get:function(){return this[Mo]}},{key:"queue",get:function(){return this[To].map((function(e){return e.title}))}},{key:"isRestoring",get:function(){return this.state===qo}},{key:"canUndo",get:function(){return this.state.canUndo(this)}},{key:"canRedo",get:function(){return this.state.canRedo(this)}}],[{key:"defaultConfig",get:function(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:Ra,makeModelInsertChildAction:Ma,makeModelRemoveChildAction:Fa,makeStoreModelAddAction:_a,makeStoreModelInsertAction:Aa,makeStoreModelRemoveAction:Ia,makeStoreRemoveAllAction:La,getTransactionTitle:null}}}]),t}(ze(z));Pa._$name="StateTrackingManager";var Ha=function(){function e(){C()(this,e)}return x()(e,null,[{key:"insertRule",value:function(e){var t=this.styleSheet,n=t.cssRules.length;if(t.insertRule(e,0),t.cssRules.length>n)return t.cssRules[0]}},{key:"findRule",value:function(e){var t,n="function"==typeof e;return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),(function(r){if(t=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,(function(t){return n?e(t):t.selectorText===e})))return!0})),t}},{key:"styleSheet",get:function(){return this._stylesheet||(this._stylesheet=rn.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:document.head}).sheet),this._stylesheet}}]),e}();Ha._$name="CSSHelper";var Na={pageXOffset:0,pageYOffset:0},Ba="onMouseDown",za="onMouseMove",ja="onMouseUp",Va="onDocumentClick",Wa="onTouchStart",Ga="onTouchMove",Ya="onTouchEnd",Ua="onKeyDown",qa=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.initListeners(),"container"===n.mode?n.initContainerDrag():n.mode.startsWith("translate")&&(n.lockY?n.mode="translateX":n.lockX&&(n.mode="translateY"),n.initTranslateDrag())}},{key:"doDestroy",value:function(){this.abort(!0),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"initListeners",value:function(){var e={element:this.outerElement,mousedown:Ba,thisObj:this};ge.isTouchDevice&&(e.touchstart=Wa),Ln.on(e)}},{key:"onPointerDown",value:function(e){var t=this,n=!1,r="touches"in e;if(t.context)t.context.awaitingFinalization||(t.onMouseUp(e),t.reset());else if(t.startEvent=e,(!t.isElementDraggable||t.isElementDraggable(e.target,e))&&(t.mode&&(n||"container"!==t.mode||(n=t.grabContainerDrag(e)),!n&&t.mode.startsWith("translate")&&(n=t.grabTranslateDrag(e))),n)){var i={element:document,thisObj:t,keydown:Ua};if(r?(i.touchmove={handler:Ga,passive:!1},i.touchend=i.pointerup=Ya):(i.mousemove=za,i.mouseup=ja),t.removeListeners=Ln.on(i),t.dragWithin&&t.dragWithin!==t.outerElement){var o=t.dragWithin.getBoundingClientRect();t.minY=o.top,t.maxY=o.bottom,t.minX=o.left,t.maxX=o.right}}}},{key:"onTouchStart",value:function(e){var t=this;1===e.touches.length&&(t.touchStartTimer=t.setTimeout((function(){t.touchStartTimer=null}),t.touchStartDelay),t.onPointerDown(e))}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(e)}},{key:"internalMove",value:function(e){var t=this,n=t.context,r=Ln.getDistanceBetween(t.startEvent,e);if(t.touchStartTimer&&r>t.dragThreshold)t.abort(!0);else if(!t.touchStartTimer&&n&&n.element&&e.target.nodeType===Node.ELEMENT_NODE&&(n.started||r>=t.dragThreshold)){if(!n.started&&!1===t.callPreventable("dragStart",{context:n,event:e},(function(){var r=t.lockX?"vertical":t.lockY?"horizontal":"both";n.action.startsWith("translate")?t.startTranslateDrag(e):"container"===n.action&&t.startContainerDrag(e),n.started=!0,t.scrollManager&&t.scrollManager.startMonitoring({direction:r,element:t.dragWithin||t.outerElement,callback:function(e){t.context.element&&t.lastMouseMoveEvent&&(t.lastMouseMoveEvent.isScroll=!0,t.update(t.lastMouseMoveEvent,e))},thisObj:t}),document.body.classList.add("b-draghelper-active")})))return t.abort();"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.update(e)}}},{key:"onTouchMove",value:function(e){this.internalMove(e)}},{key:"onMouseMove",value:function(e){this.internalMove(e)}},{key:"update",value:function(e,t){var n=this,r=n.context,i=r.dragProxy||r.element,o=e.target,a=document.scrollingElement||document.body;if("touchmove"===e.type){var s=e.changedTouches[0];o=rn.elementFromPoint(s.clientX+a.scrollLeft,s.clientY+a.scrollTop)}r.target=o,n.dropTargetSelector?r.valid=Boolean(o.closest(n.dropTargetSelector)):r.valid=!0,r.action&&("container"===r.action&&n.updateContainerProxy(e,t),r.action.startsWith("translate")&&n.updateTranslateProxy(e,t)),n.trigger("drag",{context:r,event:e}),"container"===r.action&&n.updateContainerDrag(e,t),i.classList[r.valid?"remove":"add"](n.invalidCls),e&&(n.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.context;t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),n&&(n.element.getBoundingClientRect(),n.valid=!1,"container"===n.action?t.abortContainerDrag(void 0,void 0,e):t.abortTranslateDrag(void 0,void 0,e)),t.reset()}},{key:"removeListeners",value:function(){}},{key:"reset",value:function(e){document.body.classList.remove("b-draghelper-active"),this.removeListeners(),e||this.trigger("reset"),this.context=this.lastMouseMoveEvent=null}},{key:"onTouchEnd",value:function(e){this.onMouseUp(e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onMouseUp",value:function(e){var t=this,n=t.context;t.removeListeners(),n&&(t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),"container"===n.action?t.finishContainerDrag(e):n.started&&n.action.startsWith("translate")&&t.finishTranslateDrag(e),n.started?Ln.on({element:document,thisObj:t,click:Va,capture:!0,expires:50,once:!0}):t.reset(!0))}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"createProxy",value:function(e){var t=e.cloneNode(!0);return t.removeAttribute("id"),t}}],[{key:"defaultConfig",get:function(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:null,isElementDraggable:null,targetSelector:null,dropTargetSelector:null,cloneTarget:!1,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,transitionDuration:300,ignoreSamePositionDrop:!0}}}]),t}(pi(z).mixes(ze,(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"initContainerDrag",value:function(){if(this.mode||(this.mode="container"),"container"===this.mode&&!this.containers)throw new Error("Container drag mode must specify containers")}},{key:"grabContainerDrag",value:function(e){var t=this;if(!t.ignoreSelector||!rn.up(e.target,t.ignoreSelector)){var n=rn.getAncestor(e.target,t.containers,t.outerElement);if(n){var r=n.getBoundingClientRect();t.context={element:n,valid:!0,action:"container",offsetX:e.pageX-r.left,offsetY:e.pageY-r.top,originalPosition:{parent:n.parentElement,prev:n.previousElementSibling,next:n.nextElementSibling}}}return!0}return!1}},{key:"startContainerDrag",value:function(e){var t=this.context,n=t.element,r=n.cloneNode(!0),i=n.getBoundingClientRect();r.classList.add(this.dragProxyCls),r.classList.add(this.draggingCls),document.body.appendChild(r),t.dragProxy=r,r.style.width=i.width+"px",r.style.height=i.height+"px",rn.setTranslateXY(t.dragProxy,i.left,i.top),t.dragging=n,n.classList.add(this.dropPlaceholderCls)}},{key:"updateContainerDrag",value:function(e){var t=this.context;if(t.started&&t.targetElement){var n=rn.getAncestor(t.targetElement,this.containers,"b-grid"),r=t.dragging&&t.dragging.contains(document.activeElement);n&&rn.isDescendant(t.element,n)||(r&&ir.suspendFocusEvents(),n&&t.valid?this.moveNextTo(n,e):this.revertPosition(),r&&ir.resumeFocusEvents(),e.preventDefault())}}},{key:"finishContainerDrag",value:function(e){var t=this,n=this,r=n.context,i=r.dragging,o=r.dragProxy,a=r.valid,s=r.draggedTo,l=r.insertBefore,u=r.originalPosition;i&&(r.valid=a&&s&&(i!==l||u.parent!==s),r.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.valid;!e&&t.context&&n.revertPosition(),i.classList.remove(n.dropPlaceholderCls),o.remove(),n.reset()},r.async=!1,n.trigger("drop",{context:r,event:e}),r.async?r.awaitingFinalization=!0:r.finalize())}},{key:"abortContainerDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context;i.dragging&&(i.dragging.classList.remove(r.dropPlaceholderCls),i.dragProxy.remove(),r.context={}),n||r.trigger(e?"drop":"abort",{context:i,event:t})}},{key:"updateContainerProxy",value:function(e){var t,n=this,r=n.context,i=r.dragProxy,o=e.pageX-r.offsetX,a=e.pageY-r.offsetY;if("number"==typeof n.minX&&(o=Math.max(n.minX,o)),"number"==typeof n.maxX&&(o=Math.min(n.maxX-i.offsetWidth,o)),"number"==typeof n.minY&&(a=Math.max(n.minY,a)),"number"==typeof n.maxY&&(a=Math.min(n.maxY-i.offsetHeight,a)),n.lockX?rn.setTranslateY(i,a):n.lockY?rn.setTranslateX(i,o):rn.setTranslateXY(i,o,a),"touchmove"===e.type){var s=e.changedTouches[0];t=document.elementFromPoint(s.clientX,s.clientY)}else t=e.target;r.targetElement=t}},{key:"moveNextTo",value:function(e,t){var n=this.context,r=n.dragging,i=e.parentElement;if(e!==r){var o=e.getBoundingClientRect().left+e.offsetWidth/2;t.pageX<o?(i.insertBefore(r,e),n.insertBefore=e):e.nextElementSibling?e.nextElementSibling!==r?(n.insertBefore=e.nextElementSibling,i.insertBefore(r,e.nextElementSibling)):n.insertBefore||r.parentElement.lastElementChild===r||(n.insertBefore=e.nextElementSibling):(i.appendChild(r),n.insertBefore=null),n.draggedTo=i}}},{key:"revertPosition",value:function(){var e=this.context,t=e.originalPosition;t.next?t.next&&t.next.previousSibling===e.dragging||!t.next&&e.dragging===t.parent.lastChild||t.parent.insertBefore(e.dragging,t.next):t.parent.appendChild(e.dragging);e.draggedTo=null}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"initTranslateDrag",value:function(){var e=this;!e.isElementDraggable&&e.targetSelector&&(e.isElementDraggable=function(t){return rn.up(t,e.targetSelector)})}},{key:"grabTranslateDrag",value:function(e){var t=this.getTarget(e);return!!t&&(this.context={valid:!0,action:this.mode,element:t,startPageX:e.pageX,startPageY:e.pageY,startClientX:e.clientX,startClientY:e.clientY},!0)}},{key:"getTarget",value:function(e){return rn.up(e.target,this.targetSelector)}},{key:"startTranslateDrag",value:function(e){var t=this,n=t.context,r=n.relatedElements,i=n.dragProxy||n.element;if(i&&!n.started){var o=i,a=i.parentElement,s=t.dragWithin=t.dragWithin||t.cloneTarget&&document.body,l=t.outerElement;if(t.cloneTarget){var u=rn.getOffsetX(i,s),c=rn.getOffsetY(i,s),d=i.offsetWidth,h=i.offsetHeight;i=this.createProxy(i),rn.setTranslateXY(i,u,c),i.style.width="".concat(d,"px"),i.style.height="".concat(h,"px"),i.classList.add(t.dragProxyCls),s.appendChild(i),o.classList.add("b-drag-original"),t.hideOriginalElement&&o.classList.add("b-hidden")}Object.assign(t.context,{element:i,grabbed:o,grabbedParent:a,grabbedNextSibling:i.nextElementSibling,elementStartX:rn.getTranslateX(i),elementStartY:rn.getTranslateY(i),elementX:rn.getOffsetX(i,s||l),elementY:rn.getOffsetY(i,s||l),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!t.cloneTarget||s===l}),i.classList.add(t.draggingCls),s&&(n.parentElement=i.parentElement,s!==i.parentElement&&s.appendChild(i),t.updateTranslateProxy(e)),r&&r.forEach((function(e){e.classList.add(t.draggingCls)}))}}},{key:"applyConstraints",value:function(e,t,n){var r=this,i=r.dragWithin,o=i===document.body?window:Na,a=o.pageXOffset,s=o.pageYOffset;return i&&r.constrain&&(t<0&&(t=0),t+e.offsetWidth>i.scrollWidth&&(t=i.scrollWidth-e.offsetWidth),n<0&&(n=0),n+e.offsetHeight>i.scrollHeight&&(n=i.scrollHeight-e.offsetHeight)),"number"==typeof r.minX&&(t=Math.max(r.minX+a,t)),"number"==typeof r.maxX&&(t=Math.min(r.maxX+a,t)),"number"==typeof r.minY&&(n=Math.max(r.minY+s,n)),"number"==typeof r.maxY&&(n=Math.min(r.maxY+s,n)),{constrainedX:t,constrainedY:n}}},{key:"updateTranslateProxy",value:function(e,t){var n=this,r=n.mode,i=n.lockX,o=n.lockY,a=n.context,s=a.dragProxy||a.element,l=a.relatedElements,u=a.relatedElDragFromPos;a.scrollManagerElementContainsDragProxy&&t&&(a.scrollX=t.scrollRelativeLeft,a.scrollY=t.scrollRelativeTop),a.pageX=e.pageX,a.pageY=e.pageY,a.clientX=e.clientX,a.clientY=e.clientY;var c=a.elementStartX+e.pageX-a.startPageX+a.scrollX,d=a.elementStartY+e.pageY-a.startPageY+a.scrollY,h=n.applyConstraints(s,c,d),f=h.constrainedX,g=h.constrainedY;if("translateXY"!==r||i||o?"translateX"===r||o?rn.setTranslateX(s,f):("translateY"===r||i)&&rn.setTranslateY(s,g):rn.setTranslateXY(s,f,g),l){var v=i||"translateY"===r?0:f-a.elementStartX,m=o||"translateX"===r?0:g-a.elementStartY;l.forEach((function(e,t){var n=fe()(u[t],2),r=n[0],i=n[1];rn.setTranslateXY(e,r+v,i+m)}))}a.newX=f,a.newY=g}},{key:"finishTranslateDrag",value:function(e){var t=this,n=t.context,r=n.newX!==n.elementStartX,i=n.newY!==n.elementStartY,o=n.dragProxy||n.element,a=n.relatedElements;function s(){o.classList.remove(t.invalidCls),o.classList.remove(t.draggingCls),a&&a.forEach((function(e){e.classList.remove(t.invalidCls),e.classList.remove(t.draggingCls)})),o.classList.contains("b-aborting")||(t.hideOriginalElement&&n.grabbed.classList.remove("b-hidden"),n.grabbed.classList.remove("b-drag-original"))}if(!t.ignoreSamePositionDrop||"translateY"!==t.mode&&r||"translateX"!==t.mode&&i){if(!1===n.valid)t.abortTranslateDrag(!0,e);else{var l=Oe.from(t.dragWithin||t.outerElement);!t.minX&&e.pageX<l.left||!t.maxX&&e.pageX>l.right||!t.minY&&e.pageY<l.top||!t.maxY&&e.pageY>l.bottom?(n.valid=!1,t.abortTranslateDrag(!0,e)):(n.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.valid;n.asyncCleanup&&s(),!e&&t.context?t.abortTranslateDrag(!0,null,!0):(t.cloneTarget||n.dragProxy)&&o.remove(),t.reset()},n.async=!1,t.trigger("drop",{context:n,event:e}),n.async?n.awaitingFinalization=!0:n.finalize())}n.asyncCleanup||s()}else t.abortTranslateDrag(!1,e)}},{key:"abortTranslateDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context,o=i.relatedElements,a=i.relatedElStartPos,s=i.grabbed,l=i.dragProxy||i.element,u=r.cloneTarget&&r.hideOriginalElement?s:l,c=i.elementStartX,d=i.elementStartY;if(l&&i.started){if(!r.cloneTarget&&r.dragWithin&&r.dragWithin!==i.grabbedParent&&i.grabbedParent.insertBefore(l,i.grabbedNextSibling),s.classList.remove("b-hidden"),r.cloneTarget){if(r.hideOriginalElement){var h=rn.getTranslateXY(s),f=fe()(h,2);c=f[0],d=f[1],rn.alignTo(s,l),u.getBoundingClientRect()}l.remove()}u.classList.add("b-aborting"),"translateXY"!==r.mode||r.lockX||r.lockY||(rn.setTranslateXY(u,c,d),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),rn.setTranslateXY(e,a[t][0],a[t][1])}))),("translateX"===r.mode||r.lockY)&&(rn.setTranslateX(u,c),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),rn.setTranslateX(e,a[t][0])}))),("translateY"===r.mode||r.lockX)&&(rn.setTranslateY(u,d),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),rn.setTranslateY(e,a[t][1])}))),r.setTimeout((function(){u.classList.remove("b-aborting"),s.classList.remove("b-dragging"),s.classList.remove("b-drag-original"),r.cloneTarget||(o&&o.forEach((function(e,t){e.classList.remove("b-aborting")})),l.classList.remove("b-aborting"),l.classList.remove(r.draggingCls),l.classList.remove(r.invalidCls))}),r.transitionDuration,void 0,!0),n||r.trigger(e?"drop":"abort",{context:i,event:t})}r.reset()}}]),t}(de(e||z))})));qa._$name="DragHelper";var $a=Array.prototype.slice,Xa={ignore:{_element:1,parent:1,elementData:1,ns:1},evaluate:function(e,t,n){if("html"===e&&"string"!=typeof t.value&&"compareHtml"in t.object)return t.object.compareHtml===n.object.compareHtml}},Ka={tag:1,html:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,_element:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,isReleased:1},Ja={class:1,className:1,classname:1},Qa=Object.freeze([]),Za=function(){function e(){C()(this,e)}return x()(e,null,[{key:"sync",value:function(e){return this.performSync(e,e.targetElement),e.targetElement}},{key:"performSync",value:function(e,t){var n=e.domConfig,r=e.callback;return(e.configEquality?e.configEquality(n,t.lastDomConfig,Xa):kt.isDeeplyEqual(n,t.lastDomConfig,Xa))?(this.relinkElements(n,t),r&&r({action:"none",domConfig:n,targetElement:t}),!1):(n?(n.onlyChildren||(this.syncAttributes(n,t),this.syncContent(n,t)),this.syncChildren(e,t),n._element=t):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=n,!0)}},{key:"relinkElements",value:function(e,t){var n=this;e._element=t,e.children&&e.children.forEach((function(e,r){e&&"string"!=typeof e&&n.relinkElements(e,t.lastDomConfig.children[r]._element)}))}},{key:"syncDataset",value:function(e,t){for(var n=t.lastDomConfig,r=e===n,i=Object.keys(e.dataset),o=n&&n.dataset&&Object.keys(n.dataset),a=He.delta(i,o),s=0;s<a.onlyInA.length;s++){var l=a.onlyInA[s];t.setAttribute("data-".concat(A.hyphenate(l)),e.dataset[l])}for(var u=0;u<a.inBoth.length;u++){var c=a.inBoth[u];(r||e.dataset[c]!=n.dataset[c])&&t.setAttribute("data-".concat(A.hyphenate(c)),e.dataset[c])}for(var d=0;d<a.onlyInB.length;d++)t.removeAttribute("data-".concat(A.hyphenate(a.onlyInB[d])))}},{key:"syncClassList",value:function(e,t){var n=e.className||e.class,r="object"===U()(n)?kt.getTruthyKeys(n).join(" "):n;t.setAttribute("class",r)}},{key:"getSyncAttributes",value:function(e){var t={},n=[];return e&&Object.keys(e).forEach((function(r){if(!Ka[r]){var i=r.toLowerCase();t[i]=e[r],n.push(i)}})),{attributes:t,names:n}}},{key:"syncAttributes",value:function(e,t){for(var n=t.lastDomConfig,r=e===n,i=this.getSyncAttributes(e),o=i.attributes,a=i.names,s=r?i:this.getSyncAttributes(n),l=s.attributes,u=s.names,c=r?{onlyInA:Qa,onlyInB:Qa,inBoth:a}:He.delta(a,u),d=c.onlyInA,h=c.onlyInB,f=c.inBoth,g=0;g<d.length;g++){var v=d[g],m=o[v];"style"===v?rn.applyStyle(t,m,!0):"dataset"===v?this.syncDataset(e,t):Ja[v]?this.syncClassList(e,t):t.setAttribute(v,m)}for(var p=0;p<h.length;p++)t.removeAttribute(h[p]);for(var y=0;y<f.length;y++){var k=f[y],b=o[k],w=l[k];null==b?t.removeAttribute(k):"style"===k?!r&&kt.isEqual(b,w,!0)||rn.applyStyle(t,b,!0):"dataset"===k?this.syncDataset(e,t):Ja[k]?this.syncClassList(e,t):(r||b!==w)&&t.setAttribute(k,b)}}},{key:"syncContent",value:function(e,t){var n=e.html;e.elementData&&(t.elementData=e.elementData),null!=n&&(n instanceof DocumentFragment?1===t.childNodes.length&&0===t.childElementCount&&1===n.childNodes.length&&0===n.childElementCount?rn.setInnerText(t,n.firstChild.data):(t.innerHTML="",t.appendChild(n)):String(n).includes("<")?t.innerHTML=n:rn.setInnerText(t,n))}},{key:"appendTextNode",value:function(e,t,n){var r=document.createTextNode(e);t.appendChild(r),n&&n({action:"newNode",domConfig:e,targetElement:r})}},{key:"insertElement",value:function(e,t,n,r,i){var o=i.ns?document.createElementNS(i.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(o,n),this.performSync(i,o),null!=r&&(t.syncIdMap[r]=o),i.callback&&i.callback({action:"newElement",domConfig:e,targetElement:o,syncId:r})}},{key:"syncChildren",value:function(e,t){var n=e.domConfig,r=e.syncIdField,i=e.callback,o=e.releaseThreshold,a=e.configEquality,s=e.ns;if(!n.html){var l,u=$a.call(n.children||[]),c=$a.call(t.childNodes),d=t.syncIdMap||{},h=n.syncOptions||{};r=h.syncIdField||r,i=h.callback||i,a=h.configEquality||a,o="releaseThreshold"in h?h.releaseThreshold:o,r&&(t.syncIdMap={});for(var f={syncIdField:r,releaseThreshold:o,callback:i,configEquality:a};u.length;){var g=u.shift();if(l=null,g){var v="string"==typeof g;if(f.domConfig=g,f.ns=g.ns||s,!v){if(r&&g.dataset&&null!=(l=g.dataset[r])&&!g.unmatched){var m=d[l];m?(!g.retainElement&&this.performSync(f,m)&&i&&i({action:"reuseOwnElement",domConfig:g,targetElement:m,syncId:l}),g.retainElement?(m.retainElement=!0,g._element=m):m.retainElement&&(m.retainElement=!1),t.syncIdMap[l]=m,He.remove(c,m),m.isReleased=!1):(u.push(g),g.unmatched=!0);continue}g.unmatched&&delete g.unmatched}for(var p=void 0,y=0;y<c.length&&!p;y++)c[y].retainElement||(p=c[y],0===y?c.shift():c.splice(y,1));if(p)if(p.nodeType===Node.ELEMENT_NODE&&(g.tag||"div").toLowerCase()===p.tagName.toLowerCase()){var k=p.lastDomConfig,b=this.performSync(f,p);null!=l&&(t.syncIdMap[l]=p),p.isReleased=!1,b&&i&&i({action:"reuseElement",domConfig:g,lastDomConfig:k,targetElement:p,syncId:l})}else v&&p.nodeType===Node.TEXT_NODE?p.data=g:(v?this.appendTextNode(g,t,i):this.insertElement(g,t,p,l,f),p.remove());else v?this.appendTextNode(g,t,i):this.insertElement(g,t,null,l,f)}}var w=0;c.forEach((function(e){var n=e.lastDomConfig;e.retainElement?r&&e.lastDomConfig&&(t.syncIdMap[e.dataset[r]]=e):r&&(null==o||w<o)?(e.isReleased||(e.className="b-released",e.isReleased=!0,i&&i({action:"releaseElement",domConfig:n,lastDomConfig:n,targetElement:e}),n&&(n.isReleased=!0,n.className&&(n.className="b-released")),e.elementData=e.lastConfig=null),w++):(e.remove(),i&&i({action:"removeElement",domConfig:e.lastDomConfig,lastDomConfig:e.lastDomConfig,targetElement:e}))}))}}}]),e}();Za._$name="DomSync";var es="onMouseDown",ts="onMouseMove",ns="onMouseUp",rs="onDocumentClick",is="onTouchStart",os="onTouchMove",as="onTouchEnd",ss="onKeyDown",ls=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),!n.handleSelector&&ge.isTouchDevice&&(n.handleSize=n.touchHandleSize),n.handleVisibilityThreshold=n.handleVisibilityThreshold||2*n.handleSize,n.initListeners(),n.initResize()}},{key:"doDestroy",value:function(){this.abort(!0),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"initResize",value:function(){var e=this;if(!e.isElementResizable&&e.targetSelector&&(e.isElementResizable=function(t){return rn.up(t,e.targetSelector)}),e.grab){var t=e.grab,n=t.edge,r=t.element,i=t.event;e.startEvent=i,e.context={element:r,edge:n,valid:!0,async:!1,elementStartX:rn.getTranslateX(r)||r.offsetLeft,elementStartY:rn.getTranslateY(r)||r.offsetTop,newX:rn.getTranslateX(r)||r.offsetLeft,newY:rn.getTranslateY(r)||r.offsetTop,elementWidth:r.offsetWidth,elementHeight:r.offsetHeight,startX:i.clientX+e.scrollLeft,startY:i.clientY+e.scrollTop,started:!0,finalize:function(){return e.reset&&e.reset()}},r.classList.add(e.resizingCls),e.internalStartResize(e.isTouch)}}},{key:"initListeners",value:function(){var e=this,t={element:e.outerElement,mousedown:es,thisObj:e};ge.isTouchDevice?t.touchstart=is:e.handleSelector||(t.mousemove={handler:ts,delegate:e.targetSelector},t.mouseleave={handler:"onMouseLeaveTarget",delegate:e.targetSelector,capture:!0}),e.removeListeners=Ln.on(t)}},{key:"removeListeners",value:function(){}},{key:"internalStartResize",value:function(e){var t=this,n={element:document,keydown:ss,thisObj:t};e?(n.touchmove=os,n.touchend=n.pointerup=as):(n.mousemove=ts,n.mouseup=ns),t.removeDragListeners=Ln.on(n),t.scrollManager&&t.scrollManager.startMonitoring({direction:t.direction,element:t.dragWithin||t.outerElement,callback:function(e){return t.context&&t.context.element&&t.lastMouseMoveEvent&&t.update(t.lastMouseMoveEvent,e)},thisObj:t})}},{key:"removeDragListeners",value:function(){}},{key:"reset",value:function(){this.removeDragListeners(),this.context=null}},{key:"onPointerDown",value:function(e,t){var n=this;n.startEvent=t,n.isElementResizable&&!n.isElementResizable(t.target,t)||n.grabResizeHandle(e,t)&&(t.stopImmediatePropagation(),n.internalStartResize(e))}},{key:"onTouchStart",value:function(e){e.touches.length>1||this.onPointerDown(!0,e)}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(!1,e)}},{key:"internalMove",value:function(e,t){var n=this,r=n.context;r&&r.element&&(r.started||Ln.getDistanceBetween(n.startEvent,t)>=n.dragThreshold)?(r.started||(n.trigger("resizeStart",{context:r,event:t}),r.started=!0),n.update(t)):e||n.handleSelector||n.checkResizeHandles(t)}},{key:"onTouchMove",value:function(e){this.internalMove(!0,e)}},{key:"onMouseMove",value:function(e){this.internalMove(!1,e)}},{key:"internalEnd",value:function(e,t){var n=this,r=n.context;n.removeDragListeners(),r&&(n.scrollManager&&n.scrollManager.stopMonitoring(n.dragWithin||n.outerElement),n.finishResize(t),!n.context||ge.isFirefox||ge.isSafari||Ln.on({element:document,thisObj:n,click:rs,capture:!0,once:!0}))}},{key:"onTouchEnd",value:function(e){this.internalEnd(!0,e)}},{key:"onMouseUp",value:function(e){this.internalEnd(!1,e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"update",value:function(e){var t=this,n=t.context,r=Oe.from(t.outerElement.parentElement);n.currentX=Math.max(Math.min(e.clientX,r.right-1),r.x)+t.scrollLeft,n.currentY=Math.max(Math.min(e.clientY,r.bottom-1),r.y)+t.scrollTop,t.updateResize(e),t.trigger("resizing",{context:n,event:e}),n.element.classList[!1===n.valid?"add":"remove"](t.invalidCls),e&&(t.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),t.context&&t.abortResize(null,e)}},{key:"grabResizeHandle",value:function(e,t){var n=this;if(n.allowResize&&!n.allowResize(t.target,t))return!1;var r=n.handleSelector,i="touchstart"===t.type?t.changedTouches[0]:t,o=i.clientX,a=i.clientY,s=n.targetSelector?rn.up(t.target,n.targetSelector):t.target;if(s){var l;if(r){if(!t.target.matches(r))return!1;l="horizontal"===n.direction?t.pageX<rn.getPageX(s)+s.offsetWidth/2?"left":"right":t.pageY<rn.getPageY(s)+s.offsetHeight/2?"top":"bottom"}else if("horizontal"===n.direction?n.overLeftHandle(t,s)?l="left":n.overRightHandle(t,s)&&(l="right"):n.overTopHandle(t,s)?l="top":n.overBottomHandle(t,s)&&(l="bottom"),!l)return n.context=null,!1;if("touchstart"===t.type&&t.preventDefault(),!1!==n.trigger("beforeResizeStart",{element:s,event:t}))return n.context={element:s,edge:l,valid:!0,async:!1,direction:n.direction,isTouch:e,elementStartX:rn.getTranslateX(s)||s.offsetLeft,elementStartY:rn.getTranslateY(s)||s.offsetTop,newX:rn.getTranslateX(s)||s.offsetLeft,newY:rn.getTranslateY(s)||s.offsetTop,elementWidth:s.offsetWidth,elementHeight:s.offsetHeight,startX:o+n.scrollLeft,startY:a+n.scrollTop,finalize:function(){return n.reset&&n.reset()}},s.classList.add(n.resizingCls),!0}return!1}},{key:"checkResizeHandles",value:function(e){var t=this,n=t.targetSelector?rn.up(e.target,t.targetSelector):e.target;if(!n||t.allowResize&&!t.allowResize(e.target,e))t.currentElement&&t.unHighlightHandle();else if(t.currentElement=t.handleContainerSelector?rn.up(e.target,t.handleContainerSelector):e.target,t.currentElement){("horizontal"===t.direction?t.overLeftHandle(e,n)||t.overRightHandle(e,n):t.overTopHandle(e,n)||t.overBottomHandle(e,n))?t.highlightHandle():t.unHighlightHandle()}}},{key:"onMouseLeaveTarget",value:function(e){var t=this;t.currentElement=t.handleContainerSelector?rn.up(e.target,t.handleContainerSelector):e.target,t.currentElement&&t.unHighlightHandle()}},{key:"updateResize",value:function(e){var t=this,n=t.context;t.allowEdgeSwitch&&("horizontal"===t.direction?n.edge=n.currentX>n.startX?"right":"left":n.edge=n.currentY>n.startY?"bottom":"top");var r=n.currentX-n.startX,i=n.currentY-n.startY,o=rn.getExtremalSizePX(n.element,"minWidth")||t.minWidth,a=rn.getExtremalSizePX(n.element,"maxWidth")||t.maxWidth,s=rn.getExtremalSizePX(n.element,"minHeight")||t.minHeight,l=rn.getExtremalSizePX(n.element,"maxHeight")||t.maxHeight,u="right"===n.edge||"bottom"===n.edge?1:-1,c=n.elementWidth+r*u,d=Math.max(o,c),h=n.elementHeight+i*u,f=Math.max(s,h);a>0&&(d=Math.min(d,a)),l>0&&(f=Math.min(f,l)),n.element.style.flex&&(n.element.style.flex=""),"horizontal"===t.direction?(n.element.style.width=Math.abs(d)+"px",n.newWidth=d,"left"===n.edge||d<0?(n.newX=Math.max(Math.min(n.elementStartX+n.elementWidth-t.minWidth,n.elementStartX+r),0),t.skipTranslate||rn.setTranslateX(n.element,n.newX)):"right"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&rn.setTranslateX(n.element,n.elementStartX)):(n.element.style.height=Math.abs(f)+"px",n.newHeight=f,"top"===n.edge||f<0?(n.newY=Math.max(Math.min(n.elementStartY+n.elementHeight-t.minHeight,n.elementStartY+i),0),t.skipTranslate||rn.setTranslateY(n.element,n.newY)):"bottom"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&rn.setTranslateY(n.element,n.elementStartY))}},{key:"finishResize",value:function(e){var t=this.context,n={context:t,event:e};t.element.classList.remove(this.resizingCls);var r=!1;r="horizontal"===this.direction?t.newWidth&&t.newWidth!==t.elementWidth:t.newHeight&&t.newHeight!==t.elementHeight,this.trigger(r?"resize":"cancel",n),t.async||t.finalize()}},{key:"abortResize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.context;r.element.classList.remove(n.resizingCls),"horizontal"===n.direction?(rn.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(rn.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!t&&n.trigger("cancel",{context:r,event:e}),n.isDestroyed||n.reset()}},{key:"highlightHandle",value:function(){var e=this,t=e.targetSelector?rn.up(e.currentElement,e.targetSelector):e.currentElement;e.currentElement.classList.add("b-resize-handle"),t.classList.add("b-over-resize-handle")}},{key:"unHighlightHandle",value:function(){var e=this,t=e.targetSelector?rn.up(e.currentElement,e.targetSelector):e.currentElement;t&&t.classList.remove("b-over-resize-handle"),e.currentElement.classList.remove("b-resize-handle"),e.currentElement=null}},{key:"overAnyHandle",value:function(e,t){return this.overStartHandle(e,t)||this.overEndHandle(e,t)}},{key:"overStartHandle",value:function(e,t){return"horizontal"===this.direction?this.overLeftHandle(e,t):this.overTopHandle(e,t)}},{key:"overEndHandle",value:function(e,t){return"horizontal"===this.direction?this.overRightHandle(e,t):this.overBottomHandle(e,t)}},{key:"getDynamicHandleSize",value:function(e,t){var n=e?2:1,r=this.handleSize;return this.dynamicHandleSize&&r*n>t-this.reservedSpace?Math.max((t-this.reservedSpace)/n,1):r}},{key:"overLeftHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.leftHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Oe.from(t);return i.width=n.getDynamicHandleSize(n.rightHandle,r),i.contains(Ln.getPagePoint(e))}return!1}},{key:"overRightHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.rightHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Oe.from(t);return i.x=i.right-n.getDynamicHandleSize(n.leftHandle,r),i.contains(Ln.getPagePoint(e))}return!1}},{key:"overTopHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.topHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Oe.from(t);return i.height=n.getDynamicHandleSize(n.bottomHandle,r),i.contains(Ln.getPagePoint(e))}return!1}},{key:"overBottomHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.bottomHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Oe.from(t);return i.y=i.bottom-n.getDynamicHandleSize(n.bottomHandle,r),i.contains(Ln.getPagePoint(e))}return!1}},{key:"scrollLeft",get:function(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}},{key:"scrollTop",get:function(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}}],[{key:"defaultConfig",get:function(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal"}}}]),t}(ze(z));ls._$name="ResizeHelper";var us=function(){function e(){C()(this,e),this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}return x()(e,[{key:"nextRandom",value:function(e){var t,n=this.randomCache;return n[e]?t=n[e]:(t=this.random100.filter((function(t){return t<e})),n[e]=t),t[this.rndIndex++%t.length]}},{key:"reset",value:function(){this.rndIndex=0}},{key:"fromArray",value:function(e){return e[this.nextRandom(e.length)]}}]),e}();us._$name="RandomGenerator";var cs=function(){function e(){C()(this,e)}return x()(e,null,[{key:"reset",value:function(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}},{key:"generate",value:Ei.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,d,h,f,g,v,m,p,y,k,b,w,S=arguments;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=S.length>1&&void 0!==S[1]&&S[1],r=S.length>2&&void 0!==S[2]?S[2]:1,o=(i=this).rnd,a=i.rndTime,s=i.rndRating,l=i.firstNames,u=i.surNames,c=i.teams,d=i.foods,h=i.colors,f=i.cities,g=0;case 4:if(!(g<t)){e.next=12;break}return v=o.fromArray(l),m=o.fromArray(u),p="".concat(v," ").concat(String.fromCharCode(65+g%25)," ").concat(m),y=o.nextRandom(60)+1,k=new Date(2019,0,y),b=new Date(2019,0,y+o.nextRandom(30)+2),w={id:g+r,title:"Row "+g,name:p,firstName:v,surName:m,city:o.fromArray(f),team:o.fromArray(f)+" "+o.fromArray(c),age:10+o.nextRandom(80),food:o.fromArray(d),color:o.fromArray(h),score:10*o.nextRandom(100),rank:o.nextRandom(100)+1,start:k,finish:b,time:vt.getTime(a.nextRandom(24),5*a.nextRandom(12)),percent:o.nextRandom(100),done:o.nextRandom(100)<50,rating:s.nextRandom(5),relatedTo:Math.min(t-1,g+r+o.nextRandom(10))},n&&(w.rowHeight=5*o.nextRandom(!0===n?20:n)+20),e.next=9,w;case 9:g++,e.next=4;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"generateData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&this.reset();for(var o=[],a=e.overrideRowCount?e.overrideRowCount:t,s=this.generate(a,n,r),l=0;l<a;l++)o.push(s.next().value);return o}}]),e}();Object.assign(cs,{rnd:new us,rndTime:new us,rndRating:new us,cities:["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"],firstNames:["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"],surNames:["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"],teams:["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"],foods:["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"],colors:["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"]}),cs._$name="DataGenerator";var ds=["action","target","to","deltaX","deltaY","x","y","text"],hs=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e);var n=this;n.widget&&(n.outerElement=n.widget.element,n.widget.playingDemo=!0),Ln.playingDemo=!0,Object.assign(n,{prevTarget:null,currentStep:0,mouse:rn.createElement({parent:n.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),n.intervalId=n.setInterval(n.nextStep.bind(n),1e3),n.outerElement.classList.add("b-playing-demo"),n.outerElement.addEventListener("click",(function(e){e.isTrusted&&n.abort()}))}},{key:"doDestroy",value:function(){this.abort()}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.mouse.style.top="-100px",t.clearInterval(t.intervalId),t.timeoutId&&t.clearTimeout(t.timeoutId),t.innerIntervalId&&t.clearInterval(t.innerIntervalId),t.outerElement.classList.remove("b-playing-demo"),t.widget&&(t.widget.playingDemo=!1),Ln.playingDemo=!1,t.trigger(e?"done":"abort")}},{key:"triggerEvent",value:function(e,t,n){if(!e)return null;var r;if(t.startsWith("mouse")){var i=this.mouse.getBoundingClientRect();r=new MouseEvent(t,Object.assign({view:window,bubbles:!0,cancelable:!0,clientX:i.left,clientY:i.top},n||{}))}else(r=document.createEvent("Event")).initEvent(t,!0,!1);return e.dispatchEvent(r),r}},{key:"handleMouseMove",value:function(e,t){var n=this,r=n.mouse;r.classList.add("quick"),n.mouseDown&&r.classList.add("drag");var i=Oe.from(r,n.outerElement),o=i.x,a=i.y,s=0,l=0;if(e.to)if("string"==typeof e.to){var u=n.outerElement.querySelector(e.to);if(u){var c=Oe.from(u,n.outerElement),d=c.x+c.width/2,h=c.y+c.height/2;s=(d-o)/10,l=(h-a)/10}}else e.to.x?s=(e.to.x-o)/10:(s=e.to[0]/10,l=e.to[1]/10);else e.deltaX?s=e.deltaX/10:e.x&&(s=(e.x-o)/10);e.deltaY&&(l=e.deltaY/10);var f=0;n.innerIntervalId=n.setInterval((function(){if(!n.shouldPause){9==f++&&(clearInterval(n.innerIntervalId),e.then&&e.then());var t=o+s*f,i=a+l*f;r.style.left=t+"px",r.style.top=i+"px";var u=r.getBoundingClientRect(),c=u.left,d=u.top,h=document.elementFromPoint(c,d);h!==n.prevTarget&&(n.prevTarget&&(n.mouseOutElements.push(n.prevTarget),rn.isDescendant(n.mouseOutElements[0],h)||(n.mouseOutElements.forEach((function(e){return n.triggerEvent(e,"mouseout")})),n.mouseOutElements.length=0)),n.prevTarget=h,n.triggerEvent(h,"mouseover")),n.triggerEvent(h,e.action,{clientX:c,clientY:d})}}),50)}},{key:"getTarget",value:function(e){var t=e.target;return t?"function"==typeof t?t(e):document.querySelector(t):this.prevTarget||this.outerElement}},{key:"normalizeStep",value:function(e){if(e.action)return"function"==typeof e.action?e.action(e):e;if("function"==typeof e)return e(),e;for(var t in e)e.hasOwnProperty(t)&&!ds.includes(t)&&(e.action=t.toLowerCase(),e.to=e[t]);return e.target||"string"!=typeof e.to&&"function"!=typeof e.to||(e.target=e.to),e}},{key:"nextStep",value:function(){var e=this;if(!e.shouldPause){if(e.currentStep===e.steps.length){if(!e.repeat)return e.abort(!0);e.currentStep=0}0===e.currentStep&&e.trigger("initialize");var t=e.mouse,n=e.normalizeStep(e.steps[e.currentStep++]),r=e.getTarget(n),i=n.action;if(r&&i)if(t.className="simulated-mouse","mousemove"===i)e.handleMouseMove(n,r);else{if(r!==e.prevTarget){var o=Oe.from(r,e.outerElement);t.style.left=o.x+o.width/2+"px",t.style.top=o.y+o.height/2+"px"}"mousedown"===i&&(e.mouseDown=!0),"mouseup"===i&&(e.mouseDown=!1),e.timeoutId=e.setTimeout((function(){if(e.prevTarget=r,t.classList.add(i),"type"===i){var o=Z.fromElement(r),a=n.text.split("|");o.value=a[1===a.length||o.value!=a[0]?0:1]}else e.triggerEvent(r,i)}),"type"===i?100:550)}}}},{key:"isScrolling",get:function(){var e=this.outerElement.getBoundingClientRect(),t=this.lastTop&&e.top!==this.lastTop;return this.lastTop=e.top,t}},{key:"isInView",get:function(){var e=this.outerElement.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>0}},{key:"shouldPause",get:function(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}}],[{key:"defaultConfig",get:function(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}}]),t}(ze(de()));hs._$name="DemoBot";var fs=function(){function e(){C()(this,e)}return x()(e,null,[{key:"init",value:function(){var e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=function(t){return e.map((function(e){var n=t+A.capitalizeFirstLetter(e);return"moz"===t&&(n=n.replace("screen","Screen"),"mozCancelFullScreen"in document&&"exitFullscreen"===e&&(n="mozCancelFullScreen")),n}))};this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];var n=["fullscreenchange","fullscreenerror"],r=function(e){return n.map((function(t){return e+A.capitalizeFirstLetter(t)}))};this.events="fullscreenEnabled"in document&&n||"webkitFullscreenEnabled"in document&&r("webkit")||"mozFullscreenEnabled"in document&&r("moz")||"msFullscreenEnabled"in document&&["MSFullscreenChange","MSFullscreenError"]||[]}},{key:"request",value:function(e){return e[this.functions[1]](e)}},{key:"exit",value:function(){return document[this.functions[2]]()}},{key:"onFullscreenChange",value:function(e){document.addEventListener(this.events[0],e)}},{key:"unFullscreenChange",value:function(e){document.removeEventListener(this.events[0],e)}},{key:"enabled",get:function(){return document[this.functions[0]]}},{key:"isFullscreen",get:function(){return!!document[this.functions[3]]}}]),e}();fs.init(),fs._$name="Fullscreen";var gs={constructor:1,prototype:1,name:1,length:1,arguments:1,caller:1,callee:1,__proto__:1},vs=function(){function e(){C()(this,e)}return x()(e,null,[{key:"apply",value:function(e){if(!e.target)throw new Error("Override must specify what it overrides, using static getter target");if(!e.target.class)throw new Error("Override must specify which class it overrides, using target.class");if(!this.shouldApplyOverride(e))return!1;var t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(e.prototype);return t.splice(t.indexOf("target"),1),this.internalOverrideAll(e.target.class,t,e),this.internalOverrideAll(e.target.class.prototype,n,e.prototype),!0}},{key:"internalOverrideAll",value:function(e,t,n){var r=this;Reflect.ownKeys(n).forEach((function(i){if(t.includes(i)&&!gs[i]){for(var o=Object.getOwnPropertyDescriptor(n,i),a=e,s=null;!s&&a;)(s=Object.getOwnPropertyDescriptor(a,i))||(a=Object.getPrototypeOf(a));s&&r.internalOverride(a,i,o,s)}}))}},{key:"internalOverride",value:function(e,t,n,r){(e._overridden=e._overridden||{})[t]=e[t],r.get?Object.defineProperty(e,t,{enumerable:!1,configurable:!0,get:n.get}):e[t]=n.value}},{key:"shouldApplyOverride",value:function(e){var t=e.target;if(!t.maxVersion&&!t.minVersion)return!0;if(!t.product)throw new Error("Override must specify product when using versioning");return(!t.maxVersion||!I[t.product].isNewerThan(t.maxVersion))&&(!t.minVersion||!I[t.product].isOlderThan(t.minVersion))}}]),e}();vs._$name="Override";var ms=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"store",get:function(){return this._store||(this.store=new Fi({data:[{id:this.positiveValue,text:this.positiveText||this.L("Yes")},{id:this.negativeValue,text:this.negativeText||this.L("No")}]})),this._store},set:function(e){fn()(oe()(t.prototype),"store",e,this,!0)}}],[{key:"$name",get:function(){return"BooleanCombo"}},{key:"type",get:function(){return"booleancombo"}},{key:"defaultConfig",get:function(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,value:!1}}}]),t}(Ve(qi));function ps(){var e=Lr()(['\n            <input\n             type="file"\n             reference="input"\n             id="','_input"\n             class="','"\n             ','\n             accept="','"\n            />\n        ']);return ps=function(){return e},e}ms._$name="BooleanCombo",X.register(ms.type,ms);var ys=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"inputTemplate",value:function(){return Hr.tpl(ps(),this.id,this.inputCls||"",this.multiple?"multiple":"",this.accept||"")}},{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.input=n.element.querySelector("input"),Ln.on({element:n.input,change:n.onFileInputChange,thisObj:n})}},{key:"pickFile",value:function(){this.input.click()}},{key:"clear",value:function(){this.input.value=null}},{key:"onFileInputChange",value:function(){var e=this.input.value,t=this.oldValue;this.trigger("change",{value:e,oldValue:t,userAction:!0,valid:!0}),this.oldValue=e}},{key:"oldValue",get:function(){return this._oldValue},set:function(e){this._oldValue=e}},{key:"files",get:function(){return this.input.files}}],[{key:"$name",get:function(){return"FileField"}},{key:"defaultConfig",get:function(){return{multiple:!1,accept:null}}}]),t}(ri);ys._$name="FileField",X.register("filefield",ys);var ks=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;e.items=[Object.assign({type:"button",ref:"fileButton",text:"File"},e.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},e.fileFieldConfig)].concat(e.items||[]),se()(oe()(t.prototype),"construct",this).call(this,e),n.button.on({click:n.onButtonClick,thisObj:n}),n.fileField.on({change:n.onFileFieldChange,thisObj:n}),n._thisIsAUsedExpression(n.fileTip)}},{key:"clear",value:function(){this.fileField.clear(),this.button.badge="",this.trigger("clear")}},{key:"onButtonClick",value:function(e){var t=e.event;this.fileField.pickFile(),t.preventDefault()}},{key:"onFileFieldChange",value:function(){this.button.badge=this.files.length||"",this.trigger("change",{files:this.files})}},{key:"button",get:function(){return this.widgetMap.fileButton}},{key:"fileField",get:function(){return this.widgetMap.fileField}},{key:"files",get:function(){return this.fileField.files}},{key:"fileTip",get:function(){var e=this;return e._fileTip||(e._fileTip=new Ur({cls:"b-file-tip",forElement:e.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",listeners:{beforeshow:function(){var t=e.files;return!(!t||!t.length)&&(this.html="".concat(Array.from(t).map((function(e){return e.name})).join("<br>")),!0)}}}))}}],[{key:"$name",get:function(){return"FilePicker"}},{key:"defaultConfig",get:function(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}}]),t}(Dr);ks._$name="FilePicker",X.register("filepicker",ks);var bs=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"value",get:function(){return this.checked},set:function(e){e=Boolean(e),fn()(oe()(t.prototype),"value",e,this,!0),this.inputting||(this.checked=e)}}],[{key:"$name",get:function(){return"FlagField"}},{key:"type",get:function(){return"flagfield"}},{key:"defaultConfig",get:function(){return{value:""}}}]),t}(oi);bs._$name="FlagField",X.register(bs.type,bs);var ws=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"focusElement",get:function(){}},{key:"readOnly",set:function(e){},get:function(){return!0}}],[{key:"$name",get:function(){return"DisplayField"}},{key:"defaultConfig",get:function(){return{readOnly:!0,editable:!1,cls:"b-display-field"}}}]),t}(Oi);ws._$name="DisplayField",X.register("display",ws),X.register("displayfield",ws);var Ss=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"valueToVisible",value:function(e,t){if(!isNaN(e)){var n=parseFloat(e);if(!isNaN(n)){var r=null!=this.decimalPrecision?kt.round(n,this.decimalPrecision):n;return String(n==r?n:r)+" "+vt[this.useAbbreviation?"getShortNameOfUnit":"getLocalizedNameOfUnit"](t||this.unit,1!==e)}}return""}},{key:"parseDuration",value:function(e){if(null==e)return null;var t=this.decimalPrecision,n=vt.parseDuration(e,this.allowDecimals,this.unit);return n?(n.unit=n.unit||this.unit,null!=t&&(n.magnitude=kt.round(n.magnitude,t)),n):null}},{key:"internalOnChange",value:function(e){var t=this,n=t.value,r=t._lastValue;t.hasChanged(r,n)&&(t._lastValue=n,t.trigger("change",{value:n,event:e,userAction:!0,valid:t.isValid}))}},{key:"onFocusOut",value:function(e){return this.syncInputFieldValue(!0),se()(oe()(t.prototype),"onFocusOut",this).call(this,e)}},{key:"hasChanged",value:function(e,t){return t&&!e||!t&&e||t&&e&&(t.magnitude!=e.magnitude||t.unit!=e.unit)}},{key:"onInternalKeyDown",value:function(e){"ArrowUp"===e.key?this.doSpinUp():"ArrowDown"===e.key&&this.doSpinDown()}},{key:"doSpinUp",value:function(){var e=this,t=e.value;e._isUserAction=!0,e.value={unit:t.unit,magnitude:(t.magnitude||0)+e.step},e._isUserAction=!1}},{key:"doSpinDown",value:function(){var e=this,t=e.value;(e.allowNegative||t.magnitude>0)&&(e._isUserAction=!0,e.value={unit:t.unit,magnitude:(t.magnitude||0)-e.step},e._isUserAction=!1)}},{key:"inputValue",get:function(){var e=this.value;return null==e?"":this.valueToVisible(e.magnitude,e.unit)}},{key:"unit",set:function(e){this.value={magnitude:se()(oe()(t.prototype),"value",this),unit:e}},get:function(){return this._unit}},{key:"allowDecimals",get:function(){return 0!==this.decimalPrecision}},{key:"isValid",get:function(){var e=this;return null==e.value&&e.clearable&&!e.required||null!=e.value&&(e.allowNegative||e.value.magnitude>=0)}},{key:"value",set:function(e){var n=this,r=n.decimalPrecision;"number"==typeof e?(null!=r&&(e=kt.round(e,r)),e={magnitude:e,unit:n._unit}):"object"!==U()(e)&&(e=n.parseDuration(e)),n.value!==e&&(e?(n._unit=e.unit,fn()(oe()(t.prototype),"value",e,this,!0)):(n._unit=n.clearable?null:0,fn()(oe()(t.prototype),"value",n.clearable?null:0,this,!0)))},get:function(){return se()(oe()(t.prototype),"value",this)}},{key:"milliseconds",get:function(){var e=this.value;return vt.asMilliseconds(e.magnitude,e.unit)}}],[{key:"$name",get:function(){return"DurationField"}},{key:"defaultConfig",get:function(){return{value:null,step:1,unit:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}}}}}]),t}(Oi);Ss._$name="DurationField",X.register("durationfield",Ss),X.register("duration",Ss);var Cs=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n;return ue()(t,e),x()(t,[{key:"confirm",value:(n=Di()(Ei.a.mark((function e(t){var n,r,i,o;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.message,r=t.title,i=void 0===r?" ":r,(o=this).title=i,o.element.classList.remove(o.showClass),n?(o.showClass="b-show-message-yes-no",o.widgetMap.message.html=n):o.showClass="b-show-yes-no",o.element.classList.add(o.showClass),o.show(),e.abrupt("return",o.promise=new Promise((function(e){o.resolve=e})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"doResolve",value:function(e){var t=this,n=t.resolve;n&&(t.resolve=t.reject=t.promise=null,n(e),t.hide())}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.widgetMap.cancelButton.isVisible?this.onCancelClick():this.onNoClick()),se()(oe()(t.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"onYesClick",value:function(){this.doResolve(Cs.yesButton)}},{key:"onNoClick",value:function(){this.doResolve(Cs.noButton)}},{key:"onCancelClick",value:function(){this.doResolve(Cs.cancelButton)}}],[{key:"$name",get:function(){return"MessageDialog"}},{key:"defaultConfig",get:function(){return{id:"bryntum-msgdialog",centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:" ",items:[{type:"widget",id:"bryntum-msgdialog-message",cls:"b-msgdialog-message",ref:"message"},{type:"textfield",id:"bryntum-msgdialog-input",cls:"b-msgdialog-input",ref:"input"}],bbar:{id:"bryntum-msgdialog-bbar",items:[{ref:"yesButton",id:"bryntum-msgdialog-yesbutton",cls:"b-msgdialog-yesbutton",text:"Yes",onClick:"up.onYesClick"},{ref:"noButton",id:"bryntum-msgdialog-nobutton",cls:"b-msgdialog-nobutton",text:"No",onClick:"up.onNoClick"},{ref:"cancelButton",id:"bryntum-msgdialog-cancelbutton",cls:"b-msgdialog-cancelbutton",text:"Cancel",onClick:"up.onCancelClick"}]}}}}]),t}(Ar));Cs.noButton=0,Cs.yesButton=1,Cs.cancelButton=3;var Es=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onStoreBeforeRequest",value:function(){this.eachWidget((function(e){return e.disable()}))}},{key:"updateLocalization",value:function(){var e=this,n=e.widgetMap,r=n.reloadButton,i=n.firstPageButton,o=n.previousPageButton,a=n.nextPageButton,s=n.lastPageButton;i.tooltip=e.L("firstPage"),o.tooltip=e.L("prevPage"),a.tooltip=e.L("nextPage"),s.tooltip=e.L("lastPage"),r.tooltip=e.L("reload"),e.updateSummary(),se()(oe()(t.prototype),"updateLocalization",this).call(this)}},{key:"updateSummary",value:function(){var e,t,n,r,i,o=this,a=o.widgetMap,s=a.pageCount,l=a.dataSummary;if(e=t=n=r=i=0,o.store){var u=o.store,c=u.pageSize,d=u.currentPage;e=u.count,t=u.lastPage,i=u.allCount,n=Math.max(0,(d-1)*c+1),r=Math.min(i,n+c-1)}s.html=o.L("pageCountTemplate")({lastPage:t}),l.html=e?o.L("summaryTemplate")({start:n,end:r,allCount:i}):o.L("noRecords")}},{key:"onStoreChange",value:function(){var e=this.widgetMap,t=this.store,n=t.count,r=t.lastPage,i=t.currentPage,o=e.pageNumber,a=e.pageCount,s=e.firstPageButton,l=e.previousPageButton,u=e.nextPageButton,c=e.lastPageButton,d=e.dataSummary;this.eachWidget((function(e){return e.enable()})),o.value=i,o.max=r,d.disabled=o.disabled=a.disabled=!n,s.disabled=l.disabled=i<=1||!n,u.disabled=c.disabled=i>=r||!n,this.updateSummary()}},{key:"onPageNumberChange",value:function(e){var t=e.value;this.store.currentPage!==t&&this.store.loadPage(t)}},{key:"onFirstPageClick",value:function(){this.store.loadPage(1)}},{key:"onPreviousPageClick",value:function(){this.store.previousPage()}},{key:"onNextPageClick",value:function(){this.store.nextPage()}},{key:"onLastPageClick",value:function(){this.store.loadPage(this.store.lastPage)}},{key:"onReloadClick",value:function(){this.store.loadPage(this.store.currentPage)}},{key:"store",set:function(e){var t=this,n={beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:t};t.store&&t.store.un(n),t._store=e,e&&(e.on(n),e.isLoading&&t.onStoreBeforeRequest())},get:function(){return this._store}}],[{key:"$name",get:function(){return"PagingToolbar"}},{key:"defaultConfig",get:function(){return{store:null,localeClass:this,namedItems:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-fa-angle-double-left"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-fa-angle-left"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange"},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text"},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-fa-angle-right"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-fa-angle-double-right"},reloadButton:{onClick:"up.onReloadClick",icon:"b-fa-redo"},dataSummary:{type:"widget",cls:"b-toolbar-text"}},items:{firstPageButton:!0,previousPageButton:!0,pageNumber:!0,pageCount:!0,nextPageButton:!0,lastPageButton:!0,sep:"|",reloadButton:!0,spacer:"->",dataSummary:!0}}}}]),t}(Tr);function xs(){var e=Lr()(['\n            <div class="b-splitter"></div>\n        ']);return xs=function(){return e},e}Es._$name="PagingToolbar",X.register("pagingtoolbar",Es);var Ds=function(e){return parseInt(rn.getStyleValue(e,"flex-basis"),10)||parseInt(rn.getStyleValue(e,"flex-grow"),10)},Ts=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.mouseDetacher&&this.mouseDetacher()}},{key:"template",value:function(){return Hr.tpl(xs())}},{key:"updateOrientation",value:function(){var e=this,t=this.element;if(e._prevOrientation&&t.classList.remove(e._prevOrientation),!e._currentOrientation&&e.rendered&&t.offsetParent){var n=rn.getStyleValue(t.parentElement,"flex-direction");if(n)e._currentOrientation=n.startsWith("column")?"horizontal":"vertical";else{var r=t.previousElementSibling,i=t.nextElementSibling;if(!r||!i)return;var o=r.getBoundingClientRect(),a=i.getBoundingClientRect(),s=o.top<a.top?o:a,l=s===a?o:a;e._currentOrientation=s.top!==l.top?"horizontal":"vertical"}}e._currentOrientation&&t.classList.add("b-".concat(e._currentOrientation)),e._prevOrientation=e._currentOrientation}},{key:"onMouseDown",value:function(e){var t=this.element,n=t.previousElementSibling,r=t.nextElementSibling,i=Ds(n),o=Ds(r),a=[],s=!0,l=!1,u=void 0;try{for(var c,d=t.parentElement.children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;Ds(h)&&h!==t&&a.push({element:h,width:h.offsetWidth,height:h.offsetHeight})}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}this.context={startX:e.pageX,startY:e.pageY,prevWidth:n.offsetWidth,prevHeight:n.offsetHeight,nextWidth:r.offsetWidth,nextHeight:r.offsetHeight,prevHasFlex:i,nextHasFlex:o,flexed:a,prev:n,next:r},this.mouseDetacher=Ln.on({element:document,mousemove:"onMouseMove",mouseup:"onMouseUp",thisObj:this})}},{key:"onMouseMove",value:function(e){var t=this,n=t.context,r=e.pageX-n.startX,i=e.pageY-n.startY;if(e.preventDefault(),Object.assign(n,{deltaX:r,deltaY:i}),n.started||(n.started=!0,t.trigger("start",{context:n,event:e}),n.flexed.forEach((function(e){"vertical"===t.currentOrientation?e.element.style.flexGrow=e.width:e.element.style.flexGrow=e.height,e.element.style.flexBasis="0"}))),"vertical"===t.currentOrientation){var o=n.prevWidth+r,a=n.nextWidth-r;n.prevHasFlex?n.prev.style.flexGrow=o:n.prev.style.width="".concat(o,"px"),n.nextHasFlex?n.next.style.flexGrow=a:n.next.style.width="".concat(a,"px")}else{var s=n.prevHeight+i,l=n.nextHeight-i;n.prevHasFlex?n.prev.style.flexGrow=s:n.prev.style.height="".concat(s,"px"),n.nextHasFlex?n.next.style.flexGrow=l:n.next.style.height="".concat(l,"px")}t.trigger("move",{context:n,event:e})}},{key:"onMouseUp",value:function(e){var t=this;t.mouseDetacher&&t.mouseDetacher(),t.mouseDetacher=null,t.context.started&&t.trigger("end",{context:t.context,event:e}),t.context=null}},{key:"render",value:function(){se()(oe()(t.prototype),"render",this).apply(this,arguments);var e=this;e._currentOrientation||(e.updateOrientation(),e._currentOrientation||e.requestAnimationFrame((function(){return e.updateOrientation()})))}},{key:"element",get:function(){return se()(oe()(t.prototype),"element",this)},set:function(e){fn()(oe()(t.prototype),"element",e,this,!0),Ln.on({element:this.element,mousedown:"onMouseDown",thisObj:this})}},{key:"currentOrientation",get:function(){return this._currentOrientation}},{key:"orientation",get:function(){return this._orientation},set:function(e){this._orientation=e,this._currentOrientation="auto"===e?null:e,this.updateOrientation()}}],[{key:"defaultConfig",get:function(){return{orientation:"auto"}}}]),t}(vr);Ts._$name="Splitter",X.register("splitter",Ts);var Rs=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;r.masterStore=n,n&&(r._grid=Array.isArray(n)?n[0].grid:n.grid),r.localizableProperties=e.localizableProperties||["text"],e.localeClass&&(r.localeClass=e.localeClass),se()(oe()(t.prototype),"construct",this).call(this,e,n,null,!1),r.processConfiguredListeners(e.listeners),"field"in r.data||(r.field="_"+(r.type||"")+ ++t.emptyCount,r.noFieldSpecified=!0),r.hasComplexMapping=r.field&&r.field.includes("."),r.width||r.flex||r.children||r.set({width:t.defaultWidth,flex:null},null,!0)}},{key:"remove",value:function(){var e=this.subGrid,n=this.grid,r=e&&n&&n.focusedCell;r&&r.columnId===this.id&&(document.activeElement===n?n.navigateRight():r.columnId=e.columns.getAdjacentVisibleLeafColumn(this.id,!0,!0).id),se()(oe()(t.prototype),"remove",this).call(this)}},{key:"getRawValue",value:function(e){return this.hasComplexMapping?kt.getPath(e,this.field):e[this.field]||e.get(this.field)}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;if(!t.hidden){if(t.hidden=!0,n&&!n.isRoot){var r=n.children.some((function(e){return!0!==e.hidden}));r||n.hidden||(e=!0,n.hide())}t.children&&t.children.forEach((function(e){return e.hide(!0)})),e||t.stores.forEach((function(e){return e.trigger("hideColumn")}))}}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;t.hidden&&(t.hidden=!1,n&&n.hidden&&n.show(),t.children&&t.children.forEach((function(e){return e.show(!0)})),e||t.stores.forEach((function(e){return e.trigger("showColumn")})))}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.hidden&&void 0===e||!0===e?this.show():!this.hidden&&void 0===e||!1===e?this.hide():void 0}},{key:"generateId",value:function(){return t.generatedIdIndex||(t.generatedIdIndex=0),(this.field?this.field.replace(/\./g,"-"):"col")+ ++t.generatedIdIndex}},{key:"measureSize",value:function(e){return rn.measureSize(e,this.subGrid?this.subGrid.element:void 0)}},{key:"calculateMinWidth",value:function(){var e=this,t=e.measureSize(e.width),n=e.measureSize(e.minWidth),r=0;return e.children&&(r=e.children.reduce((function(e,t){return e+t.calculateMinWidth()}),0)),Math.max(t,n,r)}},{key:"resizeToFitContent",value:function(){var e=this,t=e.grid,n=e.renderer,r=e.defaultRenderer,i=e.element,o=t.rowManager,a=t.store,s=a.count,l=n||r;if(!(s<=0)){var u,c,d,h,f,g=t.element.querySelector(".b-grid-cell[data-column-id=".concat(e.id,"]")),v=g.cssText,m=g.className,p=0;if(t.resizeToFitIncludesHeader){var y=window.getComputedStyle(i);p=rn.measureText(i.innerText,i,!1,i.parentElement)+parseInt(y.paddingLeft),i.parentElement.offScreenDiv.parentElement.remove()}for(s>1e3?c=(u=Math.max(Math.min(o.topIndex+o.rowCount/2-500,s-1e3),0))+1e3:(u=0,c=s),d=u;d<c;d++)h=a.getAt(d),f=e.getRawValue(h),l&&(f=null==(f=l.call(e,{cellElement:g,rowElement:g.parentNode,value:f,record:h,column:e,size:{height:h.rowHeight||0},grid:t,row:{},updatingSingleRow:!1}))?g.innerHTML:String(f)),f&&(p=Math.max(p,rn.measureText(f,g,!(e.htmlEncode&&!e.disableHtmlEncode),e.subGrid.element)));return g.className=m,g.cssText=v,e.width=p}}},{key:"getState",value:function(){var e,t=this,n=(e={},$()(e,t.flex?"flex":"width",t.flex?t.flex:t.width),$()(e,"id",t.id),$()(e,"hidden",t.hidden),$()(e,"index",t.allIndex),$()(e,"region",t.region),$()(e,"filterable",t.filterable),$()(e,"text",t.text),$()(e,"locked",t.locked),e);return t.children&&(n.children=t.children.map((function(e){return e.getState()}))),n}},{key:"applyState",value:function(e){var t=this;t.beginBatch(),"locked"in e&&(t.locked=e.locked),"minWidth"in e&&(t.minWidth=e.minWidth),"width"in e&&(t.width=e.width),"flex"in e&&(t.flex=e.flex),"width"in e&&t.flex?t.flex=void 0:"flex"in e&&t.width&&(t.width=void 0),"text"in e&&(t.text=e.text),"region"in e&&(t.region=e.region),"renderer"in e&&(t.renderer=e.renderer),"filterable"in e&&(t.filterable=e.filterable),t.endBatch(),"hidden"in e&&t.toggle(!0!==e.hidden)}},{key:"clearCell",value:function(e){e.innerHTML=""}},{key:"canEdit",value:function(e){return!0}},{key:"owner",get:function(){return this._owner||this.subGrid},set:function(e){this._owner=e}},{key:"nextVisibleSibling",get:function(){for(var e=this.region,t=this.nextSibling;t&&(t.hidden||t.region!==e);)t=t.nextSibling;return t}},{key:"isLastInSubGrid",get:function(){return!this.nextVisibleSibling&&(!this.parent||this.parent.isLastInSubGrid)}},{key:"element",get:function(){return this.grid.getHeaderElement(this)}},{key:"textWrapper",get:function(){return rn.getChild(this.element,".b-grid-header-text")}},{key:"textElement",get:function(){return rn.down(this.element,".b-grid-header-text-content")}},{key:"contentElement",get:function(){return rn.down(this.element,".b-grid-header-children")}},{key:"editor",get:function(){var e=this.data.editor;if(e&&!(e instanceof vr)){var t=this.grid.processCellEditor({editor:e,field:this.field});t?e=this.data.editor=t.editor:("string"==typeof e&&(e={type:e}),e=this.data.editor=te.createWidget(Object.assign(this.defaultEditor,e,{owner:this.grid})))}return e},set:function(e){this.data.editor=e}},{key:"defaultEditor",get:function(){return{type:"textfield",name:this.field}}},{key:"grid",get:function(){return this._grid||this.parent&&this.parent.grid}},{key:"locked",get:function(){return"locked"===this.data.region},set:function(e){this.region=e?"locked":"normal"}},{key:"sortable",get:function(){return this.isLeaf&&this.data.sortable},set:function(e){this.set("sortable",e)}},{key:"groupable",get:function(){return this.isLeaf&&this.data.groupable},set:function(e){this.set("groupable",e)}},{key:"allIndex",get:function(){return this.masterStore.indexOf(this)}},{key:"width",get:function(){return this.data.width},set:function(e){var t={width:e};e&&"flex"in this.data&&(t.flex=null),this.set(t)}},{key:"subGrid",set:function(e){this._subGrid=e},get:function(){return this._subGrid||(this.grid?this.grid.getSubGridFromColumn(this):void 0)}},{key:"subGridElement",get:function(){return this.subGrid.element}}],[{key:"fields",get:function(){return["text","field","renderer","width","flex",{name:"editor",defaultValue:{}},"finalizeCellEdit",{name:"revertOnEscape",defaultValue:!0},{name:"invalidAction",defaultValue:"block"},{name:"sortable",defaultValue:!0},{name:"searchable",defaultValue:!0},{name:"filterable",defaultValue:!0},{name:"hideable",defaultValue:!0},{name:"draggable",defaultValue:!0},{name:"groupable",defaultValue:!0},{name:"resizable",defaultValue:!0},"groupRenderer","headerRenderer","tooltipRenderer","cellCls","cls","icon","align",{name:"minWidth",defaultValue:60},{name:"hidden",defaultValue:!1},{name:"locked"},{name:"region"},{name:"showColumnPicker",defaultValue:!0},{name:"enableHeaderContextMenu",defaultValue:!0},{name:"enableCellContextMenu",defaultValue:!0},"headerMenuItems","cellMenuItems","sum","summaries","summaryRenderer","responsiveLevels","tags","touchConfig","tree","filterType",{name:"htmlEncode",defaultValue:!0},{name:"autoSyncHtml",defaultValue:!1},"type",{name:"instantUpdate",defaultValue:!1},{name:"repaintOnResize",defaultValue:!1},"editTargetSelector",{name:"exportable",defaultValue:!0},{name:"exportedType"}]}},{key:"autoExposeFields",get:function(){return!1}},{key:"type",get:function(){return"column"}},{key:"text",get:function(){return this.defaultValues.text}}]),t}(ze(Ve(mi)));Rs.emptyCount=0,Rs.defaultWidth=100,Rs.exposeProperties(),Rs._$name="Column";var Ms=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;e.grid&&(e.grid._columnStore=n,n.id="".concat(e.grid.id,"-columns"),e.grid.on({subGridCollapse:"clearCaches",subGridExpand:"clearCaches",thisObj:n})),se()(oe()(t.prototype),"construct",this).call(this,e),n.on({change:n.clearCaches,thisObj:n,prio:1})}},{key:"doDestroy",value:function(){var e=[];this.traverse((function(t){return e.push(t)})),se()(oe()(t.prototype),"doDestroy",this).call(this),e.forEach((function(e){return e.destroy()}))}},{key:"getById",value:function(e){return se()(oe()(t.prototype),"getById",this).call(this,e)||this.idRegister[e]}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.traverseWhile((function(n,r){return e.call(t,n,r)}),!0)}},{key:"clearCaches",value:function(){this._visibleColumns=null}},{key:"onMasterDataChanged",value:function(e){se()(oe()(t.prototype),"onMasterDataChanged",this).call(this,e),this.clearCaches()}},{key:"getAdjacentVisibleLeafColumn",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.visibleColumns,i=e instanceof Rs?e:this.getById(e),o=r.indexOf(i)+(t?1:-1);if(!r[o]){if(!n)return null;o=t?0:r.length-1}return r[o]}},{key:"get",value:function(e){return this.findRecord("field",e,!0)}},{key:"createRecord",value:function(e){var n=this.grid,r=void 0===n?{}:n,i=r.store,o=this.modelClass;if(e.type&&!(o=t.getColumnClass(e.type)))throw new Error(this.L("columnTypeNotFound",e));e.locked&&(e.region="locked",delete e.locked);var a=new o(e,this);if(a.data.region||(a.data.region=r.defaultRegion||"normal"),this.autoAddField&&!a.noFieldSpecified&&i&&!i.modelClass.getFieldDefinition(a.field)){var s=a.field;a.constructor.fieldType&&(s={name:a.field,type:a.constructor.fieldType}),i.modelClass.addField(s)}return a}},{key:"indexOf",value:function(e){var n=se()(oe()(t.prototype),"indexOf",this).call(this,e);return n>-1?n:this.records.findIndex((function(t){return t.field===e}))}},{key:"modelClass",get:function(){return this._modelClass},set:function(e){this._modelClass=e}},{key:"totalFixedWidth",get:function(){var e=0,t=!0,n=!1,r=void 0;try{for(var i,o=this[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.hidden||(a.flex?e+=a.measureSize(Rs.defaultWidth):e+=Math.max(a.measureSize(a.width),a.measureSize(a.minWidth)))}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e}},{key:"topColumns",get:function(){return this.isChained?this.masterStore.rootNode.children.filter(this.chainedFilterFn):this.rootNode.children}},{key:"visibleColumns",get:function(){return this._visibleColumns||(this._visibleColumns=this.leaves.filter((function(e){return!(e.hidden||e.subGrid&&e.subGrid.collapsed)}))),this._visibleColumns}},{key:"bottomColumns",get:function(){return this.leaves}}],[{key:"registerColumnType",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.columnTypes||(t.columnTypes={}),e.simpleRenderer=n,t.columnTypes[e.type]=e}},{key:"getColumnClass",value:function(e){return t.columnTypes&&t.columnTypes[e]}},{key:"defaultConfig",get:function(){return{modelClass:Rs,tree:!0,autoAddField:!1}}}]),t}(Ve(Fi));Ms.registerColumnType(Rs,!0),Ms._$name="ColumnStore";var Fs=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.configuredAlign="align"in e,this.configuredEditor="editor"in e,se()(oe()(t.prototype),"construct",this).apply(this,arguments);var r=n.grid;r&&(this.owner=r,r.on({paint:"onGridPaint",thisObj:this,prio:1e3}))}},{key:"onGridPaint",value:function(e){var t=e.source;this.store=t.store}},{key:"canEdit",value:function(e){return e.isLeaf}},{key:"sum",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n.length;i<o;i++)e+=parseInt(n[i],10);return e}},{key:"avg",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=n.length,o=0;o<i;o++)e+=parseInt(n[o],10);return e/i}},{key:"onRecordUpdate",value:function(e){var t=e.record,n=e.changes,r=this,i=r.grid.rowManager;r.field in n&&t.isLeaf&&t.bubble((function(e){var t=i.getRowFor(e);if(t){var n=t.getCell(r.field);n&&t.renderCell(n,e)}}),!0)}},{key:"getRawValue",value:function(e){var t=0;if(e.children){for(var n=this.function,r="string"==typeof n&&"function"==typeof Math[n]?{handler:Math[n],thisObj:Math}:this.resolveCallback(n),i=r.handler,o=r.thisObj,a=0,s=e.children.length;a<s;a++)t=i.call(o,t,this.getRawValue(e.children[a]));e.setData(this.field,t)}else t=e[this.field];return t}},{key:"store",set:function(e){var t=this,n={update:"onRecordUpdate",thisObj:t,prio:1e3},r=t._store;if(e!==r){r&&r.un(n),t._store=e;var i=e.modelClass.fieldMap[t.field];i&&"number"===i.type&&(t.configuredAlign||(t.align="end"),t.configuredEditor||(t.editor="number")),e.on(n)}},get:function(){return this._store}}],[{key:"type",get:function(){return"aggregate"}},{key:"fields",get:function(){return["function"]}},{key:"defaults",get:function(){return{function:"sum"}}}]),t}(Rs);Ms.registerColumnType(Fs,!0),Fs.exposeProperties(),Fs._$name="AggregateColumn";var _s=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.widgetMap={},this.internalCellCls="b-widget-cell",se()(oe()(t.prototype),"construct",this).apply(this,arguments)}},{key:"doDestroy",value:function(){for(var e=0,n=Object.values(this.widgetMap);e<n.length;e++){var r=n[e];r.destroy&&r.destroy()}se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"renderer",value:function(e){var t=this,n=e.cellElement,r=e.column,i=e.value,o=e.record,a=e.isExport,s=r.widgets;if(!a&&s&&(n.widgets||t.clearCell(n),n.widgets=s.map((function(a,s){var l,u;return n.widgets&&(u=(l=n.widgets[s]).element.nextElementSibling,a.recreate&&l&&(delete t.widgetMap[l.id],l.destroy(),n.widgets[s]=null)),l||(t.onBeforeWidgetCreate(a,e),l=te.append(a,u?{insertBefore:u}:n)[0],t.widgetMap[l.id]=l,t.onAfterWidgetCreate(l,e)),l.cellInfo={cellElement:n,value:i,record:o,column:r},t.grid&&(l.readOnly=t.grid.readOnly),!1!==t.onBeforeWidgetSetValue(l,e)&&(a.noValueOnRender||(a.valueProperty?l[a.valueProperty]=i:l.defaultBindProperty?l[l.defaultBindProperty]=i:l.text=l.value=i)),t.onAfterWidgetSetValue(l,e),l}))),a)return null}},{key:"onBeforeWidgetCreate",value:function(e,t){}},{key:"onAfterWidgetCreate",value:function(e,t){}},{key:"onBeforeWidgetSetValue",value:function(e,t){}},{key:"onAfterWidgetSetValue",value:function(e,t){}},{key:"clearCell",value:function(e){var n=this;e.widgets&&(e.widgets.forEach((function(e){delete n.widgetMap[e.id],e.destroy()})),e.widgets=null),se()(oe()(t.prototype),"clearCell",this).call(this,e)}},{key:"resizeToFitContent",value:function(){}}],[{key:"type",get:function(){return"widget"}},{key:"fields",get:function(){return["widgets"]}},{key:"defaults",get:function(){return{filterable:!1,sortable:!1,editor:!1,searchable:!1}}}]),t}(Rs);Ms.registerColumnType(_s),_s.exposeProperties(),_s._$name="WidgetColumn";var As=function(e){function t(e,n){var r;return C()(this,t),(r=re()(this,oe()(t).apply(this,arguments))).internalCellCls="b-check-cell",r}return ue()(t,e),x()(t,null,[{key:"type",get:function(){return"check"}},{key:"fields",get:function(){return["checkCls"]}},{key:"defaults",get:function(){return{align:"center",checkCls:null,widgets:[{type:"checkbox",valueProperty:"checked"}]}}}]),x()(t,[{key:"renderer",value:function(e){var n=e.value,r=e.isExport;if(r)return null==n?"":n;se()(oe()(t.prototype),"renderer",this).apply(this,arguments)}},{key:"onBeforeWidgetCreate",value:function(e,t){e.cls=this.checkCls}},{key:"onAfterWidgetCreate",value:function(e,t){t.cellElement.widget=e,e.on({beforeChange:"onBeforeCheckboxChange",change:"onCheckboxChange",thisObj:this})}},{key:"onBeforeWidgetSetValue",value:function(e){e.record=e.cellInfo.record,this.isInitialSet=!0}},{key:"onAfterWidgetSetValue",value:function(e){this.isInitialSet=!1}},{key:"onBeforeCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet)return this.trigger("beforeToggle",{record:t.cellInfo.record,checked:n})}},{key:"onCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet){var r=t.cellInfo.record,i=this.field;if(i){var o="set".concat(A.capitalizeFirstLetter(i));r[o]?r[o](n):r.set(i,n)}this.trigger("toggle",{record:r,checked:n})}}}]),t}(_s);Ms.registerColumnType(As,!0),As._$name="CheckColumn";var Is=function(e){function t(e,n){var r;return C()(this,t),(r=re()(this,oe()(t).apply(this,arguments))).internalCellCls="b-date-cell",r}return ue()(t,e),x()(t,null,[{key:"type",get:function(){return"date"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format","pickerFormat","step"]}},{key:"defaults",get:function(){return{format:"L",step:1,minWidth:85,filterType:"date"}}}]),x()(t,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=vt.parse(e,this.format||void 0)),vt.format(e,this.format||void 0)}},{key:"format",set:function(e){var t=this.editor;this.set("format",e),t&&(t.format=this.format)},get:function(){return this.get("format")}},{key:"defaultEditor",get:function(){return{name:this.field,type:"date",calendarContainerCls:"b-grid-cell-editor-related",format:this.format,step:this.step}}}]),t}(Rs);Ms.registerColumnType(Is,!0),Is.exposeProperties(),Is._$name="DateColumn";var Ls=function(e){function t(e,n){var r;return C()(this,t),(r=re()(this,oe()(t).apply(this,arguments))).internalCellCls="b-percent-bar-cell",r}return ue()(t,e),x()(t,null,[{key:"type",get:function(){return"percent"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["lowThreshold"]}},{key:"defaults",get:function(){return{editor:{type:"number",min:0,max:100},lowThreshold:20,filterType:"number",htmlEncode:!1,searchable:!1,summaryRenderer:function(e){return"".concat(e,"%")}}}}]),x()(t,[{key:"renderer",value:function(e){var t=e.value;return{className:"b-percent-bar-outer",children:[{tag:"div",className:{"b-percent-bar":1,"b-zero":0===(t=t||0),"b-low":t<this.lowThreshold},style:{width:t+"%"},html:t+"%"}]}}},{key:"clearCell",value:function(e){e.percentBarElement&&(e.percentBarElement=null),se()(oe()(t.prototype),"clearCell",this).call(this,e)}},{key:"resizeToFitContent",value:function(){}}]),t}(Rs);Ls.sum="average",Ms.registerColumnType(Ls,!0),Ls._$name="PercentColumn";var Os=function(e){function t(e,n){var r;return C()(this,t),(r=re()(this,oe()(t).apply(this,arguments))).internalCellCls="b-number-cell",r}return ue()(t,e),x()(t,null,[{key:"type",get:function(){return"number"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["min","max","step","unit"]}},{key:"defaults",get:function(){return{filterType:"number"}}}]),x()(t,[{key:"defaultRenderer",value:function(e){var t=e.value,n=void 0===t?0:t;return this.unit?"".concat(n).concat(this.unit):n}},{key:"defaultEditor",get:function(){return{name:this.field,type:"numberfield",max:this.max,min:this.min,step:this.step}}}]),t}(Rs);Ms.registerColumnType(Os,!0),Os.exposeProperties(),Os._$name="NumberColumn";var Ps=function(e){function t(e,n){var r;return C()(this,t),(r=re()(this,oe()(t).apply(this,arguments))).internalCellCls="b-rating-cell",r}return ue()(t,e),x()(t,null,[{key:"type",get:function(){return"rating"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["emptyIcon","filledIcon","editable"]}},{key:"defaults",get:function(){return{min:0,max:5,emptyIcon:"b-icon b-icon-star",filledIcon:"b-icon b-icon-star",editable:!0,filterType:"number",searchable:!1,width:"11.2em",htmlEncode:!1,autoSyncHtml:!0,minWidth:"11.2em",editor:!1}}}]),x()(t,[{key:"renderer",value:function(e){for(var t=e.value,n='<div class="b-rating-cell-inner '.concat(this.editable?"":"b-not-editable",'">'),r=0;r<this.max;r++){n+='<i class="b-rating-icon '.concat(r<t?"b-filled "+this.filledIcon:"b-empty "+this.emptyIcon,'"></i>')}return n+="</div>"}},{key:"onCellClick",value:function(e){var t=e.grid,n=e.column,r=e.record,i=(e.cellSelector,e.target),o=e.event;if(i.classList.contains("b-rating-icon")&&!t.readOnly&&n.editable){var a=[].indexOf.call(i.parentNode.childNodes,i);i.classList.contains("b-filled")&&(o.metaKey||o.shiftKey)&&(a-=1),1===r.get(n.field)&&0===a&&(a=-1),r.set(n.field,a+1)}}}]),t}(Os);Ms.registerColumnType(Ps,!0),Ps.exposeProperties(),Ps._$name="RatingColumn";var Hs=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;se()(oe()(t.prototype),"construct",this).apply(this,arguments),r.grid&&(r.grid.store.on({change:r.resizeToFitContent,thisObj:r}),r.grid.store.count&&r.grid.on({render:r.resizeToFitContent,thisObj:r,once:!0})),r.internalCellCls="b-row-number-cell"}},{key:"renderer",value:function(e){var t=e.record,n=e.grid;return t.meta.specialRow?"":n.store.indexOf(t,!0)+1}},{key:"resizeToFitContent",value:function(){var e=this.grid,t=e.store.count;if(t&&!this.hidden){var n=e.element.querySelector(".b-grid-cell[data-column-id=".concat(this.id,"]"));if(n){var r=window.getComputedStyle(n),i=parseInt(r["padding-left"]),o=rn.measureText(t,n);this.width=o+2*i}}}},{key:"flex",set:function(e){}}],[{key:"defaults",get:function(){return{groupable:!1,sortable:!1,filterable:!1,searchable:!1,resizable:!1,minWidth:50,width:50,align:"right",text:"#",editor:!1}}},{key:"type",get:function(){return"rownumber"}}]),t}(Rs);Ms.registerColumnType(Hs,!0),Hs._$name="RowNumberColumn";var Ns=n(60),Bs=n.n(Ns),zs=function(e){function t(e,n){var r;C()(this,t),r=re()(this,oe()(t).apply(this,arguments));var i=Bs()(r);if(!i.template)throw new Error(i.L("noTemplate"));if("function"!=typeof i.template)throw new Error(i.L("noFunction"));return r}return ue()(t,e),x()(t,null,[{key:"fields",get:function(){return["template"]}},{key:"defaults",get:function(){return{htmlEncode:!1}}}]),x()(t,[{key:"renderer",value:function(e){if(!e.record.meta.specialRow)return this.template({value:e.value,record:e.record,field:e.column.field})}}],[{key:"type",get:function(){return"template"}}]),t}(Rs);Ms.registerColumnType(zs,!0),zs.exposeProperties(),zs._$name="TemplateColumn";var js=function(e){function t(e,n){var r;return C()(this,t),(r=re()(this,oe()(t).apply(this,arguments))).internalCellCls="b-time-cell",r}return ue()(t,e),x()(t,null,[{key:"type",get:function(){return"time"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format"]}},{key:"defaults",get:function(){return{format:"LT",minWidth:140,filterType:"time"}}}]),x()(t,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=vt.parse(e,this.format)),vt.format(e,this.format)}},{key:"format",set:function(e){var t=this.editor;this.set("format",e),t&&(t.format=this.format)},get:function(){return this.get("format")}},{key:"defaultEditor",get:function(){return{name:this.field,type:"time",format:this.format}}}]),t}(Rs);Ms.registerColumnType(js,!0),js.exposeProperties(),js._$name="TimeColumn";var Vs=!1,Ws=function(e){function t(e,n){var r;C()(this,t),r=re()(this,oe()(t).apply(this,arguments));var i=Bs()(r);return i.internalCellCls="b-tree-cell",i.shouldHtmlEncode=i.htmlEncode,i.tempDiv=document.createElement("div"),i.setData("htmlEncode",!1),i.renderer&&(i.originalRenderer=i.renderer),i.renderer=i.treeRenderer.bind(i),r}return ue()(t,e),x()(t,null,[{key:"defaults",get:function(){return{tree:!0,hideable:!1,minWidth:150}}},{key:"fields",get:function(){return[{name:"expandIconCls",defaultValue:"b-icon b-icon-tree-expand"},{name:"collapseIconCls",defaultValue:"b-icon b-icon-tree-collapse"},{name:"collapsedFolderIconCls"},{name:"expandedFolderIconCls"},{name:"leafIconCls",defaultValue:"b-icon b-icon-tree-leaf"},{name:"editTargetSelector",defaultValue:".b-tree-cell-value"}]}},{key:"type",get:function(){return"tree"}}]),x()(t,[{key:"treeRenderer",value:function(e){var t,n,r=this,i=e.cellElement,o=e.row,a=e.record,s=e.isExport,l=a.instanceMeta(e.grid.store),u=a.href?"a":"div",c=e.value,d="",h="";if(r.originalRenderer){var f=r.originalRenderer(e);c=!1===f?i.innerHTML:f}if(s)n=null!=c?c:"";else{a.isLeaf?(i.classList.add("b-tree-leaf-cell"),(t=e.iconCls||a.iconCls||r.leafIconCls)&&(h+=t)):(o.addCls&&o.addCls("b-tree-parent-row"),i.classList.add("b-tree-parent-cell"),l.isLoadingChildren&&o.addCls("b-loading-children"),d+='<div class="b-tree-expander '.concat(l.collapsed?r.expandIconCls+" b-tree-collapsed":r.collapseIconCls+" b-tree-expanded",'"></div>'),Vs=t=e.iconCls||a.iconCls||(l.collapsed?r.collapsedFolderIconCls:r.expandedFolderIconCls),t&&(d+='<div class="b-tree-icon '.concat(t,'"></div>'))),c=null!=c?c:"",r.shouldHtmlEncode&&(r.tempDiv.innerText=c,c=r.tempDiv.innerHTML),d+='<div class="b-tree-cell-value">'.concat(c,"</div>");var g=1.7*a.childLevel+(a.isLeaf?Vs?1.8:t?.4:.3:0);n="<".concat(u," ").concat(a.href?'href="'.concat(a.href,'"'):""," ").concat("a"===u&&a.target?'target="'.concat(a.target,'"'):"",' class="b-tree-cell-inner ').concat(h,'" style="padding-left:').concat(g,'em">').concat(d,"</").concat(u,">")}return n}}]),t}(Rs);Ms.registerColumnType(Ws,!0),Ws.exposeProperties(),Ws._$name="TreeColumn";var Gs=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"fields",get:function(){return["iconCls","expanded","cls","rowHeight","href","target"]}}]),t}(mi);Gs.exposeProperties(),Gs._$name="GridRowModel";var Ys=new Map,Us=new Map,qs={Grid:"GridBase",Scheduler:"SchedulerBase",Gantt:"GanttBase"},$s=/\$\d+$/,Xs=function(){function e(){C()(this,e)}return x()(e,null,[{key:"registerFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r=(r=A.lowercaseFirstLetter(r||e.hasOwnProperty("$name")&&e.$name||e.name)).replace($s,""),Array.isArray(n)||(n=[n||"Grid"]),n.forEach((function(n){var i=qs[n]||n,o=Ys.get(i)||new Map,a=Us.get(i)||new Map;o.set(r,e),a.set(e,t),Ys.set(i,o),Us.set(i,a)}))}},{key:"getTypeNameFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Grid",t=qs[e]||e,n=Ys.get(t),r={};return n&&n.forEach((function(e,t){return r[t]=e})),r}},{key:"getTypeNameDefaultFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Grid",t=qs[e]||e,n=Ys.get(t),r=Us.get(t),i={};return n&&r&&n.forEach((function(e,t){r.get(e)&&(i[t]=e)})),i}},{key:"getInstanceFeatures",value:function(e){var t=this;return e.classNameHierarchy().reduce((function(e,n){return Object.assign(e,t.getTypeNameFeatures(n))}),{})}},{key:"getInstanceDefaultFeatures",value:function(e){var t=this;return e.classNameHierarchy().reduce((function(e,n){return Object.entries(t.getTypeNameFeatures(n)).reduce((function(e,r){var i=fe()(r,2),o=i[0],a=i[1];return t.isDefaultFeatureForTypeName(a,n)?e[o]=a:delete e[o],e}),e)}),{})}},{key:"isDefaultFeatureForTypeName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Grid",n=qs[t]||t,r=Us.get(n);return r&&r.get(e)||!1}},{key:"isDefaultFeatureForInstance",value:function(e,t){for(var n=t.classNameHierarchy().reverse(),r=null,i=0,o=n.length;i<o&&null===r;++i){var a=Us.get(n[i]);a&&a.has(e)&&(r=a.get(e))}return r||!1}},{key:"reset",value:function(){Ys.clear(),Us.clear()}}]),e}();Xs._$name="GridFeatureManager";var Ks={Enter:1,F2:1},Js={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1},Qs=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i;return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;r.grid=e,se()(oe()(t.prototype),"construct",this).call(this,e,n),r.storeListenerDetacher=e.store.on({update:"onStoreUpdate",thisObj:r}),r.listenerDetacher=e.on({cellclick:"onCellClick",celldblclick:"onCellDblClick",beforerenderrows:"onGridBeforeRenderRows",thisObj:r})}},{key:"confirm",value:(i=Di()(Ei.a.mark((function e(t){var n;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!0,!this.editorContext){e.next=7;break}return Cs.owner=this.editorContext.editor.inputField,e.next=5,Cs.confirm(t);case 5:n=e.sent,Cs.owner=null;case 7:return e.abrupt("return",n===Cs.yesButton);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"doDestroy",value:function(){this.cancelEditing(!0),this.listenerDetacher(),this.storeListenerDetacher(),this.grid.columns.allRecords.forEach((function(e){e._cellEditor&&e._cellEditor.destroy()})),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.cancelEditing(!0),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"getEditorForCell",value:function(e){var t=e.column,n=e.selector,r=e.editor,i=this,o=i.grid,a=t._cellEditor;return r.autoSelect=i.autoSelect,a?a.inputField!==r&&(a.remove(a.items[0]),a.add(r)):a=t._cellEditor=new i.editorClass({cls:"b-cell-editor",inputField:r,blurAction:"none",invalidAction:t.invalidAction,completeKey:!1,cancelKey:!1,owner:o,listeners:i.getEditorListeners()}),t.instantUpdate&&!r.cellEditValueSetter&&(kt.wrapProperty(r,"value",null,(function(e){var t=i.editorContext;t&&!kt.isEqual(t.record[t.column.field],e)&&(t.record[t.column.field]=e)})),r.cellEditValueSetter=!0),Object.assign(a.element.dataset,{rowId:n.id,columnId:n.columnId,field:t.field}),a.inputField.revertOnEscape=t.revertOnEscape,i.editor=a}},{key:"getEditorListeners",value:function(){return{focusout:"onEditorFocusOut",focusin:"onEditorFocusIn",start:"onEditorStart",beforecomplete:"onEditorBeforeComplete",complete:"onEditorComplete",cancel:"onEditorCancel",thisObj:this}}},{key:"onEditorStart",value:function(e){var t=e.source,n=this,r=n.editorContext=t.cellEditorContext;if(r){var i=n.grid,o=r.cell,a=r.editor,s=r.column;if(s.editTargetSelector){var l=o.querySelector(s.editTargetSelector);l&&(a.width-=l.offsetLeft,rn.addTranslateX(a.element,l.offsetLeft))}o.classList.add("b-editing"),n.grid.on({cellclick:"onCellClickWhileEditing",viewportResize:"onViewportResizeWhileEditing"},n),n.removeEditingListeners=ir.addListener({globaltap:"onTapOut",thisObj:n}),i.trigger("startCellEdit",{grid:i,editorContext:r})}}},{key:"onEditorBeforeComplete",value:function(e){var t=this.grid,n=e.source.cellEditorContext;return e.grid=t,e.editorContext=n,t.trigger("beforeFinishCellEdit",e)}},{key:"onEditorComplete",value:function(e){var t=e.source,n=this.grid,r=t.cellEditorContext;r.value=t.inputField.value,n.trigger("finishCellEdit",{grid:n,editorContext:r}),this.cleanupAfterEdit(r)}},{key:"onEditorCancel",value:function(){var e=this.editorContext,t=this.muteEvents,n=this.grid;e&&this.cleanupAfterEdit(e),t||n.trigger("cancelCellEdit",{grid:n})}},{key:"cleanupAfterEdit",value:function(e){var t=e.editor;e.cell.classList.remove("b-editing"),t.cellEditorContext=this.editorContext=null,this.grid.un({cellclick:"onCellClickWhileEditing",viewportResize:"onViewportResizeWhileEditing"},this),this.removeEditingListeners(),ir.suspendFocusEvents(),t.element.remove(),ir.resumeFocusEvents()}},{key:"getAdjacentEditableCell",value:function(e,t){for(var n=this.addNewAtEnd,r=this.grid,i=r.store,o=r.rowManager,a=e.id,s=e.columnId,l=r.columns,u=l.getAdjacentLeaf(s,t);a;){var c=i.getById(a);if(u){if(s=u.id,!u.hidden&&u.editor&&u.canEdit(c))return{id:a,columnId:u.id};u=l.getAdjacentLeaf(s,t)}else{var d=i.getAdjacent(e.id,t,!1,!0);!d&&t&&n&&(d=i.add("object"===U()(n)?kt.clone(n):{})[0],o.getRowFor(d)||o.displayRecordAtBottom()),a=d&&d.id,d&&(u=t?l.first:l.leaves[l.leaves.length-1])}}return null}},{key:"getEditingContext",value:function(e){e=this.grid.normalizeCellContext(e);var t=this.grid,n=t.columns.getById(e.columnId),r=t.store.getById(e.id),i=t.getCell(e);if(i&&n&&!n.hidden&&n.editor&&r&&!r.meta.specialRow&&n.canEdit(r)){var o=r&&r[n.field];return{column:n,record:r,cell:i,value:void 0===o?null:o,selector:e,editor:n.editor}}return!1}},{key:"startEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.editorContext&&!t.disabled){var n=t.grid,r=n.normalizeCellContext(e);n.focusCell(e);var i=t.getEditingContext(r);if(!i||!1===n.trigger("beforeCellEditStart",{grid:n,editorContext:i}))return!1;if(i){rn.focusWithoutScrolling(n.element);var o=i.editor=t.getEditorForCell(i),a=i.cell,s=i.record,l=i.column;return o.inputField.highlightExternalChange=!1,o.cellEditorContext=i,o.render(t.grid.getSubGridFromColumn(l).element),o.startEdit({target:a,record:s,field:o.inputField.name||i.column.field}),!0}}return!1}},{key:"cancelEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.editorContext,r=t.editor,i=t.grid;n&&(r.containsFocus&&(t.editorContext=null,r.inputField.owns(rn.activeElement)&&rn.focusWithoutScrolling(i.element),t.editorContext=n),t.muteEvents=e,r.cancelEdit(),t.muteEvents=!1)}},{key:"finishEditing",value:(r=Di()(Ei.a.mark((function e(){var t,n,r;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.editorContext,n=t.column,r=!1,!t){e.next=6;break}return e.next=5,t.editor.completeEdit(n.bindCallback(n.finalizeCellEdit));case 5:r=e.sent;case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onCellClickWhileEditing",value:function(e){var t=e.event,n=e.cellSelector,r=this;r.editorContext.editor.owns(t.target)||(r.getEditingContext(n)?r.finishEditing()?r.startEditing(n):(r.grid.focusCell(r.editorContext.selector),r.editor.inputField.focus()):r.finishEditing())}},{key:"onViewportResizeWhileEditing",value:function(){var e=this.editorContext,t=e.editor,n=e.column;t.width=n.element.offsetWidth}},{key:"onCellClick",value:function(e){var t=e.source,n=e.record,r=e.cellSelector,i=e.cellElement,o=e.target,a=e.event,s=t.focusedCell||{},l=t.columns.getById(r.columnId);if(l.onCellClick)l.onCellClick({grid:t,column:l,record:n,cellSelector:r,cellElement:i,target:o,event:a});else{if(o.matches(".b-tree-expander"))return this.cancelEditing(),!1;rn.isTouchEvent&&r.id==s.id&&r.columnId==s.columnId&&this.startEditing(r)}}},{key:"onCellDblClick",value:function(e){var t=e.cellSelector;this.editorContext&&!this.finishEditing()||this.startEditing(t)}},{key:"onStoreUpdate",value:function(e){var t=e.changes,n=e.record,r=this.editorContext;r&&r.editor.isVisible&&n===r.record&&r.editor.dataField in t&&r.editor.refreshEdit()}},{key:"onGridBeforeRenderRows",value:function(){this.editorContext&&this.editorContext.editor.isVisible&&this.cancelEditing()}},{key:"onElementKeyDown",value:(n=Di()(Ei.a.mark((function e(t){var n,r,i,o,a,s,l;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,!t.handled){e.next=3;break}return e.abrupt("return");case 3:if(n.editorContext){e.next=13;break}if(r=t.key,!(i=n.autoEdit&&(1===r.length||"Backspace"===r))&&!Ks[r]||!n.grid.focusedCell){e.next=11;break}if(t.preventDefault(),n.startEditing(n.grid.focusedCell)){e.next=9;break}return e.abrupt("return");case 9:o=n.editor.inputField,a=o.input,i&&a&&(a.value="Backspace"===r?"":r,o.internalOnInput(t),o.moveCaretToEnd());case 11:e.next=39;break;case 13:if("Enter"!==t.key){e.next=25;break}return t.preventDefault(),t.stopPropagation(),e.next=18,n.finishEditing();case 18:if(!e.sent){e.next=25;break}if(n.isEditing){e.next=25;break}if(!(t.ctrlKey||t.metaKey||t.altKey||n.grid.touch)){e.next=24;break}return e.abrupt("return");case 24:t.shiftKey?n.grid.navigateUp()&&n.startEditing(n.grid.focusedCell):n.grid.navigateDown()&&n.startEditing(n.grid.focusedCell);case 25:if("F2"===t.key&&(t.preventDefault(),n.finishEditing()),"Escape"===t.key&&(t.stopPropagation(),t.preventDefault(),n.cancelEditing()),"Tab"!==t.key){e.next=38;break}if(t.preventDefault(),!(s=n.grid.focusedCell)){e.next=38;break}if(!(l=n.getAdjacentEditableCell(s,!t.shiftKey))){e.next=38;break}return e.next=35,n.finishEditing();case 35:if(!e.sent){e.next=38;break}n.grid.focusCell(l,{animate:100}),n.startEditing(l);case 38:Js[t.key]&&(t.handled=!0);case 39:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onElementMouseDown",value:function(e){2===e.button&&this.editorContext&&e.preventDefault()}},{key:"onEditorFocusOut",value:function(e){var t=this,n=t.grid;t.editorContext&&!t.editor.isFinishing&&t.editor.inputField.owns(e.target)&&(e.toWidget!==n||n.isLocationEqual(t.grid.focusedCell,t.editorContext.selector))&&("cancel"===t.blurAction?t.cancelEditing():t.finishEditing())}},{key:"onEditorFocusIn",value:function(e){var t=e.toWidget;t===this.editor.inputField&&this.autoSelect&&t.selectAll&&!t.readOnly&&!t.disabled&&t.selectAll()}},{key:"onTapOut",value:function(e){var t=e.event,n=this;n.grid.bodyContainer.contains(t.target)||n.editor.owns(t.target)||("cancel"===n.blurAction?n.cancelEditing():n.finishEditing())}},{key:"onElementClick",value:function(e){e.target.classList.contains("b-grid-body-container")&&this.editorContext&&this.finishEditing()}},{key:"disabled",set:function(e){fn()(oe()(t.prototype),"disabled",e,this,!0)},get:function(){var e=this.grid;return Boolean(se()(oe()(t.prototype),"disabled",this)||e.disabled||e.readOnly)}},{key:"isEditing",get:function(){return Boolean(this.editorContext)}}],[{key:"$name",get:function(){return"CellEdit"}},{key:"defaultConfig",get:function(){return{autoSelect:!0,blurAction:"complete",addNewAtEnd:null,autoEdit:!1,editorClass:no}}},{key:"pluginConfig",get:function(){return{assign:["startEditing"],before:["onElementKeyDown","onElementMouseDown"],chain:["onElementClick"]}}}]),t}(de(ai));function Zs(){var e=Lr()(['\n                        <div class="b-target-button" data-name="','" data-disabled="','">\n                            <i class="','"></i>\n                            ',"\n                        </div>\n                    "]);return Zs=function(){return e},e}function el(){var e=Lr()(['\n                <div class="b-group">\n                    <div class="b-buttons">\n                    ','\n                    </div>\n                    <div class="b-title">',"</div>\n                </div>\n            "]);return el=function(){return e},e}function tl(){var e=Lr()(['\n            <div class="b-columndragtoolbar">     \n            <div class="b-title"></div>          \n            ',"\n            </div>"]);return tl=function(){return e},e}Qs._$name="CellEdit",Xs.registerFeature(Qs,!0);var nl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){e.features.columnReorder&&e.features.columnReorder.on("beforedestroy",this.onColumnReorderBeforeDestroy,this),this.grid=e,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"doDestroy",value:function(){var e=this;e.grid.features.columnReorder&&!e.grid.features.columnReorder.isDestroyed&&e.detachFromColumnReorder(),e.element&&e.element.remove(),e.element=null,se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.initialized&&(e?this.detachFromColumnReorder():this.init()),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"init",value:function(){var e=this,t=e.grid;t.features.columnReorder&&(e.reorderDetacher=t.features.columnReorder.on({gridheaderdragstart:function(n){var r=n.context,i=t.columns.getById(r.element.dataset.columnId);e.showToolbar(i)},gridheaderdrag:function(t){var n=t.context;return e.onDrag(n)},gridheaderabort:function(){e.hideToolbar()},gridheaderdrop:function(t){var n=t.context;n.valid?e.hideToolbar():e.onDrop(n)},thisObj:e}),e.initialized=!0)}},{key:"onColumnReorderBeforeDestroy",value:function(){this.detachFromColumnReorder()}},{key:"detachFromColumnReorder",value:function(){var e=this;e.grid.features.columnReorder.un("beforedestroy",e.onColumnReorderBeforeDestroy,e),e.reorderDetacher&&e.reorderDetacher(),e.reorderDetacher=null}},{key:"render",value:function(){this.initialized||this.init()}},{key:"showToolbar",value:function(e){var t=this,n=t.grid.getColumnDragToolbarItems(e,[]),r=[];t.clearTimeout(t.buttonHideTimer),t.clearTimeout(t.toolbarHideTimer),n.forEach((function(e){var t=r.find((function(t){return t.text===e.group}));t||(t={text:e.group,buttons:[]},r.push(t)),t.buttons.push(e)})),t.element=rn.append(t.grid.element,t.template(r)),t.groups=r,t.buttons=n,t.column=e}},{key:"hideToolbar",value:function(){var e=this;return new Promise((function(t){e.element&&!e.toolbarHideTimer&&(e.element.classList.add("b-remove"),e.toolbarHideTimer=e.setTimeout((function(){e.toolbarHideTimer=null,e.element&&e.element.remove(),e.element=null,t()}),200))}))}},{key:"onDrag",value:function(e){var t=this;if(e.dragProxy.getBoundingClientRect().top-t.grid.element.getBoundingClientRect().top>100?t.element.classList.add("b-closer"):t.element.classList.remove("b-closer"),t.hoveringButton&&(t.hoveringButton.classList.remove("b-hover"),t.hoveringButton=null),e.targetElement&&e.targetElement.closest(".b-columndragtoolbar")){t.element.classList.add("b-hover");var n=e.targetElement.closest(".b-columndragtoolbar  .b-target-button:not([data-disabled=true])");n&&(n.classList.add("b-hover"),t.hoveringButton=n)}else t.element.classList.remove("b-hover")}},{key:"onDrop",value:function(e){var t=this;if(e.targetElement&&e.targetElement.matches(".b-columndragtoolbar .b-target-button:not([data-disabled=true])")){var n=e.targetElement,r=t.buttons.find((function(e){return e.name===n.dataset.name}));r&&(n.classList.add("b-activate"),t.buttonHideTimer=t.setTimeout((function(){t.hideToolbar(),r.onDrop({column:t.column})}),100))}else t.hideToolbar()}},{key:"template",value:function(e){return Hr.tpl(tl(),e.map((function(e){return Hr.tpl(el(),e.buttons.map((function(e){return Hr.tpl(Zs(),e.name,e.disabled,e.icon,e.text)})),e.text)})))}}],[{key:"$name",get:function(){return"ColumnDragToolbar"}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),t}(de(ai));nl.featureClass="b-hascolumndragtoolbar",nl._$name="ColumnDragToolbar",Xs.registerFeature(nl,ge.isTouchDevice);var rl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.grid=e,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"getColumnPickerItems",value:function(e){var t=this;if(t.groupByRegion)return t.grid.regions.map((function(e){var n=t.grid.getSubGrid(e).columns.topColumns;return{text:A.capitalizeFirstLetter(e),menu:t.buildColumnMenu(n),disabled:0===n.length,region:e}}));if(t.groupByTag){var n={};return e.topColumns.forEach((function(e){e.tags&&e.hideable&&e.tags.forEach((function(e){n[e]||(n[e]=1)}))})),Object.keys(n).sort().map((function(e){return{text:A.capitalizeFirstLetter(e),menu:t.buildColumnMenu(t.getColumnsForTag(e)),tag:e,onBeforeSubMenu:function(e){var n=e.item,r=e.itemEl;t.refreshTagMenu(n,r)}}}))}return t.buildColumnMenu(e.topColumns)}},{key:"getColumnsForTag",value:function(e){return this.grid.columns.records.filter((function(t){return t.tags&&t.tags.includes(e)&&!1!==t.hideable}))}},{key:"refreshTagMenu",value:function(e,t){this.getColumnsForTag(e.tag).forEach((function(t){var n=e.items.find((function(e){return e.column===t}));n&&(n.checked=!0!==t.hidden)}))}},{key:"buildColumnMenu",value:function(e){var t=this,n=e.length>0&&e[0].region,r=this.grid;return e.reduce((function(e,i){var o=t.grid.columns.visibleColumns.filter((function(e){return e.region===i.region}));if(!1!==i.hideable){var a={grid:r,text:i.text,column:i,name:i.id,checked:!0!==i.hidden,disabled:!0!==i.hidden&&1===o.length,cls:i.region!==n?"b-separator":""};n=i.region,i.children&&(a.menu=t.buildColumnMenu(i.children)),e.push(a)}return e}),[])}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.grid,i=n.disabled,o=r.columns;if(!1!==e.showColumnPicker&&o.some((function(e){return e.hideable}))&&t.push({text:n.L("columnsMenu"),name:"columnPicker",icon:"b-fw-icon b-icon-columns",cls:"b-separator",weight:100,menu:n.getColumnPickerItems(o),onToggle:n.onColumnToggle,disabled:i}),!1!==e.hideable){var a=o.visibleColumns.filter((function(t){return t.region===e.region}));t.push({text:n.L("hideColumn"),icon:"b-fw-icon b-icon-hide-column",weight:101,name:"hideColumn",disabled:1===a.length||i,onItem:function(){return e.hide()}})}}},{key:"onColumnToggle",value:function(e){var t=e.menu,n=e.item,r=e.checked;if(!!n.column.hidden!=!r){n.column[r?"show":"hide"]();var i=n.grid,o=n.column,a=i.columns,s=t.items,l=a.visibleColumns.filter((function(e){return e.region===n.column.region})),u=i.features.contextMenu.currentMenu.items.find((function(e){return"hideColumn"===e.name}));if(1===l.length){var c=s.find((function(e){return e.name===l[0].id}));c&&(c.disabled=!0),u&&o.region===n.column.region&&(u.disabled=!0)}else l.forEach((function(e){var t=s.find((function(t){return t.column===e}));t&&(t.disabled=!1)})),u&&o.region===n.column.region&&(u.disabled=!1);n.menu&&n.menu.eachWidget((function(e){e.checked=r}));var d=t.owner;if(d&&d.column===o.parent){var h=s.some((function(e){return!0===e.checked}));d.checked=h}}}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this.grid.columns.visibleColumns.filter((function(t){return t.region===e.region}));return!1!==e.hideable&&n.length>1&&t.push({text:this.L("hideColumnShort"),group:this.L("Column"),icon:"b-fw-icon b-icon-hide-column",weight:101,name:"hideColumn",onDrop:function(e){return e.column.hide()}}),t}}],[{key:"$name",get:function(){return"ColumnPicker"}},{key:"defaultConfig",get:function(){return{groupByRegion:!1,groupByTag:!1}}},{key:"pluginConfig",get:function(){return{chain:["getHeaderMenuItems","getColumnDragToolbarItems"]}}}]),t}(ai);rl._$name="ColumnPicker",Xs.registerFeature(rl,!0);var il=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.ignoreSelectors=[".b-grid-header-resize-handle",".b-field"],this.grid=e,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"doDestroy",value:function(){this.dragHelper&&this.dragHelper.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid,n=t.element,r=rn.children(n,".b-grid-headers");r.push.apply(r,G()(rn.children(n,".b-grid-header-children"))),e.dragHelper?e.dragHelper.containers=r:(e.dragHelper=new qa({name:"columnReorder",mode:"container",dragThreshold:10,targetSelector:".b-grid-header",outerElement:n.querySelector("header.b-grid-header-container"),containers:r,isElementDraggable:function(n){if(Boolean(rn.up(n,e.ignoreSelectors.join(",")))||e.disabled)return!1;var r=rn.up(n,this.targetSelector),i=r&&t.columns.getById(r.dataset.columnId),o=i&&0===i.childLevel&&1===t.subGrids[i.region].columns.count;return Boolean(i)&&!1!==i.draggable&&!o},ignoreSelector:".b-filter-icon,.b-grid-header-resize-handle",listeners:{dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,thisObj:e}}),e.relayEvents(e.dragHelper,["dragStart","drag","drop","abort"],"gridHeader"))}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=Z.fromElement(n.target,"header");r&&r.subGrid.sealedColumns?t.valid=!1:this.grid.features.columnDragToolbar||(t.valid=Boolean(n.target.closest(".b-grid-headers")))}},{key:"onDragStart",value:function(){if(!this.grid.features.columnDragToolbar){var e=this.grid.element.querySelector(".b-grid-header-container").getBoundingClientRect();this.dragHelper.minY=e.top,this.dragHelper.maxY=e.bottom}this.grid.headerContainer.classList.add("b-dragging-header")}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this.grid,r=t.dragging,i=rn.up(t.target,".b-grid-header"),o=n.columns.get(i.dataset.column),a=t.draggedTo.dataset.region||o.region,s=t.insertBefore,l=n.columns.getById(r.dataset.columnId),u=s?n.columns.getById(s.dataset.columnId):n.subGrids[a].columns.last.nextSibling,c=u?u.parent:n.columns.rootNode;if(n.headerContainer.classList.remove("b-dragging-header"),a!==l.region||o!==l.previousSibling&&u!==l.nextSibling){var d=l.parent&&1===l.parent.children.length&&l.parent;d&&d.parent.removeChild(d),r.remove(),l.region=a,c.insertChild(l,u)}else this.dragHelper.abort()}},{key:"onInvalidDrop",value:function(){this.grid.headerContainer.classList.remove("b-dragging-header")}},{key:"renderContents",value:function(){this.init()}},{key:"render",value:function(){this.init()}}],[{key:"$name",get:function(){return"ColumnReorder"}},{key:"pluginConfig",get:function(){return{after:["render","renderContents"]}}}]),t}(de(ai));il.featureClass="b-column-reorder",il._$name="ColumnReorder",Xs.registerFeature(il,!0);var ol=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;r.grid=e,se()(oe()(t.prototype),"construct",this).call(this,e,n),r.resizer=new ls({name:"columnResize",targetSelector:".b-grid-header",handleSelector:".b-grid-header-resize-handle",outerElement:e.element,listeners:{beforeresizestart:r.onBeforeResizeStart,resizestart:r.onResizeStart,resizing:r.onResizing,resize:r.onResize,thisObj:r}})}},{key:"doDestroy",value:function(){this.resizer&&this.resizer.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onBeforeResizeStart",value:function(){return!this.disabled}},{key:"onResizeStart",value:function(e){var t=e.context,n=this.grid,r=this.resizer,i=t.column=n.columns.getById(t.element.dataset.columnId);r.minWidth=i.minWidth,t.element.style.minWidth="",n.element.classList.add("b-column-resizing")}},{key:"onResizing",value:function(e){var t=e.context;t.valid&&this.liveResize&&(this.grid.dragResizing=!0,t.column.width=t.newWidth)}},{key:"onResize",value:function(e){var t=e.context,n=this.grid,r=t.column;if(n.element.classList.remove("b-column-resizing"),t.valid&&(this.liveResize?(n.dragResizing=!1,n.afterColumnsResized()):r.width=t.newWidth,ge.isIE11&&r.parent&&r.parent.flex)){var i=r.parent;n.getHeaderElement(i.id).style.flexBasis=i.children.reduce((function(e,t){return e+n.getHeaderElement(t.id).offsetWidth}),0)+"px"}}},{key:"liveResize",set:function(e){"auto"===e&&(e=!ge.isMobileSafari),this._liveResize=e},get:function(){return this._liveResize}}],[{key:"$name",get:function(){return"ColumnResize"}},{key:"defaultConfig",get:function(){return{liveResize:"auto"}}},{key:"pluginConfig",get:function(){return[]}}]),t}(ai);ol._$name="ColumnResize",Xs.registerFeature(ol,!0);var al=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.grid=e,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"doDestroy",value:function(){this.currentMenu&&this.currentMenu.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(".b-grid-header.b-depth-0"))switch(e.key){case" ":case"ArrowDown":this.showContextMenu(e)}}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=rn.up(e.target,".b-grid-header"),n=this.grid.getEventData(e);t?this.handleHeaderContextMenu(t,e):n&&this.handleCellContextMenu(n,e)}}},{key:"handleHeaderContextMenu",value:function(e,t){if(e.dataset.column){var n=this,r=n.grid,i=r.columns.getById(e.dataset.columnId);if(!1!==i.enableHeaderContextMenu){var o=[].concat(G()(n.headerItems),G()(i.headerMenuItems||[])),a=n.processHeaderItems,s={items:o,column:i,event:t,element:e};r.getHeaderMenuItems(i,o),(!a||!1!==a(s))&&o.length>0&&(t.preventDefault(),o.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),o.forEach((function e(t){t.column||(t.column=i);var n=t.menu;n&&(Array.isArray(n)||(n=n.items||n.widgets),n.forEach(e))})),!1!==r.trigger("headerContextMenuBeforeShow",s)&&(n.currentMenu=te.showContextMenu("keydown"===t.type?e:[t.clientX+1,t.clientY+1],{owner:n.client,constrainTo:document,cls:"b-context-menu",items:o,scrollAction:"hide",onItem:function(e){e.source;var t=e.item,n=e.element;r.trigger("contextMenuItem",{source:r,item:t,column:i,element:n})},onToggle:function(e){e.source;var t=e.item,n=e.checked,o=e.element;r.trigger("contextMenuToggleItem",{source:r,item:t,column:i,checked:n,element:o})},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;s.menu=t,r.trigger("headerContextMenuShow",s)}}})))}}}},{key:"handleCellContextMenu",value:function(e,t){var n=this,r=n.grid,i=e.cellElement,o=r.columns.getById(e.columnId);if(!1!==o.enableCellContextMenu){r.focusCell(e.cellSelector,{doSelect:!r.isSelected(e.id),event:t});var a=e.record,s=[].concat(G()(n.cellItems||[]),G()(o.cellMenuItems||[])),l=n.processCellItems,u={items:s,column:o,event:t,record:a,element:i};r.getCellMenuItems(o,a,s),(!l||!1!==l(u))&&s.length>0&&(s.forEach((function(e){e.column=o,e.record=a})),t.preventDefault(),s.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),!1!==r.trigger("cellContextMenuBeforeShow",u)&&(n.currentMenu=te.showContextMenu([t.clientX+1,t.clientY+1],{owner:n.client,items:s,onBeforeItem:function(e){Object.assign(e,u)},onItem:function(e){var t=e.item;r.trigger("contextMenuItem",{source:r,item:t,column:o,record:a,cell:i})},onClose:function(e){"outside"!==e.reason&&r.element.focus()},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;u.menu=t,r.trigger("cellContextMenuShow",u)}}})))}}},{key:"hideContextMenu",value:function(e){this.currentMenu&&this.currentMenu.hide(e)}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"$name",get:function(){return"ContextMenu"}},{key:"defaultConfig",get:function(){return{headerItems:[],processHeaderItems:null,cellItems:[],processCellItems:null,triggerEvent:null}}},{key:"pluginConfig",get:function(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onElementKeyDown"]}}}]),t}(ai);al.featureClass="",al._$name="ContextMenu",Xs.registerFeature(al,!0);var sl=function(){function e(){C()(this,e)}return x()(e,null,[{key:"get",value:function(e,t){var n=e._domData||(e._domData={});return null!=t?n[t]:n}},{key:"set",value:function(e,t,n){3===arguments.length?(e._domData||(e._domData={}))[t]=n:e._domData=t}},{key:"assign",value:function(e,t){Object.assign(e._domData||(e._domData={}),t)}}]),e}();sl._$name="DomDataStore";var ll=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,this.processConfig(n))}},{key:"initTip",value:function(){var e=this;e.tip=new Ur(Object.assign({forElement:e.client.element,forSelector:".b-grid-cell",hoverDelay:1e3,trackMouse:!1,cls:"b-celltooltip-tip",getHtml:e.getTooltipContent.bind(e),listeners:{pointerOver:"onPointerOver",thisObj:e}},e.initialConfig)),e.relayEvents(e.tip,["beforeshow","show"])}},{key:"onPointerOver",value:function(e){var t=e.target;return!1!==this.client.getColumnFromElement(t).tooltipRenderer}},{key:"processConfig",value:function(e){return"function"==typeof e?{tooltipRenderer:e}:e}},{key:"setConfig",value:function(e){se()(oe()(t.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e?this.tip&&(this.tip.destroy(),this.tip=null):this.initTip(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"getTooltipContent",value:function(e){var t,n=e.tip,r=e.forElement,i=e.event,o=this,a=o.client.getRecordFromElement(r),s=o.client.getColumnFromElement(r);return o.forSelector||a!==o.lastRecord||s!==o.lastColumn?(s.tooltipRenderer?t=s.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o}):o.tooltipRenderer&&!1!==s.tooltipRenderer&&(t=o.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o})),null!=t&&(o.lastRecord=a,o.lastColumn=s),t):o.tip._html}}],[{key:"$name",get:function(){return"CellTooltip"}},{key:"defaultConfig",get:function(){return{tooltipRenderer:null}}}]),t}(ai);ll._$name="CellTooltip",Xs.registerFeature(ll);var ul=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;r.grid=e,r.store=e.store,r.closeFilterEditor=r.closeFilterEditor.bind(r),se()(oe()(t.prototype),"construct",this).call(this,e,n),r.store.on({filter:r.onStoreFilter},r),n&&"object"===U()(n)&&r.store.filter(n,null,r.client.isConfiguring)}},{key:"doDestroy",value:function(){var e=this;e.filterTip&&e.filterTip.destroy(),e.filterEditorPopup&&e.filterEditorPopup.destroy(),e.store.un({sort:e.onStoreFilter},e),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"refreshHeaders",value:function(e){var t=this,n=t.grid,r=n.headerContainer;if(r){rn.children(r,".b-filter-icon.b-latest").forEach((function(e){return e.classList.remove("b-latest")})),t.filterTip||(t.filterTip=new Ur({forElement:r,forSelector:".b-filter-icon",getHtml:function(e){return e.forElement.dataset.filterText}}));var i=!0,o=!1,a=void 0;try{for(var s,l=n.columns[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;if(!1!==u.filterable){var c=t.store.filters.getBy("property",u.field),d=u.element;if(d){var h=u.textWrapper,f=h&&h.querySelector(".b-filter-icon"),g=void 0;g=c?t.L("filter")+": "+("string"==typeof c?c:"".concat(c.operator," ").concat(c.displayValue||c.value||"")):t.L("applyFilter"),f?f.dataset.filterText=g:(f=rn.createElement({parent:h,tag:"div",className:"b-filter-icon",dataset:{filterText:g}}),d.classList.add("b-filterable")),u.field===t.store.latestFilterField&&f.classList.add("b-latest"),d.classList[c?"add":"remove"]("b-filter")}u.meta.isFiltered=!!c}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}e&&n.refreshRows()}}},{key:"applyFilter",value:function(e){var t=this.store,n=this.grid.columns.get(e.property);"function"==typeof n.filterable?t.filter({filterBy:function(t){return n.filterable(Object.assign({},e,{record:t}))},value:e.value,property:e.property,operator:e.operator,displayValue:e.displayValue}):t.filter(e)}},{key:"getPopupDateItems",value:function(e,t,n,r,i,o,a){var s=this,l=o,u=a;function c(e){var t=e.source,n=e.value;null==n?a():(s.applyFilter({property:r,operator:t.operator,value:n,displayValue:t._value}),o())}return[{type:"date",ref:"on",placeholder:s.L("on"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:t&&"="===t.operator?t.value:n,operator:"=",onChange:c,onClose:l,onClear:u},{type:"date",ref:"before",placeholder:s.L("before"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-before"></i>',value:t&&"<"===t.operator?t.value:null,operator:"<",onChange:c,onClose:l,onClear:u},{type:"date",ref:"after",cls:"b-last-row",placeholder:s.L("after"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-after"></i>',value:t&&">"===t.operator?t.value:null,operator:">",onChange:c,onClose:l,onClear:u}]}},{key:"getPopupNumberItems",value:function(e,t,n,r,i,o,a){var s=this,l=o,u=a;function c(e){var t=e.source,n=e.value;null==n?a():(s.applyFilter({property:r,operator:t.operator,value:n}),o())}return[{type:"number",placeholder:s.L("equals"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:t&&"="===t.operator?t.value:n,operator:"=",onChange:c,onEsc:l,onClear:u},{type:"number",placeholder:s.L("lessThan"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:t&&"<"===t.operator?t.value:null,operator:"<",onChange:c,onEsc:l,onClear:u},{type:"number",cls:"b-last-row",placeholder:s.L("moreThan"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:t&&">"===t.operator?t.value:null,operator:">",onChange:c,onEsc:l,onClear:u}]}},{key:"getPopupStringItems",value:function(e,t,n,r,i,o,a){var s=this;return[{type:e,cls:"b-last-row",placeholder:s.L("filter"),clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:t?t.value||t:n,onChange:function(e){var t=e.value;""===t?a():(s.applyFilter({property:r,value:t}),o())},onClose:o,onClear:a}]}},{key:"getPopupItems",value:function(e,t,n,r,i,o,a){switch(e){case"date":return this.getPopupDateItems.apply(this,arguments);case"number":return this.getPopupNumberItems.apply(this,arguments);default:return this.getPopupStringItems.apply(this,arguments)}}},{key:"showFilterEditor",value:function(e,t){var n=this,r=n.store,i="string"==typeof e?n.grid.columns.getById(e):e,o=i.element,a=r.modelClass.fieldMap[i.field],s=r.filters.getBy("property",i.field),l={string:"text",number:"number",date:"date"}[a&&a.type||i.filterType||i.type||"string"]||"text";!1!==i.filterable&&(n.closeFilterEditor(),n.filterEditorPopup=te.openPopup(o,{owner:this.grid,width:"16em",cls:"b-filter-popup",scrollAction:"realign",items:n.getPopupItems(l,s,t,i.field,n.store,n.closeFilterEditor,(function(){n.store.removeFieldFilter(i.field),n.closeFilterEditor()}))}))}},{key:"closeFilterEditor",value:function(){this.filterEditorPopup&&this.filterEditorPopup.setTimeout(this.filterEditorPopup.destroy),this.filterEditorPopup=null}},{key:"getMenuDateItems",value:function(e,t){var n=this,r=t[e.field],i=function(t){n.applyFilter({property:e.field,operator:t,value:r,displayValue:e.formatValue?e.formatValue(r):r})};return[{text:n.L("on"),icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterDateEquals",disabled:n.disabled,onItem:function(){return i("=")}},{text:n.L("before"),icon:"b-fw-icon b-icon-filter-before",name:"filterDateBefore",disabled:n.disabled,onItem:function(){return i("<")}},{text:n.L("after"),icon:"b-fw-icon b-icon-filter-after",name:"filterDateAfter",disabled:n.disabled,onItem:function(){return i(">")}}]}},{key:"getMenuNumberItems",value:function(e,t){var n=this,r=function(r){n.applyFilter({property:e.field,operator:r,value:t[e.field]})};return[{text:n.L("equals"),icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterNumberEquals",disabled:n.disabled,onItem:function(){return r("=")}},{text:n.L("lessThan"),icon:"b-fw-icon b-icon-filter-less",name:"filterNumberLess",disabled:n.disabled,onItem:function(){return r("<")}},{text:n.L("moreThan"),icon:"b-fw-icon b-icon-filter-more",name:"filterNumberMore",disabled:n.disabled,onItem:function(){return r(">")}}]}},{key:"getMenuStringItems",value:function(e,t){var n=this;return[{text:this.L("equals"),icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterStringEquals",disabled:this.disabled,onItem:function(){n.applyFilter({property:e.field,value:t[e.field]})}}]}},{key:"getCellMenuItems",value:function(e,t,n){var r=this,i=t.getFieldDefinition(e.field);if(!1!==e.filterable){var o=[];switch(e.meta.isFiltered&&o.push({text:r.L("removeFilter"),icon:"b-fw-icon b-icon-clear",cls:"b-separator",name:"filterRemove",disabled:r.disabled,onItem:function(){r.store.removeFieldFilter(e.field)}}),e.filterType||e.type||i&&i.type){case"date":o.push.apply(o,G()(r.getMenuDateItems.apply(r,arguments)));break;case"number":o.push.apply(o,G()(r.getMenuNumberItems.apply(r,arguments)));break;default:o.push.apply(o,G()(r.getMenuStringItems.apply(r,arguments)))}e.meta.isFiltered&&o.length>1&&(o[1].cls=""),n.push.apply(n,o)}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;e.meta.isFiltered?(t.push({text:n.L("editFilter"),name:"editFilter",icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:n.disabled,onItem:function(){n.showFilterEditor(e)}}),t.push({text:n.L("removeFilter"),name:"removeFilter",icon:"b-fw-icon b-icon-remove",disabled:n.disabled,onItem:function(){n.store.removeFieldFilter(e.field)}})):!1!==e.filterable&&t.push({text:n.L("filter"),name:"filter",icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:n.disabled,onItem:function(){n.showFilterEditor(e)}})}},{key:"onStoreFilter",value:function(){this.refreshHeaders(!1)}},{key:"renderHeader",value:function(){this.refreshHeaders(!1)}},{key:"onElementClick",value:function(e){var t=e.target;if(this.filterEditorPopup&&this.closeFilterEditor(),t.classList.contains("b-filter-icon")){var n=rn.up(t,".b-grid-header");return this.showFilterEditor(n.dataset.columnId),!1}}}],[{key:"$name",get:function(){return"Filter"}},{key:"pluginConfig",get:function(){return{chain:["renderHeader","getCellMenuItems","getHeaderMenuItems","onElementClick"]}}}]),t}(ai);ul._$name="Filter",Xs.registerFeature(ul);var cl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;Object.assign(r,{filterFieldCls:"b-filter-bar-field",filterFieldInputCls:"b-filter-bar-field-input",filterableColumnCls:"b-filter-bar-enabled",filterFieldInputSelector:".b-filter-bar-field-input",filterableColumnSelector:".b-filter-bar-enabled",filterParseRegExp:/^\s*([<>=*])?(.*)$/,storeTrackingSupended:0,store:e.store,grid:e}),r.onColumnFilterFieldChange=r.onColumnFilterFieldChange.bind(r),se()(oe()(t.prototype),"construct",this).call(this,e,Array.isArray(n)?{filter:n}:n),r.store.on({filter:r.onStoreFilter,thisObj:r}),r.filter&&r.store.filter(r.filter),r.gridDetacher=e.on("beforeelementclick",r.onBeforeElementClick,r)}},{key:"doDestroy",value:function(){this.destroyFilterBar(),this.gridDetacher&&this.gridDetacher(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var n=this,r=this.grid.columns;r&&r.forEach((function(t){var r=n.getColumnFilterField(t);r&&(r.disabled=e)})),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"destroyFilterBar",value:function(){this.grid.columns&&this.grid.columns.forEach(this.destroyColumnFilterField,this)}},{key:"hideFilterBar",value:function(){var e=this,t=e.grid.columns;e.clearStoreFiltersOnHide&&e.suspendStoreTracking(),t&&t.forEach((function(t){return e.hideColumnFilterField(t,!0)})),e.grid.store.filter(),e.clearStoreFiltersOnHide&&e.resumeStoreTracking(),e.hidden=!0}},{key:"showFilterBar",value:function(){this.renderFilterBar(),this.hidden=!1}},{key:"toggleFilterBar",value:function(){this.hidden?this.showFilterBar():this.hideFilterBar()}},{key:"renderFilterBar",value:function(){var e=this;this.grid.columns.visibleColumns.forEach((function(t){return e.renderColumnFilterField(t)})),this.rendered=!0}},{key:"renderColumnFilterField",value:function(e){var t=this,n=t.grid,r=t.getColumnFilterable(e);if(r&&!e.hidden){var i=e.element,o=t.getColumnFilterField(e);if(o)t.onColumnFilterFieldChange({source:o,value:o.value}),o.render(i),o.show();else{var a=n.store.filters.getBy("property",e.field),s="".concat(e.filterType||"text","field");o=te.append(Object.assign({type:s,owner:t.grid,clearable:!0,column:e,name:e.field,value:a&&t.buildFilterString(a),cls:t.filterFieldCls,inputCls:t.filterFieldInputCls,keyStrokeChangeDelay:t.keyStrokeFilterDelay,onChange:t.onColumnFilterFieldChange,onClear:t.onColumnFilterFieldChange,disabled:t.disabled},r.filterField),i)[0],t.setColumnFilterField(e,o)}i.classList.add(t.filterableColumnCls)}}},{key:"updateColumnFilterFields",value:function(){var e,t,n=this.grid,r=!0,i=!1,o=void 0;try{for(var a,s=n.columns[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;(e=this.getColumnFilterField(l))&&(t=n.store.filters.getBy("property",l.field),e.value=t&&this.buildFilterString(t)||"")}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"getColumnFilterable",value:function(e){if(!e.isRoot&&!1!==e.filterable&&e.field)return"function"==typeof e.filterable&&(e.filterable={filterFn:e.filterable}),e.filterable}},{key:"destroyColumnFilterField",value:function(e){var t=this.getColumnFilterField(e);t&&(this.hideColumnFilterField(e),t.destroy(),this.setColumnFilterField(e,void 0))}},{key:"hideColumnFilterField",value:function(e,t){var n=this.grid.store,r=e.element,i=this.getColumnFilterField(e);i&&(i.hide(),this.clearStoreFiltersOnHide&&e.field&&n.removeFieldFilter(e.field,t),r.classList.remove(this.filterableColumnCls))}},{key:"getColumnFilterField",value:function(e){return this._columnFilters&&this._columnFilters[e.data.id]}},{key:"setColumnFilterField",value:function(e,t){this._columnFilters=this._columnFilters||{},this._columnFilters[e.data.id]=t}},{key:"parseFilterValue",value:function(e){var t=String(e).match(this.filterParseRegExp);return{operator:t[1]||"*",value:t[2]}}},{key:"buildFilterString",value:function(e){var t;return e&&!e.initialConfig.filterBy&&(t=("*"===e.operator?"":e.operator)+e.value),t}},{key:"onStoreFilter",value:function(){!this.storeTrackingSupended&&this.rendered&&this.updateColumnFilterFields()}},{key:"suspendStoreTracking",value:function(){this.storeTrackingSupended++}},{key:"resumeStoreTracking",value:function(){this.storeTrackingSupended--}},{key:"renderHeader",value:function(){this.renderFilterBar()}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(this.filterFieldInputSelector))switch(e.key){case"ArrowLeft":case"ArrowRight":e.handled=!0}}},{key:"onBeforeElementClick",value:function(e){if(e.event.target.closest("."+this.filterFieldCls))return!1}},{key:"onColumnFilterFieldChange",value:function(e){var t=e.source,n=e.value,r=this,i=r.grid.store,o=r.getColumnFilterable(t.column);r.suspendStoreTracking(),null==n||""===n?i.removeFieldFilter(t.name):o.filterFn?i.filter({filterBy:function(e){return o.filterFn({property:t.name,value:n,record:e})},property:t.name}):i.filter(Object.assign({property:t.name},r.parseFilterValue(n))),r.resumeStoreTracking()}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;t.push({text:n.L(n.hidden?"enableFilterBar":"disableFilterBar"),name:"toggleFilterBar",icon:"b-fw-icon b-icon-filter",cls:"b-separator",onItem:function(){return n.toggleFilterBar()}})}}],[{key:"$name",get:function(){return"FilterBar"}},{key:"defaultConfig",get:function(){return{keyStrokeFilterDelay:300,clearStoreFiltersOnHide:!0}}},{key:"pluginConfig",get:function(){return{before:["onElementKeyDown"],chain:["renderHeader","getHeaderMenuItems"]}}}]),t}(ai);cl.featureClass="b-filter-bar",cl._$name="FilterBar",Xs.registerFeature(cl);var dl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;e.features.tree||(r._thisIsAUsedExpression(e.features.groupSummary),n=r.processConfig(n),Object.assign(r,{grid:e,rowManager:e.rowManager,store:e.store}),se()(oe()(t.prototype),"construct",this).call(this,e,n),r.store.on({group:r.onStoreGroup,groupingoff:r.onStoreGroupingOff,thisObj:r}),r.rowManager.on({rendercell:r.renderCell,thisObj:r}))}},{key:"processConfig",value:function(e){return"string"==typeof e?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){null===e?this.store.clearGroupers():se()(oe()(t.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var n=this.store;if(e&&n.isGrouped){var r=n.sorters;r.unshift.apply(r,G()(n.groupers)),n.clearGroupers(),n.sort(r)}se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"toggleCollapse",value:function(e,t){this.internalToggleCollapse(e,t)}},{key:"internalToggleCollapse",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.store,o=i.getById(e),a=o.meta;void 0!==a.groupRowFor&&((t=void 0===t?!a.collapsed:t)?i.excludeGroupRecords(o):i.includeGroupRecords(o),a.collapsed=t,r.grid.trigger("toggleGroup",{groupRecord:o,collapse:t}),n||r.rowManager.renderFromRecord(o))}},{key:"collapseAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!0,!0)})),e.grid.refreshRows(!0))}},{key:"expandAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!1,!0)})),e.grid.refreshRows())}},{key:"renderCell",value:function(e){if(this.store.isGrouped&&!this.disabled){var t=e.cellElement,n=e.rowElement,r=e.column,i=this.grid,o=e.record.meta,a=i.columns.visibleColumns[0],s=i.subGrids[i.regions[0]].columns.visibleColumns;o.hasOwnProperty("groupRowFor")?(r.clearCell(t),n.classList[o.collapsed?"add":"remove"]("b-grid-group-collapsed"),n.classList.add("b-group-row"),("rownumber"===a.type&&r===s[1]||"rownumber"!==a.type&&r===s[0])&&t.classList.add("b-group-title"),this.buildGroupHeader(e)):t===n.firstElementChild&&(n.classList.remove("b-group-row"),n.classList.remove("b-grid-group-collapsed"),t.classList.remove("b-group-title"))}}},{key:"buildGroupHeader",value:function(e){var t=this,n=e.record,r=e.cellElement,i=e.column,o=e.persist,a=t.grid,s=n.meta,l=s.childCount-(a.features.groupSummary?1:0),u=a.columns.visibleColumns[0],c=i&&a.subGrids[a.regions[0]].columns.visibleColumns,d="rownumber"===u.type&&i===c[1]||"rownumber"!==u.type&&i===c[0],h=null,f=!0;if(o||i){var g=a.columns.get(s.groupField);g&&g.groupRenderer?d&&(h=g.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:g,count:l})),f=!1):t.groupRenderer&&(h=t.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:g,count:l,isFirstColumn:d}))),d&&null==h&&f&&(h="".concat(null==s.groupRowFor?"":s.groupRowFor," (").concat(l,")"))}else t.groupRenderer&&(h=t.groupRenderer(e));return"string"==typeof h&&(r.innerHTML=h),r.childElementCount>0&&(r._hasHtml=!0),r.innerHTML}},{key:"renderHeader",value:function(e){var t=this.store,n=this.grid;if(t.isGrouped){var r=!0,i=!1,o=void 0;try{for(var a,s=t.groupers[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=n.columns.get(l.field),c=u&&n.getHeaderElement(u.id);c&&(c.classList.add("b-group"),c.classList.add(l.ascending?"b-asc":"b-desc"))}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.store;!1!==e.groupable&&t.push({text:n.L("groupAscending"),icon:"b-fw-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:110,disabled:n.disabled,onItem:function(e){var t=e.item.column;return r.group(t.field,!0)}},{text:n.L("groupDescending"),icon:"b-fw-icon b-icon-group-desc",name:"groupDesc",weight:110,disabled:n.disabled,onItem:function(e){var t=e.item.column;return r.group(t.field,!1)}}),r.isGrouped&&t.push({text:n.L("stopGrouping"),icon:"b-fw-icon b-icon-clear",name:"groupRemove",cls:e.groupable?"":"b-separator",weight:110,disabled:n.disabled,onItem:function(e){e.item.column;return r.clearGroupers()}})}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this,r=n.store;t.push({text:n.L("groupAscendingShort"),group:n.L("Group"),icon:"b-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:110,disabled:n.disabled,onDrop:function(e){var t=e.column;return r.group(t.field,!0)}}),t.push({text:n.L("groupDescendingShort"),group:n.L("Group"),icon:"b-icon b-icon-group-desc",name:"groupDesc",weight:110,disabled:n.disabled,onDrop:function(e){var t=e.column;return r.group(t.field,!1)}});var i=r.groupers&&r.groupers.some((function(t){return t.field===e.field}))&&!n.disabled;return t.push({text:n.L("stopGroupingShort"),group:n.L("Group"),icon:"b-icon b-icon-clear",name:"groupRemove",disabled:!i,weight:110,onDrop:function(e){var t=e.column;return r.removeGrouper(t.field)}}),t}},{key:"onStoreGroup",value:function(e){var t=e.groupers,n=this.grid,r=n.element,i=r&&rn.children(r,".b-grid-header.b-group");if(r){var o=!0,a=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;rn.removeClasses(c,["b-group","b-asc","b-desc"])}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}if(t){var d=!0,h=!1,f=void 0;try{for(var g,v=t[Symbol.iterator]();!(d=(g=v.next()).done);d=!0){var m=g.value,p=n.getHeaderElementByField(m.field);p&&rn.addClasses(p,["b-group",m.ascending?"b-asc":"b-desc"])}}catch(e){h=!0,f=e}finally{try{d||null==v.return||v.return()}finally{if(h)throw f}}}}}},{key:"onStoreGroupingOff",value:function(){var e=rn.children(this.grid.element,".b-grid-header.b-group"),t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;rn.removeClasses(a,["b-group","b-asc","b-desc"])}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.grid.refreshRows()}},{key:"onElementTouchStart",value:function(e){var t=e.target,n=rn.up(t,".b-grid-header"),r=n&&this.grid.getColumnFromElement(n);e.touches.length>1&&r&&!1!==r.groupable&&!this.disabled&&this.store.group(r.field)}},{key:"onElementClick",value:function(e){var t=this.store,n=e.target,r=rn.up(n,".b-group-row"),i=rn.up(n,".b-grid-header"),o=i&&i.dataset.column;if(!n.classList.contains("b-resizer")&&!this.disabled){if(i&&o){var a=t.groupers&&t.groupers.find((function(e){return e.field===o}));if(a&&!e.shiftKey)return t.group(o,!a.ascending),!1;e.shiftKey&&!1!==this.grid.columns.get(o).groupable&&(e.altKey?t.removeGrouper(o):t.group(o)),e.preventDefault()}return r?(this.internalToggleCollapse(sl.get(r).id),!1):void 0}}},{key:"onElementKeyDown",value:function(e){var t=this;!t.disabled&&t.store.isGrouped&&e.target===t.client.element&&" "===e.key&&t.grid.focusedCell&&(e.preventDefault(),t.internalToggleCollapse(t.grid.focusedCell.id))}},{key:"onStoreDataChange",value:function(e){var t=e.source;t.isGrouped&&t.count>0||this.overridden.onStoreDataChange(e)}},{key:"renderer",set:function(e){this.groupRenderer=e}},{key:"field",set:function(e){this._field=e,this.store.group(e,this.ascending)},get:function(){return this._field}}],[{key:"$name",get:function(){return"Group"}},{key:"defaultConfig",get:function(){return{field:null,renderer:null}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll"],chain:["renderHeader","getHeaderMenuItems","getColumnDragToolbarItems","onElementTouchStart","onElementClick","onElementKeyDown"],override:["onStoreDataChange"]}}}]),t}(ai);dl._$name="Group",Xs.registerFeature(dl,!0,["Grid","Scheduler"]);var hl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.grid=e,this.store=e.store,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"doDisable",value:function(e){e&&this.clear(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"showQuickFind",value:function(){var e=this,t=e.grid.getHeaderElement(e.columnId);if(t){if(!e.headerField){var n=rn.createElement({tag:"div",className:"b-quick-hit-header",children:[{tag:"div",className:"b-quick-hit-field"},{tag:"div",className:"b-quick-hit-badge"}]},!0),r=fe()(n,3),i=r[0],o=r[1],a=r[2];"header"===e.mode?t.appendChild(i):(i.className+=" b-quick-hit-mode-grid",e.grid.element.appendChild(i)),e.headerField={header:i,field:o,badge:a,colHeader:t}}e.headerField.field.innerHTML=e.find,e.headerField.badge.innerHTML=e.found.length,t.classList.add("b-quick-find-header"),e.renderListenerInitialized||(e.grid.rowManager.on({rendercell:e.renderCell,thisObj:e}),e.renderListenerInitialized=!0)}}},{key:"hideQuickFind",value:function(){var e=this,t=!0,n=!1,r=void 0;try{for(var i,o=(e.prevFound||e.found)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=e.grid.getRowById(a.id);s&&s.renderCell(s.getCell(e.columnId),a.data)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}e.headerField&&(e.headerField.header.parentNode.removeChild(e.headerField.header),e.headerField.colHeader.classList.remove("b-quick-find-header"),e.headerField=null),e.renderListenerInitialized&&(e.grid.rowManager.un({rendercell:e.renderCell},e),e.renderListenerInitialized=!1),e.grid.trigger("hideQuickFind")}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.columnId,n=this,r=n.grid.columns.getById(t)||n.grid.columns.get(t),i=n.store.findByField(r.field,e),o=1,a=n.grid;Object.assign(n,{foundMap:{},prevFound:n.found,found:i,find:e,columnId:r.id}),e?n.showQuickFind():n.hideQuickFind(),n.currentColumn&&n.currentColumn!==r&&(n.currentColumn.disableHtmlEncode=!1);var s=!0,l=!1,u=void 0;try{for(var c,d=rn.children(a.element,".b-quick-hit")[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h.classList.remove("b-quick-hit"),h.classList.remove("b-quick-hit-cell");var f=sl.get(h).row;f.renderCell(h)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}if(r.disableHtmlEncode=!0,n.currentColumn=r,i){i.length>0&&n.gotoClosestHit(a.focusedCell,i);var g=!0,v=!1,m=void 0;try{for(var p,y=i[Symbol.iterator]();!(g=(p=y.next()).done);g=!0){var k=p.value;n.foundMap[k.id]=o++;var b=a.getRowById(k.data.id);if(b&&b.renderCell(b.getCell(r.id)),o>1e3)break}}catch(e){v=!0,m=e}finally{try{g||null==y.return||y.return()}finally{if(v)throw m}}n.grid.trigger("quickFind",{find:e,found:i})}}},{key:"clear",value:function(){this.found&&this.found.length&&this.search("")}},{key:"gotoHit",value:function(e){var t=this.grid,n=this.found[e];return n&&t.focusCell({columnId:this.columnId,id:n.id}),!!n}},{key:"gotoClosestHit",value:function(e,t){var n=e?this.grid.store.indexOf(e.id):0,r=t.slice().sort((function(e,t){return Math.abs(e.index-n)-Math.abs(t.index-n)}));this.gotoHit(t.indexOf(r[0]))}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"gotoNextHit",value:function(){var e=this.grid,t=e._focusedCell?e._focusedCell.id:e.lastFocusedCell.id,n=e.store.indexOf(t)||0,r=this.found.find((function(e){return e.index>n}));r?e.focusCell({columnId:this.columnId,id:r.id}):this.gotoFirstHit()}},{key:"gotoPrevHit",value:function(){var e,t=this.grid,n=t._focusedCell?t._focusedCell.id:t.lastFocusedCell.id,r=t.store.indexOf(n)||0,i=this.found;if(i.length){for(var o=i.length-1;o--;o>=0)if(i[o].index<r){e=i[o];break}e?t.focusCell({columnId:this.columnId,id:e.id}):this.gotoLastHit()}}},{key:"renderCell",value:function(e){var t=this,n=e.cellElement,r=t.foundMap&&t.columnId===e.column.id&&t.foundMap[e.record.id];if(r){var i=e.column.htmlEncode||e.column.shouldHtmlEncode;if(n.classList.add("b-quick-hit"),i){var o=rn.down(n,".b-grid-cell-value,.b-tree-cell-value")||n,a=o.innerText,s=a&&a.toLowerCase().indexOf(t.find.toLowerCase());if(s>-1){var l=s+t.find.length,u=a.slice(s,l),c="";" "===a[s-1]&&(c="&nbsp;"),a=a.slice(0,s)+'<span class="b-quick-hit-text">'.concat(c).concat(u,"</span>")+a.slice(l),o.innerHTML=a+'<div class="b-quick-hit-cell-badge">'.concat(r,"</div>")}else n.classList.add("b-quick-hit-cell")}else n.classList.add("b-quick-hit-cell")}}},{key:"onElementKeyDown",value:function(e){var t=this,n=this.grid.features.filter;t.disabled||rn.up(e.target,ge.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")||t.find.length>0&&("Backspace"===e.key?(e.preventDefault(),t.find=t.find.substr(0,t.find.length-1),t.search(t.find)):"Escape"===e.key?(e.preventDefault(),t.find="",t.search(t.find)):"F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),e.shiftKey?t.gotoPrevHit():t.gotoNextHit()):n&&t.columnId&&t.foundCount&&e.ctrlKey&&e.shiftKey&&"F"===e.key&&n.showFilterEditor(t.grid.columns.getById(t.columnId),t.find))}},{key:"onElementKeyPress",value:function(e){var t=this;if(!t.disabled&&!rn.up(e.target,ge.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")&&"Enter"!==e.key&&t.grid._focusedCell){var n=t.grid.columns.getById(t.grid._focusedCell.columnId);n&&!1!==n.searchable&&(t.columnId=t.grid._focusedCell.columnId,e.key&&1===e.key.length&&(t.find+=e.key,t.search(t.find)))}}},{key:"onCellNavigate",value:function(e,t,n,r){!(this.prevFound||this.found)||n&&n.columnId===this.columnId||this.clear()}},{key:"foundCount",get:function(){return this.found?this.found.length:0}}],[{key:"$name",get:function(){return"QuickFind"}},{key:"defaultConfig",get:function(){return{mode:"header",find:""}}},{key:"pluginConfig",get:function(){return{chain:["onElementKeyDown","onElementKeyPress","onCellNavigate"]}}}]),t}(ai);hl._$name="QuickFind",Xs.registerFeature(hl);var fl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),Object.assign(this,{store:e.store,grid:e,find:"",hitEls:[]})}},{key:"doDestroy",value:function(){this.clear(!0),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.clear(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"search",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;if(!e)return r.clear();if((n||e!==r.find)&&!r.disabled){var i=r.grid,o=i.columns.visibleColumns.filter((function(e){return!1!==e.searchable})),a=o.map((function(e){return e.field})),s=r.store.search(e,a),l=1;Object.assign(r,{foundMap:{},prevFound:r.found,found:s,find:e});var u=!0,c=!1,d=void 0;try{for(var h,f=rn.children(i.element,".b-search-hit")[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var g=h.value;g.classList.remove("b-search-hit"),g.classList.remove("b-search-hit-cell");var v=sl.get(g).row;v.renderCell(g)}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}if(s){r.hitColumns&&r.hitColumns.forEach((function(e){return e.disableHtmlEncode=!1})),r.hitColumns=[];var m=!0,p=!1,y=void 0;try{for(var k,b=s[Symbol.iterator]();!(m=(k=b.next()).done);m=!0){var w=k.value;r.foundMap[w.field+"-"+w.id]=l++;var S=r.grid.columns.get(w.field);if(S&&(S.disableHtmlEncode=!0,r.hitColumns.push(S)),l>1e3)break}}catch(e){p=!0,y=e}finally{try{m||null==b.return||b.return()}finally{if(p)throw y}}return r.listenersInitialized||(r.grid.rowManager.on({rendercell:r.renderCell},r),r.store.on({refresh:r.onStoreRefresh},r),r.listenersInitialized=!0),i.refreshRows(),r.grid.trigger("search",{grid:i,find:e,found:s}),t&&!r.isHitFocused&&r.gotoNextHit(!0),s}}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid;t.foundMap&&delete t.foundMap,delete t.find,rn.forEachSelector(n.element,".b-search-hit",(function(e){return rn.removeClasses(e,["b-search-hit","b-search-hit-cell"])})),rn.removeEachSelector(n.element,".b-search-hit-cell-badge,.b-search-hit-text"),t.listenersInitialized&&(n.rowManager.un({rendercell:t.renderCell},t),t.store.un({refresh:t.onStoreRefresh},t),t.listenersInitialized=!1),e||(n.refreshRows(),t.grid.trigger("clearSearch",{grid:n}))}},{key:"gotoNextHit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(t.found&&t.found.length){var n=t.grid,r=n.focusedCell||n.lastFocusedCell,i=r&&!e?n.store.indexOf(r.id):-1,o=t.found.findIndex((function(e){return e.index>i}));-1!==o&&t.gotoHit(o)}}},{key:"gotoPrevHit",value:function(){var e=this;if(e.found&&e.found.length)for(var t=e.grid,n=t.focusedCell||t.lastFocusedCell,r=n?t.store.indexOf(n.id):0,i=e.found,o=i.length-1;o--;o>=0){if(i[o].index<r){e.gotoHit(o);break}}}},{key:"gotoHit",value:function(e){var t=this.grid,n=this.found[e];return n&&t.focusCell({field:n.field,id:n.id}),!!n}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"renderCell",value:function(e){var t=e.cellElement,n=e.column,r=e.record,i=e.value,o=e.cellContent,a=this,s=a.foundMap&&a.foundMap[n.field+"-"+r.id];if(s){t.classList.add("b-search-hit");var l=rn.down(t,".b-grid-cell-value")||t,u=String(a.find).toLowerCase();if(String(i).toLowerCase()===u)l.innerHTML='<span class="b-search-hit-text">'.concat(o,'</span><div class="b-search-hit-cell-badge">').concat(s,"</div>");else{var c=String(a.find).toLowerCase(),d=o&&o.toLowerCase().indexOf(c);if(d>-1){var h=d+c.length,f=o.slice(d,h);l.innerHTML="".concat(o.slice(0,d),'<span class="b-search-hit-text">').concat(f,"</span>").concat(o.slice(h),'<div class="b-search-hit-cell-badge">').concat(s,"</div>")}else t.classList.add("b-search-hit-cell")}a.hitEls.push(t)}}},{key:"getCellMenuItems",value:function(e,t,n){var r=this;return e.searchable&&n.push({text:r.L("searchForValue"),icon:"b-fw-icon b-icon-search",cls:"b-separator",name:"search",disabled:r.disabled,onItem:function(e){var t=e.item,n=t.column,i=t.record,o=window.getSelection().toString();o||(o=i[n.field]),r.search(o)}}),n}},{key:"onElementKeyDown",value:function(e){this.find&&""!==this.find&&("F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey))&&(e.preventDefault(),e.shiftKey?this.gotoPrevHit():this.gotoNextHit())}},{key:"onStoreRefresh",value:function(){this.search(this.find,!1,!0)}},{key:"foundCount",get:function(){return this.found&&this.found.length||0}},{key:"isHitFocused",get:function(){var e=this.grid,t=e.focusedCell?e.store.indexOf(e.focusedCell.id):-1,n=e.focusedCell?e.columns.getById(e.focusedCell.columnId):null;return-1!==t&&this.found.some((function(e){return e.index===t&&n&&e.field===n.field}))}}],[{key:"$name",get:function(){return"Search"}},{key:"pluginConfig",get:function(){return{chain:["getCellMenuItems","onElementKeyDown"]}}}]),t}(ai);fl.featureClass="b-search",fl._$name="Search",Xs.registerFeature(fl);var gl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;n=r.processConfig(n),r.store=e.store,r.grid=e,r.store.on({sort:r.syncHeaderSortState,thisObj:r}),se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"processConfig",value:function(e){return"string"==typeof e||Array.isArray(e)?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){se()(oe()(t.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"syncHeaderSortState",value:function(){var e=this,t={};if(!e.grid.isConfiguring){for(var n,r=e.store.sorters,i=r.length,o=new bt,a=0;a<i;a++){var s=r[a];s.field&&(t[s.field]={ascending:s.ascending,sortIndex:a+1})}var l=!0,u=!1,c=void 0;try{for(var d,h=e.grid.columns.bottomColumns[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value,g=f.element;if(g){var v=f.textWrapper&&f.textWrapper.dataset;v&&v.sortIndex&&delete v.sortIndex,o.value=g.classList,!1!==f.sortable?(o.add(e.sortableCls),(n=t[f.field])?(i>1&&v&&(v.sortIndex=n.sortIndex),o.add(e.sortedCls),n.ascending?(o.add(e.sortedAscCls),o.remove(e.sortedDescCls)):(o.add(e.sortedDescCls),o.remove(e.sortedAscCls))):(o.remove(e.sortedCls),o["b-group"]||(o.remove(e.sortedAscCls),o.remove(e.sortedDescCls)))):o.remove(e.sortableCls),rn.syncClassList(g,o)}}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.disabled;if(!1!==e.sortable&&(t.push({text:n.L("sortAscending"),icon:"b-fw-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:105,disabled:r,onItem:function(e){var t=e.item.column;return n.store.sort(t.field,!0)}}),t.push({text:n.L("sortDescending"),icon:"b-fw-icon b-icon-sort-desc",name:"sortDesc",weight:105,disabled:r,onItem:function(e){var t=e.item.column;return n.store.sort(t.field,!1)}}),n.multiSort&&n.grid.columns.records.filter((function(e){return e.sortable})).length>1)){var i=this.grid.store.sorters.find((function(t){return t.field===e.field}));t.push({text:n.L("multiSort"),icon:"b-fw-icon b-icon-sort",name:"multiSort",weight:105,disabled:r,menu:[{text:i?n.L("toggleSortAscending"):n.L("addSortAscending"),icon:"b-fw-icon b-icon-sort-asc",name:"addSortAsc",disabled:i&&i.ascending,weight:105,onItem:function(e){var t=e.item.column;return n.store.addSorter(t.field,!0)}},{text:i?n.L("toggleSortDescending"):n.L("addSortDescending"),icon:"b-fw-icon b-icon-sort-desc",name:"addSortDesc",disabled:i&&!i.ascending,weight:105,onItem:function(e){var t=e.item.column;return n.store.addSorter(t.field,!1)}},{text:n.L("removeSorter"),icon:"b-fw-icon b-icon-remove",name:"remove-sorter",weight:105,disabled:!i,onItem:function(e){var t=e.item.column;return n.store.removeSorter(t.field)}}]})}return t}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this,r=n.store,i=n.disabled;if(!1!==e.sortable){t.push({text:n.L("sortAscendingShort"),group:n.L("Sort"),icon:"b-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!0)}}),t.push({text:n.L("sortDescendingShort"),group:n.L("Sort"),icon:"b-icon b-icon-sort-desc",name:"sortDesc",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!1)}});var o=r.sorters.find((function(t){return t.field===e.field}));Array.prototype.push.apply(t,[{text:n.L("addSortAscendingShort"),group:n.L("Multisort"),icon:"b-icon b-icon-sort-asc",name:"multisortAddAsc",disabled:i||o&&o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!0)}},{text:n.L("addSortDescendingShort"),group:n.L("Multisort"),icon:"b-icon b-icon-sort-desc",name:"multisortAddDesc",disabled:i||o&&!o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!1)}},{text:n.L("removeSorterShort"),group:n.L("Multisort"),icon:"b-icon b-icon-remove",name:"multisortRemove",weight:105,disabled:i||!o,onDrop:function(e){var t=e.column;return r.removeSorter(t.field)}}])}return t}},{key:"onElementClick",value:function(e){var t=this.store,n=e.target,r=rn.up(n,".b-grid-header.b-sortable"),i=r&&r.dataset.column;if(!this.ignoreRe.test(n.className)&&!this.disabled&&r&&i){var o=this.grid.columns.getById(r.dataset.columnId);if(t.isGrouped&&t.groupers.find((function(e){return e.field===i}))&&!e.shiftKey)return;if(o.sortable&&!e.shiftKey)if(e.ctrlKey&&e.altKey)t.removeSorter(o.field);else{var a=o.field;"function"==typeof o.sortable?a={field:o.field,fn:o.sortable}:"object"===U()(o.sortable)&&((a=o.sortable).field||(a.field=a.property||o.field)),t.sort(a,null,e.ctrlKey)}}}},{key:"renderHeader",value:function(){this.syncHeaderSortState()}},{key:"field",set:function(e){var t=this.grid.columns.get(e);t&&"object"===U()(t.sortable)&&(t.sortable.field=t.sortable.property||e,e=t.sortable),this.store.sort(e,this.ascending)}}],[{key:"$name",get:function(){return"Sort"}},{key:"defaultConfig",get:function(){return{multiSort:!0,ignoreRe:new RegExp(["b-grid-header-resize-handle","b-filter-icon"].join("|")),sortableCls:"b-sortable",sortedCls:"b-sort",sortedAscCls:"b-asc",sortedDescCls:"b-desc"}}},{key:"pluginConfig",get:function(){return{chain:["onElementClick","getHeaderMenuItems","getColumnDragToolbarItems","renderHeader"]}}}]),t}(ai);gl.featureClass="b-sort",gl._$name="Sort",Xs.registerFeature(gl,!0);var vl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.grid=e,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"doDestroy",value:function(){se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onElementDblClick",value:function(e){var t=this,n=t.grid,r=rn.up(e.target,".b-grid-splitter-collapsed");if(r&&!t.expanding){t.expanding=!0;var i=r.dataset.region,o=n.getSubGrid(i);o.collapsed||(i=n.getLastRegions()[1],o=n.getSubGrid(i)),o.expand().then((function(){return t.expanding=!1}))}}},{key:"startMove",value:function(e,t){var n=this.grid,r=e.dataset.region,i=n.element,o=n.getSubGrid(r),a=n.regions[n.regions.indexOf(r)+1],s=n.getSubGrid(a),l=1;if(null!=o.flex&&null==s.flex&&(o=s,l=-1),!e.classList.contains("b-grid-splitter-collapsed")){var u=o.element.offsetWidth+s.element.offsetWidth;this.dragContext={element:e,headerEl:o.header.element,subGridEl:o.element,subGrid:o,originalWidth:o.element.offsetWidth,originalX:t,minWidth:o.minWidth||0,maxWidth:Math.min(u,o.maxWidth||u),flip:l},i.classList.add("b-moving-splitter"),e.classList.add("b-moving")}}},{key:"onCollapseClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r){var o=n.getSubGrid(i[1]);if(o.collapsed)return void o.expand()}e.collapse()}},{key:"onExpandClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r&&!e.collapsed)return void n.getSubGrid(i[1]).collapse();e.expand()}},{key:"updateMove",value:function(e){var t=this.dragContext;if(t){var n=e-t.originalX,r=Math.min(t.maxWidth,t.originalWidth+n*t.flip);t.subGrid.width=Math.max(r,t.minWidth)}}},{key:"endMove",value:function(){var e=this.dragContext;e&&(this.grid.element.classList.remove("b-moving-splitter"),e.element.classList.remove("b-moving"),this.dragContext=null)}},{key:"onElementTouchStart",value:function(e){var t=e.target;t.classList.contains("b-grid-splitter")&&(this.startMove(t,e.touches[0].clientX),e.preventDefault())}},{key:"onElementTouchMove",value:function(e){this.dragContext&&(this.updateMove(e.touches[0].clientX),e.preventDefault())}},{key:"onElementTouchEnd",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onElementMouseDown",value:function(e){var t=e.target,n=e.target.closest(":not(.b-row-reordering):not(.b-dragging-event):not(.b-dragging-task):not(.b-dragging-header):not(.b-dragselecting) .b-grid-splitter"),r=n&&this.grid.getSubGrid(n.dataset.region);0===e.button&&(t.classList.contains("b-grid-splitter")||t.classList.contains("b-grid-splitter-inner")?(this.startMove(n,e.clientX),e.preventDefault()):t.classList.contains("b-icon-collapse-gridregion")?this.onCollapseClick(r,n):t.classList.contains("b-icon-expand-gridregion")&&this.onExpandClick(r,n))}},{key:"onElementMouseMove",value:function(e){this.dragContext&&(this.updateMove(e.clientX),e.preventDefault())}},{key:"onElementMouseUp",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onSubGridCollapse",value:function(e){var t=this.grid.resolveSplitter(e);this.grid.getLastRegions()[1]===e.region&&t.classList.add("b-grid-splitter-allow-collapse")}},{key:"onSubGridExpand",value:function(e){this.grid.resolveSplitter(e).classList.remove("b-grid-splitter-allow-collapse")}},{key:"render",value:function(){var e=this.grid,t=e.regions,n=e.subGrids;t.length>2&&(n[t[0]].splitterElement.classList.add("b-left-only"),n[t[1]].splitterElement.classList.add("b-right-only"))}}],[{key:"$name",get:function(){return"RegionResize"}},{key:"pluginConfig",get:function(){return{chain:["onElementTouchStart","onElementTouchMove","onElementTouchEnd","onElementMouseDown","onElementMouseMove","onElementDblClick","onElementMouseUp","onSubGridCollapse","onSubGridExpand","render"]}}}]),t}(ai);vl.featureClass="b-split",vl._$name="RegionResize",Xs.registerFeature(vl);var ml=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.grid=e,se()(oe()(t.prototype),"construct",this).apply(this,arguments)}},{key:"doDestroy",value:function(){this.dragHelper&&this.dragHelper.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid;e.dragHelper=new qa({name:"rowReorder",mode:"translateXY",cloneTarget:!0,dragThreshold:10,targetSelector:".b-grid-row",lockX:!0,transitionDuration:t.transitionDuration,scrollManager:t.scrollManager,dragWithin:t.verticalScroller,outerElement:t.verticalScroller,ignoreSamePositionDrop:!1,createProxy:function(e){var t=e.cloneNode(!0),n=document.createElement("div");return t.removeAttribute("id"),t.style.transform="",n.appendChild(t),n},listeners:{beforedragstart:e.onBeforeDragStart,dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,reset:e.onReset,prio:1e4,thisObj:e}}),e.dropIndicator=rn.createElement({parent:t.bodyContainer,className:"b-row-drop-indicator"}),e.relayEvents(e.dragHelper,["beforeDragStart","dragStart","drag","drop","abort"],"gridRow")}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=this.grid,r=n.regions[0],i=n.subGrids[r].element;return!(this.disabled||n.readOnly||rn.isTouchEvent||!i.contains(t.element))&&!(t.record=this.grid.getRecordFromElement(t.element)).meta.specialRow}},{key:"onDragStart",value:function(e){var t=e.context,n=this,r=n.grid.features.cellEdit,i=n.grid.getRecordFromElement(t.grabbed);if(!i)throw new Error("Failed to find record for dragged element");r&&(n.cellEditDisabledState=r.disabled,r.disabled=!0),n.grid.features.contextMenu&&n.grid.features.contextMenu.hideContextMenu(!1),n.grid.element.classList.add("b-row-reordering");var o=t.element.querySelector(".b-focused");o&&o.classList.remove("b-focused"),rn.removeClasses(t.element.firstElementChild,["b-selected","b-hover"]),n.record=i}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=this,i=r.grid,o=i.store,a=i.rowManager;if(r.dragHelper.outerElement.contains(n.target)&&n.target.closest(".b-grid-subgrid")){var s,l,u,c,d=t.valid,h=r.grid.rowManager.getRowAt(n.clientY);if(h){var f=h.top+r.grid._bodyRectangle.y-r.grid.scrollable.y+h.height/2;l=h.dataIndex,s=h&&o.getAt(l),u=n.clientY>f}else l=o.count-1,s=o.last,h=r.grid.rowManager.getRow(l),u=!0;if(s===r.record&&(d=!1),o.tree){if(rn.removeClsGlobally(r.grid.element,"b-row-reordering-target-parent"),c=u?s.nextSibling:s,r.record.contains(s)&&(d=!1),t.parent=s.parent,!t.parent.isRoot){var g=a.getRowById(t.parent);g&&g.addCls("b-row-reordering-target-parent")}r.clearTimeout(r.hoverTimer),s&&s.isParent&&!s.isExpanded(o)&&(r.hoverTimer=r.setTimeout((function(){return r.grid.expand(s)}),r.hoverExpandTimeout))}else c=u?o.getAt(l+1):s;rn.setTranslateY(r.dropIndicator,h.top+(u?h.height:0)),t.insertBefore=c,t.valid=d}else t.valid=!1}},{key:"onDrop",value:function(e){var t=e.context,n=this,r=n.grid,i=r.store;t.asyncCleanup=t.async=!0,t.element.classList.add("b-dropping"),n.setTimeout((function(){r.element.classList.remove("b-row-reordering"),t.valid&&(i.tree?t.parent.insertChild(n.record,t.insertBefore):i.insert(t.insertBefore?i.indexOf(t.insertBefore):i.count,n.record),i.clearSorters(),t.finalize())}),300)}},{key:"onReset",value:function(){var e=this.grid.features.cellEdit;this.grid.element.classList.remove("b-row-reordering"),e&&(e.disabled=this.cellEditDisabledState),rn.removeClsGlobally(this.grid.element,"b-row-reordering-target-parent")}},{key:"render",value:function(){this.init()}}],[{key:"$name",get:function(){return"RowReorder"}},{key:"defaultConfig",get:function(){return{hoverExpandTimeout:1e3}}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),t}(de(ai));ml.featureClass="",ml._$name="RowReorder",Xs.registerFeature(ml,!1),Xs.registerFeature(ml,!0,"Gantt");var pl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),e.rowManager.on({renderrow:"onRenderRow",thisObj:this})}},{key:"doDisable",value:function(e){this.client.refreshRows(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"onRenderRow",value:function(e){var t=e.row;this.disabled||t.addCls(t.dataIndex%2==0?"b-even":"b-odd")}}],[{key:"$name",get:function(){return"Stripe"}}]),t}(ai);pl._$name="Stripe",Xs.registerFeature(pl);var yl=new Promise((function(e){return e()})),kl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i,o,a,s;return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n);var r=e.columns.find((function(e){return e instanceof Ws}));Object.assign(this,{grid:e,store:e.store,rowManager:e.rowManager,treeColumn:r}),this.store.on({beforeLoadChildren:"onBeforeLoadChildren",loadChildren:"onLoadChildren",loadChildrenException:"onLoadChildrenException",beforeToggleNode:"onBeforeToggleNode",thisObj:this})}},{key:"doDisable",value:function(e){}},{key:"toggleCollapse",value:(s=Di()(Ei.a.mark((function e(t,n){var r,i,o,a,s,l,u,c,d=arguments;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.length>2&&void 0!==d[2]&&d[2],i=(r=this).store,o=r.grid,a=o.rowManager,s=i.getById(t),l=s.instanceMeta(i),e.next=4,i.toggleCollapse(s,n);case 4:if(!e.sent){e.next=10;break}(u=a.getRowFor(s))&&(c=u.getCell(r.treeColumn.id),u.renderCell(c,s)),r.isTogglingNode||(o.element.classList.add("b-toggling-node"),r.isTogglingNode=!0,r.requestAnimationFrame((function(){o.element.classList.remove("b-toggling-node"),r.isTogglingNode=!1}))),o.trigger(l.collapsed?"collapseNode":"expandNode",{source:o,record:s}),o.trigger("toggleNode",{source:o,record:s,collapse:n});case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"collapse",value:(a=Di()(Ei.a.mark((function e(t){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!0));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"expand",value:(o=Di()(Ei.a.mark((function e(t){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onBeforeToggleNode",value:function(e){var t=e.record,n=e.collapse;this.grid.trigger("beforeToggleNode",{record:t,collapse:n})}},{key:"onBeforeLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.addCls("b-loading-children")}},{key:"onLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.removeCls("b-loading-children")}},{key:"onLoadChildrenException",value:function(e){var t=e.record,n=this.grid.rowManager.getRowFor(t);n&&n.removeCls("b-loading-children")}},{key:"expandOrCollapseAll",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.store.rootNode,r=this.grid,i=this.store,o=[];return r.trigger("beforeToggleAllNodes",{source:r,collapse:t}),i.suspendEvents(),i.traverse((function(n){var r=n.instanceMeta(i);n.isLeaf||(t&&!r.collapsed?e.toggleCollapse(n,!0,!0):!t&&r.collapsed&&o.push(e.toggleCollapse(n,!1,!0)))}),n,n===i.rootNode),i.resumeEvents(),(t?yl:Promise.all(o)).then((function(){r.refreshRows(t),r.trigger("toggleAllNodes",{source:r,collapse:t})}))}},{key:"collapseAll",value:(i=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!0));case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"expandAll",value:(r=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"expandTo",value:(n=Di()(Ei.a.mark((function e(t){var n,r,i,o,a;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(r=(n=this).store.getById(t)).instanceMeta(n.store).hiddenByCollapse){e.next=3;break}return e.abrupt("return");case 3:for(i=!1,o=r.parent,a=[];o&&!o.isRoot;)a.push(o),o=o.parent;return e.next=7,a.reverse().forEach(function(){var e=Di()(Ei.a.mark((function e(t){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.instanceMeta(n.store).collapsed&&(i=!0),e.next=3,n.toggleCollapse(t,!1,!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:return i&&n.grid.refreshRows(),e.next=10,n.grid.scrollRowIntoView(r);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onElementClick",value:function(e){var t=e.target,n=this.grid.getEventData(e);(t.classList.contains("b-tree-expander")||this.expandOnCellClick&&n&&n.record.isParent)&&this.toggleCollapse(n.record)}},{key:"onElementKeyDown",value:function(e){e.target===this.client.element&&" "===e.key&&(e.preventDefault(),this.toggleCollapse(this.grid.focusedCell.id))}},{key:"navigateRight",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&r.instanceMeta(t.store).collapsed?this.expand(r):t.navigateDown(e),!1}}},{key:"navigateLeft",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&!r.instanceMeta(t.store).collapsed?this.collapse(r):r.parent&&t.focusCell({id:r.parent.id,columnId:n.columnId}),!1}}}],[{key:"$name",get:function(){return"Tree"}},{key:"defaultConfig",get:function(){return{expandOnCellClick:!1}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll","collapse","expand","expandTo","toggleCollapse"],before:["navigateRight","navigateLeft"],chain:["onElementClick","onElementKeyDown"]}}}]),t}(de(ai));kl.featureClass="b-tree",kl._$name="Tree",Xs.registerFeature(kl,!1,"Grid"),Xs.registerFeature(kl,!0,"TreeGrid");var bl=n(61),wl=n.n(bl),Sl=n(67),Cl=n.n(Sl),El={all:"all",visible:"visible"},xl={A6:{width:4.13,height:5.81},A5:{width:5.81,height:8.25},A4:{width:8.25,height:11.69},A3:{width:11.69,height:16.51},Legal:{width:8.5,height:14},Letter:{width:8.5,height:11}},Dl={portrait:"portrait",landscape:"landscape"},Tl={pdf:"pdf",png:"png"};function Rl(){var e=Lr()(['\n            <!DOCTYPE html>\n            <html class="','" style="width: ',"in; height: ",'in;">\n                <head>\n                    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />\n                    <title>',"</title>\n                    ",'\n                </head>\n                <body class="b-export ','" style="width: ',"in; height: ","in; ",'">\n                    <div class="b-export-content">\n                        ','\n                        <div class="b-export-body"><div class="b-export-viewport">',"</div></div>\n                        ","\n                    </div>\n                </body>\n            </html>"]);return Rl=function(){return e},e}var Ml=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i,o,a;return ue()(t,e),x()(t,[{key:"pageTpl",value:function(e){var t=e.title,n=e.header,r=e.footer,i=e.styles,o=e.htmlClasses,a=e.bodyStyle,s=e.bodyClasses,l=void 0===s?[]:s,u=e.paperHeight,c=e.paperWidth,d=e.html;return l.push("b-".concat(this.constructor.type)),Hr.tpl(Rl(),o,c,u,t,i.join(""),l.join(" "),c,u,a,n&&'<div class="b-export-header" style="width: 100%">'.concat(n,"</div>"),d,r&&'<div class="b-export-footer" style="width: 100%">'.concat(r,"</div>"))}},{key:"getStyleTagURLConverter",value:function(e){return function(t,n){var r;try{var i;/^#/.test(n)?r=t:(i=!0===e?window.location.href:this.keepPathName?window.location.href.replace(window.location.origin,e):e,r="url('".concat(new URL(n,i).href,"')"))}catch(e){r=t}return r}.bind(this)}},{key:"saveState",value:function(e){var t=e.client;this.state=t.state}},{key:"restoreState",value:function(e){e.client.state=this.state}},{key:"beforeExport",value:function(){this.element=document.createElement("div")}},{key:"cloneElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.element,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&(t.innerHTML=""),ge.isChrome?t.appendChild(e.cloneNode(!0)):t.innerHTML=e.outerHTML,rn.removeEachSelector(t,".b-grid-row"),t.querySelector(".b-gridbase > .b-mask").remove()}},{key:"measureElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e instanceof HTMLElement&&(e=e.outerHTML);var t=rn.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:'<div style="height: 1px"></div>'.concat(e,'<div style="height: 1px"></div>')}),n=t.offsetHeight-2;return t.remove(),n}},{key:"prepareHTML",value:function(e){e instanceof HTMLElement&&(e=e.outerHTML);for(var t=rn.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:e}),n=t.querySelectorAll("img"),r=0,i=n.length;r<i;r++)n[r].setAttribute("src",n[r].src);var o=t.innerHTML;return t.remove(),o}},{key:"createPlaceholder",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t&&(e.innerHTML=""),rn.createElement({parent:e,id:Z.generateId("export")})}},{key:"getVirtualScrollerHeight",value:function(e){var t=0;return e.eachSubGrid((function(e){e.overflowingHorizontally&&(t=rn.scrollBarWidth)})),0===t?t:t+1}},{key:"inchToPx",value:function(e){return 96*e}},{key:"getScaleValue",value:function(e,t){return Math.floor(1e4*e/t)/1e4}},{key:"export",value:(a=Di()(Ei.a.mark((function e(t){var n,r;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this).beforeExport(),n.saveState(t),e.next=5,n.prepareComponent(t);case 5:return e.next=7,n.getPages(t);case 7:return r=e.sent,e.next=10,n.restoreComponent(t);case 10:return n.stylesheets=null,e.next=13,new Promise((function(e){return n.requestAnimationFrame(e)}));case 13:return n.restoreState(t),e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getPages",value:(o=Di()(Ei.a.mark((function e(t){var n,r,i;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.pagesExtractor(t),r=[];case 1:return e.next=3,n.next();case 3:if(e.t0=i=e.sent,!e.t0){e.next=6;break}e.t0=!i.done;case 6:if(!e.t0){e.next=10;break}r.push(i.value),e.next=1;break;case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"prepareComponent",value:(i=Di()(Ei.a.mark((function e(t){var n,r,i,o,a,s,l;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=t.columns,o=t.rowsRange,a=n.exportMeta={totalWidth:0,totalHeight:0-n.getVirtualScrollerHeight(r),subGrids:{}},r.columns.forEach((function(e){i.includes(e.id)?e.show():e.hide()})),!(r.rowManager.rowCount>0)){e.next=13;break}if(o!==El.all){e.next=9;break}return a.firstVisibleDataIndex=r.rowManager.rows[0].dataIndex,e.next=7,r.scrollable.scrollTo(0,0);case 7:e.next=13;break;case 9:return s=a.firstVisibleDataIndex=r.rowManager.rows.find((function(e){return e.bottom>r.scrollable.y})).dataIndex,e.next=12,r.scrollRowIntoView(r.store.getAt(s),{block:"start"});case 12:t.alignRows=!0;case 13:this.cloneElement(r.element),l=n.element,r.eachSubGrid((function(e){var t=n.createPlaceholder(l.querySelector('[id="'.concat(e.id,'"]')),!1),i=e.columns.visibleColumns.reduce((function(e,t){return"number"==typeof t.width?e+=t.width:e+=r.getHeaderElement(t.id).offsetWidth,e}),0);a.totalWidth+=i;var o=e.splitterElement;o&&(a.totalWidth+=o.offsetWidth),a.subGrids[e.region]={id:e.id,headerId:e.header&&e.header.id||null,footerId:e.footer&&e.footer.id||null,rows:[],placeHolder:t,width:i}}));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta;return Object.values(t.subGrids).forEach((function(t){var n=t.width;[t.id,t.headerId,t.footerId].forEach((function(t){t&&(e.querySelector('[id="'.concat(t,'"]')).style.width="".concat(n,"px"))}))})),e.innerHTML}},{key:"restoreComponent",value:(r=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"scrollRowIntoView",value:(n=Di()(Ei.a.mark((function e(t,n){var r=this;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollRowIntoView(t.store.getAt(n),{block:"start"});case 2:return e.next=4,new Promise((function(e){return r.requestAnimationFrame(e)}));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"stylesheets",get:function(){var e=this,t=this;if(t._stylesheets)return t._stylesheets;var n=t.translateURLsToAbsolute,r=window.origin,i=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),o=[];return i.forEach((function(i){var a,s;(i=i.cloneNode(!0),n&&i.href)&&(a=!0===n?i.href:e.keepPathName?i.href.replace(r,n):new URL(i.getAttribute("href"),n),i.setAttribute("href",a));if(s=ge.isIE11&&i.styleSheet&&/style/i.test(i.tagName)?'<style type="text/css">'.concat(i.styleSheet.cssText,"</style>"):i.outerHTML,n&&/style/i.test(i.tagName)){var l=t.getStyleTagURLConverter(n);s=s.replace(/url\(['"]?(.+?)['"]?\)/g,l)}o.push(s)})),o.push("<style>\n                body, html {\n                    overflow: auto;\n                }\n                \n                body {\n                    position: relative;\n                    margin: 0;\n                }\n            </style>"),t._stylesheets=o},set:function(e){this._stylesheets=e}}],[{key:"defaultConfig",get:function(){return{translateURLsToAbsolute:!0,keepPathName:!0}}}]),t}(de(ze(Ve(z))));Ml.prototype.pagesExtractor=function(){var e=Cl()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,"";case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ml._$name="Exporter";var Fl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i,o,a;return ue()(t,e),x()(t,[{key:"stateNextPage",value:(a=Di()(Ei.a.mark((function e(t){var n,r;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,++(r=this.exportMeta).currentPage,++r.verticalPosition,delete r.lastExportedRowBottom,!(r.verticalPosition>=r.verticalPages)){e.next=10;break}return r.verticalPosition=r.currentPageTopMargin=0,++r.horizontalPosition,e.next=10,this.scrollRowIntoView(n,r.firstVisibleDataIndex,{block:"start"});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"prepareComponent",value:(o=Di()(Ei.a.mark((function e(n){var r,i,o,a,s,l,u,c,d,h,f,g,v,m,p,y,k,b,w,S,C,E;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(oe()(t.prototype),"prepareComponent",this).call(this,n);case 2:i=(r=this).exportMeta,o=n.client,a=n.headerTpl,s=n.footerTpl,l=n.alignRows,u=xl[n.paperFormat],c=n.orientation===Dl.portrait,d=c?u.width:u.height,h=c?u.height:u.width,f=r.inchToPx(d),g=r.inchToPx(h),v=Math.ceil(i.totalWidth/f),m=i.totalHeight+o.height-o.bodyHeight+o.scrollable.scrollHeight,p=g,a&&(p-=r.measureElement(a({totalWidth:i.totalWidth,totalPages:-1,currentPage:-1}))),s&&(p-=r.measureElement(s({totalWidth:i.totalWidth,totalPages:-1,currentPage:-1}))),k=o.store.count,n.rowsRange===El.visible&&(k=o.rowManager.visibleRowCount,b=o.rowManager.rows[k-1].bottom,m=m-o.scrollable.scrollHeight+b),l?(w=o.rowManager.rowOffsetHeight,S=Math.floor((p-o.headerHeight)/w),C=Math.floor(p/w),E=k-S,y=1+Math.ceil(E/C)):y=Math.ceil(m/p),Object.assign(i,{paperWidth:d,paperHeight:h,pageWidth:f,pageHeight:g,horizontalPages:v,verticalPages:y,totalHeight:m,contentHeight:p,totalRows:k,totalPages:v*y,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0}),this.adjustRowBuffer(o);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"restoreComponent",value:(i=Di()(Ei.a.mark((function e(n){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(oe()(t.prototype),"restoreComponent",this).call(this,n);case 2:this.restoreRowBuffer(n.client);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"adjustRowBuffer",value:function(e){var t=this.exportMeta.contentHeight,n=e.rowManager;this.oldRowManagerConfig={prependRowBuffer:n.prependRowBuffer,appendRowBuffer:n.appendRowBuffer};var r=Math.ceil(t/n.rowOffsetHeight);n.prependRowBuffer=r,n.appendRowBuffer=r,e.renderRows()}},{key:"restoreRowBuffer",value:function(e){e.rowManager.prependRowBuffer=this.oldRowManagerConfig.prependRowBuffer,e.rowManager.appendRowBuffer=this.oldRowManagerConfig.appendRowBuffer,e.renderRows()}},{key:"buildPage",value:(r=Di()(Ei.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,d,h,f,g,v,m,p,y,k,b,w,S,C,E,x,D,T,R,M;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,s=t.alignRows,l=r.totalWidth,u=r.totalPages,c=r.currentPage,d=r.subGrids,h=r.currentPageTopMargin,f=r.verticalPosition,g=r.totalRows,v=i.rowManager,m=v.rows,Object.values(d).forEach((function(e){return e.rows=[]})),t.rowsRange===El.all&&(r.totalHeight=i.height-i.bodyHeight+i.scrollable.scrollHeight-n.getVirtualScrollerHeight(i)),p=0,y=0,k=t.rowsRange===El.visible?m.findIndex((function(e){return e.bottom>i.scrollable.y})):m.findIndex((function(e){return e.bottom+h+i.headerHeight>0})),C=k,E=0===f?0:m[k].top+h+i.headerHeight,o&&(w=n.prepareHTML(o({totalWidth:l,totalPages:u,currentPage:c})),p=n.measureElement(w)),a&&(S=n.prepareHTML(a({totalWidth:l,totalPages:u,currentPage:c})),y=n.measureElement(S)),b=r.pageHeight-p-y-E,0===f&&(b-=i.headerHeight),D=0;b>0;)T=m[k],s&&b<T.offsetHeight?(D=-b,b=0,n.exportMeta.lastExportedRowBottom=m[k-1].bottom):(n.collectRow(T),b-=T.offsetHeight,x=T.dataIndex,++k===m.length&&b>0?x+1===i.store.count&&(b=0):t.rowsRange===El.visible&&k-C===g&&(b=0));return e.next=13,n.onRowsCollected(m.slice(C,k),t);case 13:if(t.rowsRange!==El.visible){e.next=17;break}r.scrollableTopMargin=i.scrollable.y,e.next=21;break;case 17:return R=v.on("offsetrows",(function(e){var t=e.offset;return D+=t})),e.next=20,n.scrollRowIntoView(i,x+1);case 20:R();case 21:return M=n.buildPageHtml(),e.abrupt("return",{html:M,header:w,footer:S,offset:D});case 23:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onRowsCollected",value:(n=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(e){var n=fe()(e,2),r=n[0],i=n[1];t[r].rows.push(i.outerHTML)}))}},{key:"buildPageHtml",value:function(){var e=this.exportMeta.subGrids,t=this.prepareExportElement();return Object.values(e).forEach((function(e){var n=e.placeHolder,r=e.rows,i=n.outerHTML;t=t.replace(i,r.join(""))})),t}},{key:"prepareExportElement",value:function(){var e=this.element,n=this.exportMeta;return n.scrollableTopMargin&&(e.querySelector(".b-grid-vertical-scroller").style.marginTop="-".concat(n.scrollableTopMargin,"px")),se()(oe()(t.prototype),"prepareExportElement",this).call(this)}}],[{key:"type",get:function(){return"multipage"}},{key:"title",get:function(){return this.L("multipage")}}]),t}(Ml);Fl.prototype.pagesExtractor=function(){var e=Cl()(Ei.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,d,h,f,g,v,m;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this).exportMeta,i=n.stylesheets,o=r.totalWidth,a=r.totalPages,s=r.paperWidth,l=r.paperHeight,u=r.contentHeight;case 1:if(!((c=r.currentPage)<a)){e.next=18;break}return n.trigger("exportStep",{text:n.L("exportingPage",{currentPage:c,totalPages:a}),progress:Math.round((c+1)/a*90)}),e.next=5,wl()(n.buildPage(t));case 5:return d=e.sent,h=d.html,f=d.header,g=d.footer,v=d.offset,m=[].concat(G()(i),["\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(r.totalHeight,"px !important;\n                        width: ").concat(o,"px !important;\n                    }\n                    \n                    .b-export-body .b-export-viewport {\n                        margin-left : ").concat(-s*r.horizontalPosition,"in;\n                        margin-top  : ").concat(r.currentPageTopMargin,"px;\n                    }\n                </style>\n            ")]),r.currentPageTopMargin-=u+v,e.next=14,wl()(n.stateNextPage(t));case 14:return e.next=16,{html:n.pageTpl({html:h,header:f,footer:g,styles:m,paperWidth:s,paperHeight:l})};case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Fl._$name="MultiPageExporter";var _l=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r;return ue()(t,e),x()(t,[{key:"prepareComponent",value:(r=Di()(Ei.a.mark((function e(n){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(oe()(t.prototype),"prepareComponent",this).call(this,n);case 2:Object.assign(this.exportMeta,{verticalPages:1,horizontalPages:1,totalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onRowsCollected",value:(n=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=0;return e.map((function(e){var n=fe()(e,2),r=n[0],i=n[1],o=r.replace(/translate\(\d+px, \d+px\)/,"translate(0px, ".concat(t,"px)"));return t+=i,o}))}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=fe()(n,2),i=r[0],o=r[1];t[i].rows.push([o.outerHTML,e.offsetHeight])}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta.subGrids,n=e.prepareExportElement();return Object.values(t).forEach((function(t){var r=t.placeHolder,i=t.rows,o=r.outerHTML;n=n.replace(o,e.positionRows(i).join(""))})),n}}],[{key:"type",get:function(){return"singlepage"}},{key:"title",get:function(){return this.L("singlepage")}},{key:"defaultConfig",get:function(){return{centerContentHorizontally:!1}}}]),t}(Ml);_l.prototype.pagesExtractor=function(){var e=Cl()(Ei.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,d,h,f,g,v,m,p,y,k,b,w,S,C,E,x,D,T,R,M;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=r.rowManager,o=r.store,a=n.stylesheets,s=t.orientation===Dl.portrait,l=xl[t.paperFormat],u=s?l.width:l.height,c=s?l.height:l.width,d=t.rowsRange===El.visible&&o.count?i.visibleRowCount:o.count,h=n.exportMeta,f=h.totalHeight,g=h.totalWidth,v=0,m=-1,!(i.rows.length>0)){e.next=16;break}t.rowsRange===El.visible&&(m=i.rows.find((function(e){return e.bottom>r.scrollable.y})).dataIndex-1);case 4:if(!(v<d)){e.next=16;break}return k=i.rows,b=k[k.length-1],w=v,k.forEach((function(e){e.dataIndex>m&&v<d&&(++v,f+=e.offsetHeight,n.collectRow(e))})),S=k.findIndex((function(e){return e.dataIndex===m+1})),C=S+(v-w),e.next=10,wl()(n.onRowsCollected(k.slice(S,C),t));case 10:if(!(v<d)){e.next=14;break}return m=b.dataIndex,e.next=14,wl()(n.scrollRowIntoView(r,m+1));case 14:e.next=4;break;case 16:return E=n.buildPageHtml(),f+=r.height-r.bodyHeight,x=f,t.headerTpl&&(p=n.prepareHTML(t.headerTpl({totalWidth:g})),D=n.measureElement(p),f+=D),t.footerTpl&&(y=n.prepareHTML(t.footerTpl({totalWidth:g})),T=n.measureElement(y),f+=T),R=Math.min(1,n.getScaleValue(n.inchToPx(u),g)),M=Math.min(1,n.getScaleValue(n.inchToPx(c),f)),a.push("<style>\n                #".concat(r.id," {\n                    height: ").concat(x,"px !important;\n                    width: ").concat(g,"px !important;\n                }\n                \n                .b-export-content {\n                    ").concat(n.centerContentHorizontally?"left: 50%;":"","\n                    transform: scale(").concat(Math.min(R,M),") ").concat(n.centerContentHorizontally?"translateX(-50%)":"",";\n                    transform-origin: top left;\n                }\n            </style>")),e.next=25,{html:n.pageTpl({html:E,header:p,footer:y,styles:a,paperWidth:u,paperHeight:c})};case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),_l._$name="SinglePageExporter";var Al=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e;this.inConstruct=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=se()(oe()(t.prototype),"construct",this)).call.apply(e,[this].concat(r)),this.inConstruct=!1}},{key:"buildLocalizedItems",value:function(){return[]}},{key:"updateLocalizedItems",value:function(){var e=this;if(e.store&&!e.inConstruct){var t=e.value;e.store.data=e.buildLocalizedItems(),e.value=null,e.value=t,e.syncInputFieldValue(!0)}}},{key:"updateLocalization",value:function(){this.updateLocalizedItems(),se()(oe()(t.prototype),"updateLocalization",this).call(this)}},{key:"items",set:function(e){!0===e&&(e=this.buildLocalizedItems()),fn()(oe()(t.prototype),"items",e,this,!0)},get:function(){return se()(oe()(t.prototype),"items",this)}}],[{key:"$name",get:function(){return"LocalizableComboItems"}},{key:"defaultConfig",get:function(){return{items:!0}}}]),t}(e||qi)},Il=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),t}(Al(qi));Il._$name="LocalizableCombo",X.register("localizablecombo",Il);var Ll=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){return[{id:El.all,text:this.L(El.all)},{id:El.visible,text:this.L(El.visible)}]}}],[{key:"$name",get:function(){return"ExportRowsCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),t}(Il);Ll._$name="ExportRowsCombo",X.register(Ll.$name,Ll);var Ol=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){return[{id:Dl.portrait,text:this.L(Dl.portrait)},{id:Dl.landscape,text:this.L(Dl.landscape)}]}}],[{key:"$name",get:function(){return"ExportOrientationCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),t}(Il);Ol._$name="ExportOrientationCombo",X.register(Ol.$name,Ol);var Pl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildDialogItems",value:function(e){var t=this,n=e.exporters,r=e.client,i=t.L("labelWidth");function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return Object.keys(e).map((function(e){return{id:e,text:t(e)}}))}return t.columnsStore=r.columns.chain((function(e){return e.isLeaf})),[{labelWidth:i,type:"combo",ref:"columnsField",label:"L{columns}",localeClass:this,store:t.columnsStore,value:t.columnsStore.allRecords,valueField:"id",displayField:"text",multiSelect:!0},{labelWidth:i,type:"exportrowscombo",ref:"rowsRangeField",label:"L{rows}",localeClass:this,value:El.all},{labelWidth:i,type:"localizablecombo",ref:"exporterTypeField",label:"L{exporterType}",localeClass:this,editable:!1,value:n[0].type,buildLocalizedItems:function(){return n.map((function(e){return{id:e.type,text:e.title}}))},onChange:function(e){var t=e.value;this.owner.widgetMap.alignRowsField.hidden="multipage"!==t}},{labelWidth:i,type:"checkbox",ref:"alignRowsField",label:"L{alignRows}",localeClass:this,checked:!0,hidden:"multipage"!==n[0].type},{labelWidth:i,type:"combo",ref:"fileFormatField",label:"L{fileFormat}",localeClass:this,editable:!1,value:Tl.pdf,items:o(Tl,(function(e){return e.toUpperCase()})),onChange:function(e){var n=e.value,r=e.oldValue;if(t.hidePNGMultipageOption){var i=t.widgetMap.exporterTypeField,o=i.store.find((function(e){return"singlepage"===e.id}));n===Tl.png&&o?(this._previousDisabled=i.disabled,i.disabled=!0,this._previousValue=i.value,i.value="singlepage"):r===Tl.png&&this._previousValue&&(i.disabled=this._previousDisabled,i.value=this._previousValue)}}},{labelWidth:i,type:"combo",ref:"paperFormatField",label:"L{paperFormat}",localeClass:this,editable:!1,value:"A4",items:o(xl)},{labelWidth:i,type:"exportorientationcombo",ref:"orientationField",label:"L{orientation}",localeClass:this,value:Dl.portrait}]}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=e.client;if(!r)throw new Error("`client` config is required");var i,o=n.buildDialogItems(e);e.items?Array.isArray(e.items)?(i=e.items).push.apply(i,G()(o)):o.forEach((function(t){e.items[t.ref]=t,delete t.ref})):e.items=o;e.width=e.width||n.L("width"),se()(oe()(t.prototype),"construct",this).call(this,e),n.widgetMap.exportButton.on("click",n.onExportClick,n),n.widgetMap.cancelButton.on("click",n.onCancelClick,n),je.on({locale:"onLocaleChange",prio:-1,thisObj:n})}},{key:"onLocaleChange",value:function(){var e=this.L("labelWidth");this.width=this.L("width"),this.eachWidget((function(t){t instanceof ri&&(t.labelWidth=e)}))}},{key:"onExportClick",value:function(){var e=this.values;this.trigger("export",{values:e})}},{key:"onCancelClick",value:function(){this.trigger("cancel"),this.hide()}},{key:"values",get:function(){var e=/field/i,t={};return this.eachWidget((function(n){e.test(n.ref)&&(t[n.ref.replace(e,"")]=n instanceof oi?n.checked:n.value)})),t}}],[{key:"$name",get:function(){return"ExportDialog"}},{key:"defaultConfig",get:function(){return{autoShow:!1,autoClose:!1,closable:!0,centered:!0,client:null,hidePNGMultipageOption:!0,title:"L{exportSettings}",bbar:[{type:"button",ref:"exportButton",color:"b-green",localeClass:this,text:"L{export}"},{type:"button",ref:"cancelButton",color:"b-gray",localeClass:this,text:"L{cancel}"}]}}}]),t}(Ar);Pl._$name="ExportDialog";var Hl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n;return ue()(t,e),x()(t,[{key:"getExporter",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=n.exportersMap,i=t,o=i.type;if(r.has(o))e=r.get(o);else{var a=this.exporters.find((function(e){return e.type===o}));if(!a)throw new Error("Exporter type ".concat(o," is not found. Make sure you've configured it"));delete(t=kt.clone(t)).type,(e=new a(t)).relayAll(n),r.set(o,e)}return e}},{key:"buildRequest",value:function(e,t){return{html:JSON.stringify(e),fileFormat:t.fileFormat,format:t.paperFormat,orientation:t.orientation}}},{key:"buildExportConfig",value:function(e){var t=this,n=t.client,r=t.exportServer,i=t.clientURL,o=t.fileName,a=t.fileFormat,s=t.paperFormat,l=t.rowsRange,u=t.alignRows,c=t.orientation,d=t.exporters,h=t.translateURLsToAbsolute,f=t.keepPathName,g=t.headerTpl,v=t.footerTpl;return kt.assign({client:n,exportServer:r,clientURL:i,fileName:o,fileFormat:a,paperFormat:s,rowsRange:l,alignRows:u,orientation:c,translateURLsToAbsolute:h,keepPathName:f,headerTpl:g,footerTpl:v,exporterType:d[0].type},e)}},{key:"export",value:(n=Di()(Ei.a.mark((function e(){var t,n,r,i,o,a,s,l,u,c,d=arguments;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:{},r=(n=this).client,i=n.pagesPerRequest,(t=n.buildExportConfig(t)).exporterConfig=kt.assign({type:t.exporterType,translateURLsToAbsolute:t.translateURLsToAbsolute,keepPathName:t.keepPathName},t.exporterConfig||{}),!1===r.trigger("beforeExport",t)){e.next=29;break}if(a=n.getExporter(t.exporterConfig),r.ignoreViewBox=!0,r.mask(r.loadMask),0!==i){e.next=27;break}return e.next=11,a.export(t);case 11:return s=e.sent,n.trigger("exportStep",{progress:90,text:n.L("Waiting for response from server...")}),e.prev=13,e.next=16,Pe.fetch(t.exportServer,{method:"POST",body:JSON.stringify({html:s,orientation:t.orientation,format:t.paperFormat,fileFormat:t.fileFormat,fileName:t.fileName,clientURL:t.clientURL}),credentials:"omit",headers:{"Content-Type":"application/json"},parseJson:!0});case 16:l=e.sent,o={response:l},l.ok&&(u=l.parsedJson,n.openAfterExport&&(u.success?ge.isIE11?window.open(u.url,"ExportedPanel"):((c=document.createElement("a")).download="export",c.href=u.url,n.openInNewTab&&(c.target="_blank"),document.body.appendChild(c),c.click(),document.body.removeChild(c)):te.toast(u.msg))),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(13),o=e.t0 instanceof Response?{response:e.t0}:{error:e.t0};case 24:n.trigger("export",o),n.exportDialog&&(n.exportDialog.close(),!o.error&&o.response.ok||te.toast("Failed request to the export server")),r.trigger("export",o);case 27:r.unmask(),r.ignoreViewBox=!1;case 29:return e.abrupt("return",o);case 30:case"end":return e.stop()}}),e,this,[[13,21]])}))),function(){return n.apply(this,arguments)})},{key:"showExportDialog",value:function(){var e=this;e.exportDialog||(e.exportDialog=new Pl({client:e.client,exporters:e.exporters,listeners:{export:e.onExportDialogExport,thisObj:e}})),e.exportDialog.show()}},{key:"onExportDialogExport",value:function(e){var t=e.values,n=this;n.mask=new dn({progress:0,maxProgress:100,text:"Generating pages...",element:n.exportDialog.element});var r=n.on({export:function(){n.mask.close(),r()},exportstep:function(e){var t=e.progress,r=e.text;n.mask.progress=t,n.mask.text=r}});n.currentExportPromise=n.export(t),n.currentExportPromise.then((function(){return n.currentExportPromise=null}))}},{key:"currentExportPromise",get:function(){return this._currentExportPromise},set:function(e){this._currentExportPromise=e}},{key:"exportersMap",get:function(){return this._exportersMap||(this._exportersMap=new Map)}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exportServer:void 0,fileName:"export",fileFormat:"pdf",clientURL:null,paperFormat:"A4",orientation:"portrait",rowsRange:"all",alignRows:!1,pagesPerRequest:0,exporterConfig:null,exporterType:"singlepage",exporters:[_l,Fl],translateURLsToAbsolute:!0,keepPathName:!0,openAfterExport:!0,openInNewTab:!1}}}]),t}(Ve(ai));Hl._$name="PdfExport",Xs.registerFeature(Hl,!1,"Grid");var Nl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return e=kt.assign({},t.config,e),t.normalizeColumns(e),t.generateExportData(e)}},{key:"generateExportData",value:function(e){var t=this.generateColumns(e);return{rows:this.generateRows(e),columns:t}}},{key:"normalizeColumns",value:function(e){var t=this,n=e.columns||this.target.columns.visibleColumns.filter((function(e){return!1!==e.exportable}));e.columns=n.map((function(e){return"string"==typeof e?t.target.columns.find((function(t){return t.field===e}))||{field:e}:e}))}},{key:"generateColumns",value:function(e){var t=this;return e.columns.map((function(n){return t.processColumn(n,e)}))}},{key:"generateRows",value:function(e){var t=e.columns;if(!t.length)return[];var n=this;return n.target.store.map((function(r){return n.processRecord(r,t,e)})).filter((function(e){return e.length}))}},{key:"getColumnType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.target.store,n=e.exportedType||"object";if(void 0===e.exportedType&&e.field){var r=t.modelClass.getFieldDefinition(e.field);r&&r.type&&(n=r.type)}return n}},{key:"processColumn",value:function(e,t){var n=this.target,r=t.defaultColumnWidth,i=e.field,o=e.text,a=e.width,s=e.minWidth;if(i in n.store.modelClass.fieldMap||(i=""),!o||!a){var l=n.columns.find((function(e){return e.field===i}));o||(o=l&&l.text||i),null==a&&(a=l&&l.width||r)}return a=Math.max(a||r,s||r),{field:i,value:o,width:a,type:this.getColumnType(e)}}},{key:"processRecord",value:function(e,t,n){var r,i=this.target,o=n.showGroupHeader,a=n.indent,s=n.indentationSymbol;return e?e.meta.specialRow?o&&e.meta.groupRowFor&&(r=t.map((function(t){return i.features.group.buildGroupHeader({cellElement:rn.createElement(),grid:i,record:e,column:t})}))):r=t.map((function(t){var r=e[t.field],o=t.renderer||t.defaultRenderer;return!o||r&&t instanceof Is&&n.exportDateAsInstance||(r=o.call(t,{value:r,record:e,column:t,grid:i,isExport:!0})),a&&t.tree&&(r="".concat(s.repeat(e.childLevel)).concat(r)),r})):r=t.map((function(){return""})),r}}],[{key:"defaultConfig",get:function(){return{target:null,defaultColumnWidth:100,exportDateAsInstance:!0,showGroupHeader:!0,columns:null,indent:!0,indentationSymbol:"    "}}}]),t}(z);Nl._$name="TableExporter";var Bl=function(){function e(t){C()(this,e),this._value=t}return x()(e,[{key:"toString",value:function(){return Boolean(this.value)?"✓":""}},{key:"value",get:function(){return this._value}}]),e}();Bl._$name="BooleanUnicodeSymbol";var zl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"processValue",value:function(e){return null==e||Number.isNaN(e)||"function"==typeof e||"object"===U()(e)&&"[object Object]"===String(e)?"":e}},{key:"generateExportData",value:function(e){var t=this,n=t.exporter.export(e.exporterConfig),r=n.rows,i=n.columns;return{rows:r.map((function(n){return n.map((function(n,r){n instanceof Date?n=vt.format(n,e.dateFormat):"boolean"==typeof n&&(n=new Bl(n)),t.convertEmptyValueToEmptyString&&(n=t.processValue(n));return{value:n,type:"string"}}))})),columns:i.map((function(e){var t=e.field,n=e.value,r=e.width;e.type;return"string",{field:t,value:n,width:r,type:"string"}}))}}},{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.zipcelx)throw new Error('ExcelExporter: "zipcelx" library is required');if(!t.disabled){(e=kt.assign({},t.config,e)).filename||(e.filename=t.client.$name);var n=e,r=n.filename,i=t.generateExportData(e),o=i.rows,a=i.columns;t.zipcelx({filename:r,sheet:{data:[a].concat(o),cols:a}})}}},{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),this.zipcelx||"undefined"!=typeof zipcelx&&(this.zipcelx=zipcelx)}},{key:"exporter",get:function(){return this._exporter||(this._exporter=new this.exporterClass(Object.assign({target:this.client},this.exporterConfig)))}}],[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{filename:null,dateFormat:"YYYY-MM-DD",exporterClass:Nl,exporterConfig:null,zipcelx:null,convertEmptyValueToEmptyString:!0}}}]),t}(ai);zl._$name="ExcelExporter",Xs.registerFeature(zl,!1,"Grid");var jl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"startMonitoring",value:function(e){var t=this,n=e instanceof HTMLElement?{element:e}:e,r=n.element,i=n.verticalElement||t.verticalElement||r;if(r&&(r.scrollWidth>r.offsetWidth||i.scrollHeight>i.offsetHeight)){if(t.monitoring.find((function(e){return e.element===r})))return;n.direction=n.direction||t.direction,Object.assign(n,{verticalElement:i,scrollManager:t,startScrollLeft:r.scrollLeft,startScrollTop:i.scrollTop,scrollLeft:r.scrollLeft,scrollTop:i.scrollTop,scrollRelativeLeft:0,scrollRelativeTop:0});var o=t.onMouseMove.bind(n);t.mouseMoveDetacher=Ln.on({mousemove:o,touchmove:o,element:r}),n.scrollWidth=r.scrollWidth,t.monitoring.push(n)}}},{key:"stopMonitoring",value:function(e){var t=this,n=t.monitoring.find((function(t){return t.element===e}));n&&(t.stopScroll(n),t.mouseMoveDetacher&&t.mouseMoveDetacher(),t.monitoring.splice(t.monitoring.indexOf(n),1))}},{key:"startScroll",value:function(e){e.scrolling=!0,this.performScroll(e)}},{key:"stopScroll",value:function(e){e.scrolling=!1,e.scrollRequested&&(this.cancelAnimationFrame(e.frameId),e.scrollRequested=!1)}},{key:"performScroll",value:function(e){var t=this;if(e.scrolling&&!e.scrollRequested){var n=e.element,r=e.verticalElement;0!==e.scrollDeltaX&&(e.scrollLeft+=e.scrollDeltaX,e.scrollLeft=Math.max(Math.min(e.scrollLeft,e.scrollWidth-n.offsetWidth),0),e.scrollRelativeLeft=e.scrollLeft-e.startScrollLeft,n.scrollLeft=e.scrollLeft),0!==e.scrollDeltaY&&(e.scrollTop+=e.scrollDeltaY,e.scrollTop=Math.max(Math.min(e.scrollTop,r.scrollHeight-r.offsetHeight),0),e.scrollRelativeTop=e.scrollTop-e.startScrollTop,r.scrollTop=e.scrollTop),0===e.scrollRelativeLeft&&0===e.scrollRelativeTop||!e.callback||e.callback.call(e.thisObj||this,e),e.scrollRequested=!0,e.frameId=this.requestAnimationFrame((function(){e.scrollRequested=!1,t.performScroll(e)}))}}},{key:"onMouseMove",value:function(e){var t=this.scrollManager,n=this.element,r=this.verticalElement,i=n.getBoundingClientRect(),o=r.getBoundingClientRect(),a=t.zoneWidth,s=t.scrollSpeed;this.scrollDeltaX=0,"vertical"!==this.direction&&(e.clientX>i.right-a?this.scrollDeltaX=Math.round((a-(i.right-e.clientX))/s)+1:e.clientX<i.left+a&&(this.scrollDeltaX=-Math.round((a+(i.left-e.clientX))/s)-1)),this.scrollDeltaY=0,"horizontal"!==this.direction&&(e.clientY>o.bottom-a?this.scrollDeltaY=Math.round((a-(o.bottom-e.clientY))/s)+1:e.clientY<o.top+a&&(this.scrollDeltaY=-Math.round((a+(o.top-e.clientY))/s)-1)),0===this.scrollDeltaX&&0===this.scrollDeltaY?t.stopScroll(this):t.startScroll(this)}}],[{key:"defaultConfig",get:function(){return{zoneWidth:50,scrollSpeed:5,verticalElement:null,direction:"both",monitoring:[]}}}]),t}(de(z));jl._$name="ScrollManager";var Vl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){Object.assign(this,{_elements:{},_elementsArray:[],_cells:{},_allCells:[],_regions:[],lastHeight:0,lastTop:-1,_dataIndex:0,_top:0,_height:0,_id:null,forceInnerHTML:!1,isGroupFooter:!1},e),se()(oe()(t.prototype),"construct",this).call(this)}},{key:"doDestroy",value:function(){var e=this;e.rowManager.isDestroying||(e.removeElements(),e.rowManager.idMap[e.id]===e&&delete e.rowManager.idMap[e.id]),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"addElement",value:function(e,t){var n=this,r=t.firstElementChild;for(n._elements[e]=t,n._elementsArray.push(t),n._regions.push(e),sl.assign(t,{index:n.index}),n._cells[e]=[];r;)n._cells[e].push(r),n._allCells.push(r),sl.set(r,{column:r.dataset.column,columnId:r.dataset.columnId,rowElement:r.parentNode,row:n}),r=r.nextElementSibling;t.dataset.index=n.index}},{key:"getElement",value:function(e){return this._elements[e]}},{key:"eachElement",value:function(e){for(var t=0;t<this._elementsArray.length;t++)e(this._elementsArray[t],t)}},{key:"eachCell",value:function(e){this._allCells.forEach(e)}},{key:"getCells",value:function(e){return this._cells[e]}},{key:"getCell",value:function(e){return this._allCells.find((function(t){var n=sl.get(t);return n.columnId===e||n.column===e}))}},{key:"removeElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.rowManager.trigger("removeRow",{row:t}),e||t._elementsArray.forEach((function(e){return e.remove()})),t._elements={},t._cells={},t._elementsArray.length=t._regions.length=t._allCells.length=t.lastHeight=t.height=0,t.lastTop=-1}},{key:"setHeightIfBigger",value:function(e){e>this.height&&(this.height=e)}},{key:"updateElementsHeight",value:function(){var e=this;if(e.lastHeight!==e.height){for(var t=e._elementsArray,n=0;n<t.length;n++)t[n].style.height="".concat(e.offsetHeight,"px");e.lastHeight=e.height}}},{key:"addCls",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.eachElement((function(e){return rn.addClasses(e,t)}))}},{key:"removeCls",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.eachElement((function(e){return rn.removeClasses(e,t)}))}},{key:"setTop",value:function(e){this._top!==e&&(this._top=e,this.translateElements())}},{key:"setBottom",value:function(e){this.setTop(e-this.offsetHeight)}},{key:"translateElements",value:function(){var e=this,t=e.grid.positionMode;if(e.lastTop!==e.top){for(var n=e._elementsArray,r=0;r<n.length;r++){var i=n[r].style;"translate"===t?i.transform="translate(0,".concat(e.top,"px)"):"translate3d"===t?i.transform="translate3d(0,".concat(e.top,"px,0)"):"position"===t&&(i.top="".concat(e.top,"px"))}e.rowManager.trigger("translateRow",{row:e}),e.lastTop=e.top}}},{key:"offset",value:function(e){var t=this._top+e;return t<0&&(e-=t,t=0),this.setTop(t),e}},{key:"render",value:function(e,t){var n,r,i,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this,l=s.cells,u=s.grid,c=s._id,d=s._elementsArray,h=sl.get(d[0]),f=s.rowManager,g=f._rowHeight,v=s.height,m=o&&u.transitionDuration?"".concat(s.cls," b-grid-row-updating"):s.cls,p=0;t||!1===t||(t=u.store.getById(h.id),e=u.store.indexOf(t));var y=t&&u.isSelected(t.id);for(f.trigger("beforeRenderRow",{row:s,record:t,oldId:c});p<d.length;p++)(n=d[p]).className=m,y&&n.classList.add("b-selected"),t||(h.displayed=!1,n.classList.add("b-grid-row-not-displayed")),t&&(t.cls&&t.cls.split(" ").forEach((function(e){return n.classList.add(e)})),h.displayed=!0);for(o&&u.transitionDuration&&s.setTimeout((function(){d.forEach((function(e){e.classList.remove("b-grid-row-updating")}))}),u.transitionDuration),s.height=0,t?(s.id=t.id,s.dataIndex=e):(s.id=null,s.dataIndex=null),p=0;p<l.length;p++)r=l[p],i=s.renderCell(r,t,p,o),s.setHeightIfBigger(i&&i.height||g);s.updateElementsHeight(),o&&(v!==s.height&&f.translateFromRow(s,a),f.trigger("updateRow",{row:s,record:t,oldId:c}),f.trigger("renderDone")),f.trigger("renderRow",{row:s,record:t,oldId:c}),s.forceInnerHTML=!1}},{key:"renderCell",value:function(e,t,n){var r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this,a=sl.get(e),s=o.grid.columns.getById(a.columnId),l=a.rowElement,u=sl.get(l),c=s.internalCellCls,d=s.cellCls,h=s.align,f=s.renderer,g=s.defaultRenderer,v=s.id,m={columnId:v,id:u.id},p=f||g;if(!t){if(null===u.id)return void(e.className="b-grid-cell");if(!(t=o.grid.store.getById(u.id)))return}var y=(r={"b-grid-cell":1},$()(r,c,c),$()(r,d,d),$()(r,"b-cell-dirty",t.isFieldModified(s.field)),$()(r,"b-grid-cell-align-".concat(h),h),$()(r,"b-selected",o.grid.isSelected(m)),$()(r,"b-focused",o.grid.isFocused(m)),r);rn.syncClassList(e,y);var k={height:t.get("rowHeight")||0},b=s.getRawValue(t),w=!0,S={cellElement:e,rowElement:l,value:b,record:t,column:s,size:k,grid:o.grid,row:a.row,updatingSingleRow:i};p&&void 0===(b=p.call(s,S))&&(w=!1),o.grid.processCellContent&&(w=o.grid.processCellContent({cellContent:b,cellElement:e,record:t,cellElementData:a,rendererData:S}));var C=S.cellContent=null==b?"":String(b);if(w)if(o.forceInnerHTML)e.innerHTML=C;else if(s.htmlEncode&&!s.disableHtmlEncode)if(ge.isLinux||e._hasHtml)e.innerText=C,e._hasHtml=!1;else{var E=e.firstChild;E?E.data=C:e.innerText=C}else{var x="string"==typeof b,D="object"===U()(b);!s.autoSyncHtml||x&&!e.childElementCount?D?Za.sync({targetElement:e,domConfig:{onlyChildren:!0,children:[b]}}):e.innerHTML=C:x?rn.sync(C,e.firstElementChild):Za.sync({domConfig:b,targetElement:e})}return o.rowManager.trigger("renderCell",S),k}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"dataIndex",get:function(){return this._dataIndex},set:function(e){if(this._dataIndex!==e){var t=this._elementsArray;this._dataIndex=e;for(var n=0;n<t.length;n++)t[n].dataset.index=e}}},{key:"id",get:function(){return this._id},set:function(e){var t=this,n={id:e},r=t.rowManager.idMap,i=t._elementsArray,o=t._allCells;if(t._id!=e||r[e]!==t){r[t._id]===t&&delete r[t._id],r[e]=t,t._id=e;for(var a=0;a<i.length;a++)sl.assign(i[a],n);for(var s=0;s<o.length;s++)sl.assign(o[s],n);for(var l=0;l<i.length;l++)i[l].dataset.id=e}}},{key:"elements",get:function(){return this._elements}},{key:"cells",get:function(){return this._allCells}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"offsetHeight",get:function(){return this.height+this.grid._rowBorderHeight}},{key:"isFirst",get:function(){return 0===this.dataIndex}},{key:"top",get:function(){return this._top}},{key:"bottom",get:function(){return this._top+this._height+this.grid._rowBorderHeight}}],[{key:"defaultConfig",get:function(){return{cls:"b-grid-row"}}}]),t}(de(z));Vl._$name="Row";var Wl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){e.grid._rowManager=this,this.scrollTargetRecordId=null,this.refreshDetails={topRowIndex:0,topRowTop:0},se()(oe()(t.prototype),"construct",this).call(this,e.grid,e)}},{key:"doDestroy",value:function(){this._rows.forEach((function(e){return e.destroy()})),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"initWithHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return n.autoHeight&&(e=n.store.allCount*n.rowOffsetHeight),n.viewHeight=e,n.calculateRowCount(t),e}},{key:"reinitialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.topRow&&!e?t.topRow.top:0;t.scrollTargetRecordId=null,e&&(t.topIndex=t.lastScrollTop=0),t.calculateRowCount(!1,!0,!0);var r=t.topRow;r&&(r.dataIndex=t.topIndex,r.setTop(n)),t.estimateTotalHeight(),t.renderFromRow(r)}},{key:"matchRowCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t._rows,r=n.length,i=r-t.rowCount,o=t.grid;if(i)if(i<0){for(var a=[],s=r,l=r?n[r-1].dataIndex+1:0;s<t.rowCount;s++,l++)a.push(new Vl({rowManager:t,grid:o,index:s,dataIndex:l}));n.push.apply(n,a),t.trigger("addRows",{rows:a}),e||t.renderFromRow(n[Math.max(0,r-1)])}else{var u=n.splice(r-i,i);t.trigger("removeRows",{rows:u}),u.forEach((function(e){return e.destroy()}))}}},{key:"calculateRowCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.store,o=Math.ceil(r.viewHeight/r.rowOffsetHeight),a=o+r.prependRowBuffer+r.appendRowBuffer;return!r.grid.columns.count||isNaN(o)?(r.rowCount=0,0):a<r.rowCount&&!t?r.rowCount:(r.visibleRowCount=o,r.rowCount=Math.min(i.count,a),"all"===r.rowScrollMode&&(r.rowCount=i.allCount),e||(r._rows&&r.rowCount!==r._rows.length?r.matchRowCount(n):r.rowCount||r.trigger("changeTotalHeight",{totalHeight:r.totalHeight}),r.grid.toggleEmptyText()),r.rowCount)}},{key:"removeAllRows",value:function(){var e=this,t=e.topRow,n=t?e.refreshDetails={topRowIndex:t.dataIndex,topRowTop:t.top}:e.refreshDetails,r=e._rows.slice();return e.trigger("removeRows",{rows:r}),e._rows.forEach((function(e){return e.destroy()})),e._rows.length=0,e.idMap={},n}},{key:"setPosition",value:function(e){var t=this.topRow,n=e.topRowIndex,r=e.topRowTop;t.setTop(r),t.dataIndex=n}},{key:"getRow",value:function(e){return this.rowCount&&this.rows[e-this.topIndex]}},{key:"getRowById",value:function(e){return"string"!=typeof e&&"number"!=typeof e&&(e=e.id),this.idMap[e]}},{key:"getRowFromElement",value:function(e){return(e=e.closest(".b-grid-row"))&&this.getRow(e.dataset.index)}},{key:"getRowAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t||(e-=Oe.from(this.grid.bodyContainer,null,!0).top,e+=this.grid.scrollable.y),e=Qt(e),this.rows.find((function(t){return e>=t.top&&e<t.bottom}))}},{key:"getRowFor",value:function(e){return e instanceof HTMLElement?this.getRowFromElement(e):this.getRowById(e)}},{key:"getNextRow",value:function(e){var t="number"==typeof e?e:e.index;return this.getRow((t+1)%this.rowCount)}},{key:"offsetRows",value:function(e){if(0!==e)for(var t=this.rows,n=t.length,r=0;r<n;r++)t[r].offset(e);this.trigger("offsetRows",{offset:e})}},{key:"getRecordCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r="string"==typeof e||"number"==typeof e?e:e.id,i=n.getRowById(e),o=n.client._bodyRectangle;return t||(o=n.client._bodyRectangle=Oe.client(n.client.bodyContainer)),i?new Oe(o.x,t?Math.round(i.top):Math.round(i.top+o.y-n.client.scrollable.y),o.width,i.offsetHeight):n.getRecordCoordsByIndex(n.store.indexOf(r),t)}},{key:"getRecordCoordsByIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.client._bodyRectangle,i=n.averageRowHeight||n._rowHeight+n.grid._rowBorderHeight,o=n.topRow.dataIndex,a=n.bottomRow.dataIndex,s=e>a?{index:e-a-1,y:n.bottomRow.bottom,from:"bottomRow"}:e>o/2?{index:e-o,y:n.topRow.top,from:"topRow"}:{index:e,y:0,from:"top"},l=Math.floor(s.y+s.index*i),u=new Oe(r.x,t?l:l+r.y-n.client.scrollable.y,r.width,i);return u.virtual=!0,u.block=u.bottom<r.y?"start":u.y>r.bottom?"end":"nearest",u}},{key:"forEach",value:function(e){this.rows.forEach(e)}},{key:Symbol.iterator,value:function(){return this.rows[Symbol.iterator]()}},{key:"returnToTop",value:function(){var e=this;e.topIndex=0,e.lastScrollTop=0,e.topRow.dataIndex=0,e.topRow.setTop(0),e.refresh(),e.grid.scrollable.y=0}},{key:"renderFromRecord",value:function(e){var t=this.getRowById(e.id);t&&this.renderFromRow(t)}},{key:"renderFromRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t._rows,r=t.store,i=r.count;if(0!==t.calculateRowCount(!1,i<n.length,!0)){for(var o,a=e?n.indexOf(e):0,s=e?e.dataIndex:n[0].dataIndex,l=i-s-1,u=Math.min(n.length-1,a+l),c=n.length-u-1,d=a>0?n[a-1].bottom:n[a].top,h=a;h<=u;h++)(o=n[h]).dataIndex=s,o.setTop(d),o.render(s,r.getAt(s++),!1),d+=o.offsetHeight;for(;c-- >0;)t.displayRecordAtTop();t.averageRowHeight?t.averageRowHeight=(t.averageRowHeight*(i-t.rowCount)+(d-t.topRow.top))/i:t.averageRowHeight=(d-t.topRow.top)/t.rowCount,t.estimateTotalHeight(),t.trigger("renderDone")}}},{key:"renderRows",value:function(e){var t,n=!1;e=Array.from(e);var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;t=l.height,l.render(null,null,!1),n|=l.height!==t}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}n&&(this.translateFromRow(e[0],!0),this.estimateTotalHeight()),this.trigger("renderDone")}},{key:"translateFromRow",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this,o=e.bottom,a=i.store.count;for(n=e.dataIndex+1,t=i.getRow(n);t;t=i.getRow(++n))t.setTop(o),o+=t.offsetHeight;i.averageRowHeight=(i.averageRowHeight*(a-i.rowCount)+(i.bottomRow.bottom-i.topRow.top))/a,r||i.estimateTotalHeight()}},{key:"refresh",value:function(){var e=this.topRow;e&&(this.idMap={},this.renderFromRow(e),this.trigger("refresh"))}},{key:"jumpToPosition",value:function(e,t){var n=this,r=n.rowOffsetHeight,i=n.store.count,o=null==t?Math.floor(e/r)-n.prependRowBuffer:t-Math.floor(n.rowCount/2),a=Math.max(Math.min(o,i-n.rowCount),0),s=n.client.scrollable.y,l=Math.min(n.client._bodyRectangle.height+s+n.appendBufferHeight,n.totalHeight);if(n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=a,n.topRow.setTop(a*r,!1),n.refresh(),n.bottomRow.bottom<l){for(;n.bottomRow.bottom<l&&n._rows[n.prependRowBuffer].top<s&&n.bottomRow.dataIndex<i-1;)n.displayRecordAtBottom();var u=n.bottomRow.bottom-n.topRow.top;n.averageRowHeight=(n.averageRowHeight*(i-n.rowCount)+u)/i}if(n.estimateTotalHeight(),null!=t){var c=n.getRow(t),d=c&&Oe.from(c._elementsArray[0]).center.y,h=n.grid.scrollable.viewport.center.y;c&&(n.grid.scrollable.y=e=Math.floor(n.grid.scrollable.y+(d-h)))}return e}},{key:"warpIfNeeded",value:function(e){var t,n=this,r={newScrollTop:e,deltaTop:e-n.lastScrollTop};Math.abs(r.deltaTop)>n.rowCount*n.rowOffsetHeight*3&&(n.scrollTargetRecordId&&(t=n.store.indexOf(n.scrollTargetRecordId)),r.newScrollTop=n.jumpToPosition(e,t),r.deltaTop=0);return r}},{key:"updateRenderedRows",value:function(e,t,n){var r=this,i=r.client._bodyRectangle;if(0===r.rowCount)return 0;var o=r.estimatedTotalHeight;if(t||Math.abs(e-r.lastScrollTop)>r.rowOffsetHeight||r.topRow.top>e||r.bottomRow.bottom<e+i.height){var a=r.warpIfNeeded(e);if(r.scrollTargetRecordId=null,r.lastScrollTop=a.newScrollTop,a.deltaTop>0?r.fillBelow(a.newScrollTop):a.deltaTop<0&&r.fillAbove(a.newScrollTop),o=r.estimateTotalHeight(),!n&&(a.deltaTop<0&&e<2*i.height||a.deltaTop>0&&e>r.estimatedTotalHeight-2*i.height-3)){var s=r.topRow.top-r.topIndex*r.rowOffsetHeight;s&&(r.offsetRows(-s),r.grid.scrollable.y=r.lastScrollTop=r.grid.scrollable.y-s)}}return o}},{key:"fillAbove",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=0;r>n&&t.topIndex>0;)r-=t.displayRecordAtTop();t.trigger("renderDone")}},{key:"fillBelow",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=t.store.count,i=t.rowCount,o=0;o<n&&t.topIndex+i<r&&t.topRow.top+t.topRow.offsetHeight<e;)o+=t.displayRecordAtBottom();t.trigger("renderDone")}},{key:"estimateTotalHeight",value:function(){var e=this,t=e.store.count,n=Math.floor(t*(e.averageRowHeight||e.rowOffsetHeight)),r=e.bottomRow;if(!e.grid.renderingRows){if(r){var i=r.bottom;(i>n||e.topIndex+e.rowCount>=t&&n>i)&&(n=i,r.dataIndex<t-1&&(n+=(t-1-r.dataIndex)*e.rowOffsetHeight))}return n!=e.estimatedTotalHeight&&!1!==e.trigger("changeTotalHeight",{totalHeight:n})&&(e.estimatedTotalHeight=n),n}}},{key:"displayRecordAtTop",value:function(){var e=this,t=e.topIndex-1,n=e.store.getAt(t),r=e.store.count,i=e.bottomRow,o=i.top;return e.trigger("beforeTranslateRow",{row:i,newRecord:n}),i._top=e.topRow.top-e.rowOffsetHeight,i.estimatedTop=!0,i.render(t,n,!1),i._top=o,i.setBottom(e.topRow.top),i.estimatedTop=!1,e.topIndex--,e._rows.unshift(e._rows.pop()),e.averageRowHeight=(e.averageRowHeight*(r-1)+i.offsetHeight)/r,i.offsetHeight}},{key:"displayRecordAtBottom",value:function(){var e=this,t=e.topIndex+e.rowCount,n=e.store.getAt(t),r=e.store.count,i=e.topRow;return e.trigger("beforeTranslateRow",{row:i,newRecord:n}),i.dataIndex=t,i.setTop(e.bottomRow.bottom),i.render(t,n,!1),e.topIndex++,e._rows.push(e._rows.shift()),e.averageRowHeight=(e.averageRowHeight*(r-1)+i.offsetHeight)/r,i.offsetHeight}},{key:"store",get:function(){return this.client.store}},{key:"rows",get:function(){return this._rows}},{key:"topRow",get:function(){return this._rows[0]}},{key:"bottomRow",get:function(){var e=Math.min(this.rowCount,this.store.count);return this.rows[e-1]}},{key:"rowHeight",get:function(){return this._rowHeight},set:function(e){var t=this,n=t.grid,r=t._rowHeight;if(kt.assertNumber(e,"rowHeight"),t.trigger("beforeRowHeight",{height:e}),t._rowHeight=e,t.prependBufferHeight=t.prependRowBuffer*t.rowOffsetHeight,t.appendBufferHeight=t.appendRowBuffer*t.rowOffsetHeight,t.rows.length){var i=t.averageRowHeight,o=i,a=n.scrollable.y,s=t.getRowAt(a,!0),l=s.top-a;i-=n._rowBorderHeight,i*=e/r,t.averageRowHeight=i+=n._rowBorderHeight,t.calculateRowCount(!1,!0,!0),t.topRow.setTop(t.topRow.dataIndex*i),t.refresh(),a*(i/o)!==a&&n.scrollRowIntoView(s.id,{block:"start",edgeOffset:l})}t.trigger("rowHeight",{height:e})}},{key:"rowOffsetHeight",get:function(){return Math.floor(this.averageRowHeight)||this._rowHeight+this.grid._rowBorderHeight}},{key:"totalHeight",get:function(){return Math.floor(this.store.count*this.rowOffsetHeight)}}],[{key:"pluginConfig",get:function(){return{chain:["getRowById","topRow","bottomRow","getRecordCoords","getRow","getRowFor","getRowFromElement","destroy"],assign:["rowHeight"]}}},{key:"defaultConfig",get:function(){return{prependRowBuffer:5,appendRowBuffer:5,rowHeight:null,idMap:{},rowScrollMode:"move",autoHeight:!1,topIndex:0,lastScrollTop:0,_rows:[]}}}]),t}(ai);Wl._$name="RowManager";var Gl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"fixCellWidths",value:function(){var e,t=this,n=!1;t.columns.traverse((function(r){var i=t.getBarCellElement(r.id),o=rn.setLength(r.width),a=rn.setLength(r.minWidth);if(i){if(e=ge.isIE11?"calc(".concat(o," - ").concat(t.getLrPadding(i),"px)"):o,n=n||Boolean(r.flex),r.isParent&&null==r.width&&null==r.flex){var s=r.children.reduce((function(e,t){return e+(!t.hidden&&t.flex||0)}),0);i.style.flex=s>0?"".concat(s," 0 auto"):"",s>0&&r.traverse((function(e){return e.data.minWidth=null}))}else if(parseInt(r.minWidth)>=0&&(i.style.minWidth=a),i.style.flex=i.style.flexBasis=i.style.width="",r.flex)!isNaN(parseInt(r.flex))&&r.children?i.style.flex="".concat(r.flex," 0 auto"):i.style.flex=r.flex;else if(parseInt(r.width)>=0){var l=r.parent;!t.isHeader||l.isRoot||l.width?i.style.flexBasis=e:i.style.width=o}r.height>=0&&(i.style.height=rn.setLength(r.height))}})),t.element.classList[n?"add":"remove"]("b-has-flex")}},{key:"getLrPadding",value:function(e){if(!this.cellLrPadding){var t=e.ownerDocument.defaultView.getComputedStyle(e);this.cellLrPadding=parseInt(t.getPropertyValue("padding-left"))+parseInt(t.getPropertyValue("padding-right"))+parseInt(t.getPropertyValue("border-left-width"))+parseInt(t.getPropertyValue("border-right-width"))}return this.cellLrPadding}},{key:"getBarCellElement",value:function(e){return this.element.querySelector('[data-column-id="'.concat(e,'"]'))}},{key:"columns",get:function(){return this._columns||this.subGrid.columns},set:function(e){this._columns=e}}],[{key:"$name",get:function(){return"Bar"}},{key:"defaultConfig",get:function(){return{scrollable:{}}}}]),t}(vr);function Yl(){var e=Lr()(['\n                <div\n                    class="b-grid-footer '," ",'"\n                    data-column="','" data-column-id="','" data-all-index="','"\n                    >\n                    ',"\n                </div>"]);return Yl=function(){return e},e}function Ul(){var e=Lr()(['\n            <div class="b-grid-footer-scroller b-grid-footer-scroller-','">\n                <div reference="footersElement" class="b-grid-footers b-grid-footers-','" data-region="','"></div>\n            </div>\n        ']);return Ul=function(){return e},e}Gl._$name="Bar";var ql=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"refreshContent",value:function(){this.element.firstElementChild.innerHTML=this.contentTemplate(),this.fixFooterWidths()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}},{key:"template",value:function(){var e=this.subGrid.region;return Hr.tpl(Ul(),e,e,e)}},{key:"getFooter",value:function(e){return this.getBarCellElement(e)}},{key:"contentTemplate",value:function(){return this.columns.visibleColumns.map((function(e){return e.hidden?"":Hr.tpl(Yl(),e.align?"b-grid-footer-align-".concat(e.align):"",e.cls||"",e.field||"",e.id,e.allIndex,e.footerText||"")})).join("")}},{key:"fixFooterWidths",value:function(){this.fixCellWidths()}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=this.owner=e}},{key:"overflowElement",get:function(){return this.footersElement}}],[{key:"$name",get:function(){return"Footer"}},{key:"defaultConfig",get:function(){return{isFooter:!0}}}]),t}(Gl);ql._$name="Footer";var $l={x:1},Xl=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"addScroller",value:function(e){(this.xScrollers||(this.xScrollers=[])).push(e)}},{key:"addPartner",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$l;if("string"==typeof n&&(n=$()({},n,1)),n.x)for(var r=0;r<this.xScrollers.length;r++)this.xScrollers[r].addPartner(e.xScrollers[r],"x");n.y&&se()(oe()(t.prototype),"addPartner",this).call(this,e,"y")}},{key:"updateOverflowX",value:function(e){this.xScrollers&&this.xScrollers.forEach((function(t){return t.overflowX=e})),this.widget.virtualScrollers.classList[!1===e?"add":"remove"]("b-hide-display")}},{key:"scrollIntoView",value:function(e,n){if(1!==e.nodeType)return se()(oe()(t.prototype),"scrollIntoView",this).call(this,e,n);var r=!0,i=!1,o=void 0;try{for(var a,s=this.xScrollers[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(l.element.contains(e))return l.scrollIntoView(e,n)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"x",set:function(e){this.xScrollers&&(this.xScrollers[0].x=e)},get:function(){return this.xScrollers?this.xScrollers[0].x:0}}]),t}(Qn);function Kl(){var e=Lr()(['\n                <div class="b-grid-header" data-column="','" data-column-id="','" ','>\n                    <div class="b-grid-header-text">\n                        <div class="b-grid-header-text-content"></div>\n                    </div>\n                    ','\n                    <div class="b-grid-header-resize-handle"></div>\n                </div>\n            ']);return Kl=function(){return e},e}function Jl(){var e=Lr()(['\n            <div class="b-grid-header-scroller b-grid-header-scroller-','">\n                <div reference="headersElement" class="b-grid-headers b-grid-headers-','" data-region="','" data-max-depth="','" reference="headersElement"></div>\n            </div>\n        ']);return Jl=function(){return e},e}Xl._$name="GridScroller";var Ql=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"template",value:function(){var e=this.region;return Hr.tpl(Jl(),e,e,e,this.maxDepth)}},{key:"contentTemplate",value:function(e){var t=this;return e.hidden?"":Hr.tpl(Kl(),e.field||"",e.id,e.isLeaf?'tabindex="0"':"",e.children?'\n                    <div class="b-grid-header-children">\n                            '.concat(e.children.map((function(e){return t.contentTemplate(e)})).join(""),"\n                    </div>\n                    "):"")}},{key:"calculateMinWidthForSafari",value:function(){var e=0;return this.columns.visibleColumns.forEach((function(t){e+=t.calculateMinWidth()})),e}},{key:"fixHeaderWidths",value:function(){this.fixCellWidths()}},{key:"refreshHeaders",value:function(){var e=this;e.columns.traverse((function(t){var n=e.getBarCellElement(t.id);if(n){var r,i=new bt((r={"b-grid-header":1,"b-grid-header-parent":t.isParent},$()(r,"b-level-".concat(t.childLevel),1),$()(r,"b-depth-".concat(t.meta.depth),1),$()(r,"b-grid-header-align-".concat(t.align),t.align),$()(r,"b-grid-header-resizable",t.resizable&&t.isLeaf),$()(r,t.cls,t.cls),$()(r,"b-last-parent",t.isParent&&t.isLastInSubGrid),$()(r,"b-last-leaf",t.isLeaf&&t.isLastInSubGrid),r)),o=t.text;n.className=i,t.headerRenderer&&(o=t.headerRenderer.call(t.thisObj||e,{column:t,headerElement:n})),t.icon&&(o='<i class="'.concat(t.icon,'"></i>')+(o||""));var a=n.querySelector(".b-grid-header-text-content");a&&(a.innerHTML=o||"")}})),e.fixHeaderWidths()}},{key:"initDepths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columns.topColumns,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=0;t&&t.meta&&t.meta.depth++;var i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.meta.depth=0,u.children&&(n.initDepths(u.children.filter(n.columns.chainedFilterFn),u),u.meta.depth&&t&&(t.meta.depth+=u.meta.depth)),u.meta.depth>r&&(r=u.meta.depth)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return t||(n.maxDepth=r),r}},{key:"getHeader",value:function(e){return this.getBarCellElement(e)}},{key:"refreshContent",value:function(){var e=this;e.content=e.columns.topColumns.map((function(t){return e.contentTemplate(t)})).join(""),e.refreshHeaders()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=e,this.id=e.id+"-header"}},{key:"region",get:function(){return this.subGrid&&this.subGrid.region}},{key:"overflowElement",get:function(){return this.headersElement}},{key:"columns",get:function(){var e=this,n=se()(oe()(t.prototype),"columns",this);return e.columnsDetacher||(e.columnsDetacher=n.on({change:function(){e.initDepths()},thisObj:e}),e.initDepths()),n},set:function(e){fn()(oe()(t.prototype),"columns",e,this,!0)}},{key:"contentElement",get:function(){return this.element.firstElementChild}}],[{key:"$name",get:function(){return"Header"}},{key:"defaultConfig",get:function(){return{isHeader:!0}}}]),t}(Gl);Ql._$name="Header";var Zl={touchstart:"onElementTouchStart",touchmove:"onElementTouchMove",touchend:"onElementTouchEnd",mouseover:"onElementMouseOver",mouseout:"onElementMouseOut",mousedown:"onElementMouseDown",mousemove:"onElementMouseMove",mouseup:"onElementMouseUp",click:"onHandleElementClick",dblclick:"onElementDblClick",keydown:"onElementKeyDown",keyup:"onElementKeyUp",keypress:"onElementKeyPress",contextmenu:"onElementContextMenu",focus:"onGridElementFocus"},eu={string:1,object:1,function:1},tu=Object.freeze({doSelect:!0}),nu=Object.freeze({x:!1,y:!1}),ru={string:1,number:1},iu={dataset:1,batch:1},ou=function(e){return e.columns.suspendEvents()},au=function(e){return e.columns.resumeEvents()},su=function(e){e.columns.clearCaches(),e.columns.fillFromMaster()},lu=function(e,t){return e.stateSortIndex-t.stateSortIndex},uu=new Promise((function(e){return e()})),cu={block:"nearest"},du=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cu,n=this,r=n.getDeltaTo(e,t),i=r.xDelta,o=r.yDelta,a=i||o?n.scrollBy(i,o,t):uu;return(t.highlight||t.focus)&&a.then((function(){t.highlight&&(e instanceof Oe?e.translate(-i,-o).highlight():rn.highlight(e)),t.focus&&e.focus&&e.focus()})),a}},{key:"scrollBy",value:function(e,n,r){var i=n&&this.yScroller.scrollBy(0,n,r),o=e&&se()(oe()(t.prototype),"scrollBy",this).call(this,e,0,r);if(o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i}},{key:"scrollTo",value:function(e,n,r){var i=null!=n&&this.yScroller.scrollTo(null,n,r),o=null!=e&&se()(oe()(t.prototype),"scrollTo",this).call(this,e,null,r);if(r&&r.animate||this.syncPartners(),o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i}},{key:"viewport",get:function(){return Oe.from(this.element).intersect(Oe.from(this.yScroller.element))}},{key:"y",set:function(e){this.yScroller&&(this.yScroller.y=e)},get:function(){return this.yScroller?this.yScroller.y:0}},{key:"maxY",get:function(){return this.yScroller?this.yScroller.maxY:0}},{key:"scrollHeight",get:function(){return this.yScroller?this.yScroller.scrollHeight:0}},{key:"clientHeight",get:function(){return this.yScroller?this.yScroller.clientHeight:0}}]),t}(Qn);function hu(){var e=Lr()(['\n                <div reference="splitterElement" data-region="','" class="b-grid-splitter ','">\n                    <div class="b-grid-splitter-inner">\n                        <div class="b-grid-splitter-buttons" reference="splitterButtons">\n                            <i class="b-icon b-icon-collapse-gridregion"></i>\n                            <i class="b-icon b-icon-expand-gridregion"></i>\n                        </div>\n                    </div>\n                </div>']);return hu=function(){return e},e}function fu(){var e=Lr()(['\n            <div class="b-grid-subgrid b-grid-subgrid-'," b-grid-horizontal-scroller ",'" data-region="','">\n                <div reference="virtualScrollerElement" class="b-virtual-scroller" data-region="','">\n                    <div reference="virtualScrollerWidth" class="b-virtual-width"></div>\n                </div>\n                ',"\n            </div>\n        "]);return fu=function(){return e},e}du._$name="SubGridScroller";var gu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r;return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),this.initHeader(),this.rowManager.on("addrows",this.onAddRow,this)}},{key:"doDestroy",value:function(){var e=this;e.header&&e.header.destroy(),e.footer&&e.footer.destroy(),e.fakeScroller&&e.fakeScroller.destroy(),e.virtualScrollerElement&&e.virtualScrollerElement.remove(),e.splitterElement&&e.splitterElement.remove(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"initHeader",value:function(){var e=this,t=e.element.style,n=t.width,r=t.flex,i=Object.assign({subGrid:e,hidden:e.hideHeaders,parent:e},e.headerConfig);r?i.flex=r:n&&(i.width=n),e.header=new e.headerClass(i)}},{key:"initElements",value:function(){this.footerElement=rn.down(this.grid.element,".b-grid-footer-scroller-"+this.region),this.updateHasFlex()}},{key:"template",value:function(){var e=this.grid,t=this.region,n=!e||t===e.regions[e.regions.length-1];return Hr.tpl(fu(),t,this.collapsed?"b-grid-subgrid-collapsed":"",t,t,n?"":Hr.tpl(hu(),t,this.collapsed?"b-grid-splitter-collapsed":""))}},{key:"rowTemplate",value:function(){return'<div class="b-grid-row">'.concat(this.columns.visibleColumns.map(this.cellTemplate).join(""),"</div>")}},{key:"cellTemplate",value:function(e){return'<div class="b-grid-cell" data-column="'.concat(e.field||"",'" data-column-id="').concat(e.id,'"></div>')}},{key:"render",value:function(){var e=this,n=e.grid,r=e.region,i=[{className:"b-grid-splitter-inner"}],o={region:r};if(n&&(n.virtualScrollers.appendChild(e.virtualScrollerElement),e.renderHeader(n.headerContainer),e.renderFooter(n.footerContainer),e.initElements()),se()(oe()(t.prototype),"render",this).apply(this,arguments),e.splitterElement){var a=e.splitterElement.className.trim();e.element.parentNode.insertBefore(e.splitterElement,e.element.nextElementSibling),e.header&&(e.headerSplitter=rn.createElement({className:a,children:i,dataset:o,parent:e.header.element.parentNode,nextSibling:e.header.element.nextSibling}),Ln.on({element:e.headerSplitter,mouseenter:"onSplitterMouseOver",mouseleave:"onSplitterMouseOut",thisObj:e})),e.footer&&(e.footerSplitter=rn.createElement({className:a,children:i,dataset:o,parent:e.footer.element.parentNode,nextSibling:e.footer.element.nextSibling}),Ln.on({element:e.footerSplitter,mouseenter:"onSplitterMouseOver",mouseleave:"onSplitterMouseOut",thisObj:e})),e.scrollerSplitter=rn.createElement({className:a,children:i,dataset:o,parent:e.virtualScrollerElement.parentNode,nextSibling:e.virtualScrollerElement.nextSibling}),Ln.on({element:e.splitterElement,mouseenter:"onSplitterMouseOver",mouseleave:"onSplitterMouseOut",thisObj:e})}e._collapsed&&e.collapse()}},{key:"renderHeader",value:function(e){this.header&&this.header.render(e,!1)}},{key:"renderFooter",value:function(e){this.footer&&(this.footer.render(e,!1),this.grid.footerContainer.classList.remove("b-hidden"))}},{key:"refreshHeader",value:function(){this.header.refreshContent()}},{key:"refreshFooter",value:function(){this.footer&&this.footer.refreshContent()}},{key:"eachWidget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=[];n.header&&r.unshift(n.header),n.footer&&r.push(n.footer);for(var i=0;i<r.length;i++){var o=r[i];if(!1===e(o))return;t&&o.eachWidget&&o.eachWidget(e,t)}}},{key:"fixCellWidths",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t||(t=this.columns.bottomColumns.filter((function(e){return!e.hidden})));for(var n=e.firstElementChild,r=0;n;){var i=t[r];i.minWidth&&rn.setLength(n,"minWidth",i.minWidth),i.flex?(n.style.flex=i.flex,n.style.width=""):i.width?(n.style.flex="",n.style.width=rn.setLength(i.width),ge.isIE11&&(n.style.minWidth=n.style.width)):n.style.flex=n.style.width=n.style.minWidth="",n=n.nextElementSibling,r++}}},{key:"fixWidths",value:function(){var e=this,t=e.element,n=e.header,r=e.footer;if(!e.collapsed){if(e.flex)n.flex=e.flex,r&&(r.flex=e.flex),t.style.flex=e.flex;else{if(e.hasCalculatedWidth&&!e.columns.some((function(e){return!e.hidden&&e.flex}))&&e.totalFixedWidth!==e.width)return e.width=e.totalFixedWidth,void(e.hasCalculatedWidth=!0);var i=e.width;if(!i){i=0;var o=!0,a=!1,s=void 0;try{for(var l,u=e.columns[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c.flex||c.hidden||(i+=c.width)}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}}t.style.width="".concat(i,"px"),n.width=i,r&&(r.width=i)}e.syncScrollingPartners(!1)}}},{key:"fixRowWidthsInSafariEdge",value:function(){if(ge.isSafari||ge.isEdge){var e=this.region,t=this.header,n=t.calculateMinWidthForSafari();this.rowManager.forEach((function(t){var r=t.getElement(e);r&&(r.style.width="".concat(n,"px"))})),t.headersElement.style.width="".concat(n,"px")}}},{key:"onInternalResize",value:function(e,n,r,i,o){var a=this,s=a.grid;se()(oe()(t.prototype),"onInternalResize",this).call(this,e,n,r,i,o),a.splitterElement&&a.syncSplitterButtonPosition(),s&&(n!==i&&(s.trigger("horizontalScroll",{subGrid:a,grid:s,scrollLeft:a.scrollable.x}),a.refreshFakeScroll(),a.fixRowWidthsInSafariEdge()),a.trigger("afterInternalResize",a))}},{key:"syncParallelSplitters",value:function(e){var t=this,n=t.grid,r=e?"add":"remove";if(t.splitterElement)t.splitterElement.classList[r]("b-grid-splitter-collapsed"),t.headerSplitter&&t.headerSplitter.classList[r]("b-grid-splitter-collapsed"),t.footerSplitter&&t.footerSplitter.classList[r]("b-grid-splitter-collapsed"),t.scrollerSplitter&&t.scrollerSplitter.classList[r]("b-grid-splitter-collapsed");else{var i=n.getSubGrid(n.getPreviousRegion(t.region));i&&i.splitterElement&&i.syncParallelSplitters(e)}}},{key:"onSplitterMouseOver",value:function(){var e=this,t=e.nextSibling;e.collapsed||t&&t.collapsed||(e.splitterElement.classList.add("b-hover"),e.headerSplitter&&e.headerSplitter.classList.add("b-hover"),e.footerSplitter&&e.footerSplitter.classList.add("b-hover"),e.scrollerSplitter.classList.add("b-hover")),e.startSplitterButtonSyncing()}},{key:"onSplitterMouseOut",value:function(){var e=this,t=e.nextSibling;e.splitterElement.classList.remove("b-hover"),e.headerSplitter&&e.headerSplitter.classList.remove("b-hover"),e.footerSplitter&&e.footerSplitter.classList.remove("b-hover"),e.scrollerSplitter.classList.remove("b-hover"),e.collapsed||t&&t.collapsed||e.stopSplitterButtonSyncing()}},{key:"startSplitterButtonSyncing",value:function(){var e=this;e.splitterElement&&(e.syncSplitterButtonPosition(),e.splitterSyncScrollListener||(e.splitterSyncScrollListener=e.grid.scrollable.on({scroll:"syncSplitterButtonPosition",thisObj:e})))}},{key:"stopSplitterButtonSyncing",value:function(){this.splitterSyncScrollListener&&(this.splitterSyncScrollListener(),this.splitterSyncScrollListener=null)}},{key:"syncSplitterButtonPosition",value:function(){this.splitterButtons.style.transform="translateY(".concat(this.grid.scrollable.y+this.grid.bodyHeight/2-(this.headerSplitter?this.grid.headerHeight:0),"px)")}},{key:"updateHasFlex",value:function(){var e=this.columns.visibleColumns.some((function(e){return e.flex}));rn.toggleClasses(this.element,["b-has-flex"],e)}},{key:"refreshFakeScroll",value:function(){var e=this,t=e.element,n=e.virtualScrollerElement,r=e.virtualScrollerWidth,i=e.totalFixedWidth,o=e.scrollable;o.scrollWidth=e.store.count?null:i,n.style.width="".concat(t.offsetWidth,"px"),i>o.clientWidth?t.classList.add("b-overflowing-horizontally"):t.classList.remove("b-overflowing-horizontally"),e.collapsed||(o.scrollWidth>o.clientWidth+(ge.isEdge?1:0)?(r.style.width="".concat(o.scrollWidth,"px"),e.header.element.classList.add("b-overflowing"),e.footer&&e.footer.element.classList.add("b-overflowing"),e.overflowingHorizontally=!0,e.grid.virtualScrollers.classList.remove("b-hide-display")):(r.style.width=0,e.header.element.classList.remove("b-overflowing"),e.footer&&e.footer.element.classList.remove("b-overflowing"),e.overflowingHorizontally=!1))}},{key:"initScroll",value:function(){var e=this,t=e.scrollable,n=e.virtualScrollerElement,r=e.createOnFrame(e.syncScrollingPartners);ge.isFirefox&&t.element.addEventListener("wheel",(function(e){e.deltaX&&(t.x+=e.deltaX,e.preventDefault())})),t.yScroller=e.grid.scrollable,t.yScroller.addScroller(t),e.fakeScroller=new Qn({element:n,overflowX:!0}),t.on("scroll",(function(){e.forceScrollUpdate?(e.syncScrollingPartners(),e.forceScrollUpdate=!1):r()})),t.on("scrollend",(function(){e.scrolling=!1})),t.addPartner(e.fakeScroller,"x"),e.header&&t.addPartner(e.header.scrollable,"x"),e.footer&&t.addPartner(e.footer.scrollable,"x")}},{key:"syncScrollingPartners",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.grid,r=t.scrollable.x;!t.scrolling&&e&&(t.scrolling=!0),n.trigger("horizontalScroll",{subGrid:t,grid:n,scrollLeft:r})}},{key:"scrollColumnIntoView",value:function(e,t){var n=this,r=n.header.scrollable;if(e=e instanceof Rs?e:n.columns.get(e)||n.columns.getById(e)||n.columns.getAt(e)){var i=n.header.getHeader(e.id);if(i)return r.scrollIntoView(Oe.from(i,null,!0),t)}}},{key:"onAddRow",value:function(e){var t=e.rows,n=this,r=n.rowTemplate(),i=n.columns.bottomColumns.filter((function(e){return!e.hidden})),o=document.createDocumentFragment();t.forEach((function(e){var t=rn.createElementFromTemplate(r);o.appendChild(t),e.addElement(n.region,t),n.fixCellWidths(t,i)})),n.fixRowWidthsInSafariEdge(),n.element.insertBefore(o,n.insertRowsBefore)}},{key:"clearRows",value:function(){this.emptyCache();var e=this.element.querySelectorAll(".b-grid-row"),t=document.createRange();e.length&&(t.setStartBefore(e[0]),t.setEndAfter(e[e.length-1]),t.deleteContents())}},{key:"addNewRowElement",value:function(){var e=rn.append(this.element,this.rowTemplate());return this.fixCellWidths(e),e}},{key:"toggleTransitionClasses",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=n.resolveSplitter(r);r.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),r.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),i.classList[e?"remove":"add"]("b-grid-splitter-animate")}},{key:"collapse",value:(r=Di()(Ei.a.mark((function e(){var t,n,r,i,o;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,o=0,n.eachSubGrid((function(e){e!==t&&!e._collapsed&&++o})),0!==o){e.next=6;break}return e.next=6,r.expand();case 6:return e.abrupt("return",new Promise((function(e){if(!t._beforeCollapseState){t._beforeCollapseState={};var n=!1;t.width&&(n=!0,t.on({afterinternalresize:function(){e(t)},thisObj:t,once:!0})),t._beforeCollapseState.width=t.width,t._beforeCollapseState.elementWidth=t.element.style.width,""===r.element.style.flex&&(t._beforeCollapseState.nextRegionWidth=r.width,r.width+=t._beforeCollapseState.width),""!==t.element.style.flex&&(t._beforeCollapseState.flex=t.element.style.flex,t.header.element.style.flex=t.element.style.flex=""),t.element.classList.add("b-grid-subgrid-collapsed"),t.virtualScrollerElement.classList.add("b-collapsed"),t.header.element.classList.add("b-collapsed"),t.footer&&t.footer.element.classList.add("b-collapsed"),t.width="",t._collapsed=!0,n||e(!1)}})).then((function(e){t.isDestroyed||!1===e||(t.syncParallelSplitters(!0),t.grid.trigger("subGridCollapse",t),i.startSplitterButtonSyncing())})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"expand",value:(n=Di()(Ei.a.mark((function e(){var t,n,r,i;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,e.abrupt("return",new Promise((function(e){if(null!=t._beforeCollapseState){var n=!1;t.width!==t._beforeCollapseState.elementWidth&&(n=!0,t.on({afterinternalresize:function(){setTimeout((function(){return e(t)}),10)},thisObj:t,once:!0})),""===r.element.style.flex&&(r.width=t._beforeCollapseState.nextRegionWidth),t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,t.virtualScrollerElement.classList.remove("b-collapsed"),t.header.element.classList.remove("b-collapsed"),t.footer&&t.footer.element.classList.remove("b-collapsed"),t._beforeCollapseState.flex?(t.width=t._beforeCollapseState.width,t.header.flex=t.flex=t._beforeCollapseState.flex,t.footer&&(t.footer.flex=t._beforeCollapseState.flex),t._width=null):t.width=t._beforeCollapseState.elementWidth,t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,n||e(!1),delete t._beforeCollapseState}})).then((function(e){!1!==e&&(i.stopSplitterButtonSyncing(),t.syncParallelSplitters(!1),t.grid.trigger("subGridExpand",t))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"totalFixedWidth",get:function(){return this.columns.totalFixedWidth}},{key:"width",set:function(e){var n=this;n.hasCalculatedWidth=!1,fn()(oe()(t.prototype),"width",e,this,!0),n.header&&(n.header.width=e),n.footer&&(n.footer.width=e),n.isPainted&&n.onElementResize()},get:function(){return se()(oe()(t.prototype),"width",this)}},{key:"flex",set:function(e){var n=this;n.hasCalculatedWidth=!1,n.header&&(n.header.flex=e),n.footer&&(n.footer.flex=e),fn()(oe()(t.prototype),"flex",e,this,!0),n.isPainted&&n.onElementResize()},get:function(){return se()(oe()(t.prototype),"flex",this)}},{key:"viewRectangle",get:function(){return new Oe(this.scrollable.x,this.scrollable.y,this._width,this.rowManager.viewHeight)}},{key:"scrolling",set:function(e){this._scrolling=e,this.grid.bodyContainer.classList[e?"add":"remove"]("b-scrolling")},get:function(){return this._scrolling}},{key:"rowElements",get:function(){return this.fromCache(".b-grid-row",!0)}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.element.dataset.emptyText=e}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){this.isConfiguring?this._collapsed=e:e?this.collapse():this.expand()}}],[{key:"$name",get:function(){return"SubGrid"}},{key:"defaultConfig",get:function(){return{localizableProperties:["emptyText"],localeClass:"Grid",insertRowsBefore:null,appendTo:null,hideHeaders:null,monitorResize:!0,collapsed:null,scrollable:{overflowX:!0},scrollerClass:du,hasCalculatedWidth:null,sealedColumns:null,emptyText:null}}}]),t}(vr);gu._$name="SubGrid";var vu={TemplateColumn:{noTemplate:"TemplateColumn needs a template",noFunction:"TemplateColumn.template must be a function"},ColumnStore:{columnTypeNotFound:function(e){return"Column type '".concat(e.type,"' not registered")}},ColumnPicker:{columnsMenu:"Columns",hideColumn:"Hide column",hideColumnShort:"Hide"},Filter:{applyFilter:"Apply filter",filter:"Filter",editFilter:"Edit filter",on:"On",before:"Before",after:"After",equals:"Equals",lessThan:"Less than",moreThan:"More than",removeFilter:"Remove filter"},FilterBar:{enableFilterBar:"Show filter bar",disableFilterBar:"Hide filter bar"},Group:{groupAscending:"Group ascending",groupDescending:"Group descending",groupAscendingShort:"Ascending",groupDescendingShort:"Descending",stopGrouping:"Stop grouping",stopGroupingShort:"Stop"},Search:{searchForValue:"Search for value"},Sort:{sortAscending:"Sort ascending",sortDescending:"Sort descending",multiSort:"Multi sort",removeSorter:"Remove sorter",addSortAscending:"Add ascending sorter",addSortDescending:"Add descending sorter",toggleSortAscending:"Change to ascending",toggleSortDescending:"Change to descending",sortAscendingShort:"Ascending",sortDescendingShort:"Descending",removeSorterShort:"Remove",addSortAscendingShort:"+ Ascending",addSortDescendingShort:"+ Descending"},Tree:{noTreeColumn:"To use the tree feature one column must be configured with tree: true"},Grid:{featureNotFound:function(e){return"Feature '".concat(e,"' not available, make sure you have imported it")},invalidFeatureNameFormat:function(e){return"Invalid feature name '".concat(e,"', must start with a lowercase letter")},removeRow:"Delete record",removeRows:"Delete records",loadFailedMessage:"Data loading failed.",moveColumnLeft:"Move to left section",moveColumnRight:"Move to right section"},GridBase:{loadMask:"Loading...",noRows:"No records to display"},PdfExport:{"Waiting for response from server...":"Waiting for response from server..."},ExportDialog:{width:"40em",labelWidth:"12em",exportSettings:"Export settings",export:"Export",exporterType:"Control pagination",cancel:"Cancel",fileFormat:"File format",rows:"Rows",alignRows:"Align rows",columns:"Columns",paperFormat:"Paper format",orientation:"Orientation"},ExportRowsCombo:{all:"All rows",visible:"Visible rows"},ExportOrientationCombo:{portrait:"Portrait",landscape:"Landscape"},SinglePageExporter:{singlepage:"Single page"},MultiPageExporter:{multipage:"Multiple pages",exportingPage:function(e){var t=e.currentPage,n=e.totalPages;return"Exporting the page ".concat(t,"/").concat(n)}}};for(var mu in er)vu[mu]=er[mu];var pu=vu;function yu(){var e=Lr()(['\n            <div tabindex="-1">\n                <header reference="headerContainer" class="b-grid-header-container ','"></header>\n                <div reference="bodyContainer" class="b-grid-body-container">\n                    <div reference="verticalScroller" class="b-grid-vertical-scroller"></div>\n                </div>\n                <div reference="virtualScrollers" class="b-virtual-scrollers ','" style="','"></div>\n                <footer reference="footerContainer" class="b-grid-footer-container b-hidden"></footer>\n            </div>\n        ']);return yu=function(){return e},e}je.registerLocale("En",{desc:"English",locale:vu});var ku=new Promise((function(e){return e()})),bu={block:"nearest",inline:"nearest"},wu={dataset:1,filter:1},Su=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"finishConfigure",value:function(e){var n=this;se()(oe()(t.prototype),"finishConfigure",this).call(this,e),n.scrollManager=new jl({grid:n,verticalElement:n.scrollable.element}),je.on({locale:"onBeforeLocaleChange",prio:1,thisObj:n}),je.on({locale:"onLocaleChange",prio:-1,thisObj:n}),ir.on({theme:"onThemeChange",thisObj:n}),n.setGridClassList(n.element.classList)}},{key:"onBeforeLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!0}},{key:"onLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!1,this.isPainted&&this.renderContents()}},{key:"finalizeInit",value:function(){se()(oe()(t.prototype),"finalizeInit",this).call(this),this.store.isLoading&&this.onStoreBeforeRequest()}},{key:"doDestroy",value:function(){var e=this;e.storeDetacher&&e.storeDetacher();for(var n=0,r=Object.values(e.features);n<r.length;n++){var i=r[n];i.destroy&&i.destroy()}e.columns&&(e.columns=null),e.store&&(e.store=null),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"setGridClassList",value:function(e){var t=this;for(var n in e.add("b-grid-".concat(t.positionMode)),t.enableTextSelection||e.add("b-grid-notextselection"),t.autoHeight&&e.add("b-autoheight"),t.readOnly&&e.add("b-readonly"),t.fillLastColumn&&e.add("b-fill-last-column"),t.showDirty&&e.add("b-show-dirty"),t.features){var r=t.features[n],i=void 0;(i=r.constructor.hasOwnProperty("featureClass")?r.constructor.featureClass:"b-".concat(r instanceof z?r.$name:r.constructor.name))&&e.add(i.toLowerCase())}}},{key:"template",value:function(e){var t=ge.isFirefox?"height:".concat(rn.scrollBarWidth,"px"):"";return Hr.tpl(yu(),this.hideHeaders?"b-hidden":"",rn.scrollBarWidth?"":"b-overlay-scrollbar",t)}},{key:"onColumnsChanged",value:function(e){var t=e.action,n=e.changes,r=e.record,i=this;if(i.isPainted){if("update"===t){if("width"in n||"minWidth"in n||"flex"in n){if(i.isPainted){var o=r.region;i.columns.visibleColumns.forEach((function(e){e.region===o&&e.repaintOnResize&&i.refreshColumn(e)}))}return}if("hidden"in n){var a=i.getSubGridFromColumn(r.id);a.header.fixHeaderWidths(),a.footer&&a.footer.fixFooterWidths(),a.updateHasFlex()}}("dataset"===t||n&&"region"in n&&!i.regions.includes(n.region.value))&&(i.initSubGrids(),i.eachSubGrid((function(e){e.render(i.verticalScroller),e.initScroll()}))),i._suspendRenderContentsOnColumnsChanged||i.renderContents()}}},{key:"onColumnsResized",value:function(e){var t=e.changes,n=e.record,r=this,i=t.width&&null==n.flex,o=t.minWidth&&null==n.flex,a=t.flex&&null==n.width,s=rn.setLength(n.width),l=rn.setLength(n.minWidth),u=r.getSubGridFromColumn(n.id);u.header.fixHeaderWidths(),u.footer&&u.footer.fixFooterWidths(),u.updateHasFlex(),r.cellEls&&n===r.lastColumnResized||(r.cellEls=rn.children(r.element,".b-grid-cell[data-column-id=".concat(n.id,"]")),r.lastColumnResized=n);var c=!0,d=!1,h=void 0;try{for(var f,g=r.cellEls[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var v=f.value;i?(v.style.width=s,v.style.flex="",ge.isIE11&&(v.style.minWidth=s)):o?v.style.minWidth=l:a?(v.style.flex=n.flex,v.style.width=""):v.style.flex=v.style.width=v.style.minWidth=""}}catch(e){d=!0,h=e}finally{try{c||null==g.return||g.return()}finally{if(d)throw h}}r.dragResizing||r.afterColumnsResized()}},{key:"afterColumnsResized",value:function(){var e=this;e.refreshVirtualScrollbars(),e.eachSubGrid((function(e){e.collapsed||(e.fixWidths(),e.fixRowWidthsInSafariEdge(),e.refreshFakeScroll())})),e.onHeightChange(),e.lastColumnResized=e.cellEls=null}},{key:"processCellEditor",value:function(e){}},{key:"toggleEmptyText",value:function(){this.bodyContainer&&this.bodyContainer.classList[this.rowManager.rowCount||this.store.isLoading?"remove":"add"]("b-grid-empty")}},{key:"bindStore",value:function(e){if(e){var t=this;t.storeDetacher=e.on({refresh:t.onStoreDataChange,update:t.onStoreUpdateRecord,add:t.onStoreAdd,remove:t.onStoreRemove,move:t.onStoreMove,replace:t.onStoreReplace,removeall:t.onStoreRemoveAll,beforerequest:t.onStoreBeforeRequest,afterrequest:t.onStoreAfterRequest,clearchanges:t.onStoreDataChange,exception:t.onStoreException,commit:t.onStoreCommit},t)}}},{key:"onStoreUpdateRecord",value:function(e){var t=e.source,n=e.record,r=e.changes,i=this;if(i.forceFullRefresh)i.rowManager.refresh(),i.forceFullRefresh=!1;else{var o;if(n.isFieldModified("id")&&(o=i.getRowFor(n.meta.modified.id)),!(o=o||i.getRowFor(n)))return;if(i.fullRowRefresh||n.meta.specialRow){var a=t.indexOf(n);-1!==a&&o.render(a,n)}else i.columns.visibleColumns.forEach((function(e){var t=e.field;if(!(e.constructor.simpleRenderer&&!e.data.hasOwnProperty("renderer"))||r[t]){var i=o.getCell(t);i&&o.renderCell(i,n)}}))}}},{key:"refreshFromRowOnStoreAdd",value:function(e,t){var n=this.rowManager;n.renderFromRow(e),n.trigger("changeTotalHeight",{totalHeight:n.totalHeight}),1===this.store.count&&this.callEachSubGrid("refreshFakeScroll")}},{key:"onStoreAdd",value:function(e){var t=e.source,n=e.records,r=e.index,i=e.oldIndex,o=e.isChild,a=e.oldParent,s=e.isMove;if(this.isPainted&&(!o||n[0].ancestorsExpanded(t))){this.rowManager.calculateRowCount(!1,!0,!0);var l=this,u=l.rowManager,c=u.topIndex,d=u.rows,h=u.rowCount,f=u.topIndex+u.rowCount-1,g=r,v=r+n.length-1,m=f>=t.count-n.length-1;a||i>-1||o&&s?u.refresh():g>=c&&g<c+h?l.refreshFromRowOnStoreAdd.apply(l,[d[g-c]].concat(Array.prototype.slice.call(arguments))):v>=c&&v<c+h?u.refresh():(m&&r>f&&u.fillBelow(l._scrollTop),u.trigger("changeTotalHeight",{totalHeight:u.totalHeight}))}}},{key:"onStoreException",value:function(e){var t,n=this;switch(e.type){case"server":t=e.response.message||"Unspecified failure";break;case"exception":t="network"===e.exceptionType?"Network error":e.error&&e.error.message||"Failed to parse server response";break;default:t=e.response.status+" - "+e.response.statusText||"Unknown error"}var r='<div class="b-grid-load-failure">\n                <div class="b-grid-load-fail">'.concat(n.L("loadFailedMessage"),'</div>\n                <div class="b-grid-load-fail">').concat(e.response.url?e.response.url+" responded with":"",'</div>\n                <div class="b-grid-load-fail">').concat(t,"</div>\n            </div>");n.activeMask&&(n.activeMask.icon=n.loadMaskErrorIcon,n.activeMask.text=r,n.loadmaskHideTimer=n.setTimeout((function(){n.unmaskBody()}),n.loadMaskHideTimeout))}},{key:"onStoreDataChange",value:function(e){var n=e.action,r=e.changes,i=e.source;se()(oe()(t.prototype),"onStoreDataChange",this)&&se()(oe()(t.prototype),"onStoreDataChange",this).apply(this,arguments);var o=this,a=i.isGrouped&&r&&i.groupers.some((function(e){return e.field in r}));"dataset"===n&&(o.rowManager.averageRowHeight=null),o.isPainted&&!a&&o.renderRows(null,wu[n]),o.toggleEmptyText()}},{key:"onStoreBeforeRequest",value:function(){this.loadMask&&this.maskBody(this.loadMask)}},{key:"onStoreAfterRequest",value:function(e){this.activeMask&&!e.exception&&(this.unmaskBody(),this.toggleEmptyText())}},{key:"onStoreRemove",value:function(e){var n=e.records,r=e.isCollapse,i=e.isChild,o=e.isMove;if(this.isPainted&&!o){se()(oe()(t.prototype),"onStoreRemove",this)&&se()(oe()(t.prototype),"onStoreRemove",this).apply(this,arguments);var a=Math.pow(2,53)-1,s=this,l=this.rowManager,u=n.reduce((function(e,t){var n=l.getRowById(t.id);return n&&(e.push(n),a=Math.min(a,l.rows.indexOf(n))),e}),[]);if(s.animateRemovingRows&&u.length&&!r&&!i){var c=u[0];s.isAnimating=!0,Ln.on({element:c._elementsArray[0],transitionend:function(e){s.isAnimating=!1,"background-color"!==e.propertyName&&"width"!==e.propertyName&&(u.forEach((function(e){return e.removeCls("b-removing")})),l.refresh(),s.trigger("rowRemove"))},once:!0}),u.forEach((function(e){return e.addCls("b-removing")}))}else l.calculateRowCount(!1,!0,!0),l.rows[a]?l.renderFromRow(l.rows[a]):l.trigger("changeTotalHeight",{totalHeight:l.totalHeight}),s.trigger("rowRemove",{isCollapse:r})}}},{key:"onStoreMove",value:function(e){var t=e.from,n=e.to,r=this.rowManager,i=r.topIndex,o=r.rowCount,a=[t,n].sort(),s=fe()(a,2),l=s[0],u=s[1];l>=i&&l<i+o?r.renderFromRow(r.rows[l-i]):u>=i&&u<i+o&&r.refresh()}},{key:"onStoreReplace",value:function(e){var t=this,n=e.records;if(e.all)this.rowManager.refresh();else{var r=n.reduce((function(e,n){var r=fe()(n,2)[1],i=t.getRowFor(r);return i&&e.push(i),e}),[]);this.rowManager.renderRows(r)}}},{key:"onStoreRemoveAll",value:function(){se()(oe()(t.prototype),"onStoreRemoveAll",this)&&se()(oe()(t.prototype),"onStoreRemoveAll",this).apply(this,arguments),this.isPainted&&(this.renderRows(),this.toggleEmptyText())}},{key:"onStoreCommit",value:function(e){var t=this,n=e.changes;if(this.showDirty&&n.modified.length){var r=[];n.modified.forEach((function(e){var n=t.rowManager.getRowFor(e);n&&r.push(n)})),this.rowManager.renderRows(r)}}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.subGrids,i=n.regions,o=!0;Object.entries(r).forEach((function(a){var s=fe()(a,2),l=s[0],u=s[1];if(!u.sealedColumns&&e.draggable&&l!==e.region&&(!e.parent&&r[e.region].columns.count>1||e.parent&&e.parent.children.length>1)){var c=u.element.compareDocumentPosition(r[e.region].element)===document.DOCUMENT_POSITION_PRECEDING,d=i.length>2?n.L("Move column to ")+l:n.L(c?"moveColumnRight":"moveColumnLeft");t.push({targetSubGrid:l,text:d,icon:"b-fw-icon "+(c?"b-icon-column-move-right":"b-icon-column-move-left"),name:"moveColumn",cls:o?"b-separator":"",onItem:function(e){var t=e.item,i=t.column;i.traverse((function(e){return e.region=l})),n.columns.insert(n.columns.indexOf(r[t.targetSubGrid].columns.last)+1,i),n.scrollColumnIntoView(i)}}),o=!1}}))}},{key:"getCellMenuItems",value:function(e,t,n){var r=this;r.showRemoveRowInContextMenu&&!r.readOnly&&t&&!t.meta.specialRow&&(r.selectedRecords.length>1?n.push({text:r.L("removeRows"),icon:"b-fw-icon b-icon-trash",name:"removeRows",onItem:function(){return r.store.remove(r.selectedRecords)}}):n.push({text:r.L("removeRow"),icon:"b-fw-icon b-icon-trash",name:"removeRow",onItem:function(){return r.store.remove(t)}}))}},{key:"getColumnDragToolbarItems",value:function(e,t){return t}},{key:"normalizeCellContext",value:function(e){var t=this.columns,n=this.store;if(e instanceof n.modelClass)return{record:e,id:e.id,columnId:t.bottomColumns[0].id};if(!("columnId"in e)){if("field"in e){var r=t.get(e.field);e.columnId=r&&r.id}else if("column"in e){var i="number"==typeof e.column?t.bottomColumns[e.column]:e.column;e.columnId=i&&i.id}"columnId"in e||(e.columnId=t.bottomColumns[0].id)}if("id"in e){if(e.element&&!n.getById(e.id)){var o=this.getRecordFromElement(e.element);o&&(e.id=o.id)}}else"row"in e?e.id=n.getAt(e.row).id:"record"in e&&(e.id=e.record.id);return e}},{key:"getCell",value:function(e){var t,n=null;return"id"in(e=this.normalizeCellContext(e))&&(t=this.getRowById(e.id)),t&&"columnId"in e&&(n=t.getCell(e.columnId)),n}},{key:"getHeaderElement",value:function(e){return"string"!=typeof e&&(e=e.id),this.fromCache('.b-grid-header[data-column-id="'.concat(e,'"]'))}},{key:"getHeaderElementByField",value:function(e){var t=this.columns.get(e);return t?this.getHeaderElement(t):null}},{key:"getRecordFromElement",value:function(e){var t=e.closest(".b-grid-row");return t?this.store.getAt(t.dataset.index):null}},{key:"getColumnFromElement",value:function(e){var t=rn.up(e,".b-grid-cell, .b-grid-header");if(!t)return null;if(t.matches(".b-grid-header"))return this.columns.getById(t.dataset.columnId);var n=sl.get(t);return this.columns.getById(n.columnId)}},{key:"fixSizes",value:function(){this.callEachSubGrid("fixWidths")}},{key:"onRowManagerChangeTotalHeight",value:function(e){var t=e.totalHeight;return this.refreshTotalHeight(t)}},{key:"refreshTotalHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rowManager.totalHeight,t=this;if(t.renderingRows||!t.isVisible)return!1;t.rowManager.bottomRow&&(e=Math.max(e,t.rowManager.bottomRow.bottom));var n=t.scrollable,r=Math.abs(t.virtualScrollHeight-e),i=t._bodyRectangle.height,o=e-i;if(r){var a=o-t._scrollTop<2*i||t._verticalScrollHeight&&t._verticalScrollHeight-i<t._scrollTop;n.scrollHeight=t.virtualScrollHeight=e,t.scrolling&&!a?t.virtualScrollHeightDirty||(t.virtualScrollHeightDirty=n.on({scrollend:t.fixElementHeights,thisObj:t,once:!0})):(t.virtualScrollHeightDirty&&t.virtualScrollHeightDirty(),t.fixElementHeights(e))}}},{key:"fixElementHeights",value:function(){var e=this,t=e.virtualScrollHeight,n="".concat(t,"px");e._verticalScrollHeight=t,e.verticalScroller.style.height=n,e.virtualScrollHeightDirty=!1,e.autoHeight&&(e.bodyContainer.style.height=n,e._bodyHeight=t,e._bodyRectangle=Oe.client(e.bodyContainer)),e.refreshVirtualScrollbars()}},{key:"onRowManagerRequestScrollChange",value:function(e){var t=e.bottom;this.scrollable.y=t-this.bodyHeight}},{key:"initScroll",value:function(){var e=this;if(!e.scrollInitialized){var t,n=e.createOnFrame((function(){(t=e.scrollable.y)!==e._scrollTop&&(e._scrollTop=t,e.scrolling||(e.scrolling=!0,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!0}))),e.rowManager.updateRenderedRows(t),e.trigger("scroll",{scrollTop:t}))}));e.scrollInitialized=!0,e.scrollable.on({scroll:n,scrollend:function(){e.scrolling=!1,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!1}))}}),e.callEachSubGrid("initScroll")}}},{key:"scrollRowIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bu,n=this,r=t.block||"nearest",i=n.rowManager;if(e=n.store.getById(e)){if(-1===n.store.indexOf(e))return ku;var o=n.scrollable,a=n.getRecordCoords(e),s=Oe.from(o.element);if(a.virtual){var l=a.block;if(o.scrollIntoView(a,{block:"center"}),i.scrollTargetRecordId=e,i.updateRenderedRows(o.y,!0),a=n.getRecordCoords(e),i.lastScrollTop=o.y,a.virtual)return ku;var u="nearest"!==r?t:{block:l};if(t.animate){o.suspendEvents(),"end"===r||"nearest"===r&&"end"===l?o.y-=s.bottom-a.bottom:("start"===r||"nearest"===r&&"start"===l)&&(o.y+=a.y-s.y),i.updateRenderedRows(o.y,!1,!0),"end"===l?o.y-=i.appendRowBuffer*i.rowHeight-1:o.y+=i.prependRowBuffer*i.rowHeight-1;var c=o.scrollIntoView(n.getRecordCoords(e),Object.assign({},t,u));return c.then((function(){return o.resumeEvents()}))}return n.scrollRowIntoView(e,Object.assign({},t,u))}var d=t.column;if(d){if("string"==typeof d&&(d=n.columns.getById(d)||n.columns.get(d)),d){o=n.getSubGridFromColumn(d).scrollable;var h=Oe.from(i.getRowFor(e).getCell(d.id));a.x=h.x,a.width=h.width}}else t.x=!1;return o.scrollIntoView(a,t)}}},{key:"scrollColumnIntoView",value:function(e,t){return e=e instanceof Rs?e:this.columns.get(e)||this.columns.getById(e)||this.columns.getAt(e),this.getSubGridFromColumn(e).scrollColumnIntoView(e,t)}},{key:"scrollCellIntoView",value:function(e,t){return this.scrollRowIntoView(e.id,Object.assign({column:e.columnId},"boolean"==typeof t?{animate:t}:t))}},{key:"scrollToBottom",value:function(e){return this.scrollRowIntoView(this.store.last,e)}},{key:"scrollToTop",value:function(e){return this.scrollable.scrollBy(0,-this.scrollable.y,e)}},{key:"storeScroll",value:function(){var e=this.storedScrollState={scrollTop:this.scrollable.y,scrollLeft:{}};return this.eachSubGrid((function(t){e.scrollLeft[t.region]=t.scrollable.x})),e}},{key:"restoreScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.storedScrollState,t=this;t.eachSubGrid((function(t){t.scrollable.x=e.scrollLeft[t.region]})),t.scrollable.y=e.scrollTop}},{key:"measureRowHeight",value:function(){var e=this,t=rn.createElement({tag:"div",className:"b-grid "+(e.features.stripe?"b-stripe":""),style:"position: absolute; visibility: hidden",html:'<div class="b-grid-subgrid"><div class="b-grid-row"></div></div>',parent:document.getElementById(e.appendTo)||document.body}),n=t.firstElementChild.firstElementChild,r=parseInt(rn.getStyleValue(n,"height")),i=parseInt(rn.getStyleValue(n,"border-top-width")),o=parseInt(rn.getStyleValue(n,"border-bottom-width"));null!=e.rowHeight&&e.rowHeight!==e._rowHeightFromStyle||(e.rowHeight=!isNaN(r)&&r?r:e.defaultRowHeight,e._rowHeightFromStyle=e.rowHeight),e._rowBorderHeight=i+o,e._isRowMeasured=!0,t.remove()}},{key:"onThemeChange",value:function(e){var t=e.theme;this.measureRowHeight(),this.trigger("theme",{theme:t})}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.element.classList.add("b-notransition"),e?this.rowManager.returnToTop():this.rowManager.refresh(),this.element.classList.remove("b-notransition")}},{key:"refreshColumn",value:function(e){var t=e.field;this.rowManager.forEach((function(e){var n=e.getCell(t);e.renderCell(n)}))}},{key:"refreshVirtualScrollbars",value:function(){var e=this,t=e.headerContainer,n=e.footerContainer,r=e.virtualScrollers,i=e.scrollable,o=ge.isEdge||ge.isIE11?Math.abs(i.scrollHeight-i.clientHeight)>1:i.scrollHeight>i.clientHeight,a=o?"add":"remove";Object.values(e.subGrids).some((function(e){return e.overflowingHorizontally}))?r.classList.remove("b-hide-display"):r.classList.add("b-hide-display"),t.classList[a]("b-grid-vertical-overflow"),n.classList[a]("b-grid-vertical-overflow"),r.classList[a]("b-grid-vertical-overflow"),e.onHeightChange(),rn.scrollBarWidth&&(t.style.marginRight=n.style.paddingRight=o?"".concat(rn.scrollBarWidth-1,"px"):0)}},{key:"onContentChange",value:function(){var e=this,t=e.rowManager;e.isVisible?(t.estimateTotalHeight(),e.paintListener=null,e.refreshTotalHeight(e.contentHeight),e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange()):e.paintListener||(e.paintListener=e.on({paint:"onContentChange",once:!0,thisObj:e}))}},{key:"onHeightChange",value:function(){var e=this;e._bodyRectangle=Oe.client(e.bodyContainer),e._bodyHeight=e.autoHeight?e.contentHeight:e.bodyContainer.offsetHeight}},{key:"renderHeader",value:function(e,t){}},{key:"renderFooter",value:function(e,t){}},{key:"suspendRefresh",value:function(){this.refreshSuspended++}},{key:"resumeRefresh",value:function(e){this.refreshSuspended&&!--this.refreshSuspended&&e&&this.refreshRows()}},{key:"renderRows",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=e&&n.storeScroll();n.refreshSuspended||(n.trigger("beforeRenderRows"),n.renderingRows=!0,n.element.classList.add("b-grid-refreshing"),t&&(n.scrollable.y=n._scrollTop=0),n.rowManager.reinitialize(t),n.trigger("renderRows"),n.renderingRows=!1,n.onContentChange(),e&&n.restoreScroll(r),n.element.classList.remove("b-grid-refreshing"))}},{key:"renderContents",value:function(){var e=this,t=e.element,n=e.headerContainer,r=e.footerContainer,i=e.rowManager;if(e.emptyCache(),e.isPainted){e._headerHeight=null,e.callEachSubGrid("refreshHeader",n),e.callEachSubGrid("refreshFooter",r),e.renderHeader(n,t),e.renderFooter(r,t),e.fixSizes();var o=i.removeAllRows();i.calculateRowCount(!1,!0,!0),i.rowCount&&(i.setPosition(o),e.renderRows())}}},{key:"onPaint",value:function(){var e=this,t=e.rowManager,n=e.store,r=e.element,i=e.headerContainer,o=e.bodyContainer,a=e.footerContainer;if(!e.isPainted){var s,l=0;e.columns.on({change:function(){return s=!0},single:!0}),e._bodyRectangle=Oe.client(e.bodyContainer);var u=e.bodyContainer.offsetHeight;e.updateResponsive(e.width,0),s&&(e.callEachSubGrid("refreshHeader",i),e.callEachSubGrid("refreshFooter",a)),e.renderHeader(i,r),e.renderFooter(a,r),e.autoHeight?(e._bodyHeight=t.initWithHeight(r.offsetHeight-i.offsetHeight-a.offsetHeight,!0),o.style.height=e.bodyHeight+"px"):(e._bodyHeight=u,t.initWithHeight(e._bodyHeight,!0)),e.eachSubGrid((function(e){e.header.maxDepth>l&&(l=e.header.maxDepth)})),i.dataset.maxDepth=l,e.fixSizes(),!n.count&&n.isLoading||e.renderRows(!1,!1),e.initScroll(),e.initInternalEvents()}}},{key:"render",value:function(){var e=this;e.requireSize=Boolean(e.owner),se()(oe()(t.prototype),"render",this).apply(this,arguments),e.autoHeight||!e.headerContainer.offsetHeight||e.bodyContainer.offsetHeight||console.warn("Grid element not sized correctly, please check your CSS styles and review how you size the widget")}},{key:"maskBody",value:function(e){var t=this;if(t.bodyContainer){t.unmaskBody();var n=(t.activeMask=dn.mask(e,t.element)).maskElement;return n.style.marginTop="".concat(t.bodyContainer.offsetTop,"px"),n.style.height="".concat(t.virtualScrollers.offsetTop+t.virtualScrollers.offsetHeight-t.bodyContainer.offsetTop,"px"),t.activeMask}}},{key:"unmaskBody",value:function(){var e=this;e.loadmaskHideTimer&&e.clearTimeout(e.loadmaskHideTimer),e.loadmaskHideTimer=null,e.activeMask&&e.activeMask.destroy(),e.activeMask=null}},{key:"contentElement",get:function(){return this.verticalScroller}},{key:"overflowElement",get:function(){return this.bodyContainer}},{key:"focusElement",get:function(){return this.element}},{key:"columns",set:function(e){var t,n,r=this;r._columnStore?e?r._columnStore.data=e:r._columnStore.destroy():(e instanceof Ms?(e.grid||(e.grid=r),r._columnStore=e):Array.isArray(e)?r._columnStore=new Ms({grid:r,data:e}):e&&(r._columnStore=new Ms(Object.assign({grid:r},e))),r._columnStore.on("change",r.onColumnsChanged,r),r._columnStore.on((t=r.onColumnsResized,n=r,{update:function(e){var r=e.store,i=e.record,o=e.changes,a=!0;return("width"in o||"minWidth"in o||"flex"in o)&&(a=t.call(n,{store:r,record:i,changes:o})),a}})),ge.isTouchDevice&&(r.touch=!0,r._columnStore.forEach((function(e){var t=e.touchConfig;t&&e.applyState(t)}))))},get:function(){return this._columnStore}},{key:"rowManager",get:function(){var e=this;return e._isRowMeasured||e.measureRowHeight(),e._rowManager||(e._rowManager=new Wl({grid:e,rowHeight:e.rowHeight,rowScrollMode:e.rowScrollMode||"move",autoHeight:e.autoHeight,listeners:{changetotalheight:e.onRowManagerChangeTotalHeight,requestscrollchange:e.onRowManagerRequestScrollChange,thisObj:e}}))}},{key:"store",get:function(){return this._store},set:function(e){var t=this,n=t.rowManager,r=t.initialConfig.features;if(e!==t._store)if(t.storeDetacher&&(t.storeDetacher(),t.storeDetacher=null),e){if(e instanceof Fi);else{var i={};t.data&&(i.data=t.data),r&&r.tree&&(i.tree=!0),e.modelClass||(i.modelClass=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),t}(Gs)),e=new(e.readUrl?Ii:Fi)(Object.assign(i,e))}t._store=e,t.bindStore(e),t.isPainted&&n.reinitialize()}else t.destroyStore&&t._store.destroy(),t._store=null}},{key:"data",get:function(){return this._store?this._store.records:this._data},set:function(e){this._store?this._store.data=e:this._data=e}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.eachSubGrid((function(t){return t.emptyText=e}))}},{key:"bodyHeight",get:function(){return this._bodyHeight}},{key:"headerHeight",get:function(){var e=this;return e.isPainted&&!e._headerHeight&&(e._headerHeight=e.headerContainer.offsetHeight),e._headerHeight}},{key:"autoHeight",get:function(){return this._autoHeight},set:function(e){kt.assertBoolean(e,"autoHeight"),this._autoHeight=e}},{key:"columnLines",get:function(){return this._columnLines},set:function(e){kt.assertBoolean(e,"columnLines"),rn.toggleClasses(this.element,"b-no-column-lines",!e),this._columnLines=e}},{key:"readOnly",set:function(e){var t=this;t._readOnly=e,t.isPainted&&(t.trigger("readOnly",{readOnly:e}),e?t.element.classList.add("b-readonly"):t.element.classList.remove("b-readonly"))},get:function(){return this._readOnly}},{key:"scrolling",set:function(e){this._scrolling=e,this.bodyContainer.classList[e?"add":"remove"]("b-scrolling")},get:function(){return this._scrolling}},{key:"contentHeight",get:function(){var e=this.rowManager;return Math.max(e.totalHeight,e.bottomRow?e.bottomRow.bottom:0)}},{key:"isAnimating",get:function(){return this._animating},set:function(e){var t=this;t.isPainted&&e!==t.isAnimating&&(e?t.element.classList.add("b-animating"):t.element.classList.remove("b-animating"),t._animating=e)}}],[{key:"getLKey",value:function(){return"fef4b3dd-bde4-11e9-8aff-d094661a2df4"}},{key:"$name",get:function(){return"GridBase"}},{key:"defaultConfig",get:function(){return{rowHeight:null,defaultRowHeight:45,emptyText:"L{noRows}",fullRowRefresh:!0,readOnly:null,hideHeaders:null,showRemoveRowInContextMenu:!0,autoHeight:null,store:{},data:null,columns:[],defaultRegion:"normal",destroyStore:null,enableTextSelection:null,loadMask:"L{loadMask}",columnLines:!0,fillLastColumn:!0,resizeToFitIncludesHeader:!0,animateRemovingRows:!ge.isIE11,disableGridRowModelWarning:null,loadMaskErrorIcon:"b-icon b-icon-warning",headerClass:Ql,testPerformance:!1,positionMode:"translate",rowScrollMode:"move",monitorResize:!0,features:!0,subGridConfigs:{normal:{flex:1}},scrollable:{overflowY:!0},scrollerClass:Xl,showDirty:null,loadMaskHideTimeout:3e3,refreshSuspended:0,transitionDuration:500,contextMenuTriggerEvent:"contextmenu",localizableProperties:["emptyText","loadMask"],localeClass:"Grid"}}},{key:"properties",get:function(){return{_selectedRecords:[],_verticalScrollHeight:0,virtualScrollHeight:0,_scrollTop:null}}}]),t}(pi(Dr).mixes(li,ui,(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"initInternalEvents",value:function(){for(var e=Object.keys(Zl),t=e.length,n={element:this.element,thisObj:this},r=0;r<t;r++)n[e[r]]="handleEvent";Ln.on(n)}},{key:"getEventData",value:function(e){var t=rn.up(e.target,".b-grid-cell");if(t){var n=sl.get(t),r=n.id,i=n.columnId,o=this.store.getById(r);return o?{cellElement:t,cellData:n,columnId:i,id:r,record:o,cellSelector:{id:r,columnId:i}}:null}}},{key:"handleEvent",value:function(e){this.disabled||(this.event=e,Zl[e.type]&&this[Zl[e.type]](e))}},{key:"onElementTouchStart",value:function(e){var t=this;rn.isTouchEvent=!0,1===e.touches.length&&(t.longPressTimeout=setTimeout((function(){t.onElementLongPress(e),e.preventDefault(),t.longPressPerformed=!0}),t.longPressTime))}},{key:"onElementTouchMove",value:function(e){this.longPressTimeout&&(clearTimeout(this.longPressTimeout),this.longPressTimeout=null)}},{key:"onElementTouchEnd",value:function(e){var t=this;t.longPressPerformed&&(e.cancelable&&e.preventDefault(),t.longPressPerformed=!1),t.longPressTimeout&&(clearTimeout(t.longPressTimeout),t.longPressTimeout=null)}},{key:"onElementLongPress",value:function(e){}},{key:"triggerCellMouseEvent",value:function(e,t){var n=this.getEventData(t);if(n){var r=this.columns.getById(n.columnId);this.trigger("cell"+A.capitalizeFirstLetter(e),{grid:this,record:n.record,column:r,cellSelector:n.cellSelector,cellElement:n.cellElement,target:t.target,event:t})}}},{key:"onElementMouseDown",value:function(e){var t=this.getEventData(e);this.skipFocusSelection=!0,this.triggerCellMouseEvent("mousedown",e),e.defaultPrevented||this.onFocusGesture(t,e)}},{key:"onElementMouseMove",value:function(e){}},{key:"onElementMouseUp",value:function(e){}},{key:"onHandleElementClick",value:function(e){!1!==this.trigger("beforeElementClick",{event:e})&&this.onElementClick(e)}},{key:"onElementClick",value:function(e){var t=this.getEventData(e);t&&(this.triggerCellMouseEvent("click",e),sl.get(t.cellElement).row.removeCls("b-hover"))}},{key:"onFocusGesture",value:function(e,t){e&&this.focusCell(e.cellSelector,{doSelect:!0,event:t})}},{key:"onElementDblClick",value:function(e){var t=e.target;if(this.triggerCellMouseEvent("dblClick",e),t.classList.contains("b-grid-header-resize-handle")){var n=rn.up(t,".b-grid-header");this.columns.getById(n.dataset.columnId).resizeToFitContent()}}},{key:"onElementMouseOver",value:function(e){if(!this.scrolling){var t=rn.up(e.target,".b-grid-cell");if(t){var n=sl.get(t).row;!n||"number"==typeof e.buttons&&0!==e.buttons||(this.hoveredRow=n),this.triggerCellMouseEvent("mouseOver",e)}this.trigger("mouseOver",{event:e})}}},{key:"onElementMouseOut",value:function(e){(this.hoveredRow=null,this.scrolling)||(rn.up(e.target,".b-grid-cell")&&this.triggerCellMouseEvent("mouseOut",e),this.trigger("mouseOut",{event:e}))}},{key:"onElementKeyDown",value:function(e){var t=this;if(!e.handled)if(e.target.matches(".b-grid-header.b-depth-0"))t.handleHeaderKeyDown(e);else if(e.target===this.element||ge.isIE11&&e.currentTarget===this.element)t.handleViewKeyDown(e);else if("Escape"===e.key&&t.isActionableLocation){var n=kt.clone(t.focusedCell);n.element=null,t.focusCell(n),rn.focusWithoutScrolling(t.element)}}},{key:"handleViewKeyDown",value:function(e){switch(e.key){case"ArrowLeft":return e.preventDefault(),this.navigateLeft(e);case"ArrowRight":return e.preventDefault(),this.navigateRight(e);case"ArrowUp":return e.preventDefault(),this.navigateUp(e);case"ArrowDown":return e.preventDefault(),this.navigateDown(e)}}},{key:"handleHeaderKeyDown",value:function(e){var t=this,n=t.columns.getById(e.target.dataset.columnId);switch(n.onKeyDown&&n.onKeyDown(e),e.key){case"ArrowLeft":var r=t.columns.getAdjacentVisibleLeafColumn(n,!1);if(r)t.getHeaderElement(r.id).focus();break;case"ArrowRight":var i=t.columns.getAdjacentVisibleLeafColumn(n,!0);if(i)t.getHeaderElement(i.id).focus();break;case"Enter":t.getHeaderElement(n.id).click()}}},{key:"onElementKeyPress",value:function(e){}},{key:"onElementKeyUp",value:function(e){}},{key:"onElementContextMenu",value:function(e){var t=this.getEventData(e);t&&(this.triggerCellMouseEvent("contextMenu",e),rn.isTouchEvent&&this.onFocusGesture(t,e))}},{key:"onInternalResize",value:function(e,n,r,i,o){var a=this;a._devicePixelRatio&&a._devicePixelRatio!==window.devicePixelRatio&&rn.resetScrollBarWidth(),a._devicePixelRatio=window.devicePixelRatio,a._bodyRectangle=Oe.client(a.bodyContainer),se()(oe()(t.prototype),"onInternalResize",this).apply(this,arguments),r!==o&&(a._bodyHeight=a.bodyContainer.offsetHeight,a.isPainted&&a.rowManager.initWithHeight(a._bodyHeight)),a.refreshVirtualScrollbars(),n!==i&&a.setTimeout((function(){a.isDestroyed||a.updateResponsive(n,i)}),0)}},{key:"hoveredRow",set:function(e){var t=this;t._hoveredRow&&!t._hoveredRow.isDestroyed&&(t._hoveredRow.removeCls("b-hover"),t._hoveredRow=null),e&&!t.scrolling&&(t._hoveredRow=e,e.addCls("b-hover"))}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{longPressTime:400}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"createFeatureInitializer",value:function(e,t,n,r){var i=[this],o=n.prototype.construct;return eu[U()(r)]&&(i[1]=r),{configurable:!0,get:function(){return delete e[t],n.prototype.construct=function(){e[t]=this;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];o.apply(this,i),n.prototype.construct=o},V()(n,i)}}}},{key:"hasFeature",value:function(e){return!(!this.features||!this.features[e])}},{key:"features",set:function(e){var t,n,r,i=Xs.getInstanceDefaultFeatures(this);e=this._features=kt.assign({},e),i&&Object.entries(i).forEach((function(t){var n=fe()(t,2),r=n[0];n[1];r in e||(e[r]=!0)}));for(var o=Xs.getInstanceFeatures(this),a=0,s=Object.keys(e);a<s.length;a++)if(t=s[a],n=e[t]){if(A.lowercaseFirstLetter(t)!==t)throw new Error(this.L("invalidFeatureNameFormat",t));if(!(r=o[t]))throw new Error(this.L("featureNotFound",t));Reflect.defineProperty(e,t,this.createFeatureInitializer(e,t,r,n))}},get:function(){return this._features}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onGridElementFocus",value:function(e){var t=this,n={doSelect:!1,event:e};if(t._focusedCell)t.focusCell(t._focusedCell,n);else{var r=t.element.contains(e.relatedTarget)?null:t.lastFocusedCell;if(r){var i=t.getCell(r);if(!i||!rn.isVisible(i)||!t.store.getById(r.id))return void t.revertFocus();t.returningFocus=!0,t.focusCell(r,n),t.returningFocus=!1}else!t.skipFocusSelection&&t.store.first&&t.focusCell({id:t.store.first.id,columnId:t.columns.visibleColumns[0].id},n)}t.skipFocusSelection=!1}},{key:"onFocusOut",value:function(e){se()(oe()(t.prototype),"onFocusOut",this).call(this,e),this.clearFocus()}},{key:"isFocused",value:function(e){return Boolean(this._focusedCell)&&this.isLocationEqual(e,this._focusedCell)}},{key:"focusCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tu;e=this.normalizeCellContext(e===Object?Object.assign({},e):e);var n=this,r=!1!==t.doSelect,i=t,o=i.event,a=i.scroll,s=n.lastFocusedCell=n._focusedCell,l=n.isLocationEqual(e,s),u=s&&n.getCell(s),c=n.getSubGridFromColumn(e.columnId),d=n.getCell(e);if(o&&"mousedown"===o.type)for(var h=o.target;h!==d;h=h.parentElement)if(rn.isFocusable(h))return void(e.element=h);if(l)return o&&n.onCellNavigate&&n.onCellNavigate(n,null,n._focusedCell,o,r),e;u&&u.classList.remove("b-focused");var f=d||n.getCell({row:n.rowManager.topIndex,columnId:e.columnId}),g=Oe.from(c.element),v=Oe.from(f).moveTo(null,g.y);return!1===a?t=Object.assign({},t,nu):(t=Object.assign({},t,a),v.width>g.width||v.height>g.height?t.x=t.y=!1:t.column=e.columnId,n.scrollRowIntoView(e.id,t)),(d=n.getCell(e))&&(e.element=d,d.classList.add("b-focused")),n._focusedCell=e,n.onCellNavigate&&n.onCellNavigate(n,s,n._focusedCell,o,r),n.trigger("navigate",{lastFocusedCell:s,focusedCell:n._focusedCell,event:o}),e}},{key:"isLocationEqual",value:function(e,t){return e&&t&&e.id===t.id&&e.columnId===t.columnId&&(!e.element||!t.element||e.element===t.element)}},{key:"blurCell",value:function(e){var t=this.getCell(e);t&&t.classList.remove("b-focused")}},{key:"clearFocus",value:function(){var e=this;e._focusedCell&&(e.lastFocusedCell=e._focusedCell,e.blurCell(e._focusedCell),e._focusedCell=null)}},{key:"internalNextPrevCell",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this,r=n._focusedCell;return r?n.focusCell({id:r.id,columnId:n.columns.getAdjacentVisibleLeafColumn(r.columnId,e,!0).id},{doSelect:!0,event:t}):null}},{key:"navigateRight",value:function(e){return this.internalNextPrevCell(!0,e)}},{key:"navigateLeft",value:function(e){return this.internalNextPrevCell(!1,e)}},{key:"internalNextPrevRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this,i=r._focusedCell;if(!i)return!1;var o=r.store["get".concat(e?"Next":"Prev")](i.id,!1,t);return!!o&&r.focusCell({id:o.id,columnId:i.columnId,scroll:{x:!1}},{doSelect:!0,event:n})}},{key:"navigateDown",value:function(e){return this.internalNextPrevRow(!0,!1,e)}},{key:"navigateUp",value:function(e){return this.internalNextPrevRow(!1,!1,e)}},{key:"focusedCell",get:function(){var e=this._focusedCell;if(e&&this.getCell(e))return e;this.clearFocus()},set:function(e){this.focusCell(e,{doSelect:!1})}},{key:"isActionableLocation",get:function(){var e=this._focusedCell;return Boolean(e&&e.element&&this.getCell(e).contains(e.element))}},{key:"focusedRecord",get:function(){if(this._focusedCell)return this.store.getById(this._focusedCell.id)}},{key:"cellCSSSelector",get:function(){var e=this._focusedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.index,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getClosestBiggerLevel",value:function(e){var t=this,n=Object.keys(t.responsiveLevels),r=null,i=99995,o=null;return n.forEach((function(n){var a=t.responsiveLevels[n];if(["number","string"].includes(U()(a))||(a=a.levelWidth),"*"===a)o=n;else if(e<a){var s=a-e;s<i&&(i=s,r=n)}})),r||o}},{key:"updateResponsive",value:function(e,t){var n=this,r=n.getClosestBiggerLevel(t),i=n.getClosestBiggerLevel(e);if(r!==i){var o=n.responsiveLevels[i];["number","string"].includes(U()(o))||n.applyState(o),n.columns.forEach((function(e){var t=e.responsiveLevels;t&&(t[i]?e.applyState(t[i]):t["*"]&&e.applyState(t["*"]))})),n.element.classList.remove("b-responsive-"+r),n.element.classList.add("b-responsive-"+i),n.trigger("responsive",{level:i,width:e,oldLevel:r,oldWidth:t})}}},{key:"responsiveLevel",get:function(){return this.getClosestBiggerLevel(this.width)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{responsiveLevels:Object.freeze({small:400,medium:600,large:"*"})}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"afterConfigure",value:function(){var e=this;if(e.selectionMode.checkbox){var n=Ms.getColumnClass("check");if(!n)throw new Error("CheckColumn must be imported for checkbox selection mode to work");var r=e.checkboxColumn=new n({id:"".concat(e.id,"-selection-column"),width:"4em",minWidth:"4em",field:null,cellCls:"b-checkbox-selection",region:Object.keys(e.subGridConfigs).sort()[0]},e.columns);r.meta.depth=0,r._grid=e;var i=r.renderer;r.renderer=function(t){t.value=e.isSelected(t.record),i.call(r,t)},r.on({toggle:"onCheckChange",thisObj:e});var o=e.columns.indexOf(e.columns.findRecord("type","rownumber"))+1;e.columns.insert(o,r)}se()(oe()(t.prototype),"afterConfigure",this).call(this),e.store.on("idChange",e.onRecordIdChange,e)}},{key:"onRecordIdChange",value:function(e){var t=e.record,n=e.oldValue,r=(e.value,this.recordCollection);r.get(n)===t&&r.rebuildIndices()}},{key:"onRecordCollectionChange",value:function(e){e.source,e.action;var t=e.added,n=void 0===t?[]:t,r=e.removed,i=this;i._selectedCell&&!i.isSelectable(i._selectedCell)&&i.deselectCell(i._selectedCell),n=n.filter((function(e){return i.isSelectable(e)})),i.triggerChangeEvent({mode:"row",action:n.length?"select":"deselect",selection:i.selectedRecords,selected:n,deselected:r},i.silent)}},{key:"onCheckChange",value:function(e){var t=e.source,n=e.checked,r=e.record;n?this.selectRow({record:r,column:t,addToSelection:!0,scrollIntoView:!1}):this.deselectRow(r)}},{key:"onElementKeyDown",value:function(e){var n=this.focusedCell,r=this.checkboxColumn;if(se()(oe()(t.prototype),"onElementKeyDown",this).call(this,e),n&&" "===e.key&&r&&this.columns.getById(n.columnId)===r){var i=this.getCell(n).widget;i&&i.toggle()}}},{key:"spliceSelectedRecords",value:function(e,t,n){this._recordCollection.splice(e,t,n)}},{key:"isSelected",value:function(e){return e instanceof mi&&(e=e.id),ru[U()(e)]?this.recordCollection.includes(e):this._selectedCell&&this._selectedCell.id==e.id&&this._selectedCell.columnId===e.columnId}},{key:"isSelectable",value:function(e){if(!e)return!1;var t=this.store.getById(e.id||e);return t&&!(t.meta&&t.meta.specialRow)}},{key:"selectRow",value:function(e){var t=e.record,n=e.column,r=void 0===n?this.columns.bottomColumns[0]:n,i=e.scrollIntoView,o=void 0===i||i,a=e.addToSelection,s=void 0!==a&&a;if("object"!==U()(arguments[0])){var l=arguments;t=l[0],o=!(l.length>1)||l[1],s=l[2]||!1}var u=this,c=u.store.getById(t);t?u.selectCell({id:c.id,column:r},o,s):u.deselectAll()}},{key:"selectCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.recordCollection,a=i.selectionMode,s=i.normalizeCellContext(e),l=s.record||i.store.getById(s.id);if(i.isSelectable(l)){if(t&&i.scrollRowIntoView(s.id,{column:s.columnId}),a.row&&(r&&(i.silent=(i.silent||0)+1),n?o.add(l):o.splice(0,o.count,l),r&&i.silent--,1===i.recordCollection.count&&(i.startCell=s,i.lastRange=null)),a.cell&&(s.columnId||s.column)&&!i.isSelected(s)){var u=i._selectedCell?[i._selectedCell]:[];i._selectedCell=s,i.triggerChangeEvent({mode:"cell",action:"select",selected:[s],deselected:u,selection:[s]},r)}return s}this.deselectAll()}},{key:"deselectAll",value:function(){this.recordCollection.clear(),this._selectedCell&&this.deselectCell(this._selectedCell)}},{key:"deselectRow",value:function(e){var t=e instanceof mi?e:this.store.getById(e);t&&this.recordCollection.remove(t)}},{key:"deselectCell",value:function(e){var t=this,n=t.normalizeCellContext(e),r=t.selectionMode,i=n.record||t.store.getById(n.id),o=t._selectedCell;return r.row&&t.recordCollection.remove(i),r.cell&&n.columnId&&o&&o.id===n.id&&o.columnId===n.columnId&&(t._selectedCell=null,t.triggerChangeEvent({mode:"cell",action:"deselect",selected:[],deselected:[n],selection:[]})),n}},{key:"selectRange",value:function(e,t){var n=this.store,r=this.recordCollection,i=n.indexOf(e),o=n.indexOf(t),a=Math.min(i,o),s=Math.max(i,o);if(-1===a||-1===s)throw new Error("Record not found in selectRange");r.splice(0,r.count,n.getRange(a,s+1,!1))}},{key:"onStoreRemove",value:function(e){se()(oe()(t.prototype),"onStoreRemove",this)&&se()(oe()(t.prototype),"onStoreRemove",this).call(this,e),this.recordCollection.remove(e.records)}},{key:"onStoreDataChange",value:function(e){var n=e.action,r=e.source;if(se()(oe()(t.prototype),"onStoreDataChange",this)&&se()(oe()(t.prototype),"onStoreDataChange",this).apply(this,arguments),iu[n]){var i=this.recordCollection,o=[];i.forEach((function(e){r.includes(e)||o.push(e)})),i.remove(o)}}},{key:"onStoreRemoveAll",value:function(){se()(oe()(t.prototype),"onStoreRemoveAll",this)&&se()(oe()(t.prototype),"onStoreRemoveAll",this).call(this),this.deselectAll()}},{key:"handleMouseMultiSelect",value:function(e,t){var n=this,r=e.id;(t.metaKey||t.ctrlKey)&&n.isSelected(r)?n.deselectRow(r):n.selectionMode.multiSelect&&(t.shiftKey&&n.startCell?function(e,t){var r=n.store,i=n.recordCollection,o=r.indexOf(e),a=r.indexOf(t),s=Math.min(o,a),l=Math.max(o,a);if(-1===s||-1===l)throw new Error("Record not found in selectRange");var u=r.getRange(s,l+1,!1).filter((function(e){return n.isSelectable(e)}));i.splice(0,n.lastRange||0,u),n.lastRange=u}(n.startCell.id,r):(t.ctrlKey||t.metaKey)&&n.selectRow({record:r,scrollIntoView:!1,addToSelection:!0}))}},{key:"onCellNavigate",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(e.columns.getById(n.columnId)!==e.checkboxColumn&&!e.selectionMode.rowCheckboxSelection&&!(!i||e.returningFocus||r&&r.target.classList.contains("b-tree-expander"))){var o=t&&n.id===t.id,a=r&&"mousedown"===r.type,s=a&&r.ctrlKey;!r||r.button&&2!==r.button||!r.shiftKey&&!s?e.selectCell(n,!1,o&&(!r||r.shiftKey||r.ctrlKey)||r&&(s||2===r.button&&e.isSelected(n.id))):e.handleMouseMultiSelect(n,r),e.startCell&&!s||(e.startCell=n,e.lastRange=null)}}},{key:"triggerChangeEvent",value:function(e,t){var n,r,i,o,a=this,s=e.mode,l=e.selected,u=e.deselected;if("row"===s){for(n=0,r=l.length;n<r;n++)(i=a.getRowFor(l[n]))&&(i.addCls("b-selected"),a.checkboxColumn&&!l[n].meta.specialRow&&(i.getCell(a.checkboxColumn.id).widget.checked=!0));for(n=0,r=u.length;n<r;n++)(i=a.getRowFor(u[n]))&&(i.removeCls("b-selected"),a.checkboxColumn&&!u[n].meta.specialRow&&(i.getCell(a.checkboxColumn.id).widget.checked=!1))}else if("cell"===s){for(n=0,r=l.length;n<r;n++)(o=a.getCell(l[n]))&&o.classList.add("b-selected");for(n=0,r=u.length;n<r;n++)(o=a.getCell(u[n]))&&o.classList.remove("b-selected")}t||a.trigger("selectionChange",e)}},{key:"recordCollection",set:function(e){e instanceof Un||(e=new Un(e)),this._recordCollection=e,e.on({change:"onRecordCollectionChange",thisObj:this})},get:function(){return this._recordCollection}},{key:"selectedCell",get:function(){return this._selectedCell},set:function(e){this.selectCell(e)}},{key:"selectionMode",set:function(e){e&&e.rowCheckboxSelection&&(e.row=e.checkbox=!0,e.cell=!1),this._selectionMode=e},get:function(){return this._selectionMode}},{key:"selectedRecord",get:function(){return this.recordCollection.last||null},set:function(e){this.selectRow({record:e})}},{key:"selectedRecords",get:function(){return this.recordCollection.values},set:function(e){var t=this.recordCollection,n=this.store,r=[];if(e&&e.length){var i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;(u=n.getById(u))&&r.push(u)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}t.splice(0,t.count,r)}},{key:"selectedCellCSSSelector",get:function(){var e=this._selectedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.dataIndex,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{selectionMode:{row:!0,cell:!0,rowCheckboxSelection:!1,multiSelect:!0,checkbox:!1},recordCollection:{}}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getState",value:function(){var e=this,t=e.element.style.cssText,n={rowHeight:e.rowHeight,readOnly:e.readOnly};if(t&&(n.style=t),e.selectedCell){var r=e.selectedCell,i=r.id,o=r.columnId;n.selectedCell={id:i,columnId:o}}return n.selectedRecords=e.selectedRecords.map((function(e){return e.id})),n.columns=e.columns.map((function(e){return e.getState()})),n.store=e.store.state,n.scroll=e.storeScroll(),n.width={},n.collapsed={},e.eachSubGrid((function(e){null==e.flex&&(n.width[e.region]=e.width),n.collapsed[e.region]=e.collapsed})),n}},{key:"applyState",value:function(e){var t=this;if("readOnly"in e&&(t.readOnly=e.readOnly),"rowHeight"in e&&(t.rowHeight=e.rowHeight),"style"in e&&(t.style=e.style),"selectedCell"in e&&(t.selectedCell=e.selectedCell),"store"in e&&(t.store.state=e.store),"selectedRecords"in e&&(t.selectedRecords=e.selectedRecords),"columns"in e){var n=!1,r=!1;t.columns.suspendEvents(),t.eachSubGrid(ou),e.columns.forEach((function(e,i){var o=t.columns.getById(e.id);if(o){var a=o.generation;o.applyState(e),n=n||o.generation!==a,o.stateSortIndex=i,o.allIndex!==i&&(r=n=!0)}})),n&&t.eachSubGrid(su),r&&(t.eachSubGrid((function(e){e.columns.records.sort(lu),e.columns.allRecords.sort(lu)})),t.columns.sort({fn:lu},!0)),t.isPainted&&n&&t.renderContents(),t.columns.resumeEvents(),t.eachSubGrid(au)}"width"in e&&t.eachSubGrid((function(t){t.region in e.width&&(t.width=e.width[t.region])})),"collapsed"in e&&t.eachSubGrid((function(t){t.collapsed=e.collapsed[t.region]})),"scroll"in e&&t.restoreScroll(e.scroll)}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"initSubGrids",value:function(){var e,t,n,r=this,i=r._regions,o=new Set,a=!0,s=!0,l=!1,u=void 0;try{for(var c,d=r.columns.records[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h.region&&!r.subGridConfigs[h.region]&&(r.subGridConfigs[h.region]={}),o.add(h.region)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}i&&i.forEach((function(e){return r.subGrids[e].destroy()})),r.subGrids={},r._regions=Array.from(o),r._regions.sort(),r.subGridConfigs.normal&&0===Object.keys(r.subGridConfigs.normal).length&&(r.subGridConfigs.normal=Su.defaultConfig.subGridConfigs.normal);var f=!0,g=!1,v=void 0;try{for(var m,p=function(){var i=m.value;n=r.columns.makeChained((function(e){return e.region===i}),["region"]),t=kt.assign({parent:r,grid:r,store:r.store,rowManager:r.rowManager,region:i,headerClass:r.subGridConfigs[i].headerClass||r.headerClass,columns:n,hideHeaders:r.hideHeaders},r.subGridConfigs[i]),e=!1,t.flex||t.width||(t.width=n.totalFixedWidth,e=!0),r.subGrids[i]=new gu(t),r.subGrids[i].hasCalculatedWidth=e,a&&(r.subGrids[i].isFirstRegion=!0,a=!1)},y=r._regions[Symbol.iterator]();!(f=(m=y.next()).done);f=!0)p()}catch(e){g=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(g)throw v}}}},{key:"eachSubGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;n.regions.forEach((function(r,i){var o=n.subGrids[r];e.call(t||o,o,i++)}))}},{key:"eachWidget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;n.regions.forEach((function(r){var i=n.subGrids[r];!1!==e(i)&&t&&i.eachWidget&&i.eachWidget(e,t)}))}},{key:"callEachSubGrid",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=this,o=null;return i.regions.forEach((function(t,r){var a=i.subGrids[t];if(a[e]){var s=a[e].apply(a,n);0===r&&(o=s)}})),o}},{key:"getLastRegions",value:function(){var e=this.regions.slice(-2);return 2===e.length?e:[e[0],e[0]]}},{key:"getNextRegion",value:function(e){var t=this.regions;return t[t.indexOf(e)+1]||t[t.length-2]}},{key:"getPreviousRegion",value:function(e){return this.regions[this.regions.indexOf(e)-1]}},{key:"getSubGrid",value:function(e){return this.subGrids[e]}},{key:"getSubGridFromColumn",value:function(e){return e=e instanceof Rs?e:this.columns.get(e)||this.columns.getById(e),this.getSubGrid(e.region)}},{key:"resolveSplitter",value:function(e){var t=this.getLastRegions(),n=e instanceof gu?e.region:e;return t[1]===n&&(n=t[0]),this.subGrids[n].splitterElement}},{key:"items",get:function(){var e=this;return this.regions.map((function(t){return e.subGrids[t]}))}},{key:"regions",get:function(){return this._regions||this.initSubGrids(),this._regions}},{key:"widgetClass",get:function(){}}]),t}(e||z)})));Su.localeClass="Grid",Su._$name="GridBase",X.register("gridbase",Su);var Cu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"$name",get:function(){return"Grid"}}]),t}(Su);Cu._$name="Grid",X.register("grid",Cu),I.setVersion("grid","3.0.0");var Eu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"store",set:function(e){if(e&&!e.tree){if(e instanceof Fi)throw new Error("TreeGrid requires a Store configured with tree : true");e.tree=!0}fn()(oe()(t.prototype),"store",e,this,!0)},get:function(){return se()(oe()(t.prototype),"store",this)}}],[{key:"$name",get:function(){return"TreeGrid"}}]),t}(Cu);Eu._$name="TreeGrid",X.register("treegrid",Eu);var xu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),t}(Ve());xu._$name="SchedulerCommon";var Du=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"cancelRequest",value:function(e){e.abort()}},{key:"sendRequest",value:function(e){var n=this,r=e.data,i=n.transport[e.type]||{},o=i.paramName,a=Object.assign({},i.params),s=i.method||t.defaultMethod[e.type],l=Object.assign({url:i.url,method:s,params:a},i.requestConfig);o?(l.params=l.params||{},l.params[o]=r):l.jsonData=r,n.trigger("beforeSend",{params:a,type:e.type,requestConfig:l,config:e});var u=Object.assign({method:s,headers:l.headers,queryParams:a,body:"HEAD"===s||"GET"===s?void 0:l.jsonData},l.fetchOptions),c=Pe.fetch(l.url,u);return c.then((function(t){t.ok?e.success&&e.success.call(e.thisObj||n,t,u):e.failure&&e.failure.call(e.thisObj||n,t,u)})),c}}],[{key:"defaultMethod",get:function(){return{load:"GET",sync:"POST"}}}]),t}(e||z)},Tu=function(e,t,n){return e.store&&(e=e.store),t.store&&(t=t.store),(e=e[n]||0)<(t=t[n]||0)?-1:e>t?1:0},Ru=function(e,t){return Tu(e,t,"loadPriority")},Mu=function(e,t){return Tu(e,t,"syncPriority")},Fu=function(){},_u=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.stores&&(e.crudStores=e.stores,delete e.stores),se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"commit",value:function(){this.commitCrudStores()}},{key:"reject",value:function(){this.rejectCrudStores()}},{key:"addStore",value:function(){return this.addCrudStore.apply(this,arguments)}},{key:"removeStore",value:function(){return this.removeCrudStore.apply(this,arguments)}},{key:"getStore",value:function(){return this.getCrudStore.apply(this,arguments)}},{key:"hasChanges",value:function(){return this.crudStoreHasChanges.apply(this,arguments)}},{key:"loadData",value:function(){return this.loadCrudManagerData.apply(this,arguments)}},{key:"revision",get:function(){return this.crudRevision},set:function(e){this.crudRevision=e}},{key:"stores",set:function(e){e!==this.crudStores&&(this.crudStores=e)},get:function(){return this.crudStores}},{key:"isLoading",get:function(){return this.isCrudManagerLoading}}],[{key:"defaultConfig",get:function(){return Object.assign({},this.crudManagerDefaultConfig,{overrideCrudStoreLoad:!0,stores:null})}}]),t}(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i,o,a,s,l,u,c,d,h;return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._requestId=0,this.activeRequests={},this.crudStoresIndex={},this._crudManagerConfig=e,this.orderedCrudStores=[],se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"applyCrudManagerMixinConfig",value:function(e){var t=this.splitCrudManagerConfig(e);t.crudStores&&(this.crudStores=t.crudStores,delete t.crudStores),Object.assign(this,t)}},{key:"afterConfigure",value:function(){this.initialConfig||this.applyCrudManagerMixinConfig(this._crudManagerConfig)}},{key:"splitCrudManagerConfig",value:function(e){var t=Object.assign({},this.constructor.crudManagerDefaultConfig);for(var n in e)n in t&&(t[n]=e[n],delete e[n]);return t}},{key:"afterConstruct",value:function(){se()(oe()(t.prototype),"afterConstruct",this).call(this),this.autoLoad&&this.load().catch((function(e){}))}},{key:"getStoreDescriptor",value:function(e){return e?e instanceof Fi?this.crudStores.find((function(t){return t.store===e})):"object"===U()(e)?this.crudStoresIndex[e.storeId]:this.crudStoresIndex[e]||this.getStoreDescriptor(Fi.getStore(e)):null}},{key:"fillStoreDescriptor",value:function(e){var t=e.store,n=t.storeIdProperty,r=void 0===n?this.storeIdProperty:n,i=t.modelClass;return e.storeId||(e.storeId=t[r]),e.idField||(e.idField=i.idField),e.phantomIdField||(e.phantomIdField=i.phantomIdField),"writeAllFields"in e||(e.writeAllFields=t.writeAllFields),e}},{key:"updateCrudStoreIndex",value:function(){var e=this.crudStoresIndex={};this.crudStores.forEach((function(t){return t.storeId&&(e[t.storeId]=t)}))}},{key:"getCrudStore",value:function(e){var t=this.getStoreDescriptor(e);return t&&t.store}},{key:"forEachCrudStore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;e&&this.crudStores.every((function(n){return!1!==e.call(t,n.store,n.storeId,n)}))}},{key:"internalAddCrudStore",value:function(e){var t,n=this;return e instanceof Fi?t={store:e}:"object"===U()(e)?(e.stores&&(Array.isArray(e.stores)||(e.stores=[e.stores]),e.stores.forEach((function(t,n){var r=t;"string"==typeof t&&(r={storeId:t}),r.masterStoreInfo=e,e.stores[n]=r}))),t=e):t={store:Fi.getStore(e)},n.fillStoreDescriptor(t),(e=t.store).setCrudManager?e.setCrudManager(n):e.crudManager=n,e.pageSize=null,n.overrideCrudStoreLoad&&e.load&&(e.load=e.commit=function(){}),n.bindCrudStoreListeners(e),t}},{key:"addCrudStore",value:function(e,t,n){var r;if(e&&(Array.isArray(e)||(e=[e]),e.length)){var i=this,o=e.map(i.internalAddCrudStore,i);if(void 0===t){var a;(a=i.crudStores).push.apply(a,G()(o))}else{var s,l=t;n&&((n instanceof Fi||"object"!==U()(n))&&(n=i.getStoreDescriptor(n)),l+=i.crudStores.indexOf(n)),(s=i.crudStores).splice.apply(s,[l,0].concat(G()(o)))}(r=i.orderedCrudStores).push.apply(r,G()(o)),i.updateCrudStoreIndex()}}},{key:"addPrioritizedStore",value:function(e){this.hasCrudStore(e)||this.addCrudStore(e,He.findInsertionIndex(e,this.crudStores,Ru)),this.hasApplySequenceStore(e)||this.addStoreToApplySequence(e,He.findInsertionIndex(e,this.syncApplySequence,Mu))}},{key:"hasCrudStore",value:function(e){return this.crudStores.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"removeCrudStore",value:function(e){for(var t=this,n=t.crudStores,r=0,i=n.length;r<i;r++){var o=n[r];if(o===e||o.store===e||o.storeId===e){t.unbindCrudStoreListeners(o.store),delete t.crudStoresIndex[o.storeId],n.splice(r,1),t.syncApplySequence&&t.removeStoreFromApplySequence(e);break}}}},{key:"bindCrudStoreListeners",value:function(e,t){var n=this,r={update:n.onCrudStoreChange,removeall:n.onCrudStoreChange,detachable:!0,thisObj:n};Object.assign(r,{add:n.onCrudStoreChange,remove:n.onCrudStoreChange}),e.crudDetatcher=e.on(r)}},{key:"unbindCrudStoreListeners",value:function(e){e.crudDetatcher&&e.crudDetatcher()}},{key:"addStoreToApplySequence",value:function(e,t,n){if(e){Array.isArray(e)||(e=[e]);var r=this,i=e.reduce((function(e,t){var n=r.getStoreDescriptor(t);return n&&e.push(n),e}),[]);if(void 0===t){var o;(o=r.syncApplySequence).push.apply(o,G()(i))}else{var a,s=t;n&&((n instanceof Fi||"object"!==U()(n))&&(n=r.getStoreDescriptor(n)),s+=r.syncApplySequence.indexOf(n)),(a=r.syncApplySequence).splice.apply(a,[s,0].concat(G()(i)))}var l=r.syncApplySequence.map((function(e){return e.storeId}));r.orderedCrudStores=G()(r.syncApplySequence),r.crudStores.forEach((function(e){l.includes(e.storeId)||r.orderedCrudStores.push(e)}))}}},{key:"removeStoreFromApplySequence",value:function(e){var t=this.syncApplySequence.findIndex((function(t){return t===e||t.store===e||t.storeId===e}));t>-1&&(this.syncApplySequence.splice(t,1),this.orderedCrudStores.splice(t,1))}},{key:"hasApplySequenceStore",value:function(e){return this.syncApplySequence.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"onCrudStoreChange",value:function(){var e=this;e.crudIgnoreUpdates||(e.crudStoreHasChanges()?(e.trigger("hasChanges"),e.autoSync&&(e.autoSyncTimerId||(e.autoSyncTimerId=setTimeout((function(){e.autoSyncTimerId=null,e.sync()}),e.autoSyncTimeout)))):e.trigger("noChanges"))}},{key:"internalOnResponse",value:(h=Di()(Ei.a.mark((function e(t,n,r,i){var o,a;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this).activeRequests[t]=null,(a=n?o.decode(n):null)&&a.success){e.next=8;break}return o.trigger("requestFail",{requestType:t,response:a,responseText:n,responseOptions:r}),o.trigger(t+"Fail",{response:a,responseOptions:r,responseText:n,options:i}),o.warn("CrudManager: "+t+" failed, please inspect the server response"),e.abrupt("return",a);case 8:if(!1===o.trigger("beforeResponseApply",{requestType:t,response:a})||!1===o.trigger("before"+A.capitalizeFirstLetter(t)+"Apply",{response:a,options:i})){e.next=15;break}return o.crudRevision=a.revision,e.next=12,o.applyResponse(t,a,i);case 12:o.trigger("requestDone",{requestType:t,response:a,responseOptions:r}),o.trigger(t,{response:a,responseOptions:r,options:i}),"load"!==t&&o.crudStoreHasChanges()||o.trigger("noChanges");case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return h.apply(this,arguments)})},{key:"internalOnLoad",value:(d=Di()(Ei.a.mark((function e(t,n,r){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.crudLoaded=!0,e.abrupt("return",this.internalOnResponse("load",t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"internalOnSync",value:(c=Di()(Ei.a.mark((function e(t,n,r){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.internalOnResponse("sync",t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"suspendChangesTracking",value:function(){this.crudIgnoreUpdates++}},{key:"resumeChangesTracking",value:function(e){this.crudIgnoreUpdates&&!--this.crudIgnoreUpdates&&e&&this.onCrudStoreChange()}},{key:"crudStoreHasChanges",value:function(e){if(e){var t=this.getCrudStore(e);return t&&this.isCrudStoreDirty(t)}return this.crudStores.some(this.isCrudStoreDirty)}},{key:"isCrudStoreDirty",value:function(e){return null!=e.store.changes}},{key:"emitCrudStoreEvents",value:function(e,t){var n={action:"read"+t},r=!0,i=!1,o=void 0;try{for(var a,s=this.crudStores[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;e.includes(l.storeId)&&l.store.trigger(t,n)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"getLoadPackage",value:function(e){var t={type:"load",requestId:this.requestId},n=this.crudStores,r=Object.assign({},e);return t.stores=n.map((function(e){var t=r&&r[e.storeId],n=e.pageSize||e.store&&e.store.pageSize;if(t||n){var i=Object.assign({storeId:e.storeId,page:1,pageSize:n},t);return e.currentPage=i.page,t&&delete r[e.storeId],i}return e.storeId})),Object.assign(t,r),t}},{key:"loadCrudStore",value:function(e,t,n,r){var i=t&&t.rows;n&&n.append||t.append?e.add(i):e.data=i,e.trigger("load",{source:e,data:i})}},{key:"loadDataToCrudStore",value:function(e,t,n){var r,i=this,o=e.store,a=e.stores,s=e.idField||"id",l=o.tree,u=t&&t.rows;o.__loading=!0,u&&(a&&(r=i.getSubStoresData(u,a,s,l)),i.loadCrudStore(o,t,n,e),r&&r.forEach((function(e){i.loadDataToCrudStore(Object.assign({store:o.getById(e.id).get(e.storeDesc.storeId)},e.storeDesc),e.data)}))),o.__loading=!1}},{key:"loadCrudManagerData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.suspendChangesTracking(),this.crudStores.forEach((function(r){var i=r.storeId,o=e[i];o&&t.loadDataToCrudStore(r,o,n[i])})),this.resumeChangesTracking()}},{key:"load",value:function(e){var t=this,n=t.getLoadPackage(e);return new Promise((function(r,i){!1!==t.trigger("beforeLoad",{pack:n})?(t.activeRequests.load&&(t.cancelRequest(t.activeRequests.load.desc),t.trigger("loadCanceled",{pack:n})),t.emitCrudStoreEvents(n.stores,"loadStart"),t.activeRequests.load={options:e,pack:n,resolve:r,reject:i,id:n.requestId,desc:t.sendRequest({data:t.encode(n),type:"load",success:t.onLoadSuccess,failure:t.onLoadFailure,thisObj:t})}):(t.trigger("loadCanceled",{pack:n}),i({cancelled:!0}))}))}},{key:"onLoadSuccess",value:(u=Di()(Ei.a.mark((function e(t,n){var r,i,o,a;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",i=this.activeRequests.load,o=i.options,e.next=4,t.text().then((function(e){return r=e})).catch(Fu);case 4:return e.next=6,this.internalOnLoad(r,n,o);case 6:a=e.sent,this.emitCrudStoreEvents(i.pack.stores,"afterRequest"),a&&a.success?i.resolve({response:a,rawResponse:t,responseText:r,options:o}):i.reject({cancelled:!1,response:a,rawResponse:t,responseText:r,options:o});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"onLoadFailure",value:(l=Di()(Ei.a.mark((function e(t,n){var r,i,o,a;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",i=this.activeRequests.load,o=i.options,e.next=4,t.text().then((function(e){return r=e})).catch(Fu);case 4:return e.next=6,this.internalOnLoad(r,n,o);case 6:a=e.sent,this.emitCrudStoreEvents(i.pack.stores,"afterRequest"),i.reject({cancelled:!1,response:a,rawResponse:t,responseText:r,options:o});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"getSubStoresData",value:function(e,t,n,r){var i=this;if(e){var o=[];return r?e.forEach((function(e){a(e,t);var r=i.getSubStoresData(e.children,t,n,!0);r&&(o=o.concat(r))})):e.forEach((function(e){return a(e,t)})),o}function a(e,t){t.forEach((function(t){var r=t.storeId;e[r]&&(o.push({id:e[n],storeDesc:t,data:e[r]}),delete e[r])}))}}},{key:"prepareAdded",value:function(e,t,n){var r=this;return e.filter((function(e){return e.isValid})).map((function(e){var i=Object.assign(e.persistableData,$()({},t,e.id));return r.resetIdsBeforeSync&&delete i[e.constructor.idField],n&&r.processSubStores(e,i,n),i}))}},{key:"prepareUpdated",value:function(e,t,n){var r=this,i=n.writeAllFields||!1!==n.writeAllFields&&this.writeAllFields;if(n.store.tree){var o=n.store.rootNode;e=e.filter((function(e){return e!==o}))}return e.filter((function(e){return e.isValid})).reduce((function(e,n){var o;i?(o=n.persistableData)[n.constructor.idField]=n.id:(o=n.modifications)[n.constructor.idField]=n.id,t&&r.processSubStores(n,o,t);var a=Object.keys(o);return(a.length>1||a[0]!==n.constructor.idField)&&e.push(o),e}),[])}},{key:"prepareRemoved",value:function(e){return e.map((function(e){return $()({},e.constructor.idField,e.id)}))}},{key:"processSubStores",value:function(e,t,n){var r=this;n.forEach((function(n){var i=n.storeId,o=e.get(i);if(o){var a=r.getCrudStoreChanges(Object.assign({store:o},n));a?t[i]=Object.assign(a,{$store:!0}):delete t[i]}else delete t[i]}))}},{key:"getCrudStoreChanges",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.phantomIdField||this.phantomIdField,r=e.store,i=r.added.values,o=r.modified.values,a=r.removed.values,s=e.stores;return i.length&&(i=this.prepareAdded(i,n,s)),o.length&&(o=this.prepareUpdated(o,s,e)),a.length&&(a=this.prepareRemoved(a)),(i.length||o.length||a.length)&&(t={},i.length&&(t.added=i),o.length&&(t.updated=o),a.length&&(t.removed=a)),t}},{key:"getChangeSetPackage",value:function(){var e=this,t={type:"sync",requestId:this.requestId,revision:this.crudRevision},n=0;return this.crudStores.forEach((function(r){var i=e.getCrudStoreChanges(r);i&&(n++,t[r.storeId]=i)})),n?t:null}},{key:"applyChangesToRecord",value:function(e,t,n,r){var i,o=this,a=e.constructor,s=a.fieldDataSourceMap,l=a.prototype,u={},c=e.data,d=$()({},o.phantomIdField,!0);for(var h in n&&n.forEach((function(n){var r=n.storeId;if(t.hasOwnProperty(r)){d[r]=!0;var i=e.get(r);i?o.applyChangesToStore(Object.assign({store:i},n),t[r]):console.log("Can't find store for the response sub-package")}})),t)if(t.hasOwnProperty(h)&&!d[h]){var f=s[h],g=f?f.name:h,v=a.processField(g,t[h]),m=h in l?e[g]:kt.getPath(c,h);kt.isEqual(m,v)||(i=!0,u[g]=v)}if(i){for(var p in o.suspendChangesTracking(),u)e[p]=u[p];o.resumeChangesTracking()}e.clearChanges(!0,!1)}},{key:"applyRemovals",value:function(e,t,n){var r=this,i=e.removed,o=n.findByIdFn,a=n.removeRecordFn,s=0;return t.forEach((function(e){var t=!1,n=e.id;if(i.includes(e)&&(i.remove(e),t=!0,s++),!t){var l=o(n);l?(r.suspendChangesTracking(),a(l),i.remove(l),s++,r.resumeChangesTracking()):console.log("Can't find record to remove from the response package")}})),s}},{key:"getApplyChangesToStoreHelpers",value:function(e){return e.tree?{findByPhantomFn:function(t){return e.getById(t)},findByIdFn:function(t){return e.getById(t)},addRecordFn:function(t){return(t.parentId&&e.getById(t.parentId)||e.rootNode).appendChild(t)},removeRecordFn:function(e){return e.remove()}}:{findByPhantomFn:function(t){return e.getById(t)},findByIdFn:function(t){return e.getById(t)},addRecordFn:function(t){return e.add(t)[0]},removeRecordFn:function(t){return e.remove(t)}}}},{key:"applyChangesToStore",value:(s=Di()(Ei.a.mark((function e(t,n){var r,i,o,a,s,l,u,c,d,h,f,g;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this,i=t.phantomIdField||r.phantomIdField,o=t.idField||"id",a=t.store,s=r.getApplyChangesToStoreHelpers(a),l=s.findByPhantomFn,u=s.findByIdFn,c=s.addRecordFn,d=s.removeRecordFn,h=n.rows,f=n.removed,h&&(g=t.stores,h.forEach((function(e){var t=e[i],n=e[o],s=null;null!=t&&null!=t?s=l(t):o&&(s=u(n)),s?r.applyChangesToRecord(s,e,g,a):(r.suspendChangesTracking(),s=c(e),r.resumeChangesTracking(),s.clearChanges())}))),f&&r.applyRemovals(a,f,{idField:o,findByIdFn:u,removeRecordFn:d})&&a.trigger("dataChanged",{source:a});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"applySyncResponse",value:(a=Di()(Ei.a.mark((function e(t){var n,r;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this).orderedCrudStores,n.applyingSyncResponse=!0,r.forEach(function(){var e=Di()(Ei.a.mark((function e(r){var i;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=t[r.storeId])){e.next=4;break}return e.next=4,n.applyChangesToStore(r,i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.applyingSyncResponse=!1;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"applyLoadResponse",value:(o=Di()(Ei.a.mark((function e(t,n){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.applyingLoadResponse=!0,this.loadCrudManagerData(t,n),this.applyingLoadResponse=!1;case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"applyResponse",value:(i=Di()(Ei.a.mark((function e(t,n,r){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.trackResponseType&&(t=n.type||t),e.t0=t,e.next="load"===e.t0?4:"sync"===e.t0?7:10;break;case 4:return e.next=6,this.applyLoadResponse(n,r);case 6:return e.abrupt("break",10);case 7:return e.next=9,this.applySyncResponse(n);case 9:return e.abrupt("break",10);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"sync",value:function(){var e=this;return e.activeRequests.sync?(e.trigger("syncDelayed"),e.activeSyncPromise=e.activeSyncPromise.then((function(){return e.sync()}),(function(){return e.sync()}))):e.activeSyncPromise=new Promise((function(t,n){var r=e.getChangeSetPackage();r?!1!==e.trigger("beforeSync",{pack:r})?e.activeRequests.sync={pack:r,resolve:t,reject:n,id:r.requestId,desc:e.sendRequest({data:e.encode(r),type:"sync",success:e.onSyncSuccess,failure:e.onSyncFailure,thisObj:e})}:(e.trigger("syncCanceled",{pack:r}),n({cancelled:!0})):t(null)}))}},{key:"onSyncSuccess",value:(r=Di()(Ei.a.mark((function e(t,n){var r,i,o;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.next=3,t.text().then((function(e){return r=e})).catch(Fu);case 3:return i=this.activeRequests.sync,e.next=6,this.internalOnSync(r,n);case 6:(o=e.sent)&&o.success?i.resolve({response:o,rawResponse:t,responseText:r,request:i}):i.reject({cancelled:!1,response:o,rawResponse:t,responseText:r,request:i});case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"onSyncFailure",value:(n=Di()(Ei.a.mark((function e(t,n){var r,i,o;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.next=3,t.text().then((function(e){return r=e})).catch(Fu);case 3:return i=this.activeRequests.sync,e.next=6,this.internalOnSync(r,n);case 6:o=e.sent,i.reject({cancelled:!1,response:o,rawResponse:t,responseText:r,request:i});case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"commitCrudStores",value:function(){this.crudStores.forEach((function(e){return e.store.commit()}))}},{key:"rejectCrudStores",value:function(){this.orderedCrudStores.forEach((function(e){return e.store.clearChanges()}))}},{key:"warn",value:function(){if("console"in window){var e=console;e.log&&e.log.apply&&e.log.apply(e,arguments)}}},{key:"doDestroy",value:function(){var e=this;for(e.activeRequests.load&&e.cancelRequest(e.activeRequests.load.desc),e.activeRequests.sync&&e.cancelRequest(e.activeRequests.sync.desc);e.crudStores.length>0;)e.removeCrudStore(e.crudStores[0]);clearTimeout(e.autoSyncTimerId),e.destroyed=!0,se()(oe()(t.prototype),"doDestroy",this)&&se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"crudStores",set:function(e){this._crudStores=[],this.addCrudStore(e);var t=!0,n=!1,r=void 0;try{for(var i,o=this._crudStores[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.loadPriority=a.syncPriority=0}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},get:function(){return this._crudStores}},{key:"orderedCrudStores",get:function(){return this._orderedCrudStores},set:function(e){return this._orderedCrudStores=e}},{key:"syncApplySequence",set:function(e){this._syncApplySequence=[],this.addStoreToApplySequence(e)},get:function(){return this._syncApplySequence}},{key:"isCrudManagerLoading",get:function(){return Boolean(this.activeRequests.load||this.applyingLoadResponse)}},{key:"requestId",get:function(){return Date.now()+""+this._requestId++}}],[{key:"crudManagerDefaultConfig",get:function(){return{crudRevision:null,crudStores:[],storeIdProperty:"storeId",crudFilterParam:"filter",transport:{},trackResponseType:!1,phantomIdField:"$PhantomId",autoLoad:!1,autoSyncTimeout:100,autoSync:!1,resetIdsBeforeSync:!0,syncApplySequence:[],orderedCrudStores:[],writeAllFields:!1,crudIgnoreUpdates:0,crudLoaded:!1,createMissingRecords:!1,autoSyncTimerId:null,applyingLoadResponse:!1,applyingSyncResponse:!1,callOnFunctions:!0}}}]),t}(e)}(ze(z)));_u._$name="AbstractCrudManager";var Au=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"encode",value:function(e){return A.safeJsonStringify(e)}},{key:"decode",value:function(e){return A.safeJsonParse(e)}}]),t}(e||z)},Iu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getResource",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.resourceStore;return e&&e.getById(this.resourceId)}},{key:"fullCopy",value:function(){throw new Error("Not implemented")}},{key:"assignmentStore",get:function(){return this.stores&&this.stores[0]}},{key:"eventStore",get:function(){var e=this.assignmentStore;return e&&e.eventStore}},{key:"resourceStore",get:function(){var e=this.eventStore;return e&&e.resourceStore}},{key:"eventName",get:function(){return this.event&&this.event.name}},{key:"resourceName",get:function(){return this.resource&&this.resource.name}},{key:"isAssignment",get:function(){return!0}},{key:"isPersistable",get:function(){var e=this.event,t=this.resource,n=this.stores,r=this.unjoinedStores,i=n[0]&&n[0].crudManager;return n[0]?this.isValid&&(i||!e.hasGeneratedId&&!t.hasGeneratedId):Boolean(r[0])}},{key:"isValid",get:function(){return null!=this.resource&&null!=this.event}},{key:"eventResourceCompositeKey",get:function(){return t.makeAssignmentEventResourceCompositeKey(this.eventId,this.resourceId)}}],[{key:"makeAssignmentEventResourceCompositeKey",value:function(e,t){return"event(".concat(e,")-resource(").concat(t,")")}},{key:"fields",get:function(){return[{name:"resourceId"},{name:"eventId"}]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"assignments"},{relationName:"event",fieldName:"eventId",store:"eventStore",collectionName:"assignments"}]}}]),t}(mi);Iu.exposeProperties(),Iu._$name="AssignmentModel";var Lu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.eventStoreDetacher&&this.eventStoreDetacher(),this.resourceStoreDetacher&&this.resourceStoreDetacher(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"attachToEventStore",value:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),e&&(t.eventStoreDetacher=e.on({remove:t.onEventRemove,resourcestorechange:t.onEventStoreResourceStoreChange,thisObj:t,prio:200})),t.isConfiguring||t.initRelations(!0),t.attachToResourceStore(e&&e.resourceStore)}},{key:"attachToResourceStore",value:function(e){var t=this;t.resourceStore=e,t.resourceStoreDetacher&&t.resourceStoreDetacher(),e&&(t.resourceStoreDetacher=e.on({remove:t.onResourceRemove,removeAll:t.onResourceRemoveAll,thisObj:t,prio:200}),t.isConfiguring||t.initRelations(!0))}},{key:"onEventStoreResourceStoreChange",value:function(e){var t=e.newResourceStore;this.attachToResourceStore(t)}},{key:"onEventRemove",value:function(e){var t=e.records,n=e.isMove,r=e.isCollapse;if(!n&&!r){var i=[];t.forEach((function(e){e.traverse((function(e){i.push.apply(i,G()(e.assignments))}))})),this.isRemovingEvent=!0,i.length&&this.remove(i),this.isRemovingEvent=!1}}},{key:"onResourceRemove",value:function(e){var t=e.records,n=e.isMove,r=e.isCollapse;if(!n&&!r){var i=[];t.forEach((function(e){e.traverse((function(e){i.push.apply(i,G()(e.assignments))}))})),i.length&&this.remove(i)}}},{key:"onResourceRemoveAll",value:function(){this.removeAll()}},{key:"mapAssignmentsForEvent",value:function(e,t,n){var r=Boolean(t),i=Boolean(n),o=mi.asId(e),a=this.relationCache.event&&this.relationCache.event[o];return a?(t=t||function(e){return e},n=n||function(){return!0},r||i?a.reduce((function(e,r){var i=t(r);return n(i)&&e.push(i),e}),[]):a):[]}},{key:"mapAssignmentsForResource",value:function(e,t,n){var r=Boolean(t),i=Boolean(n),o=mi.asId(e),a=this.relationCache.resource&&this.relationCache.resource[o];return a?(t=t||function(e){return e},n=n||function(){return!0},r||i?a.reduce((function(e,r){var i=t(r);return n(i)&&e.push(i),e}),[]):a):[]}},{key:"getAssignmentsForEvent",value:function(e){return e.assignments}},{key:"removeAssignmentsForEvent",value:function(e){return this.remove(e.assignments)}},{key:"getAssignmentsForResource",value:function(e){return this.mapAssignmentsForResource(e)}},{key:"removeAssignmentsForResource",value:function(e){this.remove(this.getAssignmentsForResource(e))}},{key:"getResourcesForEvent",value:function(e){return this.mapAssignmentsForEvent(e,(function(e){return e.resource}),(function(e){return Boolean(e)}))}},{key:"getEventsForResource",value:function(e){return this.mapAssignmentsForResource(e,(function(e){return e.event}),(function(e){return!!e}))}},{key:"assignEventToResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=Array.isArray(t)?t:[t],a=[];return i.beginBatch(),r&&i.removeAssignmentsForEvent(e),o.forEach((function(t){if(!i.isEventAssignedToResource(e,t)){var r=new i.modelClass({eventId:mi.asId(e),resourceId:mi.asId(t)});r=n(r),a.push(r)}})),a=i.add(a),i.endBatch(),a}},{key:"unassignEventFromResource",value:function(e,t){if(!t)return this.removeAssignmentsForEvent(e);if(this.isEventAssignedToResource(e,t)){var n=this.getAssignmentForEventAndResource(e,t);return this.remove(n),n}return null}},{key:"isEventAssignedToResource",value:function(e,t){var n=this.getResourcesForEvent(e),r=mi.asId(t);return n.some((function(e){return e.id==r}))}},{key:"getAssignmentForEventAndResource",value:function(e,t){return e=this.eventStore.getById(e),t=this.resourceStore.getById(t),this.records.find((function(n){return n.event==e&&n.resource==t}))}},{key:"eventStore",get:function(){return this._eventStore},set:function(e){var t=this,n=t._eventStore;t._eventStore=e||null,t.attachToEventStore(t._eventStore),(n||e)&&n!==e&&t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:n})}}],[{key:"defaultConfig",get:function(){return{loadPriority:300,syncPriority:300,modelClass:Iu}}}]),t}(Ii);Lu._$name="AssignmentStore";var Ou=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"clearDate",value:function(){this.set("date",null)}},{key:"getAvailability",value:function(e){var t=this;if(e)return t.get("availability");if(t.availabilityCache)return t.availabilityCache;var n=t.get("availability").map((function(e){return"string"==typeof e?t.parseInterval(e):e}));return t.verifyAvailability(n),t.availabilityCache=n}},{key:"verifyAvailability",value:function(e){var t=this;e.sort((function(e,t){return e.startTime-t.startTime})),e.forEach((function(n,r){if(n.startTime>n.endTime)throw new Error("Start time ".concat(vt.format(n.startTime,"HH:mm")," is greater than end time ").concat(vt.format(n.endTime,"HH:mm")));if(r>0&&e[r-1].endTime>n.startTime)throw new Error("Availability intervals should not intersect: [".concat(t.stringifyInterval(e[r-1]),"] and [").concat(t.stringifyInterval(n),"]"))}))}},{key:"stringifyInterval",value:function(e){var t=e.startTime,n=e.endTime;return vt.format(t,"HH:mm")+"-"+vt.format(n,"HH:mm")}},{key:"stringifyIntervals",value:function(e){var t=this;return e.map((function(e){return"string"==typeof e?e:t.stringifyInterval(e)}))}},{key:"parseInterval",value:function(e){var t=/(\d\d):(\d\d)-(\d\d):(\d\d)/.exec(e);if(!t)throw new Error("Invalid format for availability string: ".concat(String,". It should have exact format: hh:mm-hh:mm"));return{startTime:new Date(0,0,0,t[1],t[2]),endTime:new Date(0,0,0,t[3],t[4])}}},{key:"addAvailabilityInterval",value:function(e,t){var n;n=e instanceof Date?{startTime:e,endTime:t}:this.parseInterval(e+(t?"-"+t:""));var r=this.getAvailability().concat(n);this.verifyAvailability(r),this.setAvailability(r)}},{key:"removeAvailabilityInterval",value:function(e){var t=this.getAvailability();t.splice(e,1),this.setAvailability(t)}},{key:"getAvailabilityIntervalsFor",value:function(e){var t=(e="number"==typeof e?new Date(e):e).getFullYear(),n=e.getMonth(),r=e.getDate();return this.getAvailability().map((function(e){var i=e.endTime.getDate();return{startDate:new Date(t,n,r,e.startTime.getHours(),e.startTime.getMinutes()),endDate:new Date(t,n,r+(1==i?1:0),e.endTime.getHours(),e.endTime.getMinutes())}}))}},{key:"getAvailabilityStartFor",value:function(e){var t=this.getAvailabilityIntervalsFor(e);return t.length?t[0].startDate:null}},{key:"getAvailabilityEndFor",value:function(e){var t=this.getAvailabilityIntervalsFor(e);return t.length?t[t.length-1].endDate:null}},{key:"date",set:function(e){e&&(e=vt.startOf(e,"day")),this.set("date",e)},get:function(){return this.get("date")}},{key:"availability",get:function(){return this.get("availability")},set:function(e){this.availabilityCache=null,this.set("availability",this.stringifyIntervals(e)),this.getAvailability()}},{key:"totalHours",get:function(){return this.getTotalMS()/1e3/60/60}},{key:"totalMS",get:function(){return this.getAvailability().reduce((function(e,t){return e+(t.endTime-t.startTime)}),0)}}],[{key:"fields",get:function(){return[{name:"date",type:"date",format:"YYYY-MM-DD",persist:!0},{name:"weekday",type:"int"},{name:"overrideStartDate",type:"date",dateFormat:"YYYY-MM-DD"},{name:"overrideEndDate",type:"date",dateFormat:"YYYY-MM-DD"},{name:"type",defaultValue:"DAY"},{name:"isWorkingDay",type:"boolean",defaultValue:!1},{name:"cls"},{name:"name"},{name:"availability",persist:!0}]}}]),t}(mi);Ou._$name="CalendarDayModel";var Pu=function(){function e(t){C()(this,e),Object.assign(this,t)}return x()(e,[{key:"toString",value:function(){return"number"!=typeof this.magnitude?"":this.magnitude+" "+vt.getLocalizedNameOfUnit(this.unit,1!==this.magnitude)}}]),e}();Pu._$name="Duration";var Hu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"afterConstruct",value:function(){se()(oe()(t.prototype),"afterConstruct",this).call(this),this.normalize()}},{key:"normalize",value:function(){var e=this,t=e.startDate,n=e.endDate,r=e.duration,i=e.durationUnit,o=null!=r;t&&n&&!o?e.setData("duration",vt.diff(t,n,i,!0)):t&&!n&&o?e.setData("endDate",vt.add(t,r,i)):!t&&n&&o&&e.setData("startDate",vt.add(n,-r,i)),this.clearCachedValues()}},{key:"setDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit,n={duration:e=parseFloat(e),durationUnit:t};this.startDate?n.endDate=vt.add(this.startDate,e,t):this.endDate&&(n.startDate=vt.add(this.endDate,-e,t)),this.set(n)}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r={startDate:e};if(e){var i;if(t)i=null!=n.duration;else if(n.endDate){if(r.duration=vt.diff(e,n.endDate,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.endDate=vt.add(e,n.duration,n.durationUnit))}else r.duration=null;n.set(r)}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r={endDate:e};if(e){var i;if(!0===t)i=null!=n.duration;else if(n.startDate){if(r.duration=vt.diff(n.startDate,e,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.startDate=vt.add(e,-n.duration,n.durationUnit))}n.set(r)}},{key:"setStartEndDate",value:function(e,t){this.set({startDate:e,endDate:t})}},{key:"clearCachedValues",value:function(){this._startDateMS=null,this._endDateMS=null,this._isMilestone=null}},{key:"inSetNormalize",value:function(e){if("string"!=typeof e)return"duration"in(e=Object.assign({},e))?(e.startDate&&!e.endDate&&(e.endDate=vt.add(e.startDate,e.duration,e.durationUnit||this.durationUnit,!0,!0)),!e.startDate&&e.endDate&&(e.startDate=vt.add(e.endDate,-e.duration,e.durationUnit||this.durationUnit,!0,!0))):e.startDate&&e.endDate&&(e.duration=vt.diff(e.startDate,e.endDate,e.durationUnit||this.durationUnit,!0)),e}},{key:"inSet",value:function(e,n,r,i){return this.clearCachedValues(),e=this.inSetNormalize(e)||e,se()(oe()(t.prototype),"inSet",this).call(this,e,n,r,i)}},{key:"forEachDate",value:function(e,t){return this.dates.forEach(e.bind(t))}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit;if("string"==typeof e){var n=e;e=t,t=n}this.setStartDate(vt.add(this.startDate,e,t,!0),!0)}},{key:"fullCopy",value:function(){return this.copy.apply(this,arguments)}},{key:"intersects",value:function(e){return this.intersectsRange(e.startDate,e.endDate)}},{key:"intersectsRange",value:function(e,t){var n=this.startDate,r=this.endDate;return n&&r&&vt.intersectSpans(n,r,e,t)}},{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=this,n=this.copy(),r=t.firstStore,i=r&&r.assignmentStore,o=t.duration*e,a=t.duration-o;if(e<=0||e>=1)throw new Error("Split point must be > 0 and < 1");return t.duration=o,n.startDate=t.endDate,n.duration=a,r&&r.add(n),i&&i.add(t.assignments.map((function(e){var t=Object.assign({},e.data,{eventId:n.id});return delete t.id,t}))),n}},{key:"cls",get:function(){return this._cls||(this._cls=new bt(se()(oe()(t.prototype),"get",this).call(this,"cls"))),this._cls},set:function(e){var t=this;t._cls?t._cls.value=e:t._cls=new bt(e),t.set("cls",t._cls.value)}},{key:"startDate",get:function(){return this.get("startDate")},set:function(e){this.setStartDate(e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){this.setEndDate(e)}},{key:"duration",get:function(){return this.get("duration")},set:function(e){this.setDuration(e,this.durationUnit)}},{key:"durationUnit",get:function(){return this.get("durationUnit")}},{key:"fullDuration",get:function(){return new Pu({unit:this.durationUnit,magnitude:this.duration})},set:function(e){"string"==typeof e&&(e=vt.parseDuration(e,!0,this.durationUnit)),this.setDuration(e.magnitude,e.unit)}},{key:"dates",get:function(){for(var e=[],t=vt.startOf(this.startDate,"day"),n=this.endDate,r=t;r<n;r=vt.add(r,1,"day"))e.push(r);return e}},{key:"durationMS",get:function(){return this.endDate&&this.startDate?this.endDateMS-this.startDateMS:vt.asMilliseconds(this.duration||0,this.durationUnit)}},{key:"endDateMS",get:function(){var e=this;return null==e._endDateMS&&(e._endDateMS=e.endDate&&e.endDate.getTime()),e._endDateMS}},{key:"startDateMS",get:function(){var e=this;return null==e._startDateMS&&(e._startDateMS=e.startDate&&e.startDate.getTime()),e._startDateMS}},{key:"isMilestone",get:function(){var e=this;return null==e._isMilestone&&(e._isMilestone=e.endDateMS===e.startDateMS),e._isMilestone}},{key:"isScheduled",get:function(){return Boolean(this.startDate&&this.endDate&&this.hasValidDates)}},{key:"isValid",get:function(){var e=!0;if(e){var t=this.startDate,n=this.endDate;e=!t||!n||n-t>=0}return e}},{key:"hasValidDates",get:function(){var e=this.startDateMS,t=this.endDateMS;return!e||!t||t-e>=0}},{key:"wbsCode",get:function(){return this.indexPath.join(".")}}],[{key:"fields",get:function(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number",allowNull:!0},{name:"durationUnit",type:"string",defaultValue:"d"},{name:"fullDuration"},{name:"cls",defaultValue:""},{name:"style",type:"object"},{name:"name",type:"string"}]}}]),t}(mi);Hu._$name="TimeSpan";var Nu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.unitsInMs={MILLI:1,SECOND:1e3,MINUTE:6e4,HOUR:36e5,DAY:60*n.hoursPerDay*60*1e3,WEEK:n.daysPerWeek*n.hoursPerDay*60*60*1e3,MONTH:n.daysPerMonth*n.hoursPerDay*60*60*1e3,QUARTER:3*n.daysPerMonth*24*60*60*1e3,YEAR:12*n.daysPerMonth*24*60*60*1e3},n.defaultWeekAvailability=n.getDefaultWeekAvailability(),n.on({change:n.clearCache,thisObj:n}),n.clearCache()}},{key:"getDefaultWeekAvailability",value:function(){for(var e=this.defaultAvailability,t=this.weekendFirstDay,n=this.weekendSecondDay,r=[],i=0;i<7;i++)r.push(this.weekendsAreWorkdays||i!=t&&i!=n?new this.modelClass({type:"WEEKDAY",weekday:i,availability:e&&e.slice()||[],isWorkingDay:!0}):new this.modelClass({type:"WEEKDAY",weekday:i,availability:[]}));return r}},{key:"removeAll",value:function(){t.allCalendars.forEach((function(e){e.storeId=null,e.destroy()}))}},{key:"intersectsWithCurrentWeeks",value:function(e,t){var n=!1;return this.forEachNonStandardWeek((function(r){var i=r.startDate,o=r.endDate;if(i<=e&&e<o||i<t&&t<=o)return n=!0,!1})),n}},{key:"clearCache",value:function(){var e=this;if(!(e.suspendCacheUpdate>0)){e.holidaysCache={},e.availabilityIntervalsCache={};var t=e.daysIndex={},n=e.weekAvailability=[],r=e.nonStandardWeeksStartDates=[],i=e.nonStandardWeeksByStartDate={};e.forEach((function(e){var o,a,s=e.id,l=/^(\d)-(\d\d\d\d\/\d\d\/\d\d)-(\d\d\d\d\/\d\d\/\d\d)$/.exec(s),u=/^WEEKDAY:(\d+)$/.exec(s),c=e.type,d=e.weekday;if("WEEKDAYOVERRIDE"==c||l){if("WEEKDAYOVERRIDE"==c&&(o=e.overrideStartDate,a=e.overrideEndDate),l&&(o=vt.parse(l[2],"YYYY/MM/DD"),a=vt.parse(l[3],"YYYY/MM/DD"),d=l[1]),o&&a&&null!=d){var h=o-0;i[h]||(i[h]={startDate:new Date(o),endDate:new Date(a),name:e.getName(),weekAvailability:[],mainDay:null},r.push(h)),d>=0?i[h].weekAvailability[d]=e:i[h].mainDay=e}}else if("WEEKDAY"==c||u){if(u&&(d=u[1]),null!=d){if(d<0||d>6)throw new Error("Incorrect week day index");n[d]=e}}else{var f=e.date;f&&(t[f-0]=e)}})),r.sort((function(e,t){return e-t})),e.trigger("calendarChange")}}},{key:"addNonStandardWeek",value:function(e,t,n,r){if(e=vt.clearTime(e),t=vt.clearTime(t),this.intersectsWithCurrentWeeks(e,t))throw new Error("Can not add intersecting week");var i=this.modelClass,o=[];n.forEach((function(n,a){if(n instanceof Ou)n.type="WEEKDAYOVERRIDE",n.overrideStartDate=e,n.overrideEndDate=t,n.weekday=a,n.name=r||"Week override",o.push(n);else if(Array.isArray(n)){var s=new i;s.type="WEEKDAYOVERRIDE",s.overrideStartDate=e,s.overrideEndDate=t,s.weekday=a,s.name=r||"Week override",s.setAvailability(n),o.push(s)}}));var a=new i;a.type="WEEKDAYOVERRIDE",a.overrideStartDate=e,a.overrideEndDate=t,a.weekday=-1,a.name=r||"Week override",o.push(a),this.add(o)}},{key:"getNonStandardWeekByStartDate",value:function(e){return this.nonStandardWeeksByStartDate[vt.clearTime(e)-0]||null}},{key:"removeNonStandardWeek",value:function(e){e=vt.clearTime(e)-0;var t=this.getNonStandardWeekByStartDate(e);t&&this.remove(He.clean(t.weekAvailability).concat(t.mainDay))}},{key:"getNonStandardWeekByDate",value:function(e){e=vt.clearTime(e)-0;for(var t=this.nonStandardWeeksStartDates,n=this.nonStandardWeeksByStartDate,r=0;r<t.length;r++){var i=n[t[r]];if(i.startDate>e)break;if(i.startDate<=e&&e<=i.endDate)return i}return null}},{key:"setWeekendsAreWorkDays",value:function(e){var t=this;e!==t.weekendsAreWorkdays&&(t.weekendsAreWorkdays=e,t.defaultWeekAvailability=t.getDefaultWeekAvailability(),t.clearCache())}},{key:"areWeekendsWorkDays",value:function(){return this.weekendsAreWorkdays}},{key:"forEachNonStandardWeek",value:function(e,t){for(var n=this.nonStandardWeeksStartDates,r=this.nonStandardWeeksByStartDate,i=0;i<n.length;i++)if(!1===e.call(t||this,r[n[i]]))return!1}},{key:"getCalendarDay",value:function(e){return e="number"==typeof e?new Date(e):e,this.getOverrideDay(e)||this.getWeekDay(e.getDay(),e)||this.getDefaultCalendarDay(e.getDay())}},{key:"getOverrideDay",value:function(e){return this.getOwnCalendarDay(e)||this.parent&&this.parent.getOverrideDay(e)||null}},{key:"getOwnCalendarDay",value:function(e){return e="number"==typeof e?new Date(e):e,this.daysIndex[vt.clearTime(e)-0]}},{key:"getWeekDay",value:function(e,t){if(t){var n=this.getNonStandardWeekByDate(t);if(n&&n.weekAvailability[e])return n.weekAvailability[e]}return this.weekAvailability[e]||this.parent&&this.parent.getWeekDay(e,t)||null}},{key:"isHoliday",value:function(e){var t=e-0,n=this.holidaysCache;if(null!=n[t])return n[t];e="number"==typeof e?new Date(e):e;var r=this.getCalendarDay(e);if(!r)throw new Error("Can't find day for "+e);return n[t]=!r.isWorkingDay}},{key:"getDefaultCalendarDay",value:function(e){return this.hasOwnProperty("defaultAvailability")||this.hasOwnProperty("weekendsAreWorkdays")||!this.parent?this.defaultWeekAvailability[e]:this.parent.getDefaultCalendarDay(e)}},{key:"isWorkingDay",value:function(e){return!this.isHoliday(e)}},{key:"isWeekend",value:function(e){var t=e.getDay();return t===this.weekendFirstDay||t===this.weekendSecondDay}},{key:"convertMSDurationToUnit",value:function(e,t){return e/this.unitsInMs[vt.getUnitByName(t)]}},{key:"convertDurationToMs",value:function(e,t){return e*this.unitsInMs[vt.getUnitByName(t)]}},{key:"forEachAvailabilityInterval",value:function(e,t,n){n=n||this;var r=e.startDate,i=e.endDate,o=!1!==e.isForward;if(o?!r:!i)throw new Error("At least `startDate` or `endDate` is required, depending from the `isForward` option");var a=new Date(o?r:i),s=vt;o?i||(i=s.add(r,e.availabilitySearchLimit||this.availabilitySearchLimit||1825,"day")):r||(r=s.add(i,-(e.availabilitySearchLimit||this.availabilitySearchLimit||1825),"day"));for(var l=!1;o?a<i:a>r;){for(var u=this.getAvailabilityIntervalsFor(a-(o?0:1),!!o&&l),c=o?0:u.length-1;o?c<u.length:c>=0;o?c++:c--){var d=u[c],h=d.startDate,f=d.endDate;if(!(h>=i||f<=r)){var g=h<r?r:h,v=f>i?i:f;if(!1===t.call(n,g,v))return!1}}a=o?s.getStartOfNextDay(a,!1,l):s.getEndOfPreviousDay(a,l),l=!0}}},{key:"calculateDuration",value:function(e,t,n){var r=0;return this.forEachAvailabilityInterval({startDate:e,endDate:t},(function(e,t){var n=e.getTimezoneOffset()-t.getTimezoneOffset();r+=t-e+60*n*1e3})),this.convertMSDurationToUnit(r,n)}},{key:"getHolidaysRanges",value:function(e,t,n){if(e>t)throw new Error("startDate can't be bigger than endDate");e=vt.clearTime(e),t=vt.clearTime(t);var r,i,o=[];for(i=e;i<t;i=vt.getNext(i,"day",1))if(this.isHoliday(i)||this.weekendsAreWorkdays&&n&&this.isWeekend(i)){var a=this.getCalendarDay(i),s=a&&a.cls||this.defaultNonWorkingTimeCssCls,l=vt.getNext(i,"day",1);r?r.cls.isEqual(s)?r.endDate=l:(o.push(r),r=new Hu({startDate:i,endDate:l,cls:s})):r=new Hu({startDate:i,endDate:l,cls:s})}else r&&(o.push(r),r=null);return r&&o.push(r),o}},{key:"calculateEndDate",value:function(e,t,n){if(!t)return new Date(e);var r,i=vt,o=0===(t=this.convertDurationToMs(t,n))&&i.clearTime(e,!0)-e==0?i.add(e,-1,"day"):e;return this.forEachAvailabilityInterval({startDate:o},(function(e,n){var i=n-e,o=e.getTimezoneOffset()-n.getTimezoneOffset();if(i>=t)return r=new Date(e-0+t),!1;t-=i+60*o*1e3})),r}},{key:"skipNonWorkingTime",value:function(e,t){var n=!1;if(this.forEachAvailabilityInterval(t?{startDate:e}:{endDate:e,isForward:!1},(function(r,i){return e=t?r:i,n=!0,!1})),!n)throw new Error("skipNonWorkingTime: Cannot skip non-working time, please ensure that this calendar has any working period of time specified");return new Date(e)}},{key:"calculateStartDate",value:function(e,t,n){return t?(t=this.convertDurationToMs(t,n),this.forEachAvailabilityInterval({endDate:e,isForward:!1},(function(e,n){var i=n-e;if(i>=t)return r=new Date(n-t),!1;t-=i})),r):new Date(e);var r}},{key:"skipWorkingTime",value:function(e,t,n){return t>=0?this.calculateEndDate(e,t,n):this.calculateStartDate(e,-t,n)}},{key:"isChildOf",value:function(e){for(var t=this,n=!1;t&&!n;)n=t===e,t=t.parent;return n}},{key:"getParentableCalendars",value:function(){var e=this;return t.getAllCalendars().reduce((function(t,n){return n===e||n.isChildOf(e)||t.push({id:n.calendarId,name:n.name||n.calendarId}),t}),[])}},{key:"getAvailabilityIntervalsFor",value:function(e,t){return e=t?e.valueOf():e instanceof Date?new Date(e.getFullYear(),e.getMonth(),e.getDate()).valueOf():vt.clearTime(new Date(e)).valueOf(),this.availabilityIntervalsCache[e]=this.availabilityIntervalsCache[e]||this.getCalendarDay(e).getAvailabilityIntervalsFor(e)}},{key:"onParentDestroy",value:function(){this.parent=null}},{key:"isAvailabilityIntersected",value:function(e,t,n){for(var r,i,o,a,s=0;s<7;s++)if(r=this.getWeekDay(s)||this.getDefaultCalendarDay(s),o=e.getWeekDay(s)||e.getDefaultCalendarDay(s),r&&o){i=r.getAvailability(),a=o.getAvailability();for(var l=0,u=i.length;l<u;l++)for(var c=0,d=a.length;c<d;c++)if(a[c].startTime<i[l].endTime&&a[c].endTime>i[l].startTime)return!0}var h=!1;return this.forEachNonStandardWeek((function(e){return!(e.startDate>=n)&&(t<e.endDate?(h=!0,!1):void 0)})),h}},{key:"calendarId",get:function(){return this._calendarId},set:function(e){var t=this;t._calendarId=e,t.storeId=null!=e?"GNT_CALENDAR:"+e:null,t.params=Object.assign(t.params||{},{calendarId:e})}},{key:"parent",set:function(e){var n=this,r=t.getCalendar(e);if(e&&!r)throw new Error("Invalid parent specified for the calendar");if(n.parent!=r){var i={calendarchange:n.clearCache,destroy:n.onParentDestroy,thisObj:n},o=n.parent;o&&o.un(i),n._parent=r,r&&r.on(i),n.params=Object.assign(n.params||{},{parentId:r?r.calendarId:null}),n.clearCache(),n.trigger("parentChange",{newParent:r,oldParent:o})}},get:function(){return this._parent}}],[{key:"getCalendar",value:function(e){return e instanceof t?e:Fi.getStore(e)}},{key:"defaultConfig",get:function(){return{modelClass:Ou,daysPerMonth:30,daysPerWeek:7,hoursPerDay:24,unitsInMs:null,defaultNonWorkingTimeCssCls:"b-nonworkingtime",weekendsAreWorkdays:!1,weekendFirstDay:6,weekendSecondDay:0,holidaysCache:null,availabilityIntervalsCache:null,daysIndex:null,weekAvailability:null,defaultWeekAvailability:null,nonStandardWeeksByStartDate:null,nonStandardWeeksStartDates:null,calendarId:null,parent:null,defaultAvailability:["00:00-24:00"],name:null,suspendCacheUpdate:0,availabilitySearchLimit:1825}}},{key:"allCalendars",get:function(){return(Fi.stores||[]).filter((function(e){return e instanceof t}))}}]),t}(Ii);Nu._$name="Calendar";var Bu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventStore;return e&&e.getEventsForResource(this)||[]}},{key:"isAbove",value:function(e){var t,n,r,i,o,a=this,s=a.resourceStore;if(a===e)return!1;if(s.tree){for(t=a,n=[];t;)n.push(t),t=t.parentNode;for(t=e,r=[];t;)r.push(t),t=t.parentNode;for(i=0;i<n.length-1&&i<r.length-1&&n[i]==r[i];)++i;return o=n[i],a=n[i+1],e=r[i+1],o.indexOf(a)<o.indexOf(e)}return s.indexOf(a)<s.indexOf(e)}},{key:"unassignAll",value:function(e){var t=this;this.events&&this.events.slice().forEach((function(n){return n.unassign(t,e)}))}},{key:"resourceStore",get:function(){return this.stores&&this.stores[0]}},{key:"eventStore",get:function(){var e=this.resourceStore;return e&&e.eventStore||this.parentNode&&this.parentNode.eventStore}},{key:"assignmentStore",get:function(){var e=this.eventStore;return e&&e.assignmentStore}},{key:"events",get:function(){return this.eventStore&&this.eventStore.getEventsForResource(this)}},{key:"isPersistable",get:function(){var e=this.parentNode;return!e||!e.phantom||e.isRoot&&e.isRoot()}}],[{key:"fields",get:function(){return[{name:"name",type:"string",persist:!0},"eventColor","eventStyle","imageUrl"]}}]),t}(Gs);Bu.exposeProperties(),Bu._$name="ResourceModel";var zu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){if(se()(oe()(t.prototype),"construct",this).call(this,e),this.modelClass!==Bu&&!(this.modelClass.prototype instanceof Bu))throw new Error("Model for ResourceStore must subclass ResourceModel")}},{key:"remove",value:function(e){e=Array.isArray(e)?e:[e];var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.getById(s).unassignAll(!0)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}se()(oe()(t.prototype),"remove",this).call(this,e)}},{key:"removeAll",value:function(){this.traverse((function(e){return e.unassignAll(!0)})),se()(oe()(t.prototype),"removeAll",this).call(this)}}],[{key:"defaultConfig",get:function(){return{loadPriority:200,syncPriority:100,modelClass:Bu,storeId:"resources",autoTree:!0}}}]),t}(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getScheduledEventsInTimeSpan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.eventStore;return this.reduce((function(r,i){r.concat(n.getEventsForResource(i).reduce((function(n,r){r.intersectsRange(e,t)&&n.push(r)})))}))}},{key:"eventStore",get:function(){return this._eventStore},set:function(e){var t=this;if(t._eventStore!==e){var n=t._eventStore;t._eventStore=e||null,e&&!e.resourceStore&&(e.resourceStore=t),t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:n})}}}]),t}(e||z)}(Ii));zu._$name="ResourceStore";var ju=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onEventStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onResourceStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onAssignmentStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onDependencyStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"removeNonPersistableRecordsToCreate",value:function(e){var t,n,r=e.added||[];for(n=r.length-1;n>=0;--n)(t=r[n]).isPersistable||r.splice(r.indexOf(t),1);0===r.length&&(e.added.length=0)}},{key:"shallContinueSync",value:function(e){return Boolean(e.added&&e.added.length>0||e.modified&&e.modified.length>0||e.removed&&e.removed.length>0)}},{key:"eventStore",set:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),t._eventStore=e,e&&e.autoCommit&&(t.eventStoreDetacher=e.on({beforecommit:t.onEventStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._eventStore}},{key:"resourceStore",set:function(e){var t=this;t.resourceStoreDetacher&&t.resourceStoreDetacher(),t._resourceStore=e,e&&e.autoCommit&&(t.resourceStoreDetacher=e.on({beforecommit:t.onResourceStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._resourceStore}},{key:"assignmentStore",set:function(e){var t=this;t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),t._assignmentStore=e,e&&e.autoSync&&(t.assignmentStoreDetacher=e.on({beforecommit:t.onAssignmentStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._assignmentStore}},{key:"dependencyStore",set:function(e){var t=this;t.dependencyStoreDetacher&&t.dependencyStoreDetacher(),t._dependencyStore=e,e&&e.autoSync&&(t.dependencyStoreDetacher=e.on({beforecommit:t.onDependencyStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._dependencyStore}}]),t}(z);ju._$name="ModelPersistencyManager";var Vu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"cancel",value:function(){var e=this.delayedCalls;if(e){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=n.length?n:Object.keys(e),o=i.length-1;o>=0;o--){var a=i[o],s=e[a];s&&s.timer&&(this.clearTimeout(s.timer),s.timer=null)}}}},{key:"invoke",value:function(e){var t=e.id,n=e.scope,r=e.beforeFn,i=A.capitalizeFirstLetter(t);this.trigger("delayed".concat(i,"Start"),e),r&&r.call(n,e);for(var o,a=e.afterFn,s=e.fn,l=e.entries,u=[];o=l.shift();)u.push(s.call.apply(s,[n,e].concat(G()(o))));return a&&a.call(n,e),this.trigger("delayed".concat(i,"End"),e),e.delete(),u}},{key:"execute",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n,r){var i=e;i.delayedCalls=i.delayedCalls||{};var o=t.id,a=t.args,s=t.timeout;i.delayedCalls[o]||(i.delayedCalls[o]=Object.assign({delete:function(){return delete i.delayedCalls[o]},entries:[],scope:e,id:o},t),delete i.delayedCalls[o].args);var l=i.delayedCalls[o];i.cancel(o),l.entries.push(a||[]),l.timer=i.setTimeout((function(){l.results=i.invoke(l),n(l)}),s||i.delayedCallTimeout)}))}},{key:"delayedCallTimeout",get:function(){return isNaN(this._delayedCallTimeout)?100:this._delayedCallTimeout},set:function(e){this._delayedCallTimeout=e}}]),t}(de(ze()));Vu._$name="DelayedCallsManager";var Wu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"getNthDayInPeriod",value:function(e,t,n,r){var i,o,a;if(r){r>0?(o=1,a=e):(o=-1,a=t);var s=n-a.getDay();o*s<0&&(r+=o),((i=new Date(a.getTime()+6048e5*(r-o)+864e5*s))<e||i>t)&&(i=null)}return i}},{key:"buildDate",value:function(e,t,n){var r=new Date(e,t,n);if(r.getFullYear()==e&&r.getMonth()==t&&r.getDate()==n)return r}},{key:"isValidPosition",value:function(e){return Boolean(e)}},{key:"forEachDateAtPositions",value:function(e,t,n,r){for(var i=e.length,o={},a=0;a<t.length;a++){var s=t[a];if(this.isValidPosition(s)){var l=s>0?e[s-1]:e[i+s];if(l&&!o[l.getTime()]&&(o[l.getTime()]=!0,!1===n.call(r,l)))return!1}}}},{key:"frequency",get:function(){return"NONE"}},{key:"MAX_OCCURRENCES_COUNT",get:function(){return 1e6}}]),t}(z);Wu._$name="AbstractRecurrenceIterator";var Gu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"forEachDate",value:function(e){var t=e.recurrence,n=e.fn,r=e.scope,i=void 0===r?this:r,o=t.timeSpan,a=t.endDate,s=t.interval,l=o.startDate,u=e.startDate||l,c=e.endDate||a,d=t.count,h=0;a&&c&&c>a&&(c=a),l>u&&(u=l);var f=u-l,g=864e5*s,v=Math.floor(f/g);c||d||(d=this.MAX_OCCURRENCES_COUNT);for(var m=vt.add(l,v,"day");(!c||m<=c)&&(h++,!(m>=u&&(c&&m>c||!1===n.call(i,m,h)||d&&h>=d)));)m=vt.add(m,s,"day")}},{key:"frequency",get:function(){return"DAILY"}}]),t}(Wu);Gu._$name="DailyRecurrenceIterator";var Yu=/^([+-]?[0-9])?(SU|MO|TU|WE|TH|FR|SA)$/,Uu=["SU","MO","TU","WE","TH","FR","SA"],qu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"decodeDay",value:function(e){var t,n;return(t=Yu.exec(e))&&(n=[Uu.indexOf(t[2])],t[1]&&(t[1]=parseInt(t[1],10),n.push(t[1]))),n}},{key:"encodeDay",value:function(e){var t;if(Array.isArray(e)){var n=e,r=fe()(n,2);e=r[0],t=r[1]}return(t?t.toString():"")+Uu[e]}},{key:"decode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.decodeDay(e[r]))&&n.push(t);return n}},{key:"encode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.encodeDay(e[r]))&&n.push(t);return n}}]),t}(z);qu._$name="RecurrenceDayRuleEncoder";var $u=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"forEachDate",value:function(e){var t,n,r=e.fn,i=e.recurrence,o=e.scope,a=void 0===o?this:o,s=i.timeSpan,l=i.interval,u=i.days,c=i.endDate,d=s.startDate,h=0,f=e.startDate||d,g=e.endDate||c,v=i.count,m=qu.decode(u);for(c&&g&&g>c&&(g=c),m&&m.length?m.sort((function(e,t){return e[0]-t[0]})):m=[[d.getDay()]],d>f&&(f=d),t=vt.getNext(v?d:f,"week",0,0),g||v||(v=this.MAX_OCCURRENCES_COUNT);!g||t<=g;){for(var p=0;p<m.length;p++)if((n=vt.copyTimeValues(vt.add(t,m[p][0],"day"),d))>=d&&(h++,n>=f&&(g&&n>g||!1===r.call(a,n,h)||v&&h>=v)))return;t=vt.getNext(t,"week",l,0)}}},{key:"frequency",get:function(){return"WEEKLY"}}]),t}(Wu);$u._$name="WeeklyRecurrenceIterator";var Xu=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"getNthDayOfMonth",value:function(e,t){var n=vt.daysInMonth(e),r=null;return t&&Math.abs(t)<=n&&(r=new Date(e.getFullYear(),e.getMonth(),t<0?n+t+1:t)),r}},{key:"isValidPosition",value:function(e){return e&&Math.abs(e)>0&&Math.abs(e)<=31}},{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,l=e.fn,u=e.recurrence,c=e.scope,d=void 0===c?s:c,h=u.timeSpan,f=u.interval,g=u.days,v=u.endDate,m=u.count,p=u.positions,y=h.startDate,k=qu.decode(g),b=p&&p.length,w={},S=e.startDate||y,C=e.endDate||v,E=u.monthDays,x=0;for(v&&C&&C>v&&(C=v),y>S&&(S=y),n=vt.startOf(m?y:S,"month"),r=new Date(vt.getNext(n,"month",1)-1),E&&E.length||k&&k.length||(E=[y.getDate()]),k&&k.length&&k.forEach((function(e){e[1]&&((t=t||{})[e[0]]=e[1])}));(!C||C>=n)&&(!m||x<m);){if(i=[],k&&k.length){if(k.forEach((function(e){var t=e[0],l=1,u=53;for(e[1]&&(l=u=e[1]),a=l;a<=u;a++)(o=s.getNthDayInPeriod(n,r,t,a))&&(o=vt.copyTimeValues(o,y),w[o.getTime()]||(w[o.getTime()]=!0,i.push(o)))})),i.sort((function(e,t){return e-t})),!b)for(a=0;a<i.length;a++)if((o=i[a])>=y&&(x++,o>=S&&(C&&o>C||!1===l.call(d,o,x)||m&&x>=m)))return!1}else{var D=[];for(a=0;a<E.length;a++)(o=s.getNthDayOfMonth(n,E[a]))&&!w[o.getTime()]&&(w[o.getTime()]=!0,D.push(o));for(D.sort((function(e,t){return e-t})),a=0;a<D.length;a++)if(o=vt.copyTimeValues(D[a],y),b)i.push(o);else if(o>=y&&(x++,o>=S&&(C&&o>C||!1===l.call(d,o,x)||m&&x>=m)))return}b&&i.length&&s.forEachDateAtPositions(i,p,(function(e){if(e>=y&&(x++,e>=S&&(!C||e<=C)&&(!1===l.call(d,e,x)||m&&x>=m)))return!1})),n=vt.getNext(n,"month",f),r=new Date(vt.getNext(n,"month",1)-1)}}},{key:"frequency",get:function(){return"MONTHLY"}}]),t}(Wu);Xu._$name="MonthlyRecurrenceIterator";var Ku=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,l=e.fn,u=e.recurrence,c=e.scope,d=void 0===c?s:c,h=u.timeSpan,f=u.interval,g=u.days,v=u.count,m=u.positions,p=u.endDate,y=h.startDate,k=qu.decode(g),b=m&&m.length,w={},S=e.startDate||y,C=e.endDate||p,E=u.months,x=0;for(p&&C&&C>p&&(C=p),y>S&&(S=y),i=vt.startOf(v?y:S,"year"),o=new Date(vt.getNext(i,"year",1)-1),E&&E.sort((function(e,t){return e-t})),E&&E.length||k&&k.length||(E=[y.getMonth()+1]),k&&k.length&&k.forEach((function(e){e[1]&&((a=a||{})[e[0]]=e[1])}));(!C||C>=i)&&(!v||x<v);){if(r=[],k&&k.length){if(k.forEach((function(e){var a=e[0],l=1,u=53;for(e[1]&&(l=u=e[1]),t=l;t<=u;t++)(n=s.getNthDayInPeriod(i,o,a,t))&&(n=vt.copyTimeValues(n,y),w[n.getTime()]||(w[n.getTime()]=!0,r.push(n)))})),r.sort((function(e,t){return e-t})),!b)for(t=0;t<r.length;t++)if((n=r[t])>=y&&(x++,n>=S&&(C&&n>C||!1===l.call(d,n,x)||v&&x>=v)))return}else for(t=0;t<E.length;t++)if((n=s.buildDate(i.getFullYear(),E[t]-1,y.getDate()))&&(n=vt.copyTimeValues(n,y),!w[n.getTime()]))if(w[n.getTime()]=!0,b)r.push(n);else if(n>=y&&(x++,n>=S&&(C&&n>C||!1===l.call(d,n,x)||v&&x>=v)))return;b&&r.length&&s.forEachDateAtPositions(r,m,(function(e){if(e>=y&&(x++,e>=S&&(!C||e<=C)&&(!1===l.call(d,e,x)||v&&x>=v)))return!1})),i=vt.getNext(i,"year",f),o=new Date(vt.getNext(i,"year",1)-1)}}},{key:"frequency",get:function(){return"YEARLY"}}]),t}(Wu);Ku._$name="YearlyRecurrenceIterator";var Ju=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"setupRecurringTimeSpans",value:function(){var e=this;e.recurrenceIterators=e.recurrenceIterators||[],e.addRecurrenceIterators(Gu,$u,Xu,Ku),e.relayEvents(e.delayedCallsManager,["delayedRegenerateOccurrencesStart","delayedRegenerateOccurrencesEnd","delayedGenerateOccurrencesStart","delayedGenerateOccurrencesEnd"]),e.delayedCallsManager.on({delayedRegenerateOccurrencesEnd:e.onDelayedRegenerateOccurrencesFinish,delayedGenerateOccurrencesEnd:e.onDelayedGenerateOccurrencesFinish,thisObj:e})}},{key:"doDestroy",value:function(){this.delayedCallsManager.destroy()}},{key:"addRecurrenceIterators",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){return e.recurrenceIterators[t.frequency]=t}))}},{key:"getRecurrenceIteratorForTimeSpan",value:function(e){return this.recurrenceIterators[e.recurrence.frequency]}},{key:"buildOccurrencesForTimeSpan",value:function(e,t,n,r){var i=[];if(e.isRecurring&&e.startDate){var o=e.recurrence,a=this.getRecurrenceIteratorForTimeSpan(e),s=e.exceptionDates?e.exceptionDates.reduce((function(e,t){return e[t.getTime()]=!0,e}),{}):{};a.forEachDate({recurrence:o,startDate:t,endDate:n,fn:function(t){s[t.getTime()]||r&&e.getOccurrenceByStartDate(t)||i.push(e.buildOccurrence(t))}})}return i}},{key:"mergeDelayedCallEntries",value:function(e){for(var t,n,r,i,o,a=e.entries,s={},l=0;l<a.length;l++){var u=o=a[l],c=fe()(u,3);r=c[0],t=c[1],n=c[2];for(var d=0;d<r.length;d++){var h=s[(i=r[d]).id];h?(h[1]>t&&(h[1]=t),h[2]<n&&(h[2]=n)):s[i.id]=[[i]].concat(o.slice(1))}}a=Object.values(s);for(var f={},g=0;g<a.length;g++){var v=o=a[g],m=fe()(v,3);i=m[0],t=m[1],n=m[2];var p=(t?t.getTime():"")+"-"+(n?n.getTime():"");f[p]?f[p][0]=f[p][0].concat(i):f[p]=o}e.entries=Object.values(f)}},{key:"regenerateOccurrencesForTimeSpansBuffered",value:function(e,t,n){var r=this;return Array.isArray(e)||(e=[e]),(e=e.filter((function(e){return e.isRecurring}))).length?new Promise(function(){var i=Di()(Ei.a.mark((function i(o,a){var s;return Ei.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.delayedCallsManager.execute({id:"regenerateOccurrences",beforeFn:r.mergeDelayedCallEntries,args:[e,t,n],fn:function(e,t,n,i){var o=e.toRemove=e.toRemove||[];o.push.apply(o,G()(r.getOccurrencesForTimeSpans(t))),e.added=r.generateOccurrencesForTimeSpans(t,n,i,!1)},afterFn:function(e){var t=e.toRemove;t.length&&(e.removed=r.remove(t))}});case 2:s=i.sent,o({added:s.added,removed:s.removed});case 4:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}()):Promise.resolve()}},{key:"generateOccurrencesForTimeSpansBuffered",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this;return Array.isArray(e)||(e=[e]),(e=e.filter((function(e){return e.isRecurring}))).length?new Promise(function(){var o=Di()(Ei.a.mark((function o(a){var s;return Ei.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,i.delayedCallsManager.execute({id:"generateOccurrences",beforeFn:i.mergeDelayedCallEntries,args:[e,t,n,r],fn:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.added=i.generateOccurrencesForTimeSpans.apply(i,n)}});case 2:s=o.sent,a({added:s.added});case 4:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()):Promise.resolve()}},{key:"generateOccurrencesForTimeSpans",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=[];if(e){var o=this,a=[];if(Array.isArray(e)||(e=[e]),e.length){for(var s=0;s<e.length;s++){var l=e[s],u=void 0,c=void 0,d=void 0;(a=o.buildOccurrencesForTimeSpan(l,t,n,r))&&(t<=(d=l.startDate)&&(c=a.shift())&&(u=c.startDate)-d&&(l.setStartEndDate(u,c.endDate),l.recurrence.sanitize()),i.push.apply(i,G()(a)))}i.length&&o.add(i)}}return i}},{key:"generateOccurrencesForAll",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getRecurringTimeSpans(),o=[];return i.length&&(r.trigger("generateOccurrencesAllStart",{timeSpans:i,startDate:e,endDate:t,preserveExisting:n}),o=r.generateOccurrencesForTimeSpans(i,e,t,n),r.trigger("generateOccurrencesAllEnd",{timeSpans:i,startDate:e,endDate:t,preserveExisting:n})),o}},{key:"getRecurringTimeSpans",value:function(){return this.query((function(e){return e.supportsRecurring&&e.isRecurring}))}},{key:"getOccurrencesForTimeSpans",value:function(e){var t=this,n=[];if(Array.isArray(e)||(e=[e]),e.length)for(var r=function(r){var i=e[r].id;n.push.apply(n,G()(t.query((function(e){return e.supportsRecurring&&e.recurringTimeSpanId==i}))))},i=0;i<e.length;i++)r(i);return n}},{key:"getOccurrencesForAll",value:function(){return this.query((function(e){return e.supportsRecurring&&e.isOccurrence}))}},{key:"removeOccurrencesForTimeSpans",value:function(e){return this.remove(this.getOccurrencesForTimeSpans(e))}},{key:"removeOccurrencesForAll",value:function(){return this.remove(this.getOccurrencesForAll())}},{key:"onDelayedRegenerateOccurrencesFinish",value:function(){this.trigger("occurrencesReady")}},{key:"onDelayedGenerateOccurrencesFinish",value:function(){this.trigger("occurrencesReady")}},{key:"supportsRecurringTimeSpans",get:function(){return!0}},{key:"delayedCallTimeout",get:function(){return isNaN(this._delayedCallTimeout)?100:this._delayedCallTimeout},set:function(e){this._delayedCallTimeout=e}},{key:"delayedCallsManager",get:function(){return this._delayedCallsManager=this._delayedCallsManager||new Vu({delayedCallTimeout:this.delayedCallTimeout}),this._delayedCallsManager}}],[{key:"$name",get:function(){return"RecurringTimeSpansMixin"}}]),t}(e||z)},Qu=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"setupRecurringEvents",value:function(){return this.setupRecurringTimeSpans.apply(this,arguments)}},{key:"generateOccurrencesForEvents",value:function(){return this.generateOccurrencesForTimeSpans.apply(this,arguments)}},{key:"generateOccurrencesForEventsBuffered",value:function(){return this.generateOccurrencesForTimeSpansBuffered.apply(this,arguments)}},{key:"regenerateOccurrencesForEvents",value:function(){return this.regenerateOccurrencesForTimeSpans.apply(this,arguments)}},{key:"regenerateOccurrencesForEventsBuffered",value:function(){return this.regenerateOccurrencesForTimeSpansBuffered.apply(this,arguments)}},{key:"getRecurringEvents",value:function(){return this.getRecurringTimeSpans()}},{key:"getOccurrencesForEvents",value:function(e){return this.getOccurrencesForTimeSpans(e)}},{key:"removeOccurrencesForEvents",value:function(e){return this.removeOccurrencesForTimeSpans(e)}},{key:"isEventPersistable",value:function(e){return se()(oe()(t.prototype),"isEventPersistable",this).call(this,e)&&(!e.supportsRecurring||!e.isOccurrence)}},{key:"supportsRecurringEvents",get:function(){return!0}}],[{key:"$name",get:function(){return"RecurringEventsMixin"}}]),t}(Ju(e||z))};function Zu(e){return e?"string"==typeof e&&(e=e.split(",").map((function(e){return parseInt(e,10)}))):e=null,e}function ec(e){return e?"string"==typeof e&&(e=e.split(",")):e=null,e}function tc(e,t){return String(e)===String(t)}function nc(e){return this.defaultValue&&void 0===e?this.defaultValue:this.allowNull&&null==e?null:(e=parseInt(e),isNaN(e)&&(e=void 0),e)}var rc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=e.rule,i=e.timeSpan;n._suspendedTimeSpanNotifying=0,delete e.timeSpan,delete e.rule,se()(oe()(t.prototype),"construct",this).apply(this,arguments),r&&(n.suspendTimeSpanNotifying(),n.rule=r,n.resumeTimeSpanNotifying()),n.timeSpan=i}},{key:"sanitize",value:function(){var e=this,t=e.timeSpan,n=t&&t.startDate;switch(e.beginBatch(),e.isSanitizing=!0,e.frequency){case"DAILY":e.positions=null,e.days=null,e.monthDays=null,e.months=null;break;case"WEEKLY":e.positions=null,e.monthDays=null,e.months=null;var r=e.days;n&&r&&1==r.length&&r[0]==qu.encodeDay(n.getDay())&&(e.days=null);break;case"MONTHLY":e.monthDays&&e.monthDays.length&&(e.positions=null,e.days=null),e.months=null;var i=e.monthDays;n&&i&&1==i.length&&i[0]==n.getDate()&&(e.monthDays=null);break;case"YEARLY":e.monthDays=null;var o=e.months;n&&o&&1==o.length&&o[0]==n.getMonth()+1&&(e.months=null)}e.isSanitizing=!1,e.endBatch()}},{key:"copy",value:function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=(e=se()(oe()(t.prototype),"copy",this)).call.apply(e,[this].concat(r));return o.dateFormat=this.dateFormat,o.timeSpan=this.timeSpan,o}},{key:"afterChange",value:function(e,n,r){var i=se()(oe()(t.prototype),"afterChange",this).call(this,e,n,r);this.isSanitizing||this.sanitize();var o=this.timeSpan;return o&&!this.isTimeSpanNotifyingSuspended&&o.onRecurrenceChanged(),i}},{key:"suspendTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying++}},{key:"resumeTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying&&this._suspendedTimeSpanNotifying--}},{key:"isRecurrenceModel",get:function(){return!0}},{key:"dateFormat",get:function(){return this._dateFormat||"YYYYMMDDTHHmmss"},set:function(e){this._dateFormat=e}},{key:"timeSpan",get:function(){return this._timeSpan},set:function(e){this._timeSpan=e}},{key:"rule",get:function(){var e=this,t=[];return e.frequency&&(t.push("FREQ=".concat(e.frequency)),e.interval>1&&t.push("INTERVAL=".concat(e.interval)),e.days&&e.days.length&&t.push("BYDAY="+e.days.join(",")),e.monthDays&&e.monthDays.length&&t.push("BYMONTHDAY="+e.monthDays.join(",")),e.months&&e.months.length&&t.push("BYMONTH="+e.months.join(",")),e.count&&t.push("COUNT=".concat(e.count)),e.endDate&&t.push("UNTIL="+vt.format(e.endDate,e.dateFormat)),e.positions&&e.positions.length&&t.push("BYSETPOS="+e.positions.join(","))),t.join(";")},set:function(e){var t=this;if(t.beginBatch(),e){for(var n=e.split(";"),r=0,i=n.length;r<i;r++){var o=n[r].split("="),a=o[1];switch(o[0]){case"FREQ":t.frequency=a;break;case"INTERVAL":t.interval=a;break;case"COUNT":t.count=a,t.until=null;break;case"UNTIL":t.endDate=a?vt.parse(a,t.dateFormat):null,t.count=null;break;case"BYDAY":t.days=a;break;case"BYMONTHDAY":t.monthDays=a;break;case"BYMONTH":t.months=a;break;case"BYSETPOS":t.positions=a}}t.sanitize()}else t.set({frequency:null,interval:null,count:null,endDate:null,days:null,monthDays:null,months:null,positions:null});t.endBatch()}},{key:"count",get:function(){return this.get("count")},set:function(e){e&&(this.endDate=null),this.set("count",e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){e&&(this.count=null),this.set("endDate",e)}},{key:"isTimeSpanNotifyingSuspended",get:function(){return Boolean(this._suspendedTimeSpanNotifying)}}],[{key:"fields",get:function(){return[{name:"frequency",defaultValue:"DAILY"},{name:"interval",defaultValue:1,convert:nc},{name:"endDate",type:"date"},{name:"count",allowNull:!0,convert:nc},{name:"days",convert:ec,isEqual:tc},{name:"monthDays",convert:Zu,isEqual:tc},{name:"months",convert:Zu,isEqual:tc},{name:"positions",convert:Zu,isEqual:tc}]}}]),t}(mi);rc._$name="RecurrenceModel";function ic(e){if(e){var t=this.dateFormat;e=(e="string"==typeof e?e.split(","):e).map((function(e){return"string"==typeof e&&(e=vt.parse(e,t)),e}))}return e}var oc=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"setRecurrence",value:function(e,t,n){var r,i;e&&(e.isRecurrenceModel?r=e:"string"==typeof e?((r=new this.recurrenceModel).frequency=e,t&&(r.interval=t),n&&(n instanceof Date?r.endDate=n:r.count=n)):r=new this.recurrenceModel(e),r.timeSpan=this,i=r.rule),this.recurrence=r,this.recurrenceRule=i}},{key:"getOccurrenceByStartDate",value:function(e){var t,n;if(e){n=this.occurrences;for(var r=0;r<n.length;r++)if(n[r].startDate-e==0){t=n[r];break}}return t}},{key:"removeOccurrences",value:function(){var e=this.stores[0];return e&&e.removeOccurrencesForTimeSpans&&e.removeOccurrencesForTimeSpans(this)}},{key:"onRecurrenceChanged",value:function(){this.recurrenceRule=this.recurrence&&this.recurrence.rule||null}},{key:"buildOccurrence",value:function(e){var t=this.copy(null);return t.beginBatch(),t.setStartDate(e),t.recurringTimeSpanId=this.id,t.endBatch(),t}},{key:"afterChange",value:function(e,n,r){var i;"recurrenceRule"in n&&(this._recurrence=null);for(var o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];return(i=se()(oe()(t.prototype),"afterChange",this)).call.apply(i,[this,e,n,r].concat(a))}},{key:"addExceptionDate",value:function(e){var t=this.exceptionDates||[];e&&(this.exceptionDates=t.concat(e))}},{key:"beforeStartDateChange",value:function(){this._startDateValue=this.startDate}},{key:"afterStartDateChange",value:function(){this._startDateValue-this.startDate&&this.exceptionDates&&(this.exceptionDates=null)}},{key:"supportsRecurring",get:function(){return!0}},{key:"recurrenceModel",get:function(){return this._recurrenceModel||rc},set:function(e){this._recurrenceModel=e}},{key:"recurrence",get:function(){var e=this,t=e.recurrenceRule;return!e._recurrence&&t&&(e._recurrence=new e.recurrenceModel({rule:t,timeSpan:e})),e._recurrence},set:function(e){var t,n=this;if(n.isOccurrence){var r=n.recurringTimeSpan;t=r&&r.recurrence,n.recurringTimeSpanId=null}e&&t&&(t.endDate=new Date(n.startDate-1)),n._recurrence=e,e?(e.timeSpan=n,n.recurrenceRule=e.rule):n.recurrenceRule=null}},{key:"isRecurring",get:function(){return this.recurrence&&!this.isOccurrence}},{key:"isOccurrence",get:function(){return Boolean(this.recurringTimeSpanId)}},{key:"recurringTimeSpan",get:function(){var e=this.recurringTimeSpanId,t=this.stores[0];return e&&t&&t.getById(e)}},{key:"occurrences",get:function(){var e=this.stores[0];return e&&e.getOccurrencesForTimeSpans&&e.getOccurrencesForTimeSpans(this)}}],[{key:"fields",get:function(){return[{name:"recurringTimeSpanId"},{name:"recurrenceRule"},{name:"exceptionDates",convert:ic}]}}]),t}(e||Hu)},ac=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"forEachResource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=!0,r=!1,i=void 0;try{for(var o,a=this.resources[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!1===e.call(t,s))return}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"getResource",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.resourceId,t=this,n=t.eventStore,r=n&&n.resourceStore;if(n&&e){var i=n.getResourcesForEvent(t);if(1==i.length)return i[0];if(i.length>1)throw new Error("Event::getResource() is not applicable for events with multiple assignments, please use Event::resources instead.");return null}if(r)return r?r.getById(e):null}},{key:"assign",value:function(e){var t=this.eventStore;e=mi.asId(e),t?t.assignEventToResource(this,e):this.resourceId=e}},{key:"unassign",value:function(e,t){var n=this,r=n.eventStore;e=mi.asId(e),n.meta.removingResource=t,r?r.unassignEventFromResource(n,e):n.resourceId==e&&(n.resourceId=null),n.meta.removingResource=null}},{key:"reassign",value:function(e,t){var n=this.eventStore;e=mi.asId(e),t=mi.asId(t),n?n.reassignEventFromResourceToResource(this,e,t):this.resourceId=t}},{key:"isAssignedTo",value:function(e){var t=this.eventStore;return e=mi.asId(e),t?t.isEventAssignedToResource(this,e):this.resourceId==e}},{key:"eventStore",get:function(){var e=this;return e._eventStore||(e._eventStore=e.stores&&e.stores.find((function(e){return e.isEventStore}))),e._eventStore}},{key:"resourceStore",get:function(){var e=this.eventStore;return e&&e.resourceStore}},{key:"assignmentStore",get:function(){var e=this.eventStore;return e&&e.assignmentStore}},{key:"resources",get:function(){return this.eventStore&&this.eventStore.getResourcesForEvent(this)||[]}},{key:"isEvent",get:function(){return!0}},{key:"isDraggable",get:function(){return this.draggable}},{key:"isResizable",get:function(){return!this.isMilestone&&this.resizable}},{key:"isPersistable",get:function(){var e=this.eventStore;return e&&e.isEventPersistable(this)}},{key:"recurringEvent",get:function(){return this.recurringTimeSpan}}],[{key:"fields",get:function(){return[{name:"iconCls"},{name:"resourceId"},{name:"draggable",type:"boolean",persist:!1,defaultValue:!0},{name:"resizable",persist:!1,defaultValue:!0},"eventStyle","eventColor","milestoneWidth"]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"events"}]}}]),t}(oc());ac.exposeProperties(),ac._$name="EventModel";var sc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){if(se()(oe()(t.prototype),"construct",this).call(this,e,!0),this.setupRecurringEvents(),this.modelClass!==ac&&!(this.modelClass.prototype instanceof ac))throw new Error("The model for the EventStore must subclass EventModel")}},{key:"append",value:function(e){this.add(e)}}],[{key:"defaultConfig",get:function(){return{loadPriority:100,syncPriority:200,modelClass:ac,storeId:"events"}}}]),t}(Qu(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),Object.assign(this,{isEventStore:!0,autoTree:!0,modelPersistencyManager:this.createModelPersistencyManager()})}},{key:"createModelPersistencyManager",value:function(){return new ju({eventStore:this,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore})}},{key:"getEventsInTimeSpan",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[];return this.forEachScheduledEvent((function(o,a,s){(n&&vt.intersectSpans(a,s,e,t)||!n&&a-e>=0&&t-s>=0)&&(!r||o.resources.length>0)&&i.push(o)})),i}},{key:"getEventsByStartDate",value:function(e){var t=[];return this.forEachScheduledEvent((function(n,r,i){vt.isEqual(r,e,"day")&&t.push(n)})),t}},{key:"forEachScheduledEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.forEach((function(n){var r=n.startDate,i=n.endDate;if(r&&i)return e.call(t,n,r,i)}))}},{key:"getTotalTimeSpan",value:function(){var e=new Date(9999,0,1),t=new Date(0);return this.forEach((function(n){n.startDate&&(e=vt.min(n.startDate,e)),n.endDate&&(t=vt.max(n.endDate,t))})),e=e<new Date(9999,0,1)?e:null,t=t>new Date(0)?t:null,this.lastTotalTimeSpan={startDate:e||null,endDate:t||e||null}}},{key:"isEventPersistable",value:function(e){var t=!0;if(!this.assignmentStore){var n=e.stores[0],r=n&&n.crudManager;t=!n||(r||!e.resource||!e.resource.hasGeneratedId)}return t}},{key:"isDateRangeAvailable",value:function(e,t,n,r){if(n instanceof Iu){var i=n.event,o=i.resources,a=new Set(r.events);return o.forEach((function(e){e.events.forEach((function(e){return a.add(e)}))})),a.delete(i),!Array.from(a).some((function(n){return vt.intersectSpans(e,t,n.startDate,n.endDate)}))}return!this.getEventsForResource(r).some((function(r){return!(n===r||!vt.intersectSpans(e,t,r.startDate,r.endDate))}))}},{key:"filterEventsForResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return e.getEvents(this).filter(t.bind(n))}},{key:"getResourcesForEvent",value:function(e){return this.assignmentStore?this.assignmentStore.getResourcesForEvent(e):(e=this.getById(e)).resource&&!e.resource.placeHolder?[e.resource]:[]}},{key:"getEventsForResource",value:function(e){if(this.assignmentStore)return this.assignmentStore.getEventsForResource(e);e=mi.asId(e);var t=this.relationCache.resource&&this.relationCache.resource[e];return t?t.slice():[]}},{key:"getAssignmentsForEvent",value:function(e){return this.assignmentStore&&this.assignmentStore.getAssignmentsForEvent(e)||[]}},{key:"getAssignmentsForResource",value:function(e){return this.assignmentStore&&this.assignmentStore.getAssignmentsForResource(e)||[]}},{key:"assignEventToResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.assignmentStore?this.assignmentStore.assignEventToResource(e,t,void 0,n):(e=this.getById(e),Array.isArray(t)&&(t=t[0]),e&&(e.resourceId=mi.asId(t)))}},{key:"unassignEventFromResource",value:function(e,t){this.assignmentStore?this.assignmentStore.unassignEventFromResource(e,t):(e=this.getById(e),t=mi.asId(t),e&&e.resourceId==t&&(e.resourceId=null))}},{key:"reassignEventFromResourceToResource",value:function(e,t,n){var r=this.assignmentStore,i=mi.asId(n),o=mi.asId(t);if(r){var a=r.getAssignmentForEventAndResource(e,t);a?a.resourceId=i:r.assignEventToResource(e,n)}else(e=this.getById(e)).resourceId==o&&(e.resourceId=i)}},{key:"isEventAssignedToResource",value:function(e,t){return this.assignmentStore?this.assignmentStore.isEventAssignedToResource(e,t):(e=this.getById(e),t=mi.asId(t),e&&e.resourceId==t||!1)}},{key:"removeAssignmentsForEvent",value:function(e){this.assignmentStore?this.assignmentStore.removeAssignmentsForEvent(e):(e=this.getById(e))&&(e.resourceId=null)}},{key:"removeAssignmentsForResource",value:function(e){var t=this.assignmentStore,n=this.resourceStore;t?t.removeAssignmentsForResource(e):n?e=n.getById(e):(e=mi.asId(e),this.forEach((function(t){return t.resourceId==e&&(t.resourceId=null)})))}},{key:"resourceStore",get:function(){return this._resourceStore},set:function(e){var t=this,n=t._resourceStore;n&&(n.eventStore=null,t.modelPersistencyManager&&(t.modelPersistencyManager.resourceStore=null)),t._resourceStore=e||null,e&&(t.modelPersistencyManager&&(t.modelPersistencyManager.resourceStore=t._resourceStore),e.eventStore=t),t.isConfiguring||t.initRelations(!0),(n||e)&&n!==e&&t.trigger("resourceStoreChange",{newResourceStore:e,oldResourceStore:n})}},{key:"assignmentStore",get:function(){return this._assignmentStore},set:function(e){var t=this,n=t._assignmentStore;n&&(n.eventStore=null,t.modelPersistencyManager&&(t.modelPersistencyManager.assignmentStore=null)),t._assignmentStore=e||null,e&&(t.modelPersistencyManager&&(t.modelPersistencyManager.assignmentStore=t._assignmentStore),e.eventStore=t),t.isConfiguring||t.initRelations(!0),(n||e)&&n!==e&&t.trigger("assignmentStoreChange",{newAssignmentStore:e,oldAssignmentStore:n})}},{key:"dependencyStore",get:function(){return this._dependencyStore},set:function(e){var t=this,n=t._dependencyStore;n&&(n.eventStore=null,t.modelPersistencyManager&&(t.modelPersistencyManager.dependencyStore=null)),t._dependencyStore=e||null,t._dependencyStore&&(t.modelPersistencyManager&&(t.modelPersistencyManager.dependencyStore=t._dependencyStore),t._dependencyStore.eventStore=t),(n||e)&&n!==e&&t.trigger("dependencyStoreChange",{newDependencyStore:e,oldDependencyStore:n})}}]),t}(e||z)}(Ii)));sc._$name="EventStore";var lc=["SS","SF","FS","FF"],uc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).apply(this,arguments),e&&(e.from&&e.from instanceof Hu&&(this.setSourceEvent(e.from),delete e.from),e.to&&e.to instanceof Hu&&(this.setTargetEvent(e.to),delete e.to))}},{key:"getHardType",value:function(){return this.get("type")}},{key:"setHardType",value:function(e){var t;return e!==this.getHardType()&&(t=this.set({type:e,fromSide:null,toSide:null})),t}},{key:"setLag",value:function(e,t){1!==arguments.length?(e=parseFloat(e),this.set({lag:e,lagUnit:t})):"number"==typeof e?this.lag=e:(e=vt.parseDuration(e),this.set({lag:e.magnitude,lagUnit:e.unit}))}},{key:"getLag",value:function(){return this.lag?"".concat(this.lag<0?"-":"+").concat(Math.abs(this.lag)).concat(vt.getShortNameOfUnit(this.lagUnit)):""}},{key:"getSourceEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventStore;return!e&&this.unjoinedStores.length&&(e=this.leftProjectEventStore),e&&e.getById(this.from)}},{key:"getTargetEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventStore;return!e&&this.unjoinedStores.length&&(e=this.leftProjectEventStore),e&&e.getById(this.to)}},{key:"getDateRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.sourceEvent,r=this.targetEvent;if(n&&r&&n.isScheduled&&r.isScheduled){var i,o,a=t.Type;switch(this.type){case a.StartToStart:i=n.startDate,o=r.startDate;break;case a.StartToEnd:i=n.startDate,o=r.endDate;break;case a.EndToEnd:i=n.endDate,o=r.endDate;break;case a.EndToStart:i=n.endDate,o=r.startDate}return{start:e?i:vt.min(i,o),end:e?o:vt.max(i,o)}}return null}},{key:"highlight",value:function(e){var t=this.highlighted?this.highlighted.split(" "):[];t.includes(e)||(this.highlighted=t.concat(e).join(" "))}},{key:"unhighlight",value:function(e){var t=this.highlighted;if(t){var n=t.split(" "),r=n.findIndex((function(t){return t===e}));r>=0&&(n.splice(r,1),this.highlighted=n.join(" "))}}},{key:"isHighlightedWith",value:function(e){var t=this.highlighted;return t&&t.split(" ").includes(e)}},{key:"getConnectorString",value:function(e){var n=lc[this.type];if(e)return n;if(this.type===t.Type.EndToStart)return"";var r=je.locale;if(r){var i=r.Scheduler&&r.Scheduler[n];if(i)return i}return n}},{key:"toString",value:function(){return"".concat(this.from).concat(this.getConnectorString()).concat(this.getLag())}},{key:"isValid",value:function(e){var t=this.from,n=this.to;return"number"==typeof this.type&&t&&""!==t&&null!=n&&""!==n&&t!==n}},{key:"eventStore",get:function(){var e=this.stores,t=this.unjoinedStores;return e[0]&&e[0].eventStore||t[0]&&t[0].eventStore}},{key:"hardType",get:function(){return this.getHardType()},set:function(e){this.setHardType(e)}},{key:"lag",get:function(){return this.get("lag")},set:function(e){"number"==typeof e?this.set({lag:e}):this.setLag(e)}},{key:"fullLag",get:function(){return{unit:this.lagUnit,magnitude:this.lag}},set:function(e){"string"==typeof e?this.setLag(e):this.setLag(e.magnitude,e.unit)}},{key:"sourceEvent",set:function(e){this.from=e.id}},{key:"targetEvent",set:function(e){this.to=e.id}},{key:"isPersistable",get:function(){var e,t=this.stores,n=this.unjoinedStores,r=t[0];if(r){var i=this.getSourceEvent(),o=this.getTargetEvent(),a=r.crudManager;e=i&&(a||!i.hasGeneratedId)&&o&&(a||!o.hasGeneratedId)}else e=Boolean(n[0]);return e}}],[{key:"Type",get:function(){return{StartToStart:0,StartToEnd:1,EndToStart:2,EndToEnd:3}}},{key:"fields",get:function(){return[{name:"from"},{name:"to"},{name:"type",type:"int",defaultValue:2},{name:"cls",defaultValue:""},{name:"bidirectional",type:"boolean"},{name:"fromSide",type:"string"},{name:"toSide",type:"string"},{name:"lag",type:"number",allowNull:!0,defaultValue:0},{name:"lagUnit",type:"string",defaultValue:"d"}]}},{key:"relationConfig",get:function(){return[{relationName:"sourceEvent",fieldName:"from",store:"eventStore",collectionName:"successors"},{relationName:"targetEvent",fieldName:"to",store:"eventStore",collectionName:"predecessors"}]}}]),t}(mi);uc.exposeProperties(),uc._$name="DependencyBaseModel";var cc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getTypeFromSides",value:function(e,t,n){var r=uc.Type,i=n?"right":"left",o=n?"left":"right";return e===i?t===i?r.StartToStart:r.StartToEnd:t===o?r.EndToEnd:r.EndToStart}}]),t}(uc);cc.exposeProperties(),cc._$name="DependencyModel";var dc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.eventStoreDetacher&&this.eventStoreDetacher(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"attachToEventStore",value:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),t.eventStoreDetacher=e.on({remove:t.onEventRemove,thisObj:t,detachable:!0})}},{key:"onEventRemove",value:function(e){var t=this,n=e.records,r=e.isMove,i=void 0!==r&&r,o=e.isCollapse;i||void 0!==o&&o||n.forEach((function(e){e.traverse((function(e){return t.removeEventDependencies(e,!1)}))}))}},{key:"reduceEventDependencies",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;return o=o||function(e){return r.getEventDependencies(e)},(e=Array.isArray(e)?e:[e]).reduce((function(e,n){n.children&&!i?n.traverse((function(n){e=o(n).reduce(t,e)})):e=o(n).reduce(t,e)}),n),n}},{key:"reduceEventPredecessors",value:function(e,t,n,r){return this.reduceEventDependencies(e,t,n,r,(function(e){}))}},{key:"reduceEventSuccessors",value:function(e,t,n,r){return this.reduceEventDependencies(e,t,n,r,(function(e){}))}},{key:"mapEventDependencies",value:function(e,t,n,r,i){return this.reduceEventDependencies(e,(function(e,t){return n(t)&&e.push(t),e}),[],r,i)}},{key:"mapEventPredecessors",value:function(e,t,n,r){return this.reduceEventPredecessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"mapEventSuccessors",value:function(e,t,n,r){return this.reduceEventSuccessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"getEventDependencies",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return[].concat(e.predecessors||[],e.successors||[])}},{key:"getEventPredecessors",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.predecessors}},{key:"getEventSuccessors",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.successors}},{key:"getUnique",value:function(e){return G()(new Set(e))}},{key:"removeEventDependencies",value:function(e,t){var n=this.getEventDependencies(e,t);n.length&&this.remove(this.getUnique(n))}},{key:"removeEventPredecessors",value:function(e,t){var n=this.getEventPredecessors(e,t);n.length&&this.remove(this.getUnique(n))}},{key:"removeEventSuccessors",value:function(e,t){var n=this.getEventSuccessors(e,t);n.length&&this.remove(this.getUnique(n))}},{key:"getBySourceTargetId",value:function(e){return this.records.find((function(e){return t.makeDependencySourceTargetCompositeKey(e.from,e.to)}))}},{key:"getDependencyForSourceAndTargetEvents",value:function(e,n){return e=mi.asId(e),n=mi.asId(n),this.getBySourceTargetId(t.makeDependencySourceTargetCompositeKey(e,n))}},{key:"getEventsLinkingDependency",value:function(e,t){return this.getDependencyForSourceAndTargetEvents(e,t)||this.getDependencyForSourceAndTargetEvents(t,e)}},{key:"isValidDependency",value:function(e,t,n){return 1===arguments.length&&(n=e.type,t=e.to,e=e.from),null!=e&&null!=t&&e!==t}},{key:"getHighlightedDependencies",value:function(e){return this.records.reduce((function(t,n){return n.isHighlightedWith(e)&&t.push(n),t}),[])}},{key:"getTimeSpanDependencies",value:function(e){return this.getEventDependencies(e)}},{key:"eventStore",get:function(){return this._eventStore},set:function(e){var t=this,n=t._eventStore;t._eventStore=e,e&&(t.attachToEventStore(e),t.isConfiguring||t.initRelations(!0)),(n||e)&&n!==e&&t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:n})}}],[{key:"makeDependencySourceTargetCompositeKey",value:function(e,t){return"source(".concat(e,")-target(").concat(t,")")}},{key:"defaultConfig",get:function(){return{loadPriority:400,syncPriority:400,modelClass:cc,storeId:"dependencies"}}}]),t}(Ii);dc._$name="DependencyStore";var hc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.scheduler&&(this.scheduler=e.scheduler,this.scheduler._crudManager=this),se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"afterConstruct",value:function(){var e=this,n=e.scheduler;if(n){(n.isVertical||n.isHorizontal&&!n.store)&&(n.resourceStore=e.resourceStore,n.eventStore=e.eventStore);var r=n.features,i=r.dependencies,o=r.timeRanges,a=r.resourceTimeRanges;i&&(e.dependencyStore=i.dependencyStore),o&&(e.addCrudStore(o.store),e._timeRangesStore=o.store),a&&(e.addCrudStore(a.store),e._resourceTimeRangesStore=a.store)}se()(oe()(t.prototype),"afterConstruct",this).call(this)}},{key:"addFeaturedStore",value:function(e){this.addPrioritizedStore(e)}},{key:"setFeaturedStore",value:function(e,t,n){var r=this,i=r[e];return t=Fi.getStore(t,t&&t.storeClass||n),i&&r.removeStore(i),r[e]=t&&{store:t}||null,r.addFeaturedStore(r[e]),r[e]}},{key:"timeRangesStore",get:function(){return this._timeRangesStore}},{key:"resourceStore",get:function(){return this._resourceStore&&this._resourceStore.store},set:function(e){var t=this;t.setFeaturedStore("_resourceStore",e,t.resourceStoreClass),t.eventStore.resourceStore=t._resourceStore&&t._resourceStore.store}},{key:"eventStore",get:function(){return this._eventStore&&this._eventStore.store},set:function(e){var n=this;if(n.setFeaturedStore("_eventStore",e,n.eventStoreClass),e=n._eventStore&&n._eventStore.store,n.isConfiguring&&e&&!1!==n.addRelatedStores){var r=t.getEventStoreInfo(e,n.initialConfig),i=r.assignmentStore,o=r.resourceStore,a=r.dependencyStore;i&&(n.assignmentStore=i),o&&(n.resourceStore=o),a&&(n.dependencyStore=a)}}},{key:"assignmentStore",get:function(){return this._assignmentStore&&this._assignmentStore.store},set:function(e){this.setFeaturedStore("_assignmentStore",e,this.assignmentStoreClass)}},{key:"dependencyStore",get:function(){return this._dependencyStore&&this._dependencyStore.store},set:function(e){this.setFeaturedStore("_dependencyStore",e,this.dependencyStoreClass)}}],[{key:"getEventStoreInfo",value:function(e,t){e instanceof sc||(e="string"==typeof e?Fi.getStore(e):e.store);var n={},r=t.assignmentStore,i=t.resourceStore,o=t.dependencyStore;return!r&&(n.assignmentStore=e.assignmentStore),!i&&(n.resourceStore=e.resourceStore),!o&&(n.dependencyStore=e.dependencyStore),n}},{key:"defaultConfig",get:function(){return{resourceStoreClass:zu,eventStoreClass:sc,assignmentStoreClass:Lu,dependencyStoreClass:dc,resourceStore:{},eventStore:{},assignmentStore:null,dependencyStore:null,addRelatedStores:!0}}}]),t}(Au(Du(_u)));hc._$name="CrudManager";var fc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"getLegend",value:function(e,t){var n,r=this,i=e.timeSpan,o=e.interval,a=e.days,s=e.monthDays,l=e.months,u=e.positions,c=t||i.startDate,d={interval:o};switch(e.frequency){case"DAILY":return 1==o?r.L("Daily"):r.L("Every {0} days",d);case"WEEKLY":return a&&a.length?d.days=r.getDaysLegend(a):c&&(d.days=vt.getDayName(c.getDay())),r.L(1==o?"Weekly on {1}":"Every {0} weeks on {1}",d);case"MONTHLY":return a&&a.length&&u&&u.length?d.days=r.getDaysLegend(a,u):s&&s.length?(s.sort((function(e,t){return e-t})),d.days=r.arrayToText(s)):c&&(d.days=c.getDate()),r.L(1==o?"Monthly on {1}":"Every {0} months on {1}",d);case"YEARLY":return a&&a.length&&u&&u.length?d.days=r.getDaysLegend(a,u):d.days=c.getDate(),l&&l.length?(l.sort((function(e,t){return e-t})),n=l.length>2?function(e){return vt.getMonthShortName(e-1)}:function(e){return vt.getMonthName(e-1)},d.months=r.arrayToText(l,n)):d.months=vt.getMonthName(c.getMonth()),r.L(1==o?"Yearly on {1} of {2}":"Every {0} years on {1} of {2}",d)}}},{key:"getDaysLegend",value:function(e,t){var n,r=this,i={position:""};if(t&&t.length&&(i.position=r.arrayToText(t,(function(e){return r.L("position".concat(e))}))),e.length)switch(e.sort((function(e,t){return qu.decodeDay(e)[0]-qu.decodeDay(t)[0]})),e.join(",")){case r.allDaysValue:i.days=r.L("day");break;case r.workingDaysValue:i.days=r.L("weekday");break;case r.nonWorkingDaysValue:i.days=r.L("weekend day");break;default:n=e.length>2?function(e){return vt.getDayShortName(qu.decodeDay(e)[0])}:function(e){return vt.getDayName(qu.decodeDay(e)[0])},i.days=r.arrayToText(e,n)}return r.L("daysFormat",i)}},{key:"arrayToText",value:function(e,t){return t&&(e=e.map(t)),e.join(", ").replace(/,(?=[^,]*$)/,this.L(" and "))}},{key:"$name",get:function(){return"RecurrenceLegend"}},{key:"allDaysValue",get:function(){return"SU,MO,TU,WE,TH,FR,SA"}},{key:"workingDaysValue",get:function(){return"MO,TU,WE,TH,FR"}},{key:"nonWorkingDaysValue",get:function(){return"SU,SA"}}]),t}(Ve());fc._$name="RecurrenceLegend";var gc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"isResourceTimeRange",get:function(){return!0}},{key:"resources",get:function(){return[this.resource]}}],[{key:"fields",get:function(){return["resourceId","timeRangeColor"]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"timeRanges",nullFieldOnRemove:!0}]}}]),t}(Hu);gc._$name="ResourceTimeRangeModel";var vc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getResourcesForEvent",value:function(e){return[e.resource]}},{key:"resourceStore",set:function(e){this._resourceStore=e,this.isConfiguring||this.initRelations(!0)},get:function(){return this._resourceStore}}],[{key:"defaultConfig",get:function(){return{loadPriority:500,syncPriority:500,resourceStore:null,modelClass:gc,storeId:"resourceTimeRanges"}}}]),t}(Ii);vc._$name="ResourceTimeRangeStore";var mc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){e.headers||this.normalizeHeaderConfig(e),se()(oe()(t.prototype),"construct",this).apply(this,arguments),this.normalizeUnits()}},{key:"generateId",value:function(e){var t=this,n=t.headers,r=[],i=Object.getPrototypeOf(t.data).id;if(!i){for(var o=n.length-1;o>=0;o--)r.push(o?n[o].unit:A.capitalizeFirstLetter(n[o].unit));i=r.join("And")}return e.includes(i)&&(i+="-".concat(t.tickWidth,"by").concat(t.tickHeight||t.tickWidth),e.includes(i)&&(i+="-".concat(t.bottomHeader.increment),e.includes(i)&&(i=Z.generateId("".concat(i,"-"))))),i}},{key:"normalizeUnits",value:function(){for(var e=this,t=e.timeResolution,n=e.headers,r=0,i=n.length;r<i;r++){var o=n[r];o.unit=vt.normalizeUnit(o.unit),o.splitUnit&&(o.splitUnit=vt.normalizeUnit(o.splitUnit)),"increment"in o||(n[r]=Object.assign({increment:1},o))}t&&(t.unit=vt.normalizeUnit(t.unit)),e.shiftUnit&&(e.shiftUnit=vt.normalizeUnit(e.shiftUnit))}},{key:"normalizeHeaderConfig",value:function(e){var t=e.headerConfig,n=e.columnLinesFor,r=e.headers=[];if(t.top&&("top"==n&&(e.columnLinesFor=0),r[0]=t.top),!t.middle)throw new Error("ViewPreset.headerConfig must be configured with a middle");"middle"==n&&(e.columnLinesFor=r.length),r.push(t.middle),t.bottom&&(e.mainHeaderLevel=r.length-1,null==n?e.columnLinesFor=r.length-1:"bottom"==n&&(e.columnLinesFor=r.length),r.push(t.bottom))}},{key:"set",value:function(){}},{key:"inSet",value:function(){}},{key:"columnLinesFor",get:function(){return"columnLinesFor"in this.data?this.data.columnLinesFor:this.headers.length-1}},{key:"tickSize",get:function(){return this._tickSize||this.tickWidth}},{key:"tickWidth",get:function(){return"tickWidth"in this.data?this.data.tickWidth:50}},{key:"tickHeight",get:function(){return"tickHeight"in this.data?this.data.tickHeight:50}},{key:"headerConfig",get:function(){if(this.data.headerConfig)return this.data.headerConfig;var e={},t=this.headers;switch(t.length){case 1:e.middle=t[0];break;case 2:0===this.mainHeaderLevel?(e.middle=t[0],e.bottom=t[1]):(e.top=t[0],e.middle=t[1]);break;case 3:e.top=t[0],e.middle=t[1],e.bottom=t[2];break;default:throw new Error("headerConfig object not supported for >3 header levels")}return e}},{key:"mainHeaderLevel",set:function(e){this.data.mainHeaderLevel=e},get:function(){return"mainHeaderLevel"in this.data?this.data.mainHeaderLevel:3===this.data.headers.length?1:this.headers.length-1}},{key:"mainHeader",get:function(){return this.headers[this.mainHeaderLevel]}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"leafUnit",get:function(){return this.bottomHeader.unit}},{key:"mainUnit",get:function(){return this.mainHeader}},{key:"msPerPixel",get:function(){var e=this.bottomHeader;return Math.round(vt.asMilliseconds(e.increment||1,e.unit)/this.tickWidth)}},{key:"isValid",get:function(){var e=this,t=!0,n=!0,r=!1,i=void 0;try{for(var o,a=e.headers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t=t&&Boolean(vt.normalizeUnit(s.unit))}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e.timeResolution&&(t=t&&vt.normalizeUnit(e.timeResolution.unit)),e.shiftUnit&&(t=t&&vt.normalizeUnit(e.shiftUnit)),t}}],[{key:"fields",get:function(){return[{name:"rowHeight",defaultValue:24},{name:"tickWidth",defaultValue:50},{name:"tickHeight",defaultValue:50},{name:"displayDateFormat",defaultValue:"HH:mm"},{name:"shiftUnit",defaultValue:"hour"},{name:"shiftIncrement",defaultValue:1},{name:"defaultSpan",defaultValue:12},"timeResolution","headers","mainHeaderLevel","columnLinesFor"]}}]),t}(mi);mc._$name="ViewPreset";var pc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"createRecord",value:function(e){if(e.preset){var n=this.getById(e.preset)||yc.getById(e.preset);e=Object.setPrototypeOf(e,n.data)}return se()(oe()(t.prototype),"createRecord",this).apply(this,arguments)}},{key:"updateLocalization",value:function(){var e=this;se()(oe()(t.prototype),"updateLocalization",this).call(this),this.forEach((function(t){var n=e.L(t.id);n&&(n.displayDateFormat&&(t.displayDateFormat=n.displayDateFormat),n.middleDateFormat&&t.headerConfig.middle&&(t.headerConfig.middle.dateFormat=n.middleDateFormat),n.topDateFormat&&t.headerConfig.top&&(t.headerConfig.top.dateFormat=n.topDateFormat),n.bottomDateFormat&&t.headerConfig.bottom&&(t.headerConfig.bottom.dateFormat=n.bottomDateFormat))}))}},{key:"storage",set:function(e){var n=this;fn()(oe()(t.prototype),"storage",e,this,!0),this.storage.addSorter((function(e,t){var r=e.bottomHeader,i=t.bottomHeader;return(t.msPerPixel-e.msPerPixel||gt[r.unit]-gt[i.unit]||r.increment-i.increment)*n.zoomOrder}))},get:function(){return se()(oe()(t.prototype),"storage",this)}}],[{key:"defaultConfig",get:function(){return{useRawData:!0,modelClass:mc,zoomOrder:1}}}]),t}(Ve(Fi));pc._$name="PresetStore";var yc=new(function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getById",value:function(e){return se()(oe()(t.prototype),"getById",this).call(this,e)||this.basePresets[e]}},{key:"registerPreset",value:function(e,t){var n=this.createRecord(Object.assign({id:e},t)),r=this.find((function(e){return e.equals(n)}));if(r)return r;if(!n.isValid)throw new Error("Invalid preset, please check your configuration");return this.add(n),n}},{key:"getPreset",value:function(e){return"number"==typeof e&&(e=this.getAt(e)),"string"==typeof e?e=this.getById(e):e instanceof mc||(e=this.createRecord(e)),e}},{key:"normalizePreset",value:function(e){if(!(e instanceof mc))if("string"==typeof e){if(!(e=this.getPreset(e)))throw new Error("You must define a valid view preset. See PresetManager for reference")}else if("object"===U()(e)){if(e.base){var t=this.getById(e.base);if(!t)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=kt.merge(kt.clone(t.data),e)}e.id?e=this.createRecord(e):(e=this.createRecord(kt.assign({},e))).id=e.generateId(e)}return e}},{key:"deletePreset",value:function(e){"string"==typeof e?e=this.getById(e):"number"==typeof e&&(e=this.getAt(e)),e&&(this.remove(e),delete this.basePresets[e.id])}},{key:"basePresets",set:function(e){var t=this._basePresets={};for(var n in e)e[n].id=n,t[n]=this.createRecord(e[n])},get:function(){return this._basePresets}},{key:"defaultPresets",set:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="string"==typeof r,o=i?r:r.preset,a=void 0;if(i)a=this.basePresets[o];else{var s=Object.setPrototypeOf(kt.clone(this.basePresets[o].data),{id:o}),l=s.timeResolution,u=s.headers[s.headers.length-1];s.id=void 0,"width"in r&&(s.tickWidth=r.width),"height"in r&&(s.tickHeight=r.height),"increment"in r&&(u.increment=r.increment),"resolution"in r&&(l.increment=r.resolution),"resolutionUnit"in r&&(l.unit=vt.getUnitByName(r.resolutionUnit)),a=this.createRecord(s)}this.add(a)}}}],[{key:"defaultConfig",get:function(){return{preventSubClassingModel:!0,basePresets:{secondAndMinute:{name:"Seconds",tickWidth:30,tickHeight:40,displayDateFormat:"ll LTS",shiftIncrement:10,shiftUnit:"minute",defaultSpan:24,timeResolution:{unit:"second",increment:5},headers:[{unit:"minute",dateFormat:"llll"},{unit:"second",increment:10,dateFormat:"ss"}]},minuteAndHour:{name:"Minutes",tickWidth:60,tickHeight:60,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"hour",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"hour",dateFormat:"ddd MM/DD, hA"},{unit:"minute",increment:30,dateFormat:"mm"}]},hourAndDay:{name:"Hours",tickWidth:70,tickHeight:40,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"day",dateFormat:"ddd DD/MM"},{unit:"hour",dateFormat:"LT"}]},day:{name:"Hours 2",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:1,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"day",dateFormat:"ddd DD/MM",splitUnit:"day"},{unit:"hour",renderer:function(e){return'\n                                    <div class="b-sch-calendarcolumn-ct"><span class="b-sch-calendarcolumn-hours">'.concat(vt.format(e,"HH"),'</span>\n                                    <span class="b-sch-calendarcolumn-minutes">').concat(vt.format(e,"mm"),"</span></div>\n                                ")}}]},week:{name:"Week/hours",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"week",defaultSpan:24,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"D d",splitUnit:"day"},{unit:"hour",dateFormat:"LT",renderer:function(e){return'\n                                    <div class="sch-calendarcolumn-ct">\n                                    <span class="sch-calendarcolumn-hours">'.concat(vt.format(e,"HH"),'</span>\n                                    <span class="sch-calendarcolumn-minutes">').concat(vt.format(e,"mm"),"</span>\n                                    </div>\n                                ")}}]},dayAndWeek:{name:"Days 2",tickWidth:100,tickHeight:80,displayDateFormat:"ll LT",shiftUnit:"day",shiftIncrement:1,defaultSpan:5,timeResolution:{unit:"hour",increment:1},headers:[{unit:"week",renderer:function(e){return vt.getShortNameOfUnit("week")+"."+vt.format(e,"WW MMM YYYY")}},{unit:"day",dateFormat:"dd DD"}]},weekAndDay:{name:"Days",tickWidth:100,tickHeight:80,displayDateFormat:"ll hh:mm A",shiftUnit:"week",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"YYYY MMMM DD"},{unit:"day",increment:1,dateFormat:"DD MMM"}]},weekAndMonth:{name:"Weeks",tickWidth:100,tickHeight:105,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:5,defaultSpan:6,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"MMM YYYY"},{unit:"week",dateFormat:"DD MMM"}]},weekAndDayLetter:{name:"Weeks 2",tickWidth:20,tickHeight:50,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"ddd DD MMM YYYY",verticalColumnWidth:115},{unit:"day",dateFormat:"d1",verticalColumnWidth:25}]},weekDateAndMonth:{name:"Weeks 3",tickWidth:30,tickHeight:40,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"YYYY MMMM"},{unit:"week",dateFormat:"DD"}]},monthAndYear:{name:"Months",tickWidth:110,tickHeight:110,displayDateFormat:"ll",shiftIncrement:3,shiftUnit:"month",defaultSpan:12,timeResolution:{unit:"day",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"month",dateFormat:"MMM YYYY"}]},year:{name:"Years",tickWidth:100,tickHeight:100,resourceColumnWidth:100,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"month",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"quarter",renderer:function(e,t,n){return vt.getShortNameOfUnit("quarter").toUpperCase()+(Math.floor(e.getMonth()/3)+1)}}]},manyYears:{name:"Years 2",tickWidth:40,tickHeight:50,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"year",increment:1},mainHeaderLevel:0,headers:[{unit:"year",dateFormat:"YYYY",increment:5},{unit:"year",dateFormat:"YY",increment:1}]}},defaultPresets:["manyYears",{width:80,increment:1,resolution:1,preset:"manyYears",resolutionUnit:"YEAR"},"year",{width:30,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:50,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:200,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},"monthAndYear","weekDateAndMonth","weekAndMonth","weekAndDayLetter","weekAndDay",{width:54,increment:1,resolution:1,preset:"weekAndDay",resolutionUnit:"HOUR"},"hourAndDay",{width:64,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:100,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:64,increment:2,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},"minuteAndHour",{width:30,increment:15,resolution:5,preset:"minuteAndHour"},{width:130,increment:15,resolution:5,preset:"minuteAndHour"},{width:60,increment:5,resolution:5,preset:"minuteAndHour"},{width:100,increment:5,resolution:5,preset:"minuteAndHour"},"secondAndMinute",{width:60,increment:10,resolution:5,preset:"secondAndMinute"},{width:130,increment:5,resolution:5,preset:"secondAndMinute"}],listeners:{locale:"updateLocalization"}}}}]),t}(pc)),kc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;if(n.generateTicksValidatorFn=function(){return!0},se()(oe()(t.prototype),"construct",this).call(this,e),n.originalContinuous=n.continuous,n.on({change:function(e){"filter"!==e.action&&n.trigger("reconfigure",{supressRefresh:!1})},refresh:function(){return n.trigger("reconfigure",{supressRefresh:!1})},endreconfigure:function(e){return n.trigger("reconfigure",e)}}),n.startDate)n.internalOnReconfigure(),n.trigger("reconfigure");else if(n.viewPreset){var r=n.getAdjustedDates(new Date);n.startDate=r.startDate,n.endDate=r.endDate}}},{key:"reconfigure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getAdjustedDates(e.startDate,e.endDate);if(!1!==r.trigger("beforeReconfigure",{startDate:i.startDate,endDate:i.endDate,config:e})){if(r.trigger("beginReconfigure"),r._configuredStartDate=e.startDate,r._configuredEndDate=e.endDate,Object.assign(r,e),!1===r.internalOnReconfigure(n))return!1;r.trigger("endReconfigure",{suppressRefresh:t,config:e})}}},{key:"internalOnReconfigure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.isConfigured=!0;var n=t.getAdjustedDates(t.startDate,t.endDate,!0),r=t.getAdjustedDates(t.startDate,t.endDate),i=r.startDate,o=r.endDate;if(i>=o)throw new Error("Invalid start/end dates. Start date must less than end date. Start date: ".concat(i,". End date: ").concat(o,"."));var a=t.unit,s=t.increment||1,l=t.generateTicks(i,o,a,s);t.suspendEvents(),t.data=l;var u=t.count;if(0===u){if(e)return t.resumeEvents(),!1;throw new Error("Invalid time axis configuration or filter, please check your input data.")}t.startDate=t.first.startDate,t.resumeEvents();var c=t.last.endDate;t.isContinuous?(t.adjustedStart=n.startDate,t.adjustedEnd=vt.getNext(u>1?l[u-1].startDate:n.startDate,a,s,t.weekStartDay)):(t.adjustedStart=t.startDate,t.adjustedEnd=c);do{t.visibleTickStart=(t.startDate-t.adjustedStart)/(vt.asMilliseconds(a)*s),t.autoAdjust&&(t.visibleTickStart=Math.floor(t.visibleTickStart)),t.visibleTickStart>=1&&(t.adjustedStart=vt.getNext(t.adjustedStart,a,s,t.weekStartDay))}while(t.visibleTickStart>=1);do{t.visibleTickEnd=u-(t.adjustedEnd-c)/(vt.asMilliseconds(a)*s),u-t.visibleTickEnd>=1&&(t.adjustedEnd=vt.getNext(t.adjustedEnd,a,-1,t.weekStartDay))}while(u-t.visibleTickEnd>=1);t.updateTickCache(!0)}},{key:"setTimeSpan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getAdjustedDates(e,t),o=i.startDate,a=i.endDate;if(r.startDate-o!=0||r.endDate-a!=0)return r.reconfigure({startDate:o,endDate:a},!1,n)}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shiftUnit,n=this,r=n.startDate,i=n.endDate;n.isFiltered&&(r=n.allRecords[0].startDate,i=n.allRecords[n.allCount-1].endDate);var o=0;do{r=vt.add(r,e,t),i=vt.add(i,e,t)}while(o++<100&&!1===n.setTimeSpan(r,i,!0))}},{key:"shiftNext",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(e)}},{key:"shiftPrevious",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(-e)}},{key:"filterBy",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=this;r.filters.clear(),se()(oe()(t.prototype),"filterBy",this).call(this,(function(t,r){return e.call(n,t.data,r)})),0===r.count&&(r.trigger("invalidFilter"),r.clearFilters())}},{key:"triggerFilterEvent",value:function(e){e.filters.count?this.continuous=!1:this.continuous=this.originalContinuous,this.updateTickCache(),se()(oe()(t.prototype),"triggerFilterEvent",this).call(this,e)}},{key:"getAdjustedDates",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return e=e||r.startDate,t=t||vt.add(e,r.defaultSpan,r.mainUnit),r.autoAdjust||n?{startDate:r.floorDate(e,!1,r.autoAdjust?r.mainUnit:r.unit,1),endDate:r.ceilDate(t,!1,r.autoAdjust?r.mainUnit:r.unit,1)}:{startDate:e,endDate:t}}},{key:"floorDate",value:function(e,t,n,r){var i=this,o=(t=!1!==t)?vt.clone(i.startDate):null,a=r||i.resolutionIncrement,s=n||(t?i.resolutionUnit:i.mainUnit),l=function(e,t){return Math.floor(e/t)*t};if(t){var u=l(vt.diff(o,e,s),a);return vt.add(o,u,s)}var c=vt.clone(e);if("week"===s){var d=c.getDay()||7,h=i.weekStartDay||7;(c=vt.add(vt.startOf(c,"day"),d>=h?h-d:-(7-h+d),"day")).getDay()!==h&&23===c.getHours()&&(c=vt.add(c,1,"hour"))}else{c=vt.startOf(c,s);var f=["day","year"].includes(s)?1:0,g="day"===s?"date":s,v=l(vt.get(c,g)-f,a)+f;c=vt.set(c,g,v)}return c}},{key:"roundDate",value:function(e,t){var n=this,r=vt.clone(e),i=n.resolutionIncrement||1;switch(t=vt.clone(t||n.startDate),n.resolutionUnit){case"week":vt.startOf(r,"day");var o,a=r.getDay()-n.weekStartDay;return a<0&&(a=7+a),o=1===Math.round(a/7)?7-a:-a,vt.add(r,o,"day");case"month":var s=vt.diff(t,r,"month")+vt.as("month",r.getDay()/vt.daysInMonth(r)),l=Math.round(s/i)*i;return vt.add(t,l,"month");case"quarter":return vt.startOf(r,"month"),vt.add(r,"month",3-r.getMonth()%3);default:var u=vt.as(n.resolutionUnit,vt.diff(t,r)),c=vt.as(n.resolutionUnit,t.getTimezoneOffset()-r.getTimezoneOffset(),"minute"),d=Math.round((u+c)/i)*i;return vt.add(t,d-c,n.resolutionUnit)}}},{key:"ceilDate",value:function(e,t,n,r){t=!1!==t,r=r||(t?this.resolutionIncrement:1);var i=vt.clone(e),o=!1,a=n||(t?this.resolutionUnit:this.mainUnit);switch(a){case"minute":o=!vt.isStartOf(i,"minute");break;case"hour":o=!vt.isStartOf(i,"hour");break;case"day":case"date":o=!vt.isStartOf(i,"day");break;case"week":o=(i=vt.startOf(i,"day")).getDay()!==this.weekStartDay||!vt.isEqual(i,e);break;case"month":o=1!==(i=vt.startOf(i,"day")).getDate()||!vt.isEqual(i,e);break;case"quarter":o=(i=vt.startOf(i,"day")).getMonth()%3!=0||1!==i.getDate()||!vt.isEqual(i,e);break;case"year":o=0!==(i=vt.startOf(i,"day")).getMonth()||1!==i.getDate()||!vt.isEqual(i,e)}return o?vt.getNext(i,a,r,this.weekStartDay):i}},{key:"processExclusion",value:function(e,t,n){var r=this.include;return!!r&&Object.entries(r).some((function(r){var i=fe()(r,2),o=i[0],a=i[1];if(!a)return!1;var s=a.from,l=a.to;if(vt.compareUnits("day",n)>=0&&vt.getLargerUnit(o)===n&&(s&&vt.set(e,o,s),l)){var u,c=n;"day"===n&&(c="date"),vt.set(t,(u={},$()(u,c,vt.get(t,c)-1),$()(u,o,l),u))}if(vt.compareUnits(o,n)>=0){var d="day"===o?e.getDay():vt.get(e,o);if(s&&d<s||l&&d>=l)return!0}}))}},{key:"initExclusion",value:function(){Object.entries(this.include).forEach((function(e){var t=fe()(e,2),n=t[0],r=t[1];if(r){var i=r.from,o=r.to;r.lengthFactor=vt.getUnitToBaseUnitRatio(n,vt.getLargerUnit(n))/(o-i),r.lengthFactorExcl=vt.getUnitToBaseUnitRatio(n,vt.getLargerUnit(n))/(o-i-1),r.center=i+i/(r.lengthFactor-1)}}))}},{key:"generateTicks",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.unit,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.increment,s=this,l=[],u=Boolean(s.include),c=0,d=s.getAdjustedDates(e,t),h=d.startDate,f=d.endDate;for(s.tickCache={},u&&s.initExclusion();h<f;){if(n=vt.getNext(h,o,a,s.weekStartDay),!s.autoAdjust&&n>f&&(n=f),"hour"===o&&a>1&&l.length>0&&0===c){var g=l[l.length-1];0!==(c=(g.startDate.getHours()+a)%24-g.endDate.getHours())&&(n=vt.add(n,c,"hour"))}i=!1,u?(r=new Date(n.getTime()),i=s.processExclusion(h,n,o)):r=n,s.generateTicksValidatorFn(h)&&!i&&(l.push({id:l.length+1,startDate:h,endDate:n}),s.tickCache[h.getTime()]=l.length-1),h=r}return l}},{key:"getTickFromDate",value:function(e){var t,n,r,i,o=this.records,a=0,s=o.length-1;if(!o.length||e<o[0].startDate||e>o[s].endDate)return-1;if(this.isContinuous){for(;a<s;)e>o[t=a+s+1>>1].endDate?a=t+1:e<o[t].startDate?s=t-1:a=t;return r=(n=o[a]).startDate,i=n.endDate,e>r&&(a+=(e-r)/(i-r)),Math.min(Math.max(a,this.visibleTickStart),this.visibleTickEnd)}for(var l=0;l<=s;l++)if(e<=(i=o[l].endDate))return n=l+(e>(r=o[l].startDate)?(e-r)/(i-r):0)}},{key:"getDateFromTick",value:function(e,t){var n=this;if(e===n.visibleTickEnd)return n.endDate;var r=Math.floor(e),i=e-r,o=n.getAt(r);if(!o)return null;var a=0===r?n.adjustedStart:o.startDate,s=r===n.count-1&&n.isContinuous?n.adjustedEnd:o.endDate,l=vt.add(a,i*(s-a),"millisecond");return t&&(l=n[t+"Date"](l)),l}},{key:"updateTickCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.count?(t._start=t.first.startDate,t._end=t.last.endDate,t._startMS=t.startDate.getTime(),t._endMS=t.endDate.getTime()):t._start=t._end=t._startMs=t._endMS=null,e||(t.tickCache={},t.forEach((function(e,n){return t.tickCache[e.startDate.getTime()]=n})))}},{key:"dateInAxis",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.startDate,i=n.endDate;if(n.isContinuous)return t?vt.betweenLesserEqual(e,r,i):vt.betweenLesser(e,r,i);for(var o,a,s,l=n.getCount(),u=0;u<l;u++)if(o=(s=n.getAt(u)).startDate,a=s.endDate,t&&e<=a||!t&&e<a)return e>=o;return!1}},{key:"timeSpanInAxis",value:function(e,t){var n=this;return t.getTime()===e.getTime()?this.dateInAxis(e,!0):n.isContinuous?vt.intersectSpans(e,t,n.startDate,n.endDate):e<n.startDate&&t>n.endDate||n.getTickFromDate(e)!==n.getTickFromDate(t)}},{key:"isTimeSpanInAxis",value:function(e){var t=this,n=e.startDateMS,r=e.endDateMS;return!(!n||!r)&&(r===n?this.dateInAxis(e.startDate,!0):t.isContinuous?r>t.startMS&&n<t.endMS:n<t.startMS&&r>t.endMS||t.getTickFromDate(e.startDate)!==t.getTickFromDate(e.endDate))}},{key:"forEachAuxInterval",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this,o=this.endDate,a=this.startDate,s=0;if(a>o)throw new Error("Invalid time axis configuration");for(;a<o;)t=vt.min(vt.getNext(a,e,n,this.weekStartDay),o),r.call(i,a,t,s),a=t,s++}},{key:"isTimeAxis",get:function(){return!0}},{key:"viewPreset",get:function(){return this._viewPreset},set:function(e){if(!((e=yc.getPreset(e))instanceof mc))throw new Error("TimeAxis must be configured with the ViewPreset instance that the Scheduler is using");this._viewPreset=e,Object.assign(this,{unit:e.bottomHeader.unit,increment:e.bottomHeader.increment||1,resolutionUnit:e.timeResolution.unit,resolutionIncrement:e.timeResolution.increment,mainUnit:e.mainHeader.unit,shiftUnit:e.shiftUnit,shiftIncrement:e.shiftIncrement||1,defaultSpan:e.defaultSpan||1,presetName:e.id,headers:e.headers})}},{key:"resolution",get:function(){return{unit:this.resolutionUnit,increment:this.resolutionIncrement}},set:function(e){this.resolutionUnit=e.unit,this.resolutionIncrement=e.increment}},{key:"resolutionUnit",get:function(){return this._resolutionUnit},set:function(e){this._resolutionUnit=e}},{key:"resolutionIncrement",get:function(){return this._resolutionIncrement},set:function(e){this._resolutionIncrement=e||1}},{key:"mainUnit",set:function(e){this._mainUnit=e},get:function(){return this._mainUnit}},{key:"shiftUnit",set:function(e){this._shiftUnit=e},get:function(){return this._shiftUnit||this._mainUnit}},{key:"shiftIncrement",set:function(e){this._shiftIncrement=e},get:function(){return this._shiftIncrement||1}},{key:"unit",set:function(e){this._unit=e},get:function(){return this._unit}},{key:"increment",set:function(e){this._increment=e},get:function(){return this._increment}},{key:"defaultSpan",get:function(){return this._defaultSpan},set:function(e){this._defaultSpan=e}},{key:"isContinuous",get:function(){return!1!==this.continuous&&!this.filtered}},{key:"startDate",get:function(){return this._start||(this.first?new Date(this.first.startDate):null)},set:function(e){this._start=vt.parse(e)}},{key:"endDate",get:function(){return this._end||(this.last?new Date(this.last.endDate):null)},set:function(e){e&&(this._end=vt.parse(e))}},{key:"startMS",get:function(){return this._startMS}},{key:"endMS",get:function(){return this._endMS}},{key:"include",get:function(){return this._include},set:function(e){var t=this;t._include=e,t.continuous=!e,t.isConfiguring||(t.startDate=t._configuredStartDate,t.endDate=t._configuredEndDate,t.internalOnReconfigure(),t.trigger("includeChange"))}},{key:"visibleTickTimeSpan",get:function(){return this.isContinuous?this.visibleTickEnd-this.visibleTickStart:this.count}},{key:"ticks",get:function(){return this.records}}],[{key:"defaultConfig",get:function(){return{modelClass:Hu,continuous:!0,originalContinuous:null,include:null,autoAdjust:!0,unit:null,increment:null,resolutionUnit:null,resolutionIncrement:null,weekStartDay:null,mainUnit:null,shiftUnit:null,shiftIncrement:1,adjustedStart:null,adjustedEnd:null,visibleTickStart:null,visibleTickEnd:null,defaultSpan:1,tickCache:{},viewPreset:null}}}]),t}(Fi);kc._$name="TimeAxis";var bc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){e.useBackgroundCanvas=!0,se()(oe()(t.prototype),"construct",this).call(this,e,n),this.timeAxisViewModel=e.timeAxisViewModel,e.on({theme:"onThemeChange",thisObj:this})}},{key:"doDestroy",value:function(){this.timeAxisViewModelDetatcher&&this.timeAxisViewModelDetatcher(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.isConfiguring||(e?(rn.removeEachSelector(this.client.backgroundCanvas,".b-column-line-major"),this.client.backgroundCanvas.style.backgroundImage="none"):this.drawLines()),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"getColorsFromCSS",value:function(){var e=this;if(!e.GotColors){var t=rn.createElement({style:"position: absolute; visibility: hidden",html:'<div class="b-column-line"></div><div class="b-column-line-major"></div>',parent:document.body}),n=rn.getStyleValue(t.firstElementChild,"border-left-color"),r=rn.getStyleValue(t.lastElementChild,"border-left-color"),i=rn.getStyleValue(t.firstElementChild,"border-left-style"),o=rn.getStyleValue(t.lastElementChild,"border-left-style");n&&(e.tickColor=n),r&&(e.majorTickColor=r),i&&(e.tickStyle=i),o&&(e.majorTickStyle=o),t.remove(),e.GotColors=!0}}},{key:"onThemeChange",value:function(){this.GotColors=!1,this.render()}},{key:"render",value:function(){this.getColorsFromCSS(),this.drawLines()}},{key:"drawLines",value:function(){if(this.client.timeAxis.startDate){var e=this,t=e.client,n=t.timeAxis,r=n.startDate,i=t.timeAxisViewModel,o=i.tickSize,a=t.backgroundCanvas,s=document.createElement("canvas"),l=s.getContext("2d"),u=i.columnLinesFor,c=i.headers[u],d=i.headers,h=d[d.indexOf(c)-1]||d[0],f=d[d.length-1],g=n.floorDate(r,!1,h.unit,"year"===h.unit?1:h.increment||1),v=vt.getNext(g,h.unit,h.increment||1,n.weekStartDay),m=Math.round(vt.getDurationInUnit(g,v,f.unit))/(f.increment||1),p=Math.round(vt.getDurationInUnit(g,v,c.unit))/(c.increment||1),y=m/p;if(t.isHorizontal){if(r){var k=d.length>1&&vt.doesUnitsAlign(h.unit,c.unit),b=k?g:n.floorDate(r,!1,c.unit,c.increment),w=n.isContinuous?vt.getDurationInUnit(b,r,f.unit,!0)/n.increment*o:0;rn.removeEachSelector(a,".b-column-line-major");var S=!1,C=!0;c!==h&&k&&"day"===f.unit&&-1!==vt.compareUnits(h.unit,"month")&&(C=!1,n.forEachAuxInterval(h.unit,h.increment,(function(e,t){rn.append(a,{tag:"div",className:"b-column-line-major",style:"left:".concat(i.getPositionFromDate(t)-1,"px;")})}))),s.width=Math.min(2*m*o,32767),s.height=20,l.translate(-.5,-.5),l.lineWidth=2;for(var E=0;E<p;E++){var x=(S=0===E&&(h!==c&&k&&C&&n.isContinuous))&&e.majorTickStyle||!S&&e.tickStyle;if("solid"!==x)switch(x){case"dashed":l.setLineDash([6,4]);break;case"dotted":l.setLineDash([2,3])}l.beginPath(),l.strokeStyle=S?e.majorTickColor:e.tickColor,l.moveTo(E*y*o*2+10-1,0),l.lineTo(E*y*o*2+10-1,22),l.stroke()}a.style.backgroundImage="url(".concat(s.toDataURL(),")"),a.style.backgroundSize="".concat(s.width/2,"px"),a.style.backgroundPositionX="".concat(-(5+w),"px")}}else{if(s.width=2*t.timeAxisColumn.resourceColumns.columnWidth,s.height=2,l.translate(-.5,-.5),l.lineWidth=2,r){if(rn.removeEachSelector(a,".b-column-line-major"),c!==h&&n.forEachAuxInterval(h.unit,h.increment,(function(e,t){rn.append(a,{tag:"div",className:"b-column-line-major",style:"top:".concat(i.getPositionFromDate(t)-1,"px;")})})),"solid"!==e.tickStyle)switch(e.tickStyle){case"dashed":l.setLineDash([6,4]);break;case"dotted":l.setLineDash([2,3])}var D=y*o*2;s.height=D,l.beginPath(),l.strokeStyle=e.tickColor,l.lineWidth=2,l.moveTo(0,D-1),l.lineTo(s.width+2,D-1),l.stroke()}l.beginPath(),l.strokeStyle=e.tickColor,l.moveTo(s.width-1,0),l.lineTo(s.width-1,s.height+2),l.stroke(),a.style.backgroundImage="url(".concat(s.toDataURL(),")"),a.style.backgroundSize="".concat(s.width/2,"px"),a.style.backgroundPositionX="0"}}}},{key:"updateCanvasSize",value:function(){this.disabled||this.drawLines()}}],[{key:"$name",get:function(){return"ColumnLines"}},{key:"properties",get:function(){return{tickColor:"#e6e6e6",majorTickColor:"#999",tickStyle:"solid",majorTickStyle:"solid"}}},{key:"pluginConfig",get:function(){return{after:["render","updateCanvasSize"]}}}]),t}(ai);bc._$name="ColumnLines",Xs.registerFeature(bc,!0,["Scheduler","Gantt"]);n(179);var wc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"findPath",value:function(e,t){var n,r,i,o,a,s,l,u,c,d,h,f,g,v,m,p,y,k,b,w,S,C,E,x,D,T,R,M,F,_,A,I=this;for(t&&!Array.isArray(t)&&(t=[t]),A=0;e&&!_;)for(r=(n=Object.assign(I.config,e)).startBox,i=n.endBox,o=n.startShift,a=n.endShift,s=n.startSide,l=n.endSide,u=n.startArrowSize,c=n.endArrowSize,d=n.startArrowMargin,h=n.endArrowMargin,f=n.horizontalMargin,g=n.verticalMargin,v=n.hasOwnProperty("startHorizontalMargin")?n.startHorizontalMargin:f,m=n.hasOwnProperty("startVerticalMargin")?n.startVerticalMargin:g,p=n.hasOwnProperty("endHorizontalMargin")?n.endHorizontalMargin:f,y=n.hasOwnProperty("endVerticalMargin")?n.endVerticalMargin:g,k=n.hasOwnProperty("otherHorizontalMargin")?n.otherHorizontalMargin:f,b=n.hasOwnProperty("otherVerticalMargin")?n.otherVerticalMargin:g,w=n.otherBoxes,s=I.normalizeSide(s),l=I.normalizeSide(l),S=I.getConnectionCoordinatesFromBoxSideShift(r,s,o),C=I.getConnectionCoordinatesFromBoxSideShift(i,l,a),R=I.calcGridBaseBoxFromBoxAndDrawParams(r,s,u,d,v,m),M=I.calcGridBaseBoxFromBoxAndDrawParams(i,l,c,h,p,y),w=w&&w.map((function(e){return I.calcGridBaseBoxFromBoxAndDrawParams(e,!1,0,0,k,b)})),E=I.getConnectionCoordinatesFromBoxSideShift(R,s,o),x=I.getConnectionCoordinatesFromBoxSideShift(M,l,a),F=I.buildPathGrid(R,M,E,x,s,l,w),D=I.convertDecartPointToGridPoint(F,E),T=I.convertDecartPointToGridPoint(F,x),_=I.findPathOnGrid(F,D,T,s,l),e=!1;!_&&!e&&t&&A<t.length;A++)e=t[A](n);return _&&(_=I.prependPathWithArrowStaffSegment(_,S,u,s),_=I.appendPathWithArrowStaffSegment(_,C,c,l),_=I.optimizePath(_)),_}},{key:"getConnectionCoordinatesFromBoxSideShift",value:function(e,t,n){var r;switch(t){case"left":r={x:e.start,y:(e.top+e.bottom)/2+n};break;case"right":r={x:e.end,y:(e.top+e.bottom)/2+n};break;case"top":r={x:(e.start+e.end)/2+n,y:e.top};break;case"bottom":r={x:(e.start+e.end)/2+n,y:e.bottom}}return r}},{key:"calcGridBaseBoxFromBoxAndDrawParams",value:function(e,t,n,r,i,o){var a;switch(t){case"left":a={start:e.start-Math.max(n+r,i),end:e.end+i,top:e.top-o,bottom:e.bottom+o};break;case"right":a={start:e.start-i,end:e.end+Math.max(n+r,i),top:e.top-o,bottom:e.bottom+o};break;case"top":a={start:e.start-i,end:e.end+i,top:e.top-Math.max(n+r,o),bottom:e.bottom+o};break;case"bottom":a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+Math.max(n+r,o)};break;default:a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+o}}return a}},{key:"buildPathGrid",value:function(e,t,n,r,i,o,a){var s,l,u,c,d,h,f,g,v,m,p,y,k,b={},w=[];for(s=[e.start,"left"===i||"right"===i?(e.start+e.end)/2:n.x,e.end,t.start,"left"===o||"right"===o?(t.start+t.end)/2:r.x,t.end],l=[e.top,"top"===i||"bottom"===i?(e.top+e.bottom)/2:n.y,e.bottom,t.top,"top"===o||"bottom"===o?(t.top+t.bottom)/2:r.y,t.bottom],a&&a.forEach((function(e){s.push(e.start,(e.start+e.end)/2,e.end),l.push(e.top,(e.top+e.bottom)/2,e.bottom)})),s=G()(new Set(s.sort((function(e,t){return e-t})))),h=0,g=(l=G()(new Set(l.sort((function(e,t){return e-t}))))).length;h<g;++h)for(b[h]=b[h]||{},u=l[h],d=0,f=s.length;d<f;++d){if(y=((c=s[d])<=e.start||c>=e.end||u<=e.top||u>=e.bottom)&&(c<=t.start||c>=t.end||u<=t.top||u>=t.bottom),a)for(v=0,m=a.length;y&&v<m;++v)y=c<=(p=a[v]).start||c>=p.end||u<=p.top||u>=p.bottom||c===n.x&&u===n.y||c===r.x&&u===r.y;k={distance:Math.pow(2,53)-1,permitted:y,x:c,y:u,ix:d,iy:h},b[h][d]=k,w.push(k)}return{width:s.length,height:l.length,xs:s,ys:l,points:b,linearPoints:w}}},{key:"convertDecartPointToGridPoint",value:function(e,t){var n=e.xs.indexOf(t.x),r=e.ys.indexOf(t.y);return e.points[r][n]}},{key:"findPathOnGrid",value:function(e,t,n,r,i){var o=!1;return t.permitted&&n.permitted&&(e=this.waveForward(e,t,0),o=this.collectPath(e,n,i)),o}},{key:"getGridPointNeighbors",value:function(e,t,n){var r,i=t.ix,o=t.iy,a=[];return o<e.height-1&&(r=e.points[o+1][i],(!n||n(r))&&a.push(r)),o>0&&(r=e.points[o-1][i],(!n||n(r))&&a.push(r)),i<e.width-1&&(r=e.points[o][i+1],(!n||n(r))&&a.push(r)),i>0&&(r=e.points[o][i-1],(!n||n(r))&&a.push(r)),a}},{key:"waveForward",value:function(e,t,n){var r=this;return Ri.preWalkUnordered([t,n],(function(t){var n=fe()(t,2),i=n[0],o=n[1];return r.getGridPointNeighbors(e,i,(function(e){return e.permitted&&e.distance>o+1})).map((function(e){return[e,o+1]}))}),(function(e){var t=fe()(e,2),n=t[0],r=t[1];return n.distance=r})),e}},{key:"collectPath",value:function(e,t,n){for(var r,i,o,a,s=!0,l=[];s&&t.distance;)if(s=(r=this.getGridPointNeighbors(e,t,(function(e){return e.permitted&&e.distance==t.distance-1}))).length>0){switch(i=(r=r.sort((function(e,r){var i,o;i=e.ix-t.ix,o=e.iy-t.iy;var a=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;i=r.ix-t.ix,o=r.iy-t.iy;var s=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;return a>s?1:a<s?-1:a===s?e.y>r.y?-1:1:void 0})))[0],l.push({x1:i.x,y1:i.y,x2:t.x,y2:t.y}),o=i.ix-t.ix,a=i.iy-t.iy,!0){case!a&&o>0:n="left";break;case!a&&o<0:n="right";break;case!o&&a>0:n="top";break;case!o&&a<0:n="bottom"}t=i}return s&&l.reverse()||!1}},{key:"prependPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x2:(o=e[0]).x1,y2:o.y1},r){case"left":i.x1=t.x-n,i.y1=o.y1;break;case"right":i.x1=t.x+n,i.y1=o.y1;break;case"top":i.x1=o.x1,i.y1=t.y-n;break;case"bottom":i.x1=o.x1,i.y1=t.y+n}e.unshift(i)}return e}},{key:"appendPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x1:(o=e[e.length-1]).x2,y1:o.y2},r){case"left":i.x2=t.x-n,i.y2=o.y2;break;case"right":i.x2=t.x+n,i.y2=o.y2;break;case"top":i.x2=o.x2,i.y2=t.y-n;break;case"bottom":i.x2=o.x2,i.y2=t.y+n}e.push(i)}return e}},{key:"optimizePath",value:function(e){var t,n,r=[];if(e.length>0)for(t=e.shift(),r.push(t);e.length>0;)n=e.shift(),t.x1==n.x1&&t.y1==n.y1&&t.x2==n.x2&&t.y2==n.y2?t=n:t.y1-t.y2==0&&n.y1-n.y2==0?t.x2=n.x2:t.x1-t.x2==0&&n.x1-n.x2==0?t.y2=n.y2:(r.push(n),t=n);return r}},{key:"normalizeSide",value:function(e){return t.sideToSide[e]||e}}],[{key:"defaultConfig",get:function(){return{startSide:"right",startArrowSize:0,startArrowMargin:12,startShift:0,endSide:"left",endArrowSize:0,endArrowMargin:12,endShift:0,verticalMargin:2,horizontalMargin:5,otherBoxes:null}}},{key:"sideToSide",get:function(){return{l:"left",r:"right",t:"top",b:"bottom"}}}]),t}(z);wc._$name="RectangularPathFinder";n(181),n(144);var Sc=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"obtainResourceStore",value:function(e,t){return e.store}},{key:"obtainDependencyStore",value:function(e,t){return e.dependencyStore}},{key:"obtainAssignmentStore",value:function(e,t){return e.assignmentStore}},{key:"obtainEventStore",value:function(e,t){return e.eventStore}}],[{key:"defaultConfig",get:function(){return{dataLayerStores:["resourceStore","dependencyStore","assignmentStore","eventStore"]}}}]),t}(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"startConfigure",value:function(e){this.configDataLayer(this.client,e),se()(oe()(t.prototype),"startConfigure",this).call(this,e)}},{key:"doDestroy",value:function(){var e=this;return(this.dataLayerStores||[]).forEach((function(t){"columns"===t&&(t="columnStore"),e[t]=null})),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"configDataLayer",value:function(e,t){var n=this;return(t.dataLayerStores||[]).reduce((function(t,r){if("columnStore"===r||"columns"===r)r="columnStore",t.columnStore=t.columnStore||t.columns||n.obtainColumnStore(e,t);else{var i="obtain".concat(A.capitalizeFirstLetter(r)),o=n[i];t[r]=t[r]||o&&o.call(n,e,t)}return Reflect.has(n,r)||!Object.isExtensible(n)||Object.isSealed(n)||Object.isFrozen(n)||Object.defineProperty(n,r,{get:function(){return this["_".concat(r)]},set:function(e){this.setDataLayerStore(r,e)}}),t}),t)}},{key:"attachToDataLayer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this.dataLayerStores||[]).forEach((function(n){"columns"===n&&(n="columnStore");var r="obtain".concat(A.capitalizeFirstLetter(n)),i=e[r];e[n]&&!t||!i||(e[n]=i.call(e,e.client))}))}},{key:"setDataLayerStore",value:function(e,t){var n="_".concat(e),r="_".concat(e,"Detacher"),i="on".concat(A.capitalizeFirstLetter(e),"Change"),o="get".concat(A.capitalizeFirstLetter(e),"ListenersConfig");if(this[n]!==t&&(this[r]&&(this[r](),this[r]=null),this[i]&&this[i](t,this[n]),this[n]=t,t&&this[o])){var a=this[o]();a&&(this[r]=t.on(Object.assign({thisObj:this,detachable:!0},a)))}}},{key:"obtainStore",value:function(e,t){return e.store}},{key:"obtainColumnStore",value:function(e,t){return e.columns}}],[{key:"defaultConfig",get:function(){return{dataLayerStores:["store"]}}}]),t}(e||z)}(e||z))},Cc=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"addEventToResource",value:function(e){var t=e.event,n=e.resource,r=e.eventStore,i=e.assignmentStore;t=r.add(t)[0];var o=this.addAssignment({event:t,resource:n,assignmentStore:i}).assignment;return{event:t,assignment:o!==t?o:null}}},{key:"getEventDependencies",value:function(e){var t=e.event;return e.dependencyStore.getEventDependencies(t)}},{key:"getEventAssignments",value:function(e){var t=e.event;e.assignmentStore;return t.assignments||[]}},{key:"getEventResource",value:function(e){var t=e.event;e.resourceStore;return t.resource}},{key:"isEventAssignedToResource",value:function(e){var t=this,n=e.event,r=e.resource,i=e.resourceStore,o=e.assignmentStore;return o?this.getEventAssignments({event:n,assignmentStore:o}).some((function(e){return t.isAssignmentForResource({assignment:e,resource:r,resourceStore:i})})):n.resource===r}},{key:"assignEventToResource",value:function(e){var t,n=e.event,r=e.resource,i=e.assignmentStore;return i?t=i.add({eventId:n.id,resourceId:r.id})[0]:n.resourceId=r.id,t||n}}]),t}(e||z)},Ec=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"isAssignmentEventAssigned",value:function(e){return!!e.assignment.event}},{key:"isAssignmentResourceAssigned",value:function(e){return!!e.assignment.resource}},{key:"isAssignmentAssigned",value:function(e){var t=e.assignment;return!!t.event&&!!t.resource}},{key:"isAssignmentForResource",value:function(e){var t=e.assignment,n=e.resource;e.resourceStore;return t.resource===n}},{key:"getAssignmentResource",value:function(e){var t=e.assignment;e.resourceStore;return t.resource}},{key:"getAssignmentEvent",value:function(e){var t=e.assignment;e.eventStore;return t.event}},{key:"getAssignmentDependencies",value:function(e){var t=e.assignment,n=e.dependencyStore,r=t.event;return r?this.getEventDependencies({event:r,dependencyStore:n}):[]}},{key:"addAssignment",value:function(e){var t=e.event,n=e.resource,r=e.assignmentStore,i=e.assignmentConfig;return{assignment:r.add(Object.assign({},i,{eventId:t.id,resourceId:n.id}))[0]}}}]),t}(e||z)},xc=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getDependencySourceEvent",value:function(e){var t=e.dependency;e.eventStore;return t.sourceEvent}},{key:"getDependencyTargetEvent",value:function(e){var t=e.dependency;e.eventStore;return t.targetEvent}},{key:"getDependencySourceAssignments",value:function(e){var t=e.dependency,n=e.assignmentStore,r=t.sourceEvent;return r?this.getEventAssignments({event:r,assignmentStore:n}):[]}},{key:"getDependencyTargetAssignments",value:function(e){var t=e.dependency,n=e.assignmentStore,r=t.targetEvent;return r?this.getEventAssignments({event:r,assignmentStore:n}):[]}},{key:"getDependencyAssignments",value:function(e){var t=e.dependency,n=e.assignmentStore;[].concat(this.getDependencySourceAssignments({dependency:t,assignmentStore:n}),this.getDependencyTargetAssignments({dependency:t,assignmentStore:n}))}},{key:"getDependencyAssignmentsAsFromToArray",value:function(e){var t=e.dependency,n=e.assignmentStore,r=this.getDependencySourceAssignments({dependency:t,assignmentStore:n}),i=this.getDependencyTargetAssignments({dependency:t,assignmentStore:n});return r.reduce((function(e,t){return i.reduce((function(e,n){return e.push({from:t,to:n}),e}),e)}),[])}},{key:"isDependencySourceAssignment",value:function(e){var t=e.dependency,n=e.assignment;return t.from===n.eventId}},{key:"isDependnecyTargetAssignment",value:function(e){var t=e.dependency,n=e.assignment;return t.to===n.eventId}},{key:"isValidDependency",value:function(e){var t=e.sourceEvent,n=e.targetEvent,r=e.type;return e.dependencyStore.isValidDependency(t.id,n.id,r)}},{key:"createDependency",value:function(e){var t=e.sourceEvent,n=e.targetEvent,r=e.type,i=e.fromSide,o=e.toSide;return e.dependencyStore.add({from:t.id,to:n.id,type:r,fromSide:i,toSide:o})[0]}}]),t}(e||z)},Dc=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),t}(e||z)},Tc=function(e){var t,n=[Ec,xc,Cc,Dc],r=(t=pi(z)).mixes.apply(t,n);return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"dataApi",get:function(){return this._dataApi||(this._dataApi=new r({host:this.dataApiHost||this})),this._dataApi}}]),t}(e||z)};function Rc(){var e=Lr()(['\n             <table class="b-sch-dependency-tooltip">\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td>\n                        <div class="b-sch-box b-','"></div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td><div class="b-sch-box b-','"></div></td>\n                </tr>\n            </table>\n        ']);return Rc=function(){return e},e}var Mc=["left","left","right","right"],Fc=["left","right","left","right"],_c=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;if(e.isVertical)throw new Error("Dependencies feature is not supported in vertical mode");r.doScheduleDraw=r.createOnFrame("draw",[],r,!0),se()(oe()(t.prototype),"construct",this).call(this,e,n),r.pathFinder=new wc(r.pathFinderConfig),delete r.pathFinderConfig,r.lineDefAdjusters=r.createLineDefAdjusters()}},{key:"doDestroy",value:function(){this.tooltip&&this.tooltip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.updateCreateListeners(),this.client.isPainted&&this.draw(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"exposeSchedulerDependenciesProperty",value:function(){var e=this;e.dependenciesPropertyExposed&&delete e.client.dependencies,Object.defineProperty(e.client,"dependencies",{configurable:!0,get:function(){return e.dependencyStore.records},set:function(t){return e.dependencyStore.data=t}}),e.dependenciesPropertyExposed=!0}},{key:"getResourceStoreListenersConfig",value:function(){return{refresh:this.onRowStoreRefresh}}},{key:"obtainDependencyStore",value:function(e,n){var r=n&&n.store||se()(oe()(t.prototype),"obtainDependencyStore",this).call(this,e,n);return!0!==r&&r||(r=new this.storeClass),r}},{key:"getDependencyStoreListenersConfig",value:function(){return{change:this.onDependencyChange}}},{key:"onDependencyStoreChange",value:function(e,t){var n=this,r=n.client;n.resetGridCache(),n.resetBoundsCache(),r.dependencyStore=e,e&&(!n.dependenciesPropertyExposed&&r.dependencies&&(e.data=r.dependencies,delete r.dependencies),n.dependencies&&(e.data=n.dependencies,delete n.dependencies),e.metaMapId=r.id,e.eventStore=r.eventStore,n.exposeSchedulerDependenciesProperty())}},{key:"getAssignmentStoreListenersConfig",value:function(){return{change:this.onAssignmentChange,refresh:this.onAssignmentRefresh}}},{key:"getEventStoreListenersConfig",value:function(){return{change:this.onEventChange}}},{key:"createMarkers",value:function(){var e=this,t=e.client.svgCanvas,n=e.endMarker=e.initMarkerElement("arrowEnd","8","M0,0 L0,6 L9,3 z");if(ge.isEdge||ge.isIE11){var r=e.startMarker=e.initMarkerElement("arrowStart","1","M0,3 L9,6 L9,0 z");t.appendChild(r)}else n.setAttribute("orient","auto-start-reverse");t.appendChild(n)}},{key:"initMarkerElement",value:function(e,t,n){return rn.createElement({id:e,tag:"marker",ns:"http://www.w3.org/2000/svg",markerHeight:9,markerWidth:9,refX:t,refY:3,viewBox:"0 0 9 6",orient:"auto",markerUnits:"userSpaceOnUse",children:[{tag:"path",ns:"http://www.w3.org/2000/svg",d:n}]})}},{key:"createLineDefAdjusters",value:function(){var e=this.client;return[function(t){var n=!1;return(t.startArrowMargin>e.barMargin||t.endArrowMargin>e.barMargin)&&(t.startArrowMargin=t.endArrowMargin=e.barMargin,n=!0),n?t:n},function(e){var t=!1;return(e.startArrowMargin>0||e.endArrowMargin>0)&&(e.startArrowMargin=e.endArrowMargin=0,t=!0),t?e:t}]}},{key:"getElementForDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n='[depId="'.concat(e.id,'"]');return t&&(n+='[fromId="'.concat(t.from.id,'"][toId="').concat(t.to.id,'"]')),this.client.svgCanvas.querySelector(n)}},{key:"getDependencyForElement",value:function(e){var t="string"==typeof e?e:e.getAttribute("depId");return this.dependencyStore.getById(t)}},{key:"onToggleNode",value:function(){this.dependencyGridCache=null,this.scheduleDraw(!0)}},{key:"onViewportResize",value:function(){this.scheduleDraw(!0)}},{key:"onTranslateRow",value:function(e){var t=e.row;t.lastTop>=0&&t.top!==t.lastTop&&this.scheduleDraw(!0)}},{key:"onChangeTotalHeight",value:function(){this.scheduleDraw(!0)}},{key:"onHorizontalScroll",value:function(e){var t=e.subGrid;this.isDrawn&&t===this.client.timeAxisSubGrid&&this.scheduleDraw(!1)}},{key:"onVerticalScroll",value:function(){this.isDrawn&&this.scheduleDraw(!1)}},{key:"onRowsRefresh",value:function(){this.scheduleDraw(!0)}},{key:"onRowsRerender",value:function(){this.scheduleDraw(!0)}},{key:"onRowStoreRefresh",value:function(e){switch(e.action){case"sort":case"filter":case"batch":return this.dependencyGridCache=null,this.scheduleDraw(!0)}}},{key:"onDependencyChange",value:function(e){var t=e.action,n=e.record,r=e.records,i=this;if(i.client.isPainted&&!i.disabled){switch(t){case"dataset":i.dependencyGridCache={};case"add":var o=i._dependencyGridCache;return r.forEach((function(e){o&&i.addToGridCache(e)})),o||i._thisIsAUsedExpression(i.dependencyGridCache),void i.scheduleDraw();case"update":return i.scheduleRefreshDependency(n);case"remove":return r.forEach((function(e){i.releaseDependency(e,!0),i.removeFromCache(e)})),void i.client.trigger("dependenciesDrawn");case"removeall":case"filter":i.dependencyGridCache=null}i.scheduleDraw(!0)}}},{key:"onEventChange",value:function(e){var t=this,n=e.action,r=e.record;switch(n){case"filter":return this.scheduleDraw(!0);case"update":if(r.isEvent){var i=[r];r.resources.forEach((function(e){return i.push.apply(i,G()(e.events))})),new Set(i).forEach((function(e){return t.drawForTimeSpan(e,!0)}))}else this.drawForTimeSpan(r,!0);break;case"removeall":return this.resetGridCache(),this.scheduleDraw(!0)}}},{key:"onAssignmentRefresh",value:function(e){"dataset"===e.action&&(this.resetGridCache(),this.scheduleDraw(!0))}},{key:"onAssignmentChange",value:function(e){var t=this,n=e.action,r=e.record,i=e.records,o=this;r&&(i=[r]),"add"!==n&&"remove"!==n&&"update"!==n||i.forEach((function(e){t.dataApi.getAssignmentDependencies({assignment:e,dependencyStore:t.dependencyStore}).forEach((function(i){if("add"===n)o.scheduleRefreshDependency(i);else if("remove"===n){(t.dataApi.isDependencySourceAssignment({dependency:i,assignment:e})?t.dataApi.getDependencyTargetAssignments({dependency:i,assignmentStore:t.assignmentStore}).map((function(t){return{from:e,to:t}})):t.dataApi.getDependencySourceAssignments({dependency:i,assignmentStore:t.assignmentStore}).map((function(t){return{from:t,to:e}}))).forEach((function(e){o.releaseDependency(i,e),o.removeFromCache(i,e)}))}else"update"===n&&t.dataApi.getDependencyAssignmentsAsFromToArray({dependency:i,assignmentStore:t.assignmentStore}).filter((function(e){return e.from===r||e.to===r})).forEach((function(e){t.scheduleRefreshDependency(i,e)}))}))}))}},{key:"onElementClick",value:function(e){if(e.target.matches("."+this.baseCls)){var t=sl.get(e.target).dependency,n="click"===e.type?"Click":"DblClick";this.client.trigger("dependency".concat(n),{dependency:t,event:e})}}},{key:"onElementDblClick",value:function(e){return this.onElementClick(e)}},{key:"onElementMouseOver",value:function(e){var t=this;if(e.target.matches("."+t.baseCls)){var n=sl.get(e.target).dependency;t.client.trigger("dependencyMouseOver",{dependency:n,event:e}),t.overCls&&t.highlight(n,t.overCls)}}},{key:"onElementMouseOut",value:function(e){if(e.target.matches("."+this.baseCls)){var t=sl.get(e.target).dependency;this.client.trigger("dependencyMouseOut",{dependency:t,event:e}),this.overCls&&!t.meta.removed&&this.unhighlight(t)}}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementForDependency(e);n&&n.classList.add(t),e.highlight(t)}},{key:"unhighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementForDependency(e);n&&n.classList.remove(t),e.unhighlight(t)}},{key:"highlightEventDependencies",value:function(e){var t=this;e.allDependencies.forEach((function(e){return t.highlight(e)}))}},{key:"unhighlightEventDependencies",value:function(e){var t=this;e.allDependencies.forEach((function(e){return t.unhighlight(e)}))}},{key:"isDependencyVisible",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this,o=i.dataApi,a=i.resourceStore,s=i.eventStore,l=o.getDependencySourceEvent({dependency:e}),u=o.getDependencyTargetEvent({dependency:e});if(!l||!u)return!1;if(r){if(t=o.getAssignmentResource({assignment:r.from,resourceStore:a}),n=o.getAssignmentResource({assignment:r.to,resourceStore:a}),s.isFiltered&&(-1===s.indexOf(l)||-1===s.indexOf(u)))return!1}else t=o.getEventResource({event:l,resourceStore:a}),n=o.getEventResource({event:u,resourceStore:a});return l instanceof mi&&t instanceof Bu&&n instanceof Bu&&!t.instanceMeta(a).hidden&&!n.instanceMeta(a).hidden}},{key:"getBox",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.getTimeSpanRecordFromDependency(e,t);return n=r?this.dataApi.getAssignmentResource({assignment:r[t?"from":"to"],resourceStore:this.resourceStore}):this.dataApi.getEventResource({event:i,resourceStore:this.resoureStore}),this.client.getResourceEventBox(i,n,!0)}},{key:"getRowRecordFromDependency",value:function(e,t,n){return n?this.dataApi.getAssignmentResource({assignment:n[t?"from":"to"],resourceStore:this.resourceStore}):this.dataApi.getEventResource({event:this.getTimeSpanRecordFromDependency(e,t),resourceStore:this.resourceStore})}},{key:"getTimeSpanRecordFromDependency",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e["".concat(t?"source":"target","Event")]}},{key:"getMetaId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?"".concat(this.client.id,"-ass").concat(e.from.id,"-ass").concat(e.to.id):this.client.id}},{key:"getDependencyBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=n.client,i=e.getDateRange();if(!r.rowManager.rowCount||!n.isDependencyVisible(e,t))return null;if(!i||!vt.intersectSpans(i.start,i.end,r.startDate,r.endDate))return null;var o=n.getMetaId(t),a=e.instanceMeta(o);if(n._resetBoundsCache||!a.bounds||!a.bounds.layout){var s=n.getBox(e,!0,t),l=n.getBox(e,!1,t);if(!s||!l)return null;var u=n.getTimeSpanRecordFromDependency(e,!0),c=n.getTimeSpanRecordFromDependency(e,!1),d=s instanceof Oe?s:new Oe(s.start,s.top,s.end-s.start,s.bottom-s.top),h=l instanceof Oe?l:new Oe(l.start,l.top,l.end-l.start,l.bottom-l.top),f=Oe.union(d,h);[[u,d,s],[c,h,l]].map((function(e){var t=fe()(e,3),n=t[0],i=t[1],o=t[2];if("default"===r.milestoneLayoutMode&&n.isMilestone){!r.milestoneWidth&&o.eventEl&&(r.milestoneWidth=n.iconCls?o.eventEl.firstElementChild.offsetWidth:parseInt(window.getComputedStyle(o.eventEl,":before").fontSize));var a=r.milestoneWidth||i.height;i.left-=a/2,i.right+=a/2}})),a.bounds={bounds:f,startRectangle:d,endRectangle:h,layout:s.layout&&l.layout}}return e.instanceMeta(o).bounds}},{key:"getIteratableDependencyAssignments",value:function(e){return this.assignmentStore?this.dataApi.getDependencyAssignmentsAsFromToArray({dependency:e,assignmentStore:this.assignmentStore}):[null]}},{key:"addToGridCache",value:function(e){var t=this,n=t.dependencyGridCache,r=t.cacheGridSize,i=t.rowStore;t.getIteratableDependencyAssignments(e).forEach((function(o){var a=t.getDependencyBounds(e,o);if(a){var s,l,u,c=t.getMetaId(o),d=e.instanceMeta(c).gridCache=[],h=i.indexOf(t.getRowRecordFromDependency(e,!0,o)),f=i.indexOf(t.getRowRecordFromDependency(e,!1,o)),g=Math.min(h,f),v=Math.max(h,f),m=a.bounds,p=Math.floor(Math.max(m.x,0)/r.x),y=Math.floor(m.right/r.x),k=Math.floor(g/r.index),b=Math.floor(v/r.index);for(l=p;l<=y;l++)for(s=n[l]||(n[l]={}),u=k;u<=b;u++)(s[u]||(s[u]=[])).push({dependency:e,assignmentData:o,metaId:c}),d.push([l,u])}}))}},{key:"removeFromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;(t?[t]:this.getIteratableDependencyAssignments(e)).forEach((function(t){var r=n.getMetaId(t),i=e.instanceMeta(r);i.gridCache&&n._dependencyGridCache&&i.gridCache.forEach((function(r){var i=fe()(r,2),o=i[0],a=i[1];if(n._dependencyGridCache.hasOwnProperty(o)&&n._dependencyGridCache[o].hasOwnProperty(a)){var s=n._dependencyGridCache[o][a],l=s.findIndex((function(n){return n.dependency===e&&(n.assignmentData===t||n.assignmentData.from===t.from&&n.assignmentData.to===t.to)}));l>-1&&s.splice(l,1)}})),i.bounds=null,i.gridCache=null}))}},{key:"resetBoundsCache",value:function(){this._resetBoundsCache=!0}},{key:"resetGridCache",value:function(){this.dependencyGridCache=null}},{key:"prepareLineDef",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=this,r=n.getTimeSpanRecordFromDependency(e,!0),i=n.getTimeSpanRecordFromDependency(e,!1),o=e.type,a=e.fromSide,s=e.toSide;if(!a)switch(!0){case o===cc.Type.StartToEnd:case o===cc.Type.StartToStart:a=n.getConnectorStartSide(r);break;case o===cc.Type.EndToStart:case o===cc.Type.EndToEnd:a=n.getConnectorEndSide(r);break;default:throw new Error("Invalid dependency type: "+o)}if(!s)switch(!0){case o===cc.Type.StartToEnd:s=n.getConnectorEndSide(i);break;case o===cc.Type.StartToStart:case o===cc.Type.EndToStart:s=n.getConnectorStartSide(i);break;case o===cc.Type.EndToEnd:s=n.getConnectorEndSide(i);break;default:throw new Error("Invalid dependency type: "+o)}var l=t.startRectangle,u=t.endRectangle;return{startBox:{start:l.x,end:l.right,top:l.y,bottom:l.bottom},endBox:{start:u.x,end:u.right,top:u.y,bottom:u.bottom},startSide:a,endSide:s}}},{key:"drawLine",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.client,s=this.getMetaId(i),l=t.instanceMeta(s).lineElement;(l&&o||(l=document.createElementNS("http://www.w3.org/2000/svg","polyline"),o&&(t.instanceMeta(s).lineElement=l),l.setAttribute("depId",t.id),i&&(l.setAttribute("fromId",i.from.id),l.setAttribute("toId",i.to.id)),e.appendChild(l)),l.classList.length&&l.classList.remove.apply(l.classList,l.getAttribute("class").split(" ")),l.classList.add(this.baseCls),t.cls&&l.classList.add(t.cls),t.bidirectional&&l.classList.add("b-sch-bidirectional-line"),t.highlighted)&&(r=l.classList).add.apply(r,G()(t.highlighted.split(" ")));if(ge.isIE11){var u=t.getDateRange(!0),c=a.startDate;u.start<c&&l.classList.add("b-no-start-marker"),u.end<c&&l.classList.add("b-no-end-marker")}return l.setAttribute("points",n?n.map((function(e,t){return t!==n.length-1?"".concat(e.x1,",").concat(e.y1):"".concat(e.x1,",").concat(e.y1," ").concat(e.x2,",").concat(e.y2)})).join(" "):""),sl.set(l,{dependency:t}),l}},{key:"refreshDependency",value:function(e){var t=this,n=t.getIteratableDependencyAssignments(e);t.releaseDependency(e,null!==n[0]),t.removeFromCache(e),t.addToGridCache(e),n.forEach((function(n){return t.drawDependency(e,null,n)}))}},{key:"refreshDependencyAssignment",value:function(e,t){this.releaseDependency(e,t),this.removeFromCache(e,t),this.addToGridCache(e),this.drawDependency(e,null,t)}},{key:"scheduleRefreshDependency",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.dependenciesToRefresh;n?r.has(e)?!0!==r.get(e)&&r.get(e).add(n):r.set(e,new Set([n])):r.set(e,!0),1===r.size&&this.requestAnimationFrame((function(){t.refreshDependencyOnFrame()}))}},{key:"refreshDependencyOnFrame",value:function(){var e=this,t=e.dependenciesToRefresh;e.client.isPainted&&(t.forEach((function(t,n){if(!0===t){var r=e.getIteratableDependencyAssignments(n);e.releaseDependency(n,null!==r[0]),e.removeFromCache(n)}else t.forEach((function(t){e.releaseDependency(n,t),e.removeFromCache(n,t)}))})),t.forEach((function(t,n){e.addToGridCache(n)})),t.forEach((function(t,n){!0===t&&(t=e.getIteratableDependencyAssignments(n)),t.forEach((function(t){e.drawDependency(n,null,t)}))})),t.clear(),e.client.trigger("dependenciesDrawn",{partial:!0}))}},{key:"drawDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.client.svgCanvas,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this,a=o.drawnDependencies,s=o.oldDrawnDependencies,l=t||o.getDependencyBounds(e,n),u=function(t){return t.dependency===e&&(t.assignmentData===n||t.assignmentData&&t.assignmentData.from===n.from&&t.assignmentData.to===n.to)};if(!o.disabled&&l){var c=o.prepareLineDef(e,l),d=o.pathFinder.findPath(c,o.lineDefAdjusters);o.drawLine(r,e,d,n,i),i&&!a.some(u)&&a.push({dependency:e,assignmentData:n})}var h=s&&s.findIndex(u);h>=0&&s.splice(h,1)}},{key:"drawForTimeSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;n.client.isAnimating?n.client.on({transitionend:function(){n.drawForTimeSpan(e,!0)},once:!0}):n.dependencyStore.getTimeSpanDependencies(e).forEach((function(e){t?n.scheduleRefreshDependency(e):n.refreshDependency(e)}))}},{key:"drawForEvent",value:function(e){this.drawForTimeSpan(e)}},{key:"updateDependenciesForTimeSpan",value:function(e,t){var n,r=this,i=this,o=e.isAssignment?e.event:e,a=i.dependencyStore.getTimeSpanDependencies(o),s=i.getMetaId(),l=i.client,u=Oe.from(t,l.timeAxisSubGridElement);a.forEach((function(t){r.getIteratableDependencyAssignments(t).forEach((function(r){var a,l,c,d=u.clone();r&&r.from!==e&&r.to!==e||i.isDependencyVisible(t,r)&&(i.getTimeSpanRecordFromDependency(t,!0)===o?(a=d,(n=t.instanceMeta(s).bounds)?l=n.endRectangle:(c=i.getBox(t,!1,r))&&(l=new Oe(c.start,c.top,c.end-c.start,c.bottom-c.top))):((n=t.instanceMeta(s).bounds)?a=n.startRectangle:(c=i.getBox(t,!0,r))&&(a=new Oe(c.start,c.top,c.end-c.start,c.bottom-c.top)),l=d),a&&l&&i.drawDependency(t,{startRectangle:a,endRectangle:l},r))}))}))}},{key:"scheduleDraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;e&&t.resetBoundsCache(),t.client.isAnimating?t.clientTransitionRemover||(t.clientTransitionRemover=t.client.on({transitionend:function(){t.clientTransitionRemover(),t.clientTransitionRemover=null,t.draw()},once:!0})):t.doScheduleDraw()}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.client;if((t.oldDrawnDependencies||t.dependencyStore.count)&&n.isPainted)if(n.isAnimating)n.on({transitionend:function(){t.scheduleDraw(!0)},once:!0});else{var r=n.timeAxisSubGrid.viewRectangle;if(e&&t.resetBoundsCache(),t.oldDrawnDependencies=t.drawnDependencies,t.drawnDependencies=[],!r.width||!r.height)return[];if(r.inflate(t.bufferSize),!t.disabled&&t.rowStore.count&&n.rowManager.rowCount){var i,o,a,s={},l=t.dependencyGridCache,u=t.cacheGridSize,c=Math.floor(Math.max(r.left,0)/u.x),d=Math.floor(r.right/u.x),h=Math.floor(n.rowManager.topRow.dataIndex/u.index),f=Math.floor(n.rowManager.bottomRow.dataIndex/u.index),g=[];for(i=c;i<=d;i++)for(o=h;o<=f;o++){var v=l[i],m=v&&v[o];for(a=0;m&&a<m.length;a++){var p=m[a],y=p.dependency,k=p.assignmentData,b=p.metaId,w=y.id+"-"+b;if(!s[w]){var S=t.getDependencyBounds(y,k);(S&&S.bounds.intersect(r,!0)||n.ignoreViewBox)&&g.push([y,S,k]),s[w]=!0}}}g.forEach((function(e){var n=fe()(e,3),r=n[0],i=n[1],o=n[2];t.drawDependency(r,i,o)}))}t._resetBoundsCache=!1,t.oldDrawnDependencies.forEach((function(e){return t.releaseDependency(e.dependency,e.assignmentData)})),n.trigger("dependenciesDrawn"),this.isDrawn=!0}}},{key:"releaseDependency",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!0===n)Object.keys(e.meta.map||{}).filter((function(e){return e.startsWith(t.client.id)})).forEach((function(t){var n=e.meta.map[t];n.lineElement&&(n.lineElement.remove(),n.lineElement=null)}));else{var r=this.getMetaId(n),i=e.instanceMeta(r).lineElement;i&&(e.instanceMeta(r).lineElement=null,i.remove())}}},{key:"render",value:function(){var e=this,t=e.client;e.showTooltip&&(e.tooltip=e.createTooltip()),t.timeAxis.on({endreconfigure:e.resetGridCache,thisObj:e}),t.rowManager.on({refresh:e.onRowsRefresh,changetotalheight:e.onChangeTotalHeight,thisObj:e}),t.on({horizontalscroll:e.onHorizontalScroll,svgcanvascreated:e.createMarkers,togglenode:e.onToggleNode,scroll:e.onVerticalScroll,timelineviewportresize:e.onViewportResize,thisObj:e}),e.highlightDependenciesOnEventHover&&(t.on(t.scheduledEventName+"MouseEnter",(function(t){return e.highlightEventDependencies(t.eventRecord||t.taskRecord)})),t.on(t.scheduledEventName+"MouseLeave",(function(t){return e.unhighlightEventDependencies(t.eventRecord||t.taskRecord)}))),e.draw()}},{key:"renderContents",value:function(){this.draw()}},{key:"getConnectorStartSide",value:function(e){return this.client.currentOrientation.getConnectorStartSide(e)}},{key:"getConnectorEndSide",value:function(e){return this.client.currentOrientation.getConnectorEndSide(e)}},{key:"createTooltip",value:function(){var e=this,t=e.client;return new Ur(Object.assign({align:"b-t",id:"".concat(t.id,"-dependency-tip"),forSelector:".b-timelinebase:not(.b-eventeditor-editing):not(.b-resizing-event):not(.b-dragcreating):not(.b-dragging-event):not(.b-creating-dependency) .".concat(e.baseCls),clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],forElement:t.timeAxisSubGridElement,showOnHover:!0,hoverDelay:0,hideDelay:0,anchorToTarget:!1,trackMouse:!1,getHtml:e.getHoverTipHtml.bind(e)},e.tooltip||{}))}},{key:"getHoverTipHtml",value:function(e){var t=e.forElement,n=this,r=n.getDependencyForElement(t),i=n.dataApi.getDependencySourceEvent({dependency:r,eventStore:this.eventStore}),o=n.dataApi.getDependencyTargetEvent({dependency:r,eventStore:this.eventStore});return Hr.tpl(Rc(),n.L("from"),i.name,Mc[r.type],n.L("to"),o.name,Fc[r.type])}},{key:"rowStore",get:function(){return this.resourceStore}},{key:"scheduler",get:function(){return this.client}},{key:"dependencyGridCache",get:function(){var e=this;return e._dependencyGridCache||(e._dependencyGridCache={},e.dependencyStore.forEach((function(t){return e.addToGridCache(t)}))),e._dependencyGridCache},set:function(e){this._dependencyGridCache=e}}],[{key:"$name",get:function(){return"Dependencies"}},{key:"defaultConfig",get:function(){return{pathFinderConfig:null,overCls:"b-sch-dependency-over",baseCls:"b-sch-dependency",store:null,dependencies:null,highlightDependenciesOnEventHover:!1,showTooltip:!0,tooltip:null,bufferSize:50,cacheGridSize:{x:500,index:25},drawnDependencies:[],drawnLines:[],dependenciesToRefresh:new Map,storeClass:dc}}},{key:"pluginConfig",get:function(){return{chain:["render","renderContents","onElementClick","onElementDblClick","onElementMouseOver","onElementMouseOut"],assign:["getElementForDependency","getDependencyForElement"]}}}]),t}(pi(ai).mixes((function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n);var r=this;r.view=e,r.eventName=e.scheduledEventName,r.view.on("readOnly",(function(){return r.updateCreateListeners()})),r.updateCreateListeners()}},{key:"doDestroy",value:function(){var e=this;e.schedulerListenersDetacher&&e.schedulerListenersDetacher(),e.abort(),e.creationTooltip&&e.creationTooltip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"updateCreateListeners",value:function(){var e,t=this;t.view&&(t.listenersDetacher&&t.listenersDetacher(),t.listenersDetacher=null,t.isCreateAllowed&&(t.listenersDetacher=t.view.on((e={},$()(e,"".concat(t.eventName,"mouseenter"),t.onTimeSpanMouseEnter),$()(e,"".concat(t.eventName,"mouseleave"),t.onTimeSpanMouseLeave),$()(e,"thisObj",t),e))))}},{key:"onTimeSpanMouseEnter",value:function(e){var t=e["".concat(this.eventName,"Record")],n=e["".concat(this.eventName,"Element")];this.showTerminals(t,rn.down(n,e.source.eventInnerSelector))}},{key:"onTimeSpanMouseLeave",value:function(e){var t=e["".concat(this.eventName,"Element")];this.creationData&&rn.isDescendant(t,this.creationData.sourceTerminal.parentElement)||this.hideTerminals(t)}},{key:"onTerminalMouseOut",value:function(e){var t=this,n=rn.up(e.target,t.view.eventSelector);rn.isDescendant(n,t.showingTerminalsFor)||t.creationData&&n===t.creationData.sourceTerminal.parentElement||(t.hideTerminals(n),t.view.unhover(e))}},{key:"onTerminalMouseDown",value:function(e){var t=this;if(0===e.button&&!t.creationData){var n=t.view,r=n.timeAxisSubGridElement,i=e.target,o=i.parentElement.closest(n.eventSelector),a=Oe.from(n.element,document.body);e.preventDefault(),e.stopPropagation(),t.creationData={source:n.resolveTimeSpanRecord(o),sourceTerminal:i,startPoint:Oe.from(i,r).center,startX:e.pageX-a.x+n.scrollLeft,startY:e.pageY-a.y+n.scrollTop,valid:!1},n.resolveResourceRecord&&(t.creationData.sourceResource=n.resolveResourceRecord(o)),t.mouseDetacher=Ln.on({mouseup:{element:document.body,handler:"onMouseUp"},mousemove:{element:r,handler:"onMouseMove"},thisObj:t})}}},{key:"onMouseMove",value:function(e){var t=this,n=e.target,r=t.view,i=t.creationData,o=Oe.from(r.element,document.body),a=e.pageX-o.x+r.scrollLeft-i.startX,s=e.pageY-o.y+r.scrollTop-i.startY,l=Math.round(Math.sqrt(a*a+s*s))-3,u=Math.atan2(s,a),c=t.connector;if(!(i.valid instanceof Promise)){if(!c){if(!1===r.trigger("beforeDependencyCreateDrag",{data:i}))return void t.abort();c=t.createConnector(i.startPoint.x,i.startPoint.y),r.trigger("dependencyCreateDragStart",{data:i})}if(c.style.width="".concat(l,"px"),c.style.transform="rotate(".concat(u,"rad)"),n.matches(".".concat(t.terminalCls))&&n!==i.sourceTerminal){if(n!==i.targetTerminal){i.targetTerminal=n,i.target=r.resolveTimeSpanRecord(n),r.resolveResourceRecord&&(i.targetResource=r.resolveResourceRecord(n));var d,h=i.sourceTerminal.dataset.side,f=i.targetTerminal.dataset.side,g=function(e){t.isDestroyed||(i.valid=e,n.classList.add(e?"b-valid":"b-invalid"),c.classList.add(e?"b-valid":"b-invalid"),r.trigger("dependencyValidationComplete",{data:i}))};switch(!0){case"left"===h&&"left"===f:d=uc.Type.StartToStart;break;case"left"===h&&"right"===f:d=uc.Type.StartToEnd;break;case"right"===h&&"left"===f:d=uc.Type.EndToStart;break;case"right"===h&&"right"===f:d=uc.Type.EndToEnd}r.trigger("dependencyValidationStart",{data:i}),i.valid=this.dataApi.isValidDependency({type:d,sourceEvent:i.source,targetEvent:i.target,dependencyStore:this.dependencyStore}),i.valid instanceof Promise?i.valid.then(g):g(i.valid)}}else i.target=i.targetTerminal=null,i.valid=!1,c.classList.remove("b-valid"),c.classList.remove("b-invalid");t.lastMouseMoveEvent=e}}},{key:"onMouseUp",value:function(e){var t=this,n=t.creationData,r=e.target,i=function(){var r=Di()(Ei.a.mark((function r(){var i;return Ei.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.targetTerminal=e.target,!((i=t.createDependency())instanceof Promise)){r.next=5;break}return r.next=5,i;case 5:t.view.trigger("dependencyCreateDrop",{data:n});case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),o=function(){t.view.trigger("afterDependencyCreateDrop",{data:n}),t.abort()};n.valid&&r.matches(".".concat(t.terminalCls))?n.valid instanceof Promise?n.valid.then((function(e){n.valid=e,e?i().then(o):o()})):i().then(o):(n.valid=!1,o())}},{key:"abort",value:function(){var e=this,t=e.view,n=e.creationData;if(n){var r=n.source,i=n.sourceResource,o=n.target,a=n.targetResource;if(r){var s=t.getElementFromEventRecord(r,i);s&&e.hideTerminals(s)}if(o){var l=t.getElementFromEventRecord(o,a);l&&e.hideTerminals(l)}}e.creationData=null,e.mouseDetacher&&e.mouseDetacher(),e.removeConnector()}},{key:"createConnector",value:function(e,t){var n=this,r=n.view;return n.connector=rn.createElement({parent:r.timeAxisSubGridElement,className:"".concat(n.baseCls,"-connector"),style:"left:".concat(e,"px;top:").concat(t,"px")}),r.element.classList.add("b-creating-dependency"),n.showCreationTooltip&&(n.creationTooltip?n.creationTooltip.show():n.creationTooltip=new Ur(Object.assign({id:"".concat(r.id,"-dependency-drag-tip"),cls:"b-sch-dependency-creation-tooltip",autoShow:!0,anchorToTarget:!1,trackMouse:!0,constrainTo:null,onBeforeAlign:function(e){return n.updateTipContent(e.source,n.creationData)},header:{dock:"right"}},n.creationTooltip||{}))),r.scrollManager.startMonitoring({element:r.timeAxisSubGridElement,callback:function(){return n.creationData&&n.lastMouseMoveEvent&&n.onMouseMove(n.lastMouseMoveEvent)},thisObj:n}),n.connector}},{key:"removeConnector",value:function(e){var t=this,n=t.connector,r=t.view;n&&(n.classList.add("b-removing"),n.style.width="0",t.setTimeout((function(){n.remove(),t.connector=null,e&&e.call(t)}),200)),r.element.classList.remove("b-creating-dependency"),t.creationTooltip&&t.creationTooltip.hide(),r.scrollManager.stopMonitoring(r.timeAxisSubGridElement)}},{key:"showTerminals",value:function(e,t){var n=this;if(n.isCreateAllowed){var r=n.terminalCls,i="".concat(r,"s-visible");(t=rn.down(t,n.view.eventInnerSelector)).classList.contains(i)||this.view.element.classList.contains("b-resizing-event")||n.view.readOnly||(n.terminalSides.forEach((function(e){var i=rn.createElement({parent:t,className:"".concat(r," ").concat(r,"-").concat(e),dataset:{side:e,feature:!0}});i.detacher=Ln.on({element:i,mouseout:"onTerminalMouseOut",mousedown:{handler:"onTerminalMouseDown",capture:!0},thisObj:n})})),t.classList.add(i),e.cls.add(i),n.showingTerminalsFor=t)}}},{key:"hideTerminals",value:function(e){var t=this,n=t.client.getTimeSpanMouseEventParams(e)["".concat(this.eventName,"Record")],r="".concat(t.terminalCls,"s-visible");rn.forEachSelector(e,".".concat(t.terminalCls),(function(e){e.detacher&&e.detacher(),e.remove()})),rn.down(e,t.view.eventInnerSelector).classList.remove(r),n.cls.remove(r),t.showingTerminalsFor=null}},{key:"createDependency",value:function(){var e=this.creationData,t=e.source,n=e.target,r=e.sourceTerminal.dataset.side,i=e.targetTerminal.dataset.side,o=("left"===r?0:2)+("right"===i?1:0);return this.dataApi.createDependency({sourceEvent:t,targetEvent:n,dependencyStore:this.dependencyStore,type:o,fromSide:r,toSide:i})}},{key:"updateTipContent",value:function(e,t){var n,r,i=this,o=t.valid;Object.assign(t,{fromText:t.source.name,toText:t.target?t.target.name:"",fromSide:t.sourceTerminal.dataset.side,toSide:t.targetTerminal?t.targetTerminal.dataset.side:""}),o instanceof Promise?(e.element.classList.remove("b-invalid"),e.element.classList.add("b-checking"),n="checking",r=i.L("Checking"),o.then((function(n){t.valid=n,e.isDestroyed||i.updateTipContent(e,t)}))):!0===o?(e.element.classList.remove("b-invalid"),e.element.classList.remove("b-checking"),n="valid",r=i.L("valid")):(e.element.classList.remove("b-checking"),e.element.classList.add("b-invalid"),n="invalid",r=i.L("invalid")),e.titleElement.innerHTML='<i class="b-icon b-icon-'.concat(n,'"></i>').concat(r),e.html='<table class="b-sch-dependency-creation-tooltip">\n                        <tr><td>'.concat(i.L("from"),": </td><td>").concat(t.fromText,'</td><td><div class="b-sch-box b-').concat(t.fromSide,'"></div></td></tr>\n                        <tr><td>').concat(i.L("to"),": </td><td>").concat(t.toText,'</td><td><div class="b-sch-box b-').concat(t.toSide,'"></div></td></tr>\n                    </table>')}},{key:"allowCreate",set:function(e){this._allowCreate=e,this.updateCreateListeners()},get:function(){return this._allowCreate}},{key:"isCreateAllowed",get:function(){return this.allowCreate&&!this.view.readOnly&&!this.disabled}}],[{key:"defaultConfig",get:function(){return{showCreationTooltip:!0,creationTooltip:null,terminalCls:"b-sch-terminal",terminalSides:["left","top","right","bottom"],allowCreate:!0}}}]),t}(e||z)}),Sc,de,Tc));_c._$name="Dependencies",Xs.registerFeature(_c,!1,"Scheduler"),!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g")||function(e){if("Element"in e){var t=e.Element.prototype,n=Object,r=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},i=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},o=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new o("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(t))throw new o("INVALID_CHARACTER_ERR","The token must not contain space characters.");return i.call(e,t)},s=function(e){for(var t=r.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},l=s.prototype=[],u=function(){return new s(this)};if(o.prototype=Error.prototype,l.item=function(e){return this[e]||null},l.contains=function(e){return~a(this,e+"")},l.add=function(){var e,t=arguments,n=0,r=t.length,i=!1;do{e=t[n]+"",~a(this,e)||(this.push(e),i=!0)}while(++n<r);i&&this._updateClassName()},l.remove=function(){var e,t,n=arguments,r=0,i=n.length,o=!1;do{for(e=n[r]+"",t=a(this,e);~t;)this.splice(t,1),o=!0,t=a(this,e)}while(++r<i);o&&this._updateClassName()},l.toggle=function(e,t){var n=this.contains(e),r=n?!0!==t&&"remove":!1!==t&&"add";return r&&this[r](e),!0===t||!1===t?t:!n},l.replace=function(e,t){var n=a(e+"");~n&&(this.splice(n,1,t),this._updateClassName())},l.toString=function(){return this.join(" ")},n.defineProperty){var c={get:u,enumerable:!0,configurable:!0};try{n.defineProperty(t,"classList",c)}catch(e){void 0!==e.number&&-2146823252!==e.number||(c.enumerable=!1,n.defineProperty(t,"classList",c))}}else n.prototype.__defineGetter__&&t.__defineGetter__("classList",u)}}(window),function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){for(var n=0,r=arguments.length;n<r;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(e,t){var n=this.toString().split(" "),r=n.indexOf(e+"");~r&&(n=n.slice(r),this.remove.apply(this,n),this.add(t),this.add.apply(this,n.slice(1)))}),e=null}();var Ac=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"processWidgetConfig",value:function(e){var n=this.dependencyEditFeature;return!("lagField"===e.ref&&!n.showLagField)&&(!("deleteButton"===e.ref&&!n.showDeleteButton)&&(Object.assign(e,{}),se()(oe()(t.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"afterShow",value:function(){var e,n=this.widgetMap.deleteButton;n&&(n.hidden=!this.record.isPartOfStore());for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=se()(oe()(t.prototype),"afterShow",this)).call.apply(e,[this].concat(i))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),se()(oe()(t.prototype),"onInternalKeyDown",this).call(this,e)}}],[{key:"$name",get:function(){return"DependencyEditor"}},{key:"defaultConfig",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible"}}}]),t}(Ar);Ac._$name="DependencyEditor";var Ic=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r,i=this;if(e.dependencyEdit=i,i.dependencyStore=e.dependencyStore,se()(oe()(t.prototype),"construct",this).call(this,e,n),!e.features.dependencies)throw new Error("Dependencies feature required when using DependencyEdit");i.clientListenersDetacher=e.on((r={},$()(r,i.triggerEvent,i.onActivateEditor),$()(r,"thisObj",i),r))}},{key:"doDestroy",value:function(){this.clientListenersDetacher(),this.editor&&this.editor.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;if(e.beginBatch(),e.set(t),this.lagField){var n=this.lagField.value;e.setLag(n.magnitude,n.unit)}this.typeField&&"type"in t&&e.set({fromSide:null,toSide:null}),e.endBatch()}},{key:"onPopupKeyDown",value:function(e){var t=e.event;"Enter"===t.key&&this.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),this.onSaveClick())}},{key:"onSaveClick",value:function(){this.save()&&this.editor.hide()}},{key:"onDeleteClick",value:function(){this.deleteDependency(),this.editor.hide()}},{key:"onCancelClick",value:function(){this.editor.hide()}},{key:"internalShowEditor",value:function(e){var t=this,n=t.client,r=t.lastPointerDownCoordinate;if(!1!==n.trigger("beforeDependencyEdit",{dependencyEdit:t,dependencyRecord:e})){var i=t.getEditor(e);if(t.loadRecord(e),n.trigger("beforeDependencyEditShow",{dependencyEdit:t,dependencyRecord:e,editor:i}),!r){var o=Oe.from(t.client.element).center;r=[o.x-i.width/2,o.y-i.height/2]}i.showByPoint(r)}}},{key:"editDependency",value:function(e){this.client.readOnly||this.internalShowEditor(e)}},{key:"getEditor",value:function(){var e=this,t=e.editor;return t||(0===(t=e.editor=new Ac(kt.assign({dependencyEditFeature:e,autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[e.client.timeAxisSubGridElement,e.client.bodyContainer],constrainTo:window,autoClose:e.autoClose,cls:e.cls,listeners:{keydown:e.onPopupKeyDown,thisObj:e}},e.editorConfig))).items.length&&console.warn("Editor configured without any `items`"),t.eachWidget((function(t){var n=t.ref||t.id;n&&!e[n]&&(e[n]=t)})),e.saveButton&&e.saveButton.on("click",e.onSaveClick,e),e.deleteButton&&e.deleteButton.on("click",e.onDeleteClick,e),e.cancelButton&&e.cancelButton.on("click",e.onCancelClick,e),e.editor)}},{key:"loadRecord",value:function(e){var t=this;t.fromNameField.value=e.sourceEvent.name,t.toNameField.value=e.targetEvent.name,t.lagField&&(t.lagField.unit=e.lagUnit),t.editor.record=t.dependencyRecord=e}},{key:"save",value:function(){var e=this,t=e.client,n=e.dependencyRecord;if(n&&e.isValid){var r=e.dependencyStore,i=e.values;if(!1!==t.trigger("beforeDependencySave",{dependencyRecord:n,values:i})){if(e.onBeforeSave(n),e.updateRecord(n),r&&!n.stores.length){if(!1===t.trigger("beforeDependencyAdd",{dependencyRecord:n,dependencyEdit:e}))return;r.add(n)}t.project&&t.project.propagate(),t.trigger("afterDependencySave",{dependencyRecord:n}),e.onAfterSave(n)}return n}}},{key:"deleteDependency",value:function(){var e=this;return!1!==e.client.trigger("beforeDependencyDelete",{dependencyRecord:e.dependencyRecord})&&(e.editor.containsFocus&&e.editor.revertFocus(),e.client.dependencyStore.remove(e.dependencyRecord),e.client.project&&e.client.project.propagate(),!0)}},{key:"onActivateEditor",value:function(e){var t=e.dependency,n=e.event;this.disabled||(this.lastPointerDownCoordinate=[n.clientX,n.clientY],this.editDependency(t))}},{key:"editorConfig",get:function(){return this._editorConfig},set:function(e){var t=this.getDefaultConfiguration().editorConfig;(e=kt.assign({},t,e)).items=e.items||[],this._editorConfig=e}},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e={};return this.editor.eachWidget((function(t){t.name&&!t.hidden&&(e[t.name]=t.value)}),!0),e}}],[{key:"$name",get:function(){return"DependencyEdit"}},{key:"defaultConfig",get:function(){var e=this;return{autoClose:!0,saveAndCloseOnEnter:!0,showDeleteButton:!0,triggerEvent:"dependencydblclick",showLagField:!1,dependencyRecord:null,editorConfig:{title:"L{Edit dependency}",localeClass:this,closable:!0,items:[{type:"display",localeClass:this,label:"L{From}",editable:!1,ref:"fromNameField"},{type:"display",localeClass:this,label:"L{To}",ref:"toNameField"},{type:"combo",localeClass:this,label:"L{Type}",name:"type",ref:"typeField",editable:!1,valueField:"id",displayField:"name",items:Object.keys(cc.Type).map((function(t){return{id:cc.Type[t],name:e.L(t)}}))},{type:"duration",localeClass:this,label:"L{Lag}",name:"lag",ref:"lagField"}],bbar:[{type:"widget",cls:"b-label-filler"},{color:"b-green",localeClass:this,text:"L{Save}",ref:"saveButton"},{color:"b-gray",localeClass:this,text:"L{Delete}",ref:"deleteButton"},{color:"b-gray",localeClass:this,text:"L{Cancel}",ref:"cancelButton"}]}}}}]),t}(ai);Ic._$name="DependencyEdit",Xs.registerFeature(Ic,!1);var Lc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.menu&&this.menu.destroy()}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onEventSpaceKey",value:function(e){var t=Oe.from(e.target).center,n=new MouseEvent("contextmenu",Object.assign({clientX:t.x,clientY:t.y},e));Object.defineProperty(n,"target",{get:function(){return e.target}}),this.showEventContextMenu(n)}},{key:"showEventContextMenu",value:function(e){var t=this.client,n=e.target,r=rn.up(n,t.eventSelector)||n;if(r){e.preventDefault();var i=this.resolveRecord(r);i&&this.showContextMenuFor(i,{targetElement:r,event:e})}}},{key:"showContextMenuFor",value:function(e,t){}},{key:"beforeContextMenuShow",value:function(){}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=this,n=e.event,r=e.menuType.toLowerCase(),i=A.lowercaseFirstLetter(r),o="get".concat(A.capitalizeFirstLetter(r),"MenuItems"),a=t.client,s=t.processItems,l=t.defaultItems,u=t.namedItems,c=n?[n.clientX+1,n.clientY+1]:Oe.from(e.targetElement).center,d=e.items=kt.isEmpty(t.items)?kt.clone(l):kt.merge(kt.clone(l),t.items);e.namedItems=u,e.selection=a.selectedRecords,function e(t,n){for(var r in t){var i=t[r];if(i){r in n&&(i=t[r]="object"===U()(i)?kt.merge(kt.clone(n[r]),i):n[r]);var o=i.menu;o&&e("items"in o?o.items:o,n)}}}(d,u),a[o]&&a[o](e,d),s&&!1===s(e)||kt.isEmpty(e.items)||!1!==t.beforeContextMenuShow(e)&&!1!==a.trigger("".concat(i,"ContextMenuBeforeShow"),e)&&(t.menu=te.showContextMenu(c,{owner:a,scrollAction:"hide",clippedBy:[a.timeAxisSubGridElement,a.bodyContainer],constrainTo:window,items:d,onDestroy:function(){t.menu=null},onBeforeItem:function(t){Object.assign(t,e)},onItem:function(e){return a.trigger("".concat(i,"ContextMenuItem"),e)},listeners:{show:function(t){var n=t.source;e.menu=n,a.trigger("".concat(i,"ContextMenuShow"),e)}}}))}}},{key:"hideContextMenu",value:function(e){this.menu&&this.menu.hide(e)}},{key:"defaultItems",set:function(e){this._defaultItems=e},get:function(){var e=kt.clone(this._defaultItems);if(this.client.readOnly)for(var t in e)e[t]=!1;return e}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"defaultConfig",get:function(){return{defaultItems:null,items:null,processItems:null,triggerEvent:null}}},{key:"pluginConfig",get:function(){return{assign:["showEventContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onEventSpaceKey"]}}}]),t}(ai);Lc._$name="TimeSpanRecordContextMenuBase";var Oc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"resolveRecord",value:function(e){return this.client.resolveEventRecord(e)}},{key:"showContextMenuFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.targetElement,r=t.event,i=this,o=i.client;(n||(n=o.getElementsFromEventRecord(e)[0]))&&i.showContextMenu({menuType:"event",eventElement:n,targetElement:n,eventRecord:e,resourceRecord:o.resolveResourceRecord(n),assignmentRecord:o.resolveAssignmentRecord(n),event:r})}},{key:"defaultItems",set:function(e){this._defaultItems=e},get:function(){var e=se()(oe()(t.prototype),"defaultItems",this);return this.client.assignmentStore||(e.unassignEvent=!1),e}},{key:"namedItems",get:function(){var e=this.client;return this._namedItems||(this._namedItems={deleteEvent:{text:e.L("Delete event"),icon:"b-icon b-icon-trash",weight:-160,onItem:function(t){var n=t.menu,r=t.eventRecord,i=n.focusInEvent&&n.focusInEvent.relatedTarget;i&&(i.focus(),e.navigator.activeItem=i),e.removeRecords([r])}},unassignEvent:{text:e.L("Unassign event"),icon:"b-icon b-icon-unassign",weight:-150,name:"unassignEvent",onItem:function(t){var n=t.menu,r=t.eventRecord,i=t.resourceRecord,o=n.focusInEvent&&n.focusInEvent.relatedTarget;o&&(o.focus(),e.navigator.activeItem=o),r.unassign(i)}}}),this._namedItems}}],[{key:"$name",get:function(){return"EventContextMenu"}},{key:"defaultConfig",get:function(){return{items:null,processItems:null,defaultItems:{deleteEvent:!0,unassignEvent:!0}}}}]),t}(Lc);Oc.featureClass="",Oc._$name="EventContextMenu",Xs.registerFeature(Oc,!0,"Scheduler");var Pc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),this.timeAxisViewModelDetacher=this.timeAxisViewModel.on({update:this.onTimeAxisViewModelUpdate,thisObj:this})}},{key:"doDestroy",value:function(){this.timeAxisViewModelDetacher&&this.timeAxisViewModelDetacher()}},{key:"onTimeAxisViewModelUpdate",value:function(){delete this._mode}},{key:"updateDateIndicator",value:function(e,t){var n=e.querySelector(".b-sch-hour-indicator"),r=e.querySelector(".b-sch-minute-indicator");t&&n&&r&&("hour"===this.mode?(n.style.transform="rotate(".concat(t.getHours()%12*30,"deg)"),r.style.transform="rotate(".concat(6*t.getMinutes(),"deg)")):(n.style.transform="none",r.style.transform="none"))}},{key:"mode",get:function(){return this._mode||(this._mode=vt.compareUnits(this.timeAxisViewModel.timeResolution.unit,"day")>=0?"day":"hour")}},{key:"template",set:function(e){this._template=e},get:function(){return this._template}}],[{key:"defaultConfig",get:function(){return{minuteHeight:8,minuteTop:2,hourHeight:8,hourTop:2,handLeft:10,timeAxisViewModel:null,template:function(e){return'<div class="b-sch-clockwrap b-sch-clock-'.concat(this.mode," ").concat(e.cls||"",'">\n                    <div class="b-sch-clock">\n                        <div class="b-sch-hour-indicator">').concat(vt.format(e.date,"MMM"),'</div>\n                        <div class="b-sch-minute-indicator">').concat(vt.format(e.date,"D"),'</div>\n                        <div class="b-sch-clock-dot"></div>\n                    </div>\n                    <span class="b-sch-clock-text">').concat(e.text,"</span>\n                </div>")}}}}]),t}(z);Pc._$name="ClockTemplate";var Hc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n;return ue()(t,e),x()(t,[{key:"render",value:function(){var e=this,t=e.client;e.drag&&e.drag.destroy(),e.drag=new qa(Object.assign({name:e.constructor.name,mode:"translateXY",lockY:e.constrainDragToResource,minX:!0,maxX:!0,constrain:!1,cloneTarget:!e.constrainDragToTimeline,dragWithin:e.constrainDragToTimeline?null:document.body,hideOriginalElement:!0,outerElement:t.timeAxisSubGridElement,targetSelector:t.eventSelector,isElementDraggable:function(n,r){return!t.readOnly&&e.isElementDraggable(n,r)},scrollManager:e.constrainDragToTimeline?t.scrollManager:null,transitionDuration:t.transitionDuration,listeners:{beforedragstart:"onBeforeDragStart",dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onDragAbort",reset:"onDragReset",thisObj:e}},e.dragHelperConfig)),e.constrainDragToResource||t.rowManager.on({changeTotalHeight:"updateYConstraint",thisObj:e}),e.showTooltip&&(e.clockTemplate=new Pc({timeAxisViewModel:t.timeAxisViewModel}))}},{key:"doDestroy",value:function(){var e=this;e.drag&&e.drag.destroy(),e.clockTemplate&&e.clockTemplate.destroy(),e.tip&&e.tip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=(e.event,this.client),r=n.scheduledEventName,i=n.resolveEventRecord(t.element);return!(this.disabled||!i||!i.isDraggable)&&(t.pointerStartDate=n.getDateFromXY([t.startClientX,t.startPageY],null,!1),!1!==n.trigger("before".concat(r,"Drag"),{eventRecord:i,context:this.dragData}))}},{key:"onDragStart",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.client,a=o.scheduledEventName;i.currentOverClient=o,i.scrollClients={},i.onMouseOverNewTimeline(o);var s=i.dragData=i.getDragData(n,r);if(i.showTooltip){var l=s.context.dragProxy?s.context.dragProxy.firstChild:n.element;i.tip?i.tip.showBy(l):(i.tip=new Ur({id:"".concat(o.id,"-event-drag-tip"),align:"b-t",autoShow:!0,clippedBy:i.constrainDragToTimeline?[o.timeAxisSubGridElement,o.bodyContainer]:null,forElement:l,getHtml:i.getTipHtml.bind(i),style:"pointer-events:none",cls:i.tooltipCls}),i.tip.on("innerhtmlupdate",i.updateDateIndicator,i))}o.trigger("".concat(a,"DragStart"),(t={},$()(t,"".concat(a,"Records"),s.draggedRecords),$()(t,"context",s),t))}},{key:"updateDateIndicator",value:function(){var e=this.dragData,t=e.startDate,n=e.endDate,r=this.tip,i=r.element.querySelector(".b-sch-tooltip-enddate");this.clockTemplate.updateDateIndicator(r.element,t),i&&this.clockTemplate.updateDateIndicator(i,n)}},{key:"onDrag",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.dragData,a=o.startDate;if(i.constrainToTimeline)t=i.client;else{var s=r.target;if(/^touch/.test(r.type)){var l=Oe.from(o.context.element,null,!0).center;s=rn.elementFromPoint(l.x,l.y)}t=Z.fromElement(s,"timelinebase")}var u=i.client.features.dependencies,c=n.newX,d=n.newY;if(t){if(t!==i.currentOverClient&&i.onMouseOverNewTimeline(t),i.updateDragContext(n,r),i.constrainDragToTimeline&&(i.showExactDropPosition||i.client.timeAxisViewModel.snap)){var h=t.getDateFromCoordinate(i.getCoordinate(o.draggedRecords[0],n.element,[c,d]))-o.sourceDate,f=new Date(o.origStart-0+h),g=t.timeAxisViewModel.getDistanceBetweenDates(f,o.startDate);o.startDate>=t.timeAxis.startDate&&null!=g&&rn.addTranslateX(n.element,g)}i.triggerEventDrag(o,a);var v=i.checkDragValidity(o,r);v&&"boolean"!=typeof v&&(n.message=v.message||"",v=v.valid),n.valid=!1!==v,i.showTooltip&&i.tip.realign(),u&&u.updateDependenciesForTimeSpan(o.draggedRecords[0],o.context.element.querySelector(t.eventInnerSelector))}else u&&u.updateDependenciesForTimeSpan(o.draggedRecords[0],o.context.element)}},{key:"onMouseOverNewTimeline",value:function(e){var t=this.scrollClients;(this.currentOverClient.element.classList.remove("b-dragging-"+this.currentOverClient.scheduledEventName),e.element.classList.add("b-dragging-"+e.scheduledEventName),e.id in t)||(e.scrollManager.startMonitoring({element:e.timeAxisSubGridElement}),t[e.id]=e);this.currentOverClient=e}},{key:"onDrop",value:function(e){var t=e.context,n=e.event,r=this,i=r.currentOverClient,o=r.dragData;if(!t.valid)return r.onInvalidDrop({context:t,event:n});var a=!1;r.updateDragContext(t,n),r.tip&&r.tip.hide(),t.valid&&o.startDate&&o.endDate&&(o.finalize=function(){r.finalize.apply(r,arguments),t.finalize.apply(t,arguments)},i.trigger("before".concat(i.capitalizedEventName,"DropFinalize"),{context:o,event:n}),t.async=o.async,!t.async&&r.isValidDrop(o)&&(a=o.startDate-o.origStart!=0||o.newResource!==o.resourceRecord)),t.async||r.finalize(o.valid&&t.valid&&a)}},{key:"onDragAbort",value:function(e){var t,n=e.context,r=this.dragData,i=this.client,o=r.draggedRecords;i.currentOrientation.onDragAbort(n),this.tip&&this.tip.hide(),i.trigger("".concat(i.capitalizedEventName,"DragAbort"),(t={},$()(t,"".concat(i.scheduledEventName,"Records"),o),$()(t,"context",r),t))}},{key:"onInvalidDrop",value:function(){var e=this;e.dragData.draggedRecords.forEach((function(t){return e.resumeElementRedrawing(t)})),e.tip&&e.tip.hide()}},{key:"onDragReset",value:function(e){var t=e.source,n=this;for(var r in n.scrollClients||{})n.scrollClients[r].scrollManager.stopMonitoring(n.scrollClients[r].timeAxisSubGridElement);t.context&&t.context.started&&n.dragData.eventBarEls[0].classList.remove("b-drag-main");if(n.scrollClients=null,n.currentOverClient&&n.currentOverClient.element.classList.remove("b-dragging-"+n.currentOverClient.scheduledEventName),n.dragData&&!n.dragData.context.valid){var i=n.currentOverClient.features.dependencies;i&&i.scheduleDraw(!0)}}},{key:"onInternalInvalidDrop",value:function(){var e,t=this,n=t.currentOverClient;t.tip&&t.tip.hide(),t.drag.abort(),n.trigger("after".concat(n.capitalizedEventName,"Drop"),(e={},$()(e,n.scheduledEventName+"Records",t.dragData.draggedRecords),$()(e,"valid",!1),$()(e,"context",t.dragData),e))}},{key:"finalize",value:(n=Di()(Ei.a.mark((function e(t){var n,r,i,o,a,s,l;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).currentOverClient,i=n.dragData,o=i.context,(a=i.draggedRecords).forEach((function(e,t){n.resumeElementRedrawing(e),i.eventBarEls[t].classList.remove(n.drag.draggingCls)})),!t){e.next=11;break}if(!((s=n.updateRecords(i))instanceof Promise)){e.next=8;break}return o.async=!0,e.next=8,s;case 8:i.valid?(n.drag.reset(),r.trigger("after".concat(r.capitalizedEventName,"Drop"),(l={},$()(l,"".concat(r.scheduledEventName,"Records"),a),$()(l,"valid",!0),$()(l,"context",i),l))):n.onInternalInvalidDrop(),e.next=12;break;case 11:n.onInternalInvalidDrop();case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateDragContext",value:function(e,t){var n=this,r=n.dragData,i=n.currentOverClient,o=e.element,a=Oe.from(o,i.timeAxisSubGridElement),s=r.draggedRecords[0],l=s.isAssignment?s.event:s;if(r.browserEvent=t,n.constrainDragToTimeSlot)r.timeDiff=0;else{if(i.timeAxis.isContinuous){var u=r.dateConstraints,c=i.timeAxisSubGrid.scrollable,d=c.viewport,h=i.isHorizontal?e.clientX-d.x+c.x:e.clientY-d.y+c.y,f=i.timeAxisViewModel.getDateFromPosition(h,null,!0),g=r.timeDiff=f-e.pointerStartDate;r.startDate=n.adjustStartDate(r.origStart,g),u&&(r.startDate=vt.constrain(r.startDate,u.start,new Date(u.end-l.durationMS))),r.endDate=new Date(r.startDate-0+r.duration)}else{var v=n.resolveStartEndDates(a);r.startDate=v.startDate,r.endDate=v.endDate}r.timeDiff=r.startDate-r.origStart}if(Object.assign(r,n.getProductDragContext(r)),r.valid)if(r.endDate<=i.timeAxis.startDate||r.startDate>=i.timeAxis.endDate)r.context.valid=!1,r.context.message=n.L("noDropOutsideTimeline");else{var m=!t||n.checkDragValidity(r,t);m&&"boolean"!=typeof m?(r.context.valid=!1!==m.valid,r.context.message=m.message):(r.context.valid=!1!==m,r.context.message="")}else r.context.valid=!1}},{key:"suspendElementRedrawing",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.instanceMeta(this.client).retainElement=t}},{key:"resumeElementRedrawing",value:function(e){this.suspendElementRedrawing(e,!1)}},{key:"getDragData",value:function(e,t){var n=this,r=n.client,i=n.setupProductDragData(e),o=i.record,a=i.dateConstraints,s=i.eventBarEls,l=i.draggedRecords,u=o.startDate,c=o.endDate,d=r.timeAxis,h=u<d.startDate,f=c>d.endDate,g=n.getCoordinate(o,e.element,[e.elementStartX,e.elementStartY]),v=n.getCoordinate(o,e.element,[e.startClientX,e.startClientY]);l.forEach((function(e){return n.suspendElementRedrawing(e)})),n.drag.startEvent.ctrlKey&&n.client.selectEvent(l[0],!0),n.drag[r.isHorizontal?"lockX":"lockY"]=n.constrainDragToTimeSlot;var m={context:e,dateConstraints:a,eventBarEls:s,record:o,draggedRecords:l,sourceDate:h?u:r.getDateFromCoordinate(g),screenSourceDate:r.getDateFromCoordinate(v,null,!1),origStart:u,origEnd:c,startDate:u,endDate:c,timeDiff:0,startsOutsideView:h,endsOutsideView:f,duration:c-u,browserEvent:t};if(s.forEach((function(e,t){e.classList.add(n.drag.draggingCls),e.classList.remove("b-sch-event-hover"),e.classList.remove("b-active"),e.classList.remove("b-first-render")})),s.length>1)if(e.relatedElements=s.slice(1),e.relatedElStartPos=[],e.relatedElDragFromPos=[],n.unifiedDrag){n.client.isAnimating=!0,Ln.on({element:s[1],transitionend:function(e){n.client.isAnimating=!1},once:!0}),s[0].classList.add("b-drag-main");var p=rn.getTranslateXY(e.element),y=fe()(p,2),k=y[0],b=y[1];e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=rn.getTranslateXY(t),k+=10,b+=10,rn.setTranslateXY(t,k,b),e.relatedElDragFromPos[n]=[k,b]}))}else e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=e.relatedElDragFromPos[n]=rn.getTranslateXY(t)}));return m}},{key:"getRelatedRecords",value:function(e){return[]}},{key:"setupConstraints",value:function(e,t,n,r){var i=!this.showExactDropPosition&&n>1?n:0;r?this.setXConstraint(e.left,e.right-t.width,i):this.setXConstraint(!0,!0,i),this.setYConstraint(e.top,e.bottom-t.height,0)}},{key:"updateYConstraint",value:function(){var e=this.dragData,t=this.drag.context;if(t){var n=this.scheduler.getScheduleRegion(null,e.record);this.setYConstraint(n.top,n.bottom-t.grabbed.offsetHeight,0)}}},{key:"setXConstraint",value:function(e,t,n){var r=this.drag;r.leftConstraint=e,r.rightConstraint=t,r.minX=e,r.maxX=t}},{key:"setYConstraint",value:function(e,t,n){var r=this.drag;r.topConstraint=e,r.bottomConstraint=t,r.minY=e,r.maxY=t}},{key:"adjustStartDate",value:function(e,t){return this.client.timeAxis.roundDate(new Date(e-0+t),!!this.client.snapRelativeToEventStartDate&&e)}},{key:"resolveStartEndDates",value:function(e){var t=this.client.getStartEndDatesFromRectangle(e,"round",this.dragData.duration);return{startDate:t.start,endDate:t.end}}},{key:"getTipHtml",value:function(){var e,t=this,n=t.dragData,r=n.startDate,i=n.endDate,o=n.draggedRecords,a=t.client.getFormattedDate(r),s=t.client.getFormattedEndDate(i,r),l=t.dragData.context,u=l.valid,c=l.message;return t.dragTipTemplate((e={valid:u,startDate:r,endDate:i,startText:a,endText:s,message:c||""},$()(e,t.client.scheduledEventName+"Record",o[0]),$()(e,"dragData",t.dragData),$()(e,"startClockHtml",t.clockTemplate.template({date:r,text:a,cls:"b-sch-tooltip-startdate"})),$()(e,"endClockHtml",o[0].isMilestone?"":t.clockTemplate.template({date:i,text:s,cls:"b-sch-tooltip-enddate"})),e))}},{key:"isValidDrop",value:function(e){throw new Error("Implement in subclass")}},{key:"checkDragValidity",value:function(e){throw new Error("Implement in subclass")}},{key:"updateRecords",value:function(e){throw new Error("Implement in subclass")}},{key:"isElementDraggable",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getCoordinate",value:function(e,t,n){throw new Error("Implement in subclass")}},{key:"setupProductDragData",value:function(e){throw new Error("Implement in subclass")}},{key:"getProductDragContext",value:function(e){throw new Error("Implement in subclass")}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e}}],[{key:"defaultConfig",get:function(){return{dragTipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")},constrainDragToResource:!0,showTooltip:!0,showExactDropPosition:!1,constrainDragToTimeline:!0,store:null,dragHelperConfig:null,tooltipCls:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),t}(ai);Hc._$name="DragBase";var Nc=[null],Bc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"isElementDraggable",value:function(e,t){var n=this.scheduler,r=rn.up(e,n.eventSelector),i=n.features.eventResize;if(!r||this.disabled)return!1;if(e.matches('[class$="-handle"]'))return!1;var o=n.resolveEventRecord(r);return!(i&&!o.isMilestone&&i.resize.overAnyHandle(t,r))}},{key:"triggerEventDrag",value:function(e,t){e.startDate-t==0&&e.newResource===e.resourceRecord||this.scheduler.trigger("eventDrag",{eventRecords:e.draggedRecords,startDate:e.startDate,endDate:e.endDate,newResource:e.newResource,context:e})}},{key:"onDragStart",value:function(e){var n=e.context,r=e.event,i=this.client.features.eventContextMenu;se()(oe()(t.prototype),"onDragStart",this).call(this,{context:n,event:r}),i&&i.hideContextMenu(!1)}},{key:"isValidDrop",value:function(e){var t=e.newResource,n=e.resourceRecord,r=e.draggedRecords[0];return!t.meta.specialRow&&(n===t||(r instanceof Iu?(r=this.dataApi.getAssignmentEvent({assignment:r,eventStore:this.eventStore}),!this.dataApi.isAssignmentForResource({assignment:r,resource:t,resourceStore:this.resourceStore})):!this.dataApi.isEventAssignedToResource({event:r,resource:t,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore})))}},{key:"checkDragValidity",value:function(e,t){var n=this,r=this.currentOverClient,i=n.dragData.context.valid;return i&&(i=r.allowOverlap||r.isDateRangeAvailable(e.startDate,e.endDate,e.draggedRecords[0],e.newResource)?n.validatorFn.call(n.validatorFnThisObj||n,e,t):{valid:!1,message:n.L("eventOverlapsExisting")}),i}},{key:"updateRecords",value:function(e){var t,n=this.scheduler,r=this.currentOverClient,i=n.assignmentStore,o=n.eventStore,a=e.draggedRecords;if(o!==r.eventStore&&(o.remove(a),r.eventStore.add(a)),i){if(r!==n)throw new Error("Assignments cannot be dragged cross-scheduler");t=this.updateRecordsMultipleAssignmentMode(n,r,e,!1)}else t=this.updateRecordsSingleAssignmentMode(n,r,e,!1);return r.trigger("eventDrop",{eventRecords:a,isCopy:!1,event:e.browserEvent,targetEventRecord:e.targetEventRecord,targetResourceRecord:e.newResource,context:e}),t}},{key:"updateRecordsSingleAssignmentMode",value:function(e,t,n,r){var i,o=this,a=e!==t,s=e.eventStore,l=e.resourceStore,u=n.draggedRecords,c=n.timeDiff,d=n.resourceRecord,h=n.newResource,f=o.unifiedDrag||a&&u.length>1,g=[],v=o.constrainDragToResource?0:l.indexOf(d)-l.indexOf(h),m=o.adjustStartDate(u[0].startDate,c);if(u.forEach((function(d,p){var y=n.eventBarEls[p],k=d.generation,b=a?Nc:d.resources;y.querySelector(e.eventInnerSelector).classList.add(e.committingCls),r?(d=d.fullCopy(null),g.push(d)):s!==t.eventStore&&(s.remove(u),t.eventStore.add(u),d.instanceMeta(t).fromDragProxy=!0),d.beginBatch();var w=f?m:o.adjustStartDate(d.startDate,c);(0!==v||f||a)&&b.length&&b.forEach((function(e){var r=h;if(!f&&!a){var i=l.indexOf(e)-v;i<0?i=0:i>=l.getCount()&&(i=l.getCount()-1),r=l.getAt(i)}if(e?d.reassign(e,r):d.assign(r),"vertical"!==t.mode){var o=t.rowManager.getRowFor(r)&&t.isInTimeAxis(d)?t.getEventRenderId(d,r):null;if(o)if(a){var s=Oe.from(n.context.element,t.foregroundCanvas,!0),u=n.context.element.cloneNode(!0);rn.setTranslateXY(u,s.x,s.y),u.classList.remove("b-first-render"),u.classList.remove("b-active"),u.classList.remove("b-drag-proxy"),u.classList.remove("b-dragging"),t.currentOrientation.cacheTimeSpanElement(d,r,u)}else t.currentOrientation.releaseTimeSpanDiv(y,!0),t.currentOrientation.updateElementId(y,o);else y.remove()}})),d.setStartDate(w,!0,s.skipWeekendsDuringDragDrop),d.endBatch(),d.generation!==k&&(i=!0)})),g.length){var p=s.count;s.add(g),s.count!==p&&(i=!0)}i||(n.valid=!1)}},{key:"updateRecordsMultipleAssignmentMode",value:function(e,t,n,r){var i,o=this,a=e!==t,s=e.eventStore,l=n.draggedRecords,u=n.timeDiff,c=n.resourceRecord,d=n.newResource,h={};l.forEach((function(l,f){var g=l.event,v=n.eventBarEls[f],m=g.generation,p=e.getEventRenderId(l.event,d);h[g.id]||(h[g.id]=!0,p&&(a?t.currentOrientation.cacheTimeSpanElement(g,v):t.currentOrientation.updateElementId(v,p)),g.setStartDate(o.adjustStartDate(g.startDate,u),!0,s.skipWeekendsDuringDragDrop),c!==d&&(r?g.assign(d):g.isAssignedTo(d)?g.unassign(l.resource):g.reassign(l.resource,d)),i=i||l.resource!==c||g.generation!==m)})),i||(n.valid=!1)}},{key:"getProductDragContext",value:function(e){var t,n=this.scheduler.resolveEventRecord(e.browserEvent.target);return t=this.constrainDragToResource?e.resourceRecord:this.constrainDragToTimeline?this.resolveResource()||e.newResource||e.resourceRecord:this.resolveResource(),{valid:Boolean(t),newResource:t,targetEventRecord:n}}},{key:"setupProductDragData",value:function(e){var t=this,n=t.scheduler,r=e.grabbed,i=n.resolveEventRecord(r),o=n.resolveResourceRecord(r),a=n.resolveAssignmentRecord(r),s=Oe.from(r),l=[a||i],u=[];if(t.constrainDragToResource&&!o)throw new Error("Resource could not be resolved for event: "+i.id);var c=n.getDateConstraints(t.constrainDragToResource?o:null,i);return t.constrainDragToTimeline&&t.setupConstraints(n.getScheduleRegion(t.constrainDragToResource?o:null,i),s,n.timeAxisViewModel.snapPixelAmount,Boolean(c)),n.multiEventSelect&&(n.isEventSelected(l[0])||t.drag.startEvent.ctrlKey)&&l.push.apply(l,t.getRelatedRecords(a||i)),l.forEach((function(e){var t;if(!(t=e instanceof Iu?n.getElementFromEventRecord(e.event,e.resource):n.getElementFromEventRecord(e,e.resource))){var r=n.generateTplData(e,e.resource,{timeAxis:!0,viewport:!0});r.top=r.row?r.top+r.row.top:n.getResourceEventBox(e,e.resource,!0).top,t=n.currentOrientation.renderTimeSpan(r,{},null,!0),n.currentOrientation.availableDivs.add(t),t=t.innerElement}u.push(t)})),u.forEach((function(e,t){return u[t]=e.parentNode})),{record:i,dateConstraints:c,eventBarEls:u,draggedRecords:l}}},{key:"getDragData",value:function(e,n){return Object.assign(se()(oe()(t.prototype),"getDragData",this).call(this,e,n),{resourceRecord:this.scheduler.resolveResourceRecord(e.grabbed)})}},{key:"getRelatedRecords",value:function(e){return this.scheduler.selectedEvents.filter((function(t){return t!==e&&t.isDraggable}))}},{key:"getCoordinate",value:function(e,t,n){var r=this.currentOverClient;if(r.isHorizontal){var i=n[0];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":i+=t.offsetWidth/2;break;case"end":i+=t.offsetWidth}return i}var o=n[1];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":o+=t.offsetHeight/2;break;case"end":o+=t.offsetHeight}return o}},{key:"resolveResource",value:function(){var e=this.currentOverClient,t=e.isHorizontal,n=this.dragData.context,r=n.dragProxy||n.element,i=e.timeAxisSubGrid.virtualScrollerElement,o=Oe.from(r,null,!0),a=t?n.clientX:o.center.x,s=e.isVertical||this.unifiedDrag?n.clientY:o.center.y,l=Oe.from(r,this.currentOverClient.timeAxisSubGridElement,!0).center,u=l.x,c=l.y;if(t){var d=e.rowManager.getRowAt(s);if(d)return e.resourceStore.getAt(d.dataIndex)}r.style.pointerEvents="none",i&&(i.style.display="none");var h=rn.elementFromPoint(a,s);return r.style.pointerEvents="",i&&(i.style.display=""),h&&e.resolveResourceRecord(h,[u,c])}},{key:"adjustStartDate",value:function(e,t){var n=this.currentOverClient;return n.timeAxis.roundDate(new Date(e-0+t),!!n.snapRelativeToEventStartDate&&e)}},{key:"resolveStartEndDates",value:function(e){var t=this.currentOverClient,n=this.dragData,r=t.getStartEndDatesFromRectangle(e,"round",n.duration),i=r.start,o=r.end;if(n.startsOutsideView)n.endsOutsideView||(i=vt.add(o,-n.duration,"ms"));else{if(i&&!t.timeAxis.dateInAxis(i,!1)){var a=t.timeAxis.getTickFromDate(i);a&&(i=t.timeAxis.getDateFromTick(a))}o=vt.add(i,n.duration,"ms")}return{startDate:i,endDate:o}}},{key:"scheduler",get:function(){return this.client}},{key:"store",get:function(){return this.eventStore}}],[{key:"$name",get:function(){return"EventDrag"}},{key:"defaultConfig",get:function(){return{constrainDragToResource:!1,constrainDragToTimeSlot:!1,validatorFn:function(){},validatorFnThisObj:null,unifiedDrag:null}}}]),t}(pi(Hc).mixes(Sc,Tc));Bc._$name="EventDrag",Xs.registerFeature(Bc,!0,"Scheduler");var zc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),this.resize&&this.resize.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"addProxy",value:function(e){var t,n,r,i,o=this,a=o.client,s=a.barMargin,l=a.currentOrientation.getRowRegion(e.rowRecord);return a.isHorizontal?(r="currentX"in e?Math.min(e.startX,e.currentX+1):e.startX,i=l.y+s,t=e.width||o.dragTolerance,n=l.height-2*s):(r=l.x+s,i="currentY"in e?Math.min(e.startY,e.currentY+1):e.startY,t=l.width-2*s,n=e.height||o.dragTolerance),a.element.classList.add("b-dragcreating"),a.element.classList.add("b-dragcreating-proxy-sizing"),o.proxy=rn.createElement({parent:a.foregroundCanvas,className:o.proxyCls,style:"transform:translate(".concat(r,"px, ").concat(i,"px);width:").concat(t,"px;height:").concat(n,"px"),retainElement:!0})}},{key:"removeProxy",value:function(){var e=this;e.proxy&&(e.proxy.remove(),e.resize.destroy(),e.proxy=e.resize=null,e.client.element.classList.remove("b-dragcreating"),e.client.element.classList.remove("b-dragcreating-proxy-sizing"),e.tip&&e.tip.hide())}},{key:"initResizer",value:function(e,t){var n,r=this;n=r.client.isHorizontal?t.currentX>t.startX?"right":"left":t.currentY>t.startY?"bottom":"top",r.resize&&r.resize.destroy(),r.resize=new ls({name:r.constructor.name,direction:r.client.isVertical?"vertical":"horizontal",isTouch:e.type.startsWith("touch"),grab:{element:r.proxy,edge:n,event:t.startEvent},allowEdgeSwitch:!0,outerElement:r.client.timeAxisSubGridElement,scrollManager:r.client.scrollManager,scroller:r.client.timeAxisSubGrid.scrollable,listeners:{resizing:r.onResizing,resize:r.onResize,cancel:r.onCancel,thisObj:r}}),r.resize.context.resource=t.resource}},{key:"initTooltip",value:function(){var e=this,t=e.client;e.showTooltip&&(e.tip?e.tip.showBy(e.getTooltipTarget()):(e.clockTemplate=new Pc({timeAxisViewModel:t.timeAxisViewModel}),e.tip=new Ur({id:"".concat(t.id,"-drag-create-tip"),autoShow:!0,trackMouse:!1,getHtml:e.getTipHtml.bind(e),align:t.isVertical?"t-b":"b100-t100",hideDelay:0,axisLock:!0}),e.tip.on("innerhtmlupdate",e.updateDateIndicator,e)))}},{key:"updateDateIndicator",value:function(){var e=this.createContext,t=e.startDate,n=e.endDate,r=this.tip,i=r.element.querySelector(".b-sch-tooltip-enddate");t&&n&&(this.clockTemplate.updateDateIndicator(r.element,t),i&&this.clockTemplate.updateDateIndicator(i,n))}},{key:"getTipHtml",value:function(){if(this.resize.context){var e,t,n=this,r=n.client,i=n.resize.context,o=i.edge,a=i.newX,s=i.newY,l=i.elementStartX,u=i.elementStartY,c=i.elementWidth,d=i.elementHeight,h=i.newWidth,f=i.newHeight,g=i.valid,v=i.message;if(r.isHorizontal){var m="left"===o?a:l,p=Math.min(Math.max(m+(h||c)-1,0),r.timeAxisViewModel.totalSize-1);e=r.getDateFromCoordinate(m,"round",!0),t=r.getDateFromCoordinate(p,"round",!0)}else{var y="top"===o?s:u,k=Math.min(Math.max(y+(f||d)-1,0),r.timeAxisViewModel.totalSize-1);e=r.getDateFromCoordinate(y,"round",!0),t=r.getDateFromCoordinate(k,"round",!0)}var b=vt.min(e,t),w=vt.max(e,t),S=b&&r.getFormattedDate(b),C=w&&t&&r.getFormattedEndDate(w,b);return n.tipTemplate({valid:g,startDate:b,endDate:w,startText:S,endText:C,message:v,startClockHtml:n.clockTemplate.template({date:b,text:S,cls:"b-sch-tooltip-startdate"}),endClockHtml:n.clockTemplate.template({date:r.getDisplayEndDate(w,b),text:C,cls:"b-sch-tooltip-enddate"})})}}},{key:"finalize",value:function(e){var t=this,n=function(){t.proxy.retainElement=!1,t.reset()},r=function(){t.client.trigger("afterDragCreate",{proxyElement:t.proxy}),n()};if(e){var i=t.finalizeDragCreate(t.createContext);i instanceof Promise?i.then(r,n):r()}else r()}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;if(0===e.button&&e.target.matches(".b-sch-timeaxis-cell")&&!t.disabled&&!n.readOnly){var r=n.isVertical?n.resolveResourceRecord(e):n.getRecordFromElement(e.target);if(r.meta.specialRow)return;if(t.preventMultiple&&!t.isRowEmpty(r))return;t.monitorMove=!0,t.createContext={startEvent:e,startScreenX:e.screenX,startScreenY:e.screenY,startX:e.offsetX,startY:e.offsetY,cellElement:e.target,rowRecord:r},t.mouseUpDetacher=Ln.on({element:document.body,mouseup:"onMouseUp",once:!0,thisObj:this})}}},{key:"onElementMouseMove",value:function(e){var t=this;if(t.monitorMove){var n=t.createContext,r=t.client,i=t.client.isVertical?n.startScreenY-e.screenY:n.startScreenX-e.screenX;if(Math.abs(i)>t.dragTolerance){var o=r.getDateFromDomEvent(e),a=Oe.from(r.timeAxisSubGridElement,null,!0);if(!1===t.handleBeforeDragCreate(o,e))return void(t.monitorMove=!1);n.currentX=Math.max(e.clientX-a.x+r.timeAxisSubGrid.scrollable.x,0),n.currentY=Math.max(e.clientY-a.y+r.timeAxisSubGrid.scrollable.y,0),t.addProxy(t.createContext),t.initResizer(e,t.createContext),t.initTooltip(),t.monitorMove=!1,r.trigger("dragCreateStart",{proxyElement:t.proxy})}}t.proxy&&t.showTooltip&&t.resize.context&&t.tip.alignTo(t.getTooltipTarget())}},{key:"getTooltipTarget",value:function(){var e=this,t=Oe.from(e.proxy,null,!0);return e.client.isVertical?("bottom"===e.resize.context.edge&&(t.y=t.bottom-1),t.height=e.tip.anchorSize[1]/2):("right"===e.resize.context.edge&&(t.x=t.right-1),t.width=e.tip.anchorSize[0]/2),{target:t}}},{key:"onMouseUp",value:function(){this.client.element.classList.remove("b-dragcreating-proxy-sizing"),this.monitorMove=!1}},{key:"onElementContextMenu",value:function(){if(this.proxy)return!1}},{key:"onResizing",value:function(e){var t=e.context,n=e.event,r=this,i=r.client,o="left"===t.edge?t.newX:t.elementStartX,a="top"===t.edge?t.newY:t.elementStartY,s=Math.min(o+Math.max((t.newWidth||t.elementWidth)-1,0),i.timeAxisViewModel.totalSize-1),l=Math.min(a+Math.max((t.newHeight||t.elementHeight)-1,0),i.timeAxisViewModel.totalSize-1),u=i.isVertical?a:o,c=i.isVertical?l:s,d=i.getDateFromCoordinate(u,"round",!0),h=i.getDateFromCoordinate(c,"round",!0),f=r.dateConstraints,g=vt.min(d,h),v=vt.max(d,h);f&&(v=vt.constrain(v,f.start,f.end),g=vt.constrain(g,f.start,f.end)),Object.assign(r.createContext,{startDate:g,endDate:v}),t.valid=r.checkValidity(r.createContext,n),t.message="",t.valid&&"boolean"!=typeof t.valid&&(t.message=t.valid.message,t.valid=t.valid.valid),t.valid=!1!==t.valid}},{key:"onResize",value:function(e){var t=e.context.valid,n=e.event,r=this,i=r.createContext,o=i.startDate,a=i.endDate;(!o||!a||a-o<=0)&&(t=!1),r.createContext=r.prepareCreateContextForFinalization(r.createContext,n,r.finalize.bind(r)),t&&r.client.trigger("beforeDragCreateFinalize",{context:r.createContext,event:n,proxyElement:r.proxy}),r.createContext&&(r.resize.context.async=r.createContext.async,r.createContext.async?r.resize.removeListeners():r.finalize(t))}},{key:"prepareCreateContextForFinalization",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.assign({},e,{async:r,event:t,finalize:n})}},{key:"onCancel",value:function(){this.cancel()}},{key:"cancel",value:function(){this.reset(),this.mouseUpDetacher&&this.mouseUpDetacher()}},{key:"reset",value:function(){this.removeProxy(),this.createContext=null,this.monitorMove=!1}},{key:"checkValidity",value:function(e,t){throw new Error("Implement in subclass")}},{key:"triggerDragCreateEnd",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleBeforeDragCreate",value:function(e,t){throw new Error("Implement in subclass")}},{key:"isRowEmpty",value:function(e){throw new Error("Implement in subclass")}},{key:"dragging",get:function(){return this.resize}}],[{key:"defaultConfig",get:function(){return{showTooltip:!0,dragTolerance:2,preventMultiple:!1,validatorFn:function(){},validatorFnThisObj:null,proxyCls:"b-sch-dragcreator-proxy",tipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")}}}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove"],before:["onElementContextMenu"]}}}]),t}(ai);zc._$name="DragCreateBase";var jc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.scheduler=e,this.store=e.eventStore,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"finalizeDragCreate",value:function(e){var t=new this.store.modelClass({startDate:e.startDate,endDate:e.endDate});this.proxy.dataset.eventId=t.id,this.scheduler.trigger("dragCreateEnd",{newEventRecord:t,resourceRecord:e.rowRecord,event:e.event,proxyElement:this.proxy})}},{key:"handleBeforeDragCreate",value:function(e,t){var n=this,r=n.scheduler.trigger("beforeDragCreate",{resourceRecord:n.createContext.rowRecord,date:e,event:t});if(r){var i=n.scheduler.features.scheduleTooltip;i&&i.hoverTip&&i.hoverTip.hide()}return n.dateConstraints=n.scheduler.getDateConstraints(n.createContext.rowRecord,e),r}},{key:"checkValidity",value:function(e,t){var n=this.client;return e.resourceRecord=e.rowRecord,(n.allowOverlap||n.isDateRangeAvailable(e.startDate,e.endDate,null,e.resourceRecord))&&this.validatorFn.call(this.validatorFnThisObj||this,e,t)}},{key:"isRowEmpty",value:function(e){var t=this.store.getEventsForResource(e);return!t||!t.length}}],[{key:"$name",get:function(){return"EventDragCreate"}},{key:"defaultConfig",get:function(){return{validatorFn:function(){}}}}]),t}(zc);jc._$name="EventDragCreate",Xs.registerFeature(jc,!0,"Scheduler");var Vc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){if(this.timeline=e,e.multiEventSelect=!0,e.features.eventDragCreate||e.features.pan)throw new Error("Cannot combine this feature with Pan or EventDragCreate features");this.targetSelector=[".b-grid-cell",".b-timeline-subgrid"].join(","),se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;e.touches||0!==e.button||t.disabled||e.target.matches(t.targetSelector)&&(t.startX=e.clientX,t.startY=e.clientY,t.element=rn.createElement({tag:"div",className:"b-dragselect-rect"},!0)[0],vr.floatRoot.appendChild(t.element),n.element.classList.add("b-dragselecting"),t.eventRectangles=Array.from(n.element.querySelectorAll(n.eventSelector)).map((function(e){return{rectangle:Oe.from(e),record:n.resolveEventRecord(e)}})),n.clearEventSelection(),t.subGridElementRect=Oe.from(n.timeAxisSubGrid.element),n.navigator.disabled=!0)}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||ge.isSafari||ge.isIE11&&!e.isTrusted){if("number"==typeof t.startX){var n=Math.max(e.clientX,t.subGridElementRect.left),r=Math.max(e.clientY,t.subGridElementRect.top),i=Math.min(t.startX,n),o=Math.min(t.startY,r),a=Math.abs(t.startX-n),s=Math.abs(t.startY-r),l=new Oe(i,o,a,s).constrainTo(t.subGridElementRect);rn.setTranslateXY(t.element,l.left,l.top),t.element.style.width=l.width+"px",t.element.style.height=l.height+"px",t.rectangle=l,t.updateSelection()}}else t.onElementMouseUp(e)}},{key:"onElementMouseUp",value:function(e){var t=this;"number"==typeof t.startX&&(t.element&&t.element.remove(),t.client.element.classList.remove("b-dragselecting"),t.startX=t.startY=null,t.setTimeout((function(){return t.client.navigator.disabled=!1}),100))}},{key:"updateSelection",value:function(){for(var e=this.eventRectangles,t=this.rectangle,n=0,r=e.length;n<r;n++){var i=e[n],o=t.intersect(i.rectangle,!0);o&&!i.selected?(i.selected=!0,this.client.selectEvent(i.record,!0)):!o&&i.selected&&(i.selected=!1,this.client.deselectEvent(i.record))}}}],[{key:"$name",get:function(){return"EventDragSelect"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),t}(de(ai));Vc._$name="EventDragSelect",Xs.registerFeature(Vc,!1,"Scheduler");var Wc=vt,Gc=function(e){if(1===e.length)return e[0].value;if(2===e.length){var t=e[0]instanceof oo?e:e.reverse(),n=fe()(t,2),r=n[0],i=n[1],o=Wc.parse(r.value);return o.setHours(i.value.getHours(),i.value.getMinutes(),i.value.getSeconds(),i.value.getMilliseconds()),o}return null},Yc=function(e,t,n){if(e&&t){var r=Wc.add((i=n.startDateField.value,o=n.startTimeField.value,(a=new Date(i.getTime())).setHours(o.getHours(),o.getMinutes()),a),n.eventRecord.durationMS,"milliseconds");n.endDateField.value=r,n.endTimeField.value=Wc.clone(r)}var i,o,a},Uc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i;return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r,i=this;e.eventEdit=i,se()(oe()(t.prototype),"construct",this).call(this,e,n),i.clientListenersDetacher=e.on((r={},$()(r,i.triggerEvent,i.onActivateEditor),$()(r,"dragcreateend",i.onDragCreateEnd),$()(r,"thisObj",i),r))}},{key:"doDestroy",value:function(){this.clientListenersDetacher(),this.editor&&this.editor.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"insertExtraWidgetsIntoDefaultWidgets",value:function(e){if(this.extraItems&&this.extraItems.length){var t,n=e.items.findIndex((function(e){return"extraItems"===e.type}));n>-1&&(e.items.splice(n,1),t=e.items.splice(n));var r=this.extraItems.filter((function(e){return e.index>=0})),i=this.extraItems.filter((function(e){return!(e.index>=0)}));e.items=e.items.concat(i),r.sort((function(e,t){return e.index-t.index})),r.forEach((function(t){return e.items.splice(t.index,0,t)})),t&&t.length&&(e.items=e.items.concat(t))}}},{key:"onDatesChange",value:function(e){var t=this,n=e.source,r=e.value;switch(n.ref){case"startDateField":t.startTimeField&&Yc(r,t.startTimeField.value,t);break;case"startTimeField":t.startDateField&&Yc(t.startDateField.value,r,t)}t.endTimeField&&(Wc.isEqual(Wc.clearTime(t.startDateField.value),Wc.clearTime(t.endDateField.value))?t.endTimeField.min=t.startTimeField.value:t.endTimeField.min=null)}},{key:"save",value:(i=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Implement in subclass");case 1:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;this.scheduler.assignmentStore&&delete t.resource,e.set(t)}},{key:"onPopupBeforeHide",value:function(){var e=this;e.isEditing=!1,e.client.element.classList.remove("b-eventeditor-editing"),e.dragProxyElement&&e.dragProxyElement.remove(),e.dragProxyElement=null}},{key:"onPopupKeyDown",value:function(e){var t=e.event;"Enter"===t.key&&this.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),"startDate"===t.target.name&&Yc(this.startDateField.value,this.startTimeField.value,this),this.onSaveClick())}},{key:"onSaveClick",value:(r=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.save();case 2:e.sent&&this.editor.close();case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onDeleteClick",value:(n=Di()(Ei.a.mark((function e(){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deleteEvent();case 2:e.sent&&(this.editor.autoClose&&!this.editor.containsFocus||this.editor.close());case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onCancelClick",value:function(){this.editor.close()}},{key:"editorConfig",get:function(){return this._editorConfig},set:function(e){var t=this.getDefaultConfiguration().editorConfig;(e=kt.assign({},t,e)).items=e.items||[],this.insertExtraWidgetsIntoDefaultWidgets(e),this._editorConfig=e}},{key:"extraWidgets",get:function(){return this._skipWarn||console.warn("`extraWidgets` was deprecated in 2.1, please change your code to use `extraItems`"),this._extraItems},set:function(e){console.warn("`extraWidgets` was deprecated in 2.1, please change your code to use `extraItems`"),this._extraItems=e}},{key:"extraItems",get:function(){var e=this;return e._skipWarn=!0,e._thisIsAUsedExpression(e.extraWidgets),e._skipWarn=!1,e._extraItems},set:function(e){this._extraItems=e}},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e=[],t=[],n={};return this.editor.eachWidget((function(r){var i=r.name;if(i&&!r.hidden)switch(i){case"startDate":e.push(r);break;case"endDate":t.push(r);break;case"resource":n[i]=r.record;break;default:n[i]=r.value}}),!0),n.startDate=Gc(e),n.endDate=Gc(t),n.duration=Wc.diff(n.startDate,n.endDate,this.editor.record.durationUnit,!0),n}}],[{key:"defaultConfig",get:function(){return{autoClose:!0,saveAndCloseOnEnter:!0,triggerEvent:null,showDeleteButton:!0,showNameField:!0,startTimeConfig:null,startDateConfig:null,endTimeConfig:null,endDateConfig:null,dateFormat:"L",timeFormat:"LT",editorConfig:null,extraItems:null,extraWidgets:null}}}]),t}(ai);Uc._$name="EditBase";var qc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"processWidgetConfig",value:function(e){var n=this.eventEditFeature;if("extraItems"===e.type)return!1;var r={};if("resourceField"===e.ref){if(!n.showResourceField)return!1;this.resourceStore=e.store=new n.resourceStore.constructor({chained:!0,chainAllRecords:!0,masterStore:n.resourceStore,chainedFilterFn:function(e){return!e.meta.specialRow}}),e.multiSelect=Boolean(n.scheduler.assignmentStore),n.resourceFieldConfig&&(r=n.resourceFieldConfig)}return!("nameField"===e.ref&&!n.showNameField)&&(!("deleteButton"===e.ref&&!n.showDeleteButton)&&("startDate"!==e.name&&"endDate"!==e.name||"date"!==e.type||(r.format=n.dateFormat),"startDate"!==e.name&&"endDate"!==e.name||"time"!==e.type||(r.format=n.timeFormat),n.startDateConfig&&"startDate"===e.name&&"date"===e.type&&(r=n.startDateConfig),n.startTimeConfig&&"startDate"===e.name&&"time"===e.type&&(r=n.startTimeConfig),n.endDateConfig&&"endDate"===e.name&&"date"===e.type&&(r=n.endDateConfig),n.endTimeConfig&&"endDate"===e.name&&"time"===e.type&&(r=n.endTimeConfig),Object.assign(e,r),se()(oe()(t.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"show",value:function(){var e;this.resourceStore&&this.resourceStore.fillFromMaster();for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=se()(oe()(t.prototype),"show",this)).call.apply(e,[this].concat(r))}},{key:"afterShow",value:function(){var e,n=this.widgetMap.deleteButton;n&&(n.hidden=this.readOnly||!this.record.stores.length);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=se()(oe()(t.prototype),"afterShow",this)).call.apply(e,[this].concat(i))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),se()(oe()(t.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"readOnly",set:function(e){var t=this.widgetMap,n=t.deleteButton,r=t.saveButton,i=t.cancelButton;this._readOnly=e,this.element.classList[e?"add":"remove"]("b-readonly"),this.eachWidget((function(t){t.readOnly=e})),n&&(n.hidden=e),r&&(r.hidden=e),i&&(i.hidden=e)},get:function(){return this._readOnly}}],[{key:"$name",get:function(){return"EventEditor"}},{key:"defaultConfig",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible"}}}]),t}(Ar);qc._$name="EventEditor";var $c=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){for(var e,n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=se()(oe()(t.prototype),"construct",this)).call.apply(e,[this].concat(i));var a=n.widgetMap,s=a.changeMultipleButton,l=a.changeSingleButton,u=a.cancelButton;s&&s.on("click",n.onChangeMultipleButtonClick,n),l&&l.on("click",n.onChangeSingleButtonClick,n),u&&u.on("click",n.onCancelButtonClick,n),n.on("toolclick",n.onToolClick,n)}},{key:"onChangeMultipleButtonClick",value:function(){this.processMultipleRecords(),this.close()}},{key:"onChangeSingleButtonClick",value:function(){this.processSingleRecord(),this.close()}},{key:"onCancelButtonClick",value:function(){this.cancelFn&&this.cancelFn.call(this.thisObj),this.close()}},{key:"onToolClick",value:function(e){"close"===e.tool.handler&&this.cancelFn&&this.cancelFn.call(this.thisObj)}},{key:"confirm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;return["actionType","eventRecord","title","html","changerFn","cancelFn","thisObj"].forEach((function(t){t in e&&(n[t]=e[t])})),n.updatePopupContent(),se()(oe()(t.prototype),"show",this).call(this,e)}},{key:"updatePopupContent",value:function(){var e=this,t=e.widgetMap,n=t.changeMultipleButton,r=t.changeSingleButton,i=t.cancelButton,o=e.eventRecord,a=e.actionType,s=void 0===a?"update":a,l=o&&o.isRecurring;l?(n.text=e.L("Yes"),e.html=e.L("".concat(s,"-all-message"))):(n.text=e.L("".concat(s,"-further-btn-text")),e.html=e.L("".concat(s,"-further-message"))),r.text=e.L("".concat(s,"-only-this-btn-text")),i.text=e.L("Cancel"),l?r.hide():r.show(),e.width=e.L("width"),e.title=e.L("".concat(s,"-title"))}},{key:"processMultipleRecords",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj,r=e.recurringEvent,i=new Date(e.startDate-1);e.beginBatch(),t.call(n,e),e.recurringTimeSpanId=null,e.endBatch(),r&&(r.recurrence.endDate=i)}},{key:"processSingleRecord",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj,r=e.recurringEvent,i=e.startDate;e.beginBatch(),t.call(n),e.recurrence=null,e.endBatch(),r.addExceptionDate(i)}},{key:"updateLocalization",value:function(){this.updatePopupContent(),se()(oe()(t.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"RecurrenceConfirmationPopup"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],align:"b-t",autoShow:!1,autoClose:!1,centered:!0,scrollAction:"realign",constrainTo:window,draggable:!0,closable:!0,floating:!0,eventRecord:null,cls:"b-sch-recurrenceconfirmation",bbar:[{color:"b-green",localeClass:this,text:"L{Yes}",ref:"changeMultipleButton"},{color:"b-gray",localeClass:this,text:"L{update-only-this-btn-text}",ref:"changeSingleButton"},{color:"b-gray",localeClass:this,text:"L{Cancel}",ref:"cancelButton"}]}}}]),t}(Ar);$c._$name="RecurrenceConfirmationPopup",X.register("recurrenceconfirmation",$c);var Xc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){return[{value:"DAILY",text:this.L("Daily")},{value:"WEEKLY",text:this.L("Weekly")},{value:"MONTHLY",text:this.L("Monthly")},{value:"YEARLY",text:this.L("Yearly")}]}}],[{key:"$name",get:function(){return"RecurrenceFrequencyCombo"}},{key:"defaultConfig",get:function(){return{editable:!1,displayField:"text",valueField:"value"}}}]),t}(Al(qi));Xc._$name="RecurrenceFrequencyCombo",X.register("recurrencefrequencycombo",Xc);var Kc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){return[{value:"none",text:this.L("None")}].concat(G()(se()(oe()(t.prototype),"buildLocalizedItems",this).call(this)),[{value:this.customValue,text:this.L("Custom..."),cls:this.splitCls}])}},{key:"isCustomRecurrence",value:function(e){var t=e.interval,n=e.days,r=e.monthDays,i=e.months;return Boolean(t>1||n&&n.length||r&&r.length||i&&i.length)}},{key:"value",set:function(e){e=e||"none",fn()(oe()(t.prototype),"value",e,this,!0)},get:function(){return se()(oe()(t.prototype),"value",this)}},{key:"recurrence",set:function(e){this.value=e?this.isCustomRecurrence(e)?this.customValue:e.frequency:null}}],[{key:"$name",get:function(){return"RecurrenceCombo"}},{key:"defaultConfig",get:function(){return{customValue:"custom",placeholder:"None",splitCls:"b-recurrencecombo-split",items:!0,highlightExternalChange:!1}}}]),t}(Xc);Kc._$name="RecurrenceCombo",X.register("recurrencecombo",Kc);var Jc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"updateLegend",value:function(){var e=this.recurrence;this.text=e?fc.getLegend(e,this.eventStartDate):""}},{key:"onLocaleChange",value:function(){this.updateLegend()}},{key:"updateLocalization",value:function(){this.onLocaleChange(),se()(oe()(t.prototype),"updateLocalization",this).call(this)}},{key:"recurrence",set:function(e){this._recurrence=e,this.updateLegend()},get:function(){return this._recurrence}},{key:"eventStartDate",set:function(e){this._eventStartDate=e,this.updateLegend()},get:function(){return this._eventStartDate}}],[{key:"$name",get:function(){return"RecurrenceLegendButton"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],recurrence:null}}}]),t}(Jr);Jc._$name="RecurrenceLegendButton",X.register("recurrencelegendbutton",Jc);var Qc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){var e=this;return e._weekDays=null,e.weekDays.concat([{value:e.allDaysValue,text:e.L("day"),cls:e.splitCls},{value:e.workingDaysValue,text:e.L("weekday")},{value:e.nonWorkingDaysValue,text:e.L("weekend day")}])}},{key:"weekDays",get:function(){if(!this._weekDays){var e=vt.weekStartDay,t=vt.getDayNames().map((function(e,t){return{text:e,value:qu.encodeDay(t)}}));this._weekDays=t.slice(e).concat(t.slice(0,e))}return this._weekDays}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),fn()(oe()(t.prototype),"value",e,this,!0)},get:function(){var e=se()(oe()(t.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e}}],[{key:"$name",get:function(){return"RecurrenceDaysCombo"}},{key:"defaultConfig",get:function(){return{allDaysValue:"SU,MO,TU,WE,TH,FR,SA",editable:!1,defaultValue:"SU,MO,TU,WE,TH,FR,SA",workingDaysValue:"MO,TU,WE,TH,FR",nonWorkingDaysValue:"SU,SA",splitCls:"b-recurrencedays-split",displayField:"text",valueField:"value"}}}]),t}(Al(qi));Qc._$name="RecurrenceDaysCombo",X.register("recurrencedayscombo",Qc);var Zc=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;e.columns=7,e.items=n.buildItems(),se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"updateItemText",value:function(e){var t=qu.decodeDay(e.value)[0];e.text=vt.getDayName(t).substring(0,3)}},{key:"buildItems",value:function(){if(!this.__items){var e=vt.weekStartDay,t=vt.getDayNames().map((function(e,t){return{text:e.substring(0,3),value:qu.encodeDay(t)}}));this.__items=t.slice(e).concat(t.slice(0,e))}return this.__items}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),se()(oe()(t.prototype),"updateLocalization",this).call(this)}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),fn()(oe()(t.prototype),"value",e,this,!0)},get:function(){var e=se()(oe()(t.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e}},{key:"widgetClassList",get:function(){var e=se()(oe()(t.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceDaysButtonGroup"}},{key:"defaultConfig",get:function(){return{defaults:{cls:"b-raised",toggleable:!0}}}}]),t}(Qr);Zc._$name="RecurrenceDaysButtonGroup",X.register("recurrencedaysbuttongroup",Zc);var ed=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;e.columns=7,e.items=n.buildItems(),se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){for(var e=[],t=this.minValue;t<=this.maxValue;t++)e.push({text:t+"",value:t});return e}},{key:"minValue",get:function(){return 1}},{key:"maxValue",get:function(){return 31}},{key:"widgetClassList",get:function(){var e=se()(oe()(t.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthDaysButtonGroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),t}(Qr);ed._$name="RecurrenceMonthDaysButtonGroup",X.register("recurrencemonthdaysbuttongroup",ed);var td=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;e.columns=4,e.items=n.buildItems(),se()(oe()(t.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){return vt.getMonthNames().map((function(e,t){return{text:e.substring(0,3),value:t+1}}))}},{key:"updateItemText",value:function(e){e.text=vt.getMonthName(e.value-1).substring(0,3)}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),se()(oe()(t.prototype),"updateLocalization",this).call(this)}},{key:"widgetClassList",get:function(){var e=se()(oe()(t.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthsButtonGroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),t}(Qr);td._$name="RecurrenceMonthsButtonGroup",X.register("recurrencemonthsbuttongroup",td);var nd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){return[{value:"never",text:this.L("Never")},{value:"count",text:this.L("After")},{value:"date",text:this.L("On date")}]}},{key:"value",set:function(e){e=e||"never",fn()(oe()(t.prototype),"value",e,this,!0)},get:function(){return se()(oe()(t.prototype),"value",this)}},{key:"recurrence",get:function(){return this._recurrence},set:function(e){var t=null;e.endDate?t="date":e.count&&(t="count"),this._recurrence=e,this.value=t}}],[{key:"$name",get:function(){return"RecurrenceStopConditionCombo"}},{key:"defaultConfig",get:function(){return{editable:!1,placeholder:"Never",displayField:"text",valueField:"value"}}}]),t}(Al(qi));nd._$name="RecurrenceStopConditionCombo",X.register("recurrencestopconditioncombo",nd);var rd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){return this.buildDayNumbers().concat([{value:"-1",text:this.L("position-1"),cls:this.splitCls}])}},{key:"buildDayNumbers",value:function(){var e=this;return He.populate(e.maxPosition,(function(t){return{value:t,text:e.L("position".concat(t))}}))}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),fn()(oe()(t.prototype),"value",e,this,!0)},get:function(){var e=se()(oe()(t.prototype),"value",this);return e?"".concat(e).split(",").map((function(e){return parseInt(e,10)})):[]}}],[{key:"$name",get:function(){return"RecurrencePositionsCombo"}},{key:"defaultConfig",get:function(){return{editable:!1,splitCls:"b-sch-recurrencepositions-split",displayField:"text",valueField:"value",defaultValue:1,maxPosition:5}}}]),t}(Al(qi));rd._$name="RecurrencePositionsCombo",X.register("recurrencepositionscombo",rd);var id=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onSaveClick",value:function(){var e=this;e.saveHandler?e.saveHandler.call(e.thisObj||e,e,e.record):(e.updateRecord(),e.close())}},{key:"onCancelClick",value:function(){var e=this;e.cancelHandler?e.cancelHandler.call(e.thisObj||e,e,e.record):e.close()}},{key:"updateRecord",value:function(e){var t=this.getValues((function(t){return t.name in e&&!t.disabled}));e.set(t)}},{key:"toggleStopFields",value:function(){var e=this.widgetMap,t=e.countField,n=e.endDateField;switch(this.widgetMap.stopRecurrenceField.value){case"count":t.show(),t.enable(),n.hide(),n.disable();break;case"date":t.hide(),t.disable(),n.show(),n.enable();break;default:t.hide(),n.hide(),t.disable(),n.disable()}}},{key:"onMonthDaysRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap.monthDaysButtonField;n.disabled=!t||!this.isWidgetAvailableForFrequency(n)}},{key:"onPositionAndDayRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap,r=n.daysCombo,i=n.positionsCombo;r.disabled=i.disabled=!t||!this.isWidgetAvailableForFrequency(r)}},{key:"onStopRecurrenceFieldChange",value:function(){this.toggleStopFields()}},{key:"isWidgetAvailableForFrequency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.widgetMap.frequencyField.value;return!e.forFrequency||e.forFrequency.indexOf(t)>-1}},{key:"onFrequencyFieldChange",value:function(e){var t=e.value,n=e.valid,r=this,i=r.queryAll((function(e){return"forFrequency"in e}));if(n&&t){for(var o=0;o<i.length;o++){var a=i[o];r.isWidgetAvailableForFrequency(a,t)?(a.show(),a.enable()):(a.hide(),a.disable())}r.widgetMap.intervalField.intervalUnit.innerHTML=r.L("".concat(t,"intervalUnit")),r.toggleFieldsState()}}},{key:"toggleFieldsState",value:function(){var e=this.widgetMap;this.onMonthDaysRadioFieldChange({checked:e.monthDaysRadioField.checked}),this.onPositionAndDayRadioFieldChange({checked:e.positionAndDayRadioField.checked}),this.onStopRecurrenceFieldChange()}},{key:"updateLocalization",value:function(){var e=this.widgetMap,n=e.countField,r=e.intervalField,i=e.frequencyField;n.countUnit.innerHTML=this.L("time(s)"),r.intervalUnit.innerHTML=this.L("".concat(i.value,"intervalUnit")),se()(oe()(t.prototype),"updateLocalization",this).call(this)}},{key:"record",get:function(){return se()(oe()(t.prototype),"record",this)},set:function(e){fn()(oe()(t.prototype),"record",e,this,!0);var n=e.timeSpan,r=n&&n.startDate,i=this.widgetMap,o=i.daysButtonField,a=i.monthDaysButtonField,s=i.monthsButtonField,l=i.monthDaysRadioField,u=i.positionAndDayRadioField,c=i.stopRecurrenceField;r&&(e.days&&e.days.length||(o.value=[qu.encodeDay(r.getDay())]),e.monthDays&&e.monthDays.length||(a.value=r.getDate()),e.months&&e.months.length||(s.value=r.getMonth()+1)),e.days&&e.positions?(u.check(),this.isPainted||l.uncheck()):(l.check(),this.isPainted||u.uncheck()),c.recurrence=e}}],[{key:"$name",get:function(){return"RecurrenceEditor"}},{key:"defaultConfig",get:function(){return{draggable:!0,closable:!0,floating:!0,cls:"b-recurrenceeditor",title:"L{Repeat event}",autoClose:!0,width:400,items:{frequencyField:!0,daysButtonField:!0,monthDaysRadioField:!0,monthDaysButtonField:!0,monthsButtonField:!0,positionAndDayRadioField:!0,stopRecurrenceField:!0,countField:!0,endDateField:!0,intervalField:!0,positionsCombo:!0,daysCombo:!0},namedItems:{frequencyField:{type:"recurrencefrequencycombo",name:"frequency",localeClass:this,label:"L{Frequency}",weight:10,onChange:"up.onFrequencyFieldChange"},intervalField:{type:"numberfield",weight:15,name:"interval",localeClass:this,label:"L{Every}",labels:[{align:"end",reference:"intervalUnit",style:{width:"50em"}}],min:1,allowBlank:!1},daysButtonField:{type:"recurrencedaysbuttongroup",weight:20,name:"days",forFrequency:"WEEKLY"},monthDaysRadioField:{type:"checkbox",weight:30,toggleGroup:"radio",forFrequency:"MONTHLY",localeClass:this,label:"L{Each}",checked:!0,onChange:"up.onMonthDaysRadioFieldChange"},monthDaysButtonField:{type:"recurrencemonthdaysbuttongroup",weight:40,name:"monthDays",forFrequency:"MONTHLY"},monthsButtonField:{type:"recurrencemonthsbuttongroup",weight:50,name:"months",forFrequency:"YEARLY"},positionAndDayRadioField:{type:"checkbox",weight:60,toggleGroup:"radio",forFrequency:"MONTHLY|YEARLY",localeClass:this,label:"L{On the}",onChange:"up.onPositionAndDayRadioFieldChange"},positionsCombo:{type:"recurrencepositionscombo",weight:80,name:"positions",forFrequency:"MONTHLY|YEARLY"},daysCombo:{type:"recurrencedayscombo",weight:90,name:"days",forFrequency:"MONTHLY|YEARLY",flex:1},stopRecurrenceField:{type:"recurrencestopconditioncombo",weight:100,localeClass:this,label:"L{End repeat}",onChange:"up.onStopRecurrenceFieldChange"},countField:{type:"numberfield",weight:110,name:"count",min:2,localeClass:this,allowBlank:!1,disabled:!0,label:" ",labels:[{align:"end",reference:"countUnit",label:"L{time(s)}"}]},endDateField:{type:"datefield",weight:120,name:"endDate",hidden:!0,disabled:!0,label:" ",allowBlank:!1}},bbar:[{type:"widget",cls:"b-label-filler"},{type:"button",color:"b-green",ref:"saveButton",localeClass:this,text:"L{Save}",onClick:"up.onSaveClick"},{type:"button",color:"b-gray",ref:"cancelButton",localeClass:this,text:"L{Cancel}",onClick:"up.onCancelClick"}]}}}]),t}(Ar);id._$name="RecurrenceEditor",X.register("recurrenceeditor",id);var od=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"insertExtraWidgetsIntoDefaultWidgets",value:function(e){this.processEditorConfig(e),se()(oe()(t.prototype),"insertExtraWidgetsIntoDefaultWidgets",this).call(this,e)}},{key:"processEditorConfig",value:function(e){var t=e.items,n=t.findIndex((function(e){return"extraItems"===e.type}));n<0?t.push.apply(t,G()(this.recurringEventsItems)):t.splice.apply(t,[n,0].concat(G()(this.recurringEventsItems)))}},{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),this.scheduler.on({beforeEventDelete:this.onRecurrableEventBeforeDelete,beforeEventSave:this.onRecurrableEventBeforeSave,thisObj:this})}},{key:"onEditorConstructed",value:function(e){var t=this;e.on("hide",t.onRecurringEventEditorHide,t),t.editRecurrenceButton&&t.editRecurrenceButton.on("click",t.onEditRecurrenceClick,t)}},{key:"internalShowEditor",value:function(){this.toggleRecurringFieldsVisibility(this.isRecurringEnabled&&!1!==this.showRecurringUI)}},{key:"toggleRecurringFieldsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"show":"hide";this.editRecurrenceButton&&this.editRecurrenceButton[t](),this.recurrenceCombo&&this.recurrenceCombo[t]()}},{key:"onRecurringEventEditorHide",value:function(e){e.source;var t=this.recurrenceEditor,n=this.recurrenceConfirmation;t&&t.isVisible&&t.hide(),n&&n.isVisible&&n.hide()}},{key:"makeRecurrence",value:function(e){var t=this.eventRecord,n=t.copy(),r=t.recurrence;return(r=!e&&r?r.copy():new t.recurrenceModel({rule:e})).timeSpan=n,n.setStartDate(this.values.startDate),r.suspendTimeSpanNotifying(),r}},{key:"onRecurrableEventBeforeSave",value:function(e){var t=e.eventRecord,n=e.context;if(t.supportsRecurring&&(t.isRecurring||t.isOccurrence))return this.recurrenceConfirmation.confirm({actionType:"update",eventRecord:t,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),n.async=!0,!1}},{key:"showDisplayConfirmationOnEventDelete",value:function(e){return this.isEditing&&this.eventRecord===e&&e.supportsRecurring&&(e.isRecurring||e.isOccurrence)}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=fe()(t,1)[0];if(this.showDisplayConfirmationOnEventDelete(r))return this.recurrenceConfirmation.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"showRecurrenceEditor",value:function(){var e=this,t=e.recurrenceEditor,n=e.eventRecord;t&&n&&n.supportsRecurring&&(e.recurrence||(e.recurrence=e.makeRecurrence()),e.recurrence.timeSpan.setStartDate(e.values.startDate),t.record=e.recurrence,t.showBy(e.recurrenceCombo.element))}},{key:"onEditRecurrenceClick",value:function(){this.showRecurrenceEditor()}},{key:"loadRecurrenceData",value:function(e){this.recurrence=e,this.updateRecurrenceFields(e)}},{key:"updateRecurrenceFields",value:function(e){var t=this;t.recurrenceCombo&&(t.recurrenceCombo.recurrence=e),t.editRecurrenceButton&&(t.editRecurrenceButton.recurrence=e,t.editRecurrenceButton.value=e?e.rule:null,e&&t.isRecurringEnabled&&!1!==t.showRecurringUI?t.editRecurrenceButton.show():t.editRecurrenceButton.hide())}},{key:"onRecurrenceComboChange",value:function(e){var t=e.source,n=e.value,r=e.userAction;n==t.customValue?r&&this.showRecurrenceEditor():this.loadRecurrenceData(n?this.makeRecurrence("FREQ=".concat(n)):null)}},{key:"recurrenceEditorSaveHandler",value:function(e,t){e.updateRecord(t),this.updateRecurrenceFields(t),e.close()}},{key:"onDatesChange",value:function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=se()(oe()(t.prototype),"onDatesChange",this)).call.apply(e,[this].concat(r));var o=this,a=o.editRecurrenceButton;if(!o.loadingRecord&&a){var s=o.values.startDate;s&&(a.eventStartDate=s)}}},{key:"internalLoadRecord",value:function(e,t){this.recurrenceCombo&&e&&e.supportsRecurring&&this.loadRecurrenceData(e.recurrence?this.makeRecurrence():null)}},{key:"isRecurringEnabled",get:function(){return this.scheduler.features.recurringEvents&&!this.scheduler.features.recurringEvents.disabled}},{key:"recurrenceConfirmation",set:function(e){this._recurrenceConfirmation=e},get:function(){var e=this._recurrenceConfirmation;return e&&e.$name||(e=te.createWidget(Object.assign({type:"recurrenceconfirmation",owner:this.getEditor()},e)),this._recurrenceConfirmation=e),e}},{key:"recurrenceEditor",set:function(e){this._recurrenceEditor=e},get:function(){var e=this,t=e._recurrenceEditor;return t&&t.$name||(t=te.createWidget(Object.assign({type:"recurrenceeditor",autoShow:!1,owner:e.getEditor(),scrollAction:"realign",clippedBy:[e.scheduler.timeAxisSubGridElement,e.scheduler.bodyContainer],constrainTo:window,anchor:!0,saveHandler:e.recurrenceEditorSaveHandler,thisObj:e},t)),e._recurrenceEditor=t),t}}],[{key:"$name",get:function(){return"RecurringEventEdit"}},{key:"defaultConfig",get:function(){return{recurringEventsItems:[{type:"recurrencecombo",label:"L{Repeat}",ref:"recurrenceCombo"},{type:"recurrencelegendbutton",ref:"editRecurrenceButton",name:"recurrenceRule",flex:"1"}],showRecurringUI:null}}}]),t}(e||z)},ad=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.scheduler=e,this.eventStore=e.eventStore,this.resourceStore=e.resourceStore,se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"getEditor",value:function(){var e=this,t=e.editor;return t||(0===(t=e.editor=new qc(e.getEditorConfig())).items.length&&console.warn("Event Editor configured without any `items`"),t.on({beforehide:e.onPopupBeforeHide,keydown:e.onPopupKeyDown,thisObj:e}),Object.values(t.widgetMap).forEach((function(t){var n=t.ref||t.id;if(n&&!e[n])switch(e[n]=t,t.name){case"startDate":case"endDate":t.on("change",e.onDatesChange,e)}})),e.onEditorConstructed&&e.onEditorConstructed(t),e.eventTypeField&&e.eventTypeField.on("change",e.onEventTypeChange,e),e.saveButton&&e.saveButton.on("click",e.onSaveClick,e),e.deleteButton&&e.deleteButton.on("click",e.onDeleteClick,e),e.cancelButton&&e.cancelButton.on("click",e.onCancelClick,e),e.editor)}},{key:"getEditorConfig",value:function(){var e=this,t=e.autoClose,n=e.cls,r=e.readOnly;return kt.assign({eventEditFeature:e,align:"b-t",id:"".concat(e.scheduler.id,"-event-editor"),autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[e.scheduler.timeAxisSubGridElement,e.scheduler.bodyContainer],constrainTo:window,autoClose:t,readOnly:r,cls:n},e.editorConfig)}},{key:"internalShowEditor",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this,o=i.scheduler,a=r||rn.down(o.getElementFromEventRecord(e,n),o.eventInnerSelector);if(a||!e.isPartOfStore(o.eventStore)){if(!1===o.trigger("beforeEventEdit",{eventEdit:i,eventRecord:e,resourceRecord:n,eventElement:a}))return o.element.classList.remove("b-eventeditor-editing"),i.dragProxyElement&&i.dragProxyElement.remove(),void(i.dragProxyElement=null);i.resourceRecord=n;var s=i.getEditor(e);se()(oe()(t.prototype),"internalShowEditor",this)&&se()(oe()(t.prototype),"internalShowEditor",this).call(this,e,n,r),i.typeField&&i.toggleEventType(e.get(i.typeField)),o.trigger("beforeEventEditShow",{eventEdit:i,eventRecord:e,resourceRecord:n,eventElement:a,editor:s}),i.isEditing=!0,i.loadRecord(e,n),a?(a.classList.add("b-editing"),s.anchor=!0,s.showBy(a)):(s.anchor=!1,s.showBy({target:o.element,align:"c-c"}));var l=o.timeAxisViewModel.timeResolution;"hour"!==l.unit&&"minute"!==l.unit||(i.startTimeField.step=i.endTimeField.step="".concat(l.increment).concat(l.unit))}}},{key:"editEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this,i=r.scheduler;i.readOnly||r.disabled||(i.element.classList.add("b-eventeditor-editing"),t||(e.resource?t=e.resource:e.resourceId&&(t=i.resourceStore.getById(e.resourceId))),n||i.eventStore.indexOf(e)<0?r.internalShowEditor(e,t,n):i.scrollResourceEventIntoView(t,e,null,{animate:!0,edgeOffset:0,extendTimeAxis:!1}).then((function(){return r.internalShowEditor(e,t)}),(function(){return i.element.classList.remove("b-eventeditor-editing")})))}},{key:"loadRecord",value:function(e,t){this.loadingRecord=!0,this.internalLoadRecord(e,t),this.loadingRecord=!1}},{key:"internalLoadRecord",value:function(e,n){var r=this,i=r.client.eventStore;if(r.eventRecord=e,r.resourceRecord=n,r.editor.record=e,r.resourceField){var o=i.getResourcesForEvent(e);!i.storage.includes(e,!0)&&r.resourceRecord?r.resourceField.value=r.resourceRecord[r.resourceField.valueField]:r.scheduler.assignmentStore&&(r.resourceField.value=o.map((function(e){return e[r.resourceField.valueField]})))}se()(oe()(t.prototype),"internalLoadRecord",this).call(this,e,n)}},{key:"toggleEventType",value:function(e){this.editor.element.dataset.eventType=e||"",this.editor.eachWidget((function(t){return t.dataset&&t.dataset.eventType&&(t.hidden=t.dataset.eventType!==e)}))}},{key:"finalizeEventSave",value:function(e,t,n,r){var i=this,o=i.scheduler,a=i.eventStore;if(i.onBeforeSave(e),e.beginBatch(),i.updateRecord(e),e.endBatch(),a&&!e.stores.length){if(!1===o.trigger("beforeEventAdd",{eventRecord:e,resourceRecords:t,resources:t}))return void n(!1);if(i.dragProxyElement){var s=o.generateTplData(e,t[0]);s&&(rn.syncClassList(i.dragProxyElement,s.wrapperCls),rn.createElement({tag:"div",parent:i.dragProxyElement,className:s.cls.toString()}),i.dragProxyElement.classList.add("b-sch-dragcreator-proxy"),i.dragProxyElement.id=s.id,o.isHorizontal&&o.currentOrientation.releaseTimeSpanDiv(i.dragProxyElement,!0),i.dragProxyElement=null,e.instanceMeta(o).fromDragProxy=!0)}if(i.eventStore.add(e),i.eventStore.assignEventToResource(e,t),!i.eventStore.includes(e)){var l=o.element.querySelector(".b-sch-dragcreator-proxy");l&&(o.currentOrientation.availableDivs.remove(l),l.remove())}}else o.assignmentStore&&i.eventStore.assignEventToResource(e,t,!0);o.trigger("afterEventSave",{eventRecord:e}),i.onAfterSave(e),n(e)}},{key:"save",value:function(){var e=this;return new Promise((function(t,n){var r=e,i=r.scheduler,o=r.eventRecord;if(o&&r.isValid){var a=r.eventStore,s=r.values,l=r.resourceField&&r.resourceField.records||[r.resourceRecord],u=l[0];if(!r.scheduler.allowOverlap&&a)if(l.some((function(e){return!a.isDateRangeAvailable(s.startDate,s.endDate,o,e)})))return void t(!1);var c={finalize:function(e){try{!1!==e?r.finalizeEventSave(o,l,t,n):t(!1)}catch(e){n(e)}}};!1!==i.trigger("beforeEventSave",{eventRecord:o,resourceRecords:l,resourceRecord:u,values:s,context:c})?c.finalize():c.async||t()}else t(!1)}))}},{key:"deleteEvent",value:function(){var e=this;return new Promise((function(t,n){var r=e,i=r.eventRecord,o=r.editor;r.scheduler.removeRecords([i],(function(e){e&&o.containsFocus&&o.revertFocus(),t(e)}))}))}},{key:"onActivateEditor",value:function(e){var t=e.eventRecord,n=e.resourceRecord;this.editEvent(t,n)}},{key:"onDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=e.proxyElement;if(!this.disabled){this.scheduler.onEventCreated(t);var i=r.cloneNode(!0);i.removeAttribute("id"),r.parentElement.appendChild(i),this.dragProxyElement=i,this.editEvent(t,n,i)}}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord;t?this.editEvent(n,t.resource):n&&this.editEvent(n,n.resource)}},{key:"onEventTypeChange",value:function(e){var t=e.value;this.toggleEventType(t)}},{key:"getEventMenuItems",value:function(e){var t=this,n=e.eventRecord,r=e.resourceRecord,i=e.items;this.scheduler.readOnly||(i.editEvent={text:this.L("Edit Event"),icon:"b-icon b-icon-edit",weight:-200,onItem:function(){t.editEvent(n,r)}})}},{key:"readOnly",get:function(){return this.editor?this.editor.readOnly:this._readOnly},set:function(e){this._readOnly=e,this.editor&&(this.editor.readOnly=e)}},{key:"values",get:function(){var e=se()(oe()(t.prototype),"values",this);return!this.scheduler.assignmentStore&&e.resource&&(e.resourceId=e.resource.id,delete e.resource),e}},{key:"resourceStore",get:function(){return this._resourceStore},set:function(e){this._resourceStore=e,this.resourceField&&(this.resourceField.store=e)}}],[{key:"$name",get:function(){return"EventEdit"}},{key:"defaultConfig",get:function(){return{triggerEvent:"eventdblclick",showResourceField:!0,resourceFieldConfig:null,typeField:"eventType",eventRecord:null,readOnly:null,editorConfig:{title:"L{Edit Event}",localeClass:this,closable:!0,items:[{type:"text",localeClass:this,label:"L{Name}",clearable:!0,name:"name",ref:"nameField"},{type:"combo",localeClass:this,label:"L{Resource}",name:"resource",ref:"resourceField",editable:!1,valueField:"id",displayField:"name"},{type:"date",cls:"b-inline",clearable:!1,required:!0,localeClass:this,label:"L{Start}",name:"startDate",ref:"startDateField",flex:"1 0 60%"},{type:"time",clearable:!1,required:!0,name:"startDate",ref:"startTimeField",cls:"b-match-label",flex:"1 0 40%"},{type:"date",cls:"b-inline",clearable:!1,required:!0,localeClass:this,label:"L{End}",name:"endDate",ref:"endDateField",flex:"1 0 60%"},{type:"time",clearable:!1,required:!0,name:"endDate",ref:"endTimeField",cls:"b-match-label",flex:"1 0 40%"},{type:"extraItems"}],bbar:[{type:"widget",cls:"b-label-filler"},{color:"b-green",localeClass:this,text:"L{Save}",ref:"saveButton"},{color:"b-gray",localeClass:this,text:"L{Delete}",ref:"deleteButton"},{color:"b-gray",localeClass:this,text:"L{Cancel}",ref:"cancelButton"}]}}}},{key:"pluginConfig",get:function(){return{chain:["getEventMenuItems","onEventEnterKey"],assign:["editEvent"]}}}]),t}(od(Uc));ad._$name="EventEdit",Xs.registerFeature(ad,!0,"Scheduler");var sd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),this.scheduler=e}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;"timeAxis"===e.type&&t.push({text:n.L("filterEvents"),icon:"b-fw-icon b-icon-filter",disabled:n.disabled,menu:{type:"popup",items:[{type:"textfield",cls:"b-eventfilter b-last-row",clearable:!0,keyStrokeChangeDelay:300,label:n.L("byName"),width:200,listeners:{change:n.onEventFilterChange,thisObj:n}}],onBeforeShow:function(e){var t=e.source,r=fe()(t.items,1)[0],i=n.scheduler.eventStore.filters.getBy("property","name");r.value=i&&i.value}}})}},{key:"onEventFilterChange",value:function(e){var t=e.value;""!==t?this.scheduler.eventStore.filter("name",t):this.scheduler.eventStore.removeFieldFilter("name")}}],[{key:"$name",get:function(){return"EventFilter"}},{key:"pluginConfig",get:function(){return{chain:["getHeaderMenuItems"]}}}]),t}(ai);sd.featureClass="b-event-filter",sd._$name="EventFilter",Xs.registerFeature(sd,!0,["Scheduler","Gantt"]);var ld={top:"b-t",right:"b100-t100",bottom:"t-b",left:"b0-t0"},ud=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"render",value:function(){var e=this,t=e.client;e.resize&&e.resize.destroy(),e.resize=e.createResizeHelper(),e.showTooltip&&(e.clockTemplate=new Pc({timeAxisViewModel:t.timeAxisViewModel}))}},{key:"doDestroy",value:function(){var e=this;e.tip&&e.tip.destroy(),e.clockTemplate&&e.clockTemplate.destroy(),e.resize&&e.resize.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"isElementResizable",value:function(e,t){var n=this.client,r=this.resize,i=n.resolveTimeSpanRecord(e);if(n.readOnly)return!1;var o=i&&i.isResizable,a=(e=rn.up(t.target,n.eventSelector))?e.firstElementChild:e,s=t.target.closest('[class$="-handle"]');if(!o||s&&s!==a)return!1;var l=e.classList.contains("b-sch-event-startsoutside"),u=e.classList.contains("b-sch-event-endsoutside");if(!0===o){if(l&&u)return!1;if(l)o="end";else{if(!u)return r.overStartHandle(t,e)||r.overEndHandle(t,e);o="start"}}return!(l&&"start"===o||u&&"end"===o)&&!!(r.overStartHandle(t,e)&&"start"===o||r.overEndHandle(t,e)&&"end"===o)}},{key:"onBeforeResizeStart",value:function(e){var t,n=e.element,r=e.event,i=this.client,o=i.scheduledEventName,a=i.resolveTimeSpanRecord(n);return!this.disabled&&!1!==i.trigger("before".concat(i.capitalizedEventName,"Resize"),(t={},$()(t,o+"Record",a),$()(t,"event",r),t))}},{key:"onResizeStart",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.client,a=o.resolveTimeSpanRecord(n.element),s=o.scheduledEventName;o.element.classList.add("b-resizing-event"),i.setupProductResizeContext(n,r),i.showTooltip&&(i.tip?(i.tip.align=ld[n.edge],i.tip.showBy(i.getTooltipTarget())):(i.tip=new Ur({id:"".concat(o.id,"-event-resize-tip"),autoShow:!0,axisLock:!0,trackMouse:!1,getHtml:i.getTipHtml.bind(i),align:ld[n.edge],hideDelay:0}),i.tip.on("innerhtmlupdate",i.updateDateIndicator,i))),a.instanceMeta(o).retainElement=!0,o.trigger("".concat(s,"ResizeStart"),(t={},$()(t,"".concat(s,"Record"),a),$()(t,"event",r),t))}},{key:"updateDateIndicator",value:function(){var e=this.resize.context,t=e.edge,n=e.startDate,r=e.endDate,i=this.tip.element;(n||r)&&("right"===t||"bottom"===t?this.clockTemplate.updateDateIndicator(i.querySelector(".b-sch-tooltip-enddate"),r):this.clockTemplate.updateDateIndicator(i,n))}},{key:"getTooltipTarget",value:function(){var e=this,t=Oe.from(e.resize.context.element,null,!0);return"horizontal"===e.resize.direction?("right"===e.resize.context.edge&&(t.x=t.right-1),t.width=e.tip.anchorSize[0]/2):("bottom"===e.resize.context.edge&&(t.y=t.bottom-1),t.height=e.tip.anchorSize[1]/2),{target:t}}},{key:"onResizing",value:function(e){var t,n,r,i=e.context,o=e.event,a=this,s=a.client,l=s.features.dependencies,u=a.getTimespanRecord(i),c=s.scheduledEventName,d=i.element,h=i.edge,f=rn.getTranslateXY(d);if("top"===h||"left"===h?(r=u.endDate,s.snapRelativeToEventStartDate?(n=s.getDateFromXY(f,null,!0),n=s.timeAxis.roundDate(n,u.startDate)):n=s.getDateFromXY(f,"round",!0)):(f[0]+=d.offsetWidth,f[1]+=d.offsetHeight,n=u&&u.startDate,s.snapRelativeToEventStartDate?(r=s.getDateFromXY(f,null,!0),r=s.timeAxis.roundDate(r,u.endDate)):r=s.getDateFromXY(f,"round",!0)),n=n||i.startDate,r=r||i.endDate,i.dateConstraints&&(n=vt.constrain(n,i.dateConstraints.start,i.dateConstraints.end),r=vt.constrain(r,i.dateConstraints.start,i.dateConstraints.end)),a.showExactResizePosition||s.timeAxisViewModel.snap){var g="top"===h||"left"===h?s.timeAxisViewModel.getDistanceBetweenDates(n,u.endDate):s.timeAxisViewModel.getDistanceBetweenDates(u.startDate,r);switch(h){case"top":rn.setTranslateY(d,i.elementStartY+i.elementWidth-g),d.style.height=g+"px";break;case"right":d.style.width=g+"px";break;case"bottom":d.style.height=g+"px";break;case"left":rn.setTranslateX(d,i.elementStartX+i.elementWidth-g),d.style.width=g+"px"}}var v=i.endDate-r!=0||i.startDate-n!=0;i.endDate=r,i.startDate=n,v&&(i.valid=a.checkValidity(i,o)),s.trigger("".concat(c,"PartialResize"),(t={},$()(t,"".concat(c,"Record"),u),$()(t,"startDate",n),$()(t,"endDate",r),$()(t,"element",d),$()(t,"context",i),t)),l&&l.updateDependenciesForTimeSpan(u,d),a.showTooltip&&a.tip.alignTo(a.getTooltipTarget())}},{key:"checkValidity",value:function(e,t){var n=e.startDate&&e.endDate>e.startDate&&this.validatorFn.call(this.validatorFnThisObj||this,e,t);return n&&"boolean"!=typeof n&&(e.message=n.message||"",n=n.valid),!1!==n}},{key:"onFinishResize",value:function(e){e.source;var t=e.context,n=e.event,r=this,i=r.getTimespanRecord(t),o=i.startDate,a=i.endDate,s=t.startDate||o,l=t.endDate||a,u=r.client,c=!1;i.instanceMeta(u).retainElement=!1;var d=t.finalize;t.finalize=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.async&&r.finalize.apply(r,n),d.call(t,n)},t.valid=s&&l&&l-s>0&&(s-o!=0||l-a!=0)&&!1!==t.valid,t.valid&&(u.trigger("before".concat(u.scheduledEventName,"ResizeFinalize"),{context:t,event:n}),c=!0),t.async||r.finalize(c)}},{key:"onCancelResize",value:function(e){var t=e.context,n=this.getTimespanRecord(t);n&&(n.instanceMeta(this.client).retainElement=!1),this.finalize(!1)}},{key:"finalize",value:function(e){var t=this,n=t.client,r=t.resize.context,i=t.getTimespanRecord(r),o=n.scheduledEventName,a=!1;if(t.tip&&t.tip.hide(),r.started&&(e&&(a=t.internalUpdateRecord(r,i)),!e||!a)){var s=n.features.dependencies;s&&s.scheduleDraw(!0),n.repaintEventsForResource(t.getRowRecord(r))}n.element.classList.remove("b-resizing-event"),n.trigger("".concat(o,"ResizeEnd"),$()({changed:a},"".concat(o,"Record"),i||n.resolveEventRecord(r.element)))}},{key:"getTipHtml",value:function(e){var t=e.tip,n=this,r=n.resize.context,i=r.startDate,o=r.endDate,a=r.valid,s=r.message;if(!i||!o)return t.html;void 0===s&&(s=""),o=n.client.getDisplayEndDate(o,i);var l=n.client.getFormattedDate(i),u=n.client.getFormattedDate(o);return n.tipTemplate({valid:a,startDate:i,endDate:o,startText:l,endText:u,message:s,startClockHtml:n.clockTemplate.template({date:i,text:l,cls:"b-sch-tooltip-startdate"}),endClockHtml:n.clockTemplate.template({date:o,text:u,cls:"b-sch-tooltip-enddate"})})}},{key:"getRowRecord",value:function(e){throw new Error("Implement in subclass")}},{key:"getTimespanRecord",value:function(e){throw new Error("Implement in subclass")}},{key:"setupProductResizeContext",value:function(e,t){throw new Error("Implement in subclass")}},{key:"store",get:function(){throw new Error("Implement in subclass")}}],[{key:"defaultConfig",get:function(){return{showTooltip:!0,showExactResizePosition:!1,validatorFn:function(){},validatorFnThisObj:null,tip:null,tipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")}}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),t}(ai);ud._$name="ResizeBase";var cd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"createResizeHelper",value:function(){var e=this,t=e.client;return new ls({direction:t.isVertical?"vertical":"horizontal",name:e.constructor.$name,isElementResizable:function(t,n){return e.isElementResizable(t,n)},targetSelector:t.eventSelector,handleContainerSelector:t.eventInnerSelector,resizingCls:"b-sch-event-wrap-resizing",allowResize:e.isElementResizable.bind(e),outerElement:t.timeAxisSubGridElement,scrollManager:t.scrollManager,dragThreshold:0,dynamicHandleSize:!0,reservedSpace:5,scroller:t.timeAxisSubGrid.scrollable,listeners:{beforeresizestart:e.onBeforeResizeStart,resizestart:e.onResizeStart,resizing:e.onResizing,resize:e.onFinishResize,cancel:e.onCancelResize,thisObj:e}})}},{key:"getTimespanRecord",value:function(e){return e.eventRecord}},{key:"getRowRecord",value:function(e){return e.resourceRecord}},{key:"setupProductResizeContext",value:function(e,t){var n=this.client,r=n.resolveEventRecord(e.element),i=n.resolveResourceRecord(e.element);Object.assign(e,{eventRecord:r,resourceRecord:i,dateConstraints:n.getDateConstraints(i,r)})}},{key:"onResizeStart",value:function(e){var n=e.context,r=e.event;se()(oe()(t.prototype),"onResizeStart",this).call(this,{context:n,event:r}),this.client.features.dependencies&&this.client.features.dependencies.hideTerminals(n.element),n.element.querySelector(".b-sch-event").classList.add("b-sch-event-resizing")}},{key:"checkValidity",value:function(e,n){return(this.client.allowOverlap||this.client.isDateRangeAvailable(e.startDate,e.endDate,e.eventRecord,e.resourceRecord))&&se()(oe()(t.prototype),"checkValidity",this).call(this,e,n)}},{key:"onFinishResize",value:function(e){var n=e.source,r=e.context,i=e.event;se()(oe()(t.prototype),"onFinishResize",this).call(this,{source:n,context:r,event:i}),this.client.features.dependencies&&this.client.features.dependencies.showTerminals(r.eventRecord,r.element)}},{key:"internalUpdateRecord",value:function(e,t){var n=this.store,r=t.generation;return"left"===e.edge||"top"===e.edge?t.setStartDate(e.startDate,!1,n.skipWeekendsDuringDragDrop):t.setEndDate(e.endDate,!1,n.skipWeekendsDuringDragDrop),t.generation!==r||(this.client.repaintEventsForResource(e.resourceRecord),!1)}},{key:"finalize",value:function(e){this.resize.context.element.querySelector(".b-sch-event").classList.remove("b-sch-event-resizing"),se()(oe()(t.prototype),"finalize",this).call(this,e)}},{key:"store",get:function(){return this.client.eventStore}}],[{key:"$name",get:function(){return"EventResize"}}]),t}(ud);cd._$name="EventResize",Xs.registerFeature(cd,!0,"Scheduler");var dd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;n=r.processConfig(n),se()(oe()(t.prototype),"construct",this).call(this,e,n),r.forSelector||(r.forSelector="".concat(e.eventInnerSelector,":not(.b-dragproxy)")),r.clockTemplate=new Pc({timeAxisViewModel:e.timeAxisViewModel}),e.on($()({},"before".concat(e.scheduledEventName,"drag"),(function(){r.tooltip&&r.tooltip.hide()})))}},{key:"processConfig",value:function(e){return"function"==typeof e?{template:e}:e}},{key:"setConfig",value:function(e){se()(oe()(t.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){this.clockTemplate&&this.clockTemplate.destroy(),this.tooltip&&this.tooltip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.tooltip&&(this.tooltip.disabled=e),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"render",value:function(){var e=this,t=e.client,n=[".b-dragselecting",".b-eventeditor-editing",".b-resizing-event",".b-dragcreating",".b-dragging-".concat(t.scheduledEventName),".b-creating-dependency",".b-dragproxy"].map((function(e){return":not(".concat(e,")")})).join("");e.tooltip&&e.tooltip.destroy(),e.tooltip=new Ur(Object.assign({axisLock:"flexible",id:e.tipId||"".concat(e.client.id,"-event-tip"),cls:e.tipCls,forSelector:".b-timelinebase".concat(n," ").concat(e.forSelector),scrollAction:"realign",clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],forElement:t.timeAxisSubGridElement,showOnHover:!0,hoverDelay:0,hideDelay:100,anchorToTarget:!0,allowOver:!0,getHtml:e.getTipHtml.bind(e),disabled:e.disabled},e.config)),e.tooltip.on("innerhtmlupdate",e.updateDateIndicator,e)}},{key:"updateDateIndicator",value:function(){var e=this.client,t=this.tooltip,n=t.activeTarget&&e.resolveTimeSpanRecord(t.activeTarget),r=t.element.querySelector(".b-sch-tooltip-enddate");n&&(this.clockTemplate.updateDateIndicator(t.element,n.startDate),r&&this.clockTemplate.updateDateIndicator(r,n.endDate))}},{key:"resolveTimeSpanRecord",value:function(e){return this.client.resolveTimeSpanRecord(e)}},{key:"getTipHtml",value:function(e){var t=e.tip,n=e.forElement,r=this,i=r.client,o=r.recordType||"".concat(i.scheduledEventName,"Record"),a=r.resolveTimeSpanRecord(n);if(a){var s,l=a.startDate,u=a.endDate,c=i.getFormattedDate(l),d=i.getDisplayEndDate(u,l),h=i.getFormattedDate(d);return t.eventRecord=a,t.title=a.name,r.template((s={tip:t},$()(s,"".concat(o),a),$()(s,"startDate",l),$()(s,"endDate",u),$()(s,"startText",c),$()(s,"endText",h),$()(s,"startClockHtml",r.clockTemplate.template({date:l,text:c,cls:"b-sch-tooltip-startdate"})),$()(s,"endClockHtml",a.isMilestone?"":r.clockTemplate.template({date:d,text:h,cls:"b-sch-tooltip-enddate"})),s))}return t.hide(),""}}],[{key:"defaultConfig",get:function(){return{autoUpdate:!1,template:null,cls:null,align:"b-t",clockTemplate:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),t}(ai);dd._$name="TooltipBase";var hd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"$name",get:function(){return"EventTooltip"}},{key:"defaultConfig",get:function(){return{template:function(e){return"\n                ".concat(e.eventRecord.name?'<div class="b-sch-event-title">'.concat(e.eventRecord.name,"</div>"):"","\n                ").concat(e.startClockHtml,"\n                ").concat(e.endClockHtml)},cls:"b-sch-event-tooltip"}}}]),t}(dd);hd._$name="EventTooltip",Xs.registerFeature(hd,!0,"Scheduler");var fd=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"generateHtml",value:function(e,t,n){var r=this.store,i=e.summaries||(e.sum?[{sum:e.sum,renderer:e.summaryRenderer}]:[]),o='<table class="'.concat(n,'">');return i.forEach((function(n){var i=n.sum,a=null;switch(!0===i&&(i="sum"),i){case"sum":case"add":a=r.sum(e.field,t);break;case"max":a=r.max(e.field,t);break;case"min":a=r.min(e.field,t);break;case"average":case"avg":a=r.average(e.field,t);break;case"count":a=t.length;break;case"countNotEmpty":a=t.reduce((function(t,n){var r=n[e.field];return t+(null!=r?1:0)}),0)}if("function"==typeof i&&(a=t.reduce(i,"seed"in n?n.seed:0)),null!==a){var s,l=n.renderer?n.renderer({config:n,sum:a}):a,u=n.label?'<td class="b-grid-summary-label">'.concat(n.label,"</td>"):"";s=String(l).includes("<td>")?l:u?"".concat(u,'<td class="').concat("b-grid-summary-value",'">').concat(l,"</td>"):'<td colspan="2" class="'.concat("b-grid-summary-value",'">').concat(l,"</td>"),o+="<tr>".concat(s,"</tr>")}})),o+"</table>"}}]),t}(e||z)},gd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;if(Object.assign(r,{grid:e,store:e.store}),se()(oe()(t.prototype),"construct",this).call(this,e,n),!e.features.group)throw new Error("Requires Group feature to work, please enable");r.store.on({update:r.onStoreUpdate,prio:1,thisObj:r}),r.grid.rowManager.on({beforerenderrow:r.onBeforeRenderRow,rendercell:r.renderCell,thisObj:r})}},{key:"doDisable",value:function(e){this.store.useGroupFooters=!e,this.isConfiguring||this.store.group(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=e.record;t.isGroupFooter&&!n.meta.hasOwnProperty("groupFooterFor")&&(t.isGroupFooter=!1,t.removeCls("b-group-footer"),t.forceInnerHTML=!0)}},{key:"renderCell",value:function(e){var t=e.column,n=e.cellElement,r=e.rowElement,i=e.row,o=e.record,a=e.size;if(this.store.isGrouped&&o.meta.hasOwnProperty("groupFooterFor")){r.classList.add("b-group-footer"),i.isGroupFooter=!0;var s=this.updateSummaryHtml(n,t,o.meta.groupRecord.groupChildren),l="number"==typeof s?s:s.count;l>1&&(a.height=this.grid.rowHeight+l*this.grid.rowHeight*.1),s.height&&(a.height+=s.height)}}},{key:"updateSummaryHtml",value:function(e,t,n){(n=n.slice()).pop();var r=this.generateHtml(t,n,"b-grid-group-summary");return e.children.length?rn.sync(r,e.firstElementChild):e.innerHTML=r,t.summaries?t.summaries.length:t.sum?1:0}},{key:"onStoreUpdate",value:function(e){var t=this,n=e.source,r=e.changes;if(!this.disabled){if(r&&n.groupers.find((function(e){return e.field in r})))return;Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))&&(this.grid.forceFullRefresh=!0)}}}],[{key:"$name",get:function(){return"GroupSummary"}}]),t}(fd(ai));gd.featureClass="b-group-summary",gd._$name="GroupSummary",Xs.registerFeature(gd);var vd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"refreshContent",value:function(){this.headersElement&&0===this.headersElement.childNodes.length&&se()(oe()(t.prototype),"refreshContent",this).call(this)}}]),t}(Ql);vd._$name="Header";var md=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;n.unitToPixelsCache={},se()(oe()(t.prototype),"construct",this).call(this,e);var r=n.timeAxis.viewPreset||n.viewPreset;if(r)if(r instanceof mc)n.consumeViewPreset(r);else{var i=yc.getPreset(r);i&&n.consumeViewPreset(i)}n.timeAxis.on("reconfigure",n.onTimeAxisReconfigure,n),n.configured=!0}},{key:"doDestroy",value:function(){this.timeAxis.un("reconfigure",this.onTimeAxisReconfigure,this)}},{key:"reconfigure",value:function(e){this._headers=null,this.setConfig(e),this.trigger("reconfigure")}},{key:"onTimeAxisReconfigure",value:function(e){var t=e.source,n=e.suppressRefresh;this.viewPreset!==t.viewPreset&&this.consumeViewPreset(t.viewPreset),n||this.update()}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=r.headers;if(r.isConfiguring||r._availableSpace===e)n&&r.trigger("update");else{if(r._availableSpace=Math.max(e||r.availableSpace||0,0),"number"!=typeof r.availableSpace)throw new Error("Invalid available space provided to TimeAxisModel");r.availableSpace<=0&&console.warn("No available space provided for time axis. Make sure you have set width for horizontal mode and height for vertical"),r.columnConfig=[];var a=r._tickSize=r.calculateTickSize(r.originalTickSize);if("number"!=typeof a||a<=0)throw new Error("Invalid timeAxis tick size");r.unitToPixelsCache={},r._totalSize=null;for(var s=0,l=o.length;s<l;s++){var u=o[s];u.cellGenerator?r.columnConfig[s]=u.cellGenerator.call(r,i.startDate,i.endDate):r.columnConfig[s]=r.createHeaderRow(s,u)}t||r.trigger("update")}}},{key:"getDistanceBetweenDates",value:function(e,t){return Math.round(this.getPositionFromDate(t)-this.getPositionFromDate(e))}},{key:"getDistanceForDuration",value:function(e){var t=this.timeAxis.getAt(0);return this.tickSize/(t.endDate-t.startDate)*e}},{key:"getPositionFromDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.getScaledTick(e,t);return-1===r?-1:Math.round(n.tickSize*(r-n.timeAxis.visibleTickStart))}},{key:"getScaledTick",value:function(e,t){var n=t.respectExclusion,r=t.snapToNextIncluded,i=t.isEnd,o=t.min,a=t.max,s=this.timeAxis,l=s.include,u=s.unit,c=s.weekStartDay,d=s.getTickFromDate(e);if(-1!==d&&n&&l){var h=!1;if(l.hour&&vt.compareUnits(u,"hour")>0&&"day"!==u){var f=l.hour,g=f.from,v=f.to,m=f.lengthFactor,p=f.center,y=e.getHours(),k=Math.min(Math.max(y,g),v);if(!r&&k!==y)return-1;var b=p-(p-(k+e.getMinutes()/60))*m;e=vt.add(e,b-y,"h"),h=!0}if(l.day&&vt.compareUnits(u,"day")>0){var w=l.day,S=w.from,C=w.to,E=w.lengthFactor,x=w.center,D=e.getDay();i&&0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()&&--D<0&&(D=6);var T=0;if(D<S||D>=C){if(!r)return-1;if(T=i?(C-D-8)%7:(S-D+7)%7,e=vt.add(e,T,"d"),e=vt.startOf(e,"d",!1),a&&e.getTime()>=a||o&&e.getTime()<=o)return-1}var R=0===e.getDay()?0:x,M=e.getDay()+e.getHours()/24,F=R-(R-M)*E;e=vt.add(e,F-M+c,"d"),h=!0}h&&(e=vt.constrain(e,s.startDate,s.endDate),d=s.getTickFromDate(e))}return d}},{key:"getDateFromPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=r.getScaledPosition(e)/r.tickSize+i.visibleTickStart;return o<0||o>i.count?n?o<0?vt.add(i.startDate,o,i.unit):vt.add(i.endDate,o-i.count,i.unit):null:i.getDateFromTick(o,t)}},{key:"getScaledPosition",value:function(e){var t=this.timeAxis,n=t.include,r=t.unit,i=t.weekStartDay;if(n){var o=this.getSingleUnitInPixels("day");if(n.day&&vt.compareUnits(r,"day")>0){var a=n.day,s=a.from,l=e%(7*o);e=l/a.lengthFactor+(s-i)*o+(e-l)}if(n.hour&&vt.compareUnits(r,"hour")>0&&"day"!==r){var u=n.hour,c=u.from,d=e%o;e=d/u.lengthFactorExcl+c*this.getSingleUnitInPixels("hour")+(e-d)}}return e}},{key:"getSingleUnitInPixels",value:function(e){var t=this;return t.unitToPixelsCache[e]||(t.unitToPixelsCache[e]=vt.getUnitToBaseUnitRatio(t.timeAxis.unit,e,!0)*t.tickSize/t.timeAxis.increment)}},{key:"setTickSize",value:function(e,t){this._tickSize=this.originalTickSize=e,this.update(void 0,t)}},{key:"calculateTickSize",value:function(e){var t=this,n=t.forceFit,r=t.timeAxis,i=r.unit,o=0,a=1;if(t.snap){var s=r.resolution;a=vt.getUnitToBaseUnitRatio(i,s.unit)*s.increment}if(t.suppressFit)o=e;else{var l=r.visibleTickTimeSpan,u=Math[n?"floor":"round"](t.availableSpace/l);if(o=n||e<u?u:e,a>0&&(!n||a<1)){var c=n?"floor":"round";o=Math.round(Math.max(1,Math[c](a*o))/a)}}return o}},{key:"getDates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columnLinesFor,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=[],o=t?r.lowestHeader:e,a=r.majorHeaderLevel,s=r.headers&&r.headers[e].unit,l=null!=a&&r.headers&&r.headers[a].unit,u=null!=a&&vt.doesUnitsAlign(l,s),c=!(!r.headers||!r.headers[o].cellGenerator);if(c)for(var d=r.columnConfig[o],h=1,f=d.length;h<f;h++)i.push({date:d[h].startDate});else r.forEachInterval(o,(function(t,o){i.push({date:n?o:t,isMajor:a!==e&&u&&r.isMajorTick(n?o:t)})}));return i}},{key:"fitToAvailableSpace",value:function(e){var t=Math.floor(this.availableSpace/this.timeAxis.visibleTickTimeSpan);this.setTickSize(t,e)}},{key:"createHeaderRow",value:function(e,t){var n=this,r=this,i=[],o=t.align,a=vt.clearTime(new Date),s=t.headerCellCls||"",l=0;return r.headersDatesCache[e]={},r.forEachInterval(e,(function(u,c,d){var h=vt.format(u,t.dateFormat),f={align:o,start:u,end:c,value:h,headerCellCls:s,width:n.getDistanceBetweenDates(u,c),index:d};0!==f.width&&(f.coord=l,l+=f.width,r.headersDatesCache[e][u.getTime()]=1,t.renderer&&(h=t.renderer.call(t.thisObj||r,u,c,f,d,r.eventStore),f.value=null==h?"":h),"day"!==t.unit||t.increment&&1!==t.increment||(f.headerCellCls+=" b-sch-dayheadercell-"+u.getDay(),r.calendar&&r.calendar.isWeekend(u)&&(f.headerCellCls+=" b-sch-dayheadercell-nonworking"),vt.clearTime(u,!0)-a==0&&(f.headerCellCls+=" b-sch-dayheadercell-today")),i.push(f))})),i}},{key:"isMajorTick",value:function(e){var t=this.majorHeaderLevel;return null!=t&&this.headersDatesCache[t]&&this.headersDatesCache[t][e.getTime()]||!1}},{key:"forEachInterval",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=this.headers;if(r)if(e===r.length-1)this.timeAxis.forEach((function(e,r){return t.call(n,e.startDate,e.endDate,r)}));else{var i=r[e];this.timeAxis.forEachAuxInterval(i.unit,i.increment,t,n)}}},{key:"forEachMainInterval",value:function(e,t){this.forEachInterval(this.mainHeaderLevel,e,t)}},{key:"consumeViewPreset",value:function(e){var t=this;t._headers=null,t._thisIsAUsedExpression(t.tickSize),t.viewPreset=e,Object.assign(t,{headers:e.headers,columnLinesFor:e.columnLinesFor,mainHeaderLevel:e.mainHeaderLevel,_tickSize:t.isHorizontal?e.tickWidth:e.tickHeight}),t.originalTickSize=t.tickSize}},{key:"columnConfig",get:function(){return this._columnConfig},set:function(e){this._columnConfig=e}},{key:"isTimeAxisViewModel",get:function(){return!0}},{key:"isHorizontal",get:function(){return"vertical"!==this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"forceFit",set:function(e){e!==this._forceFit&&(this._forceFit=e,this.update())},get:function(){return this._forceFit}},{key:"snapPixelAmount",get:function(){if(this.snap){var e=this.timeAxis.resolution;return(e.increment||1)*this.getSingleUnitInPixels(e.unit)}return 1}},{key:"tickSize",get:function(){return this._tickSize},set:function(e){this.setTickSize(e,!1)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution}},{key:"totalSize",get:function(){return this._totalSize||(this._totalSize=Math.round(this.tickSize*this.timeAxis.visibleTickTimeSpan))}},{key:"availableSpace",get:function(){return this._availableSpace},set:function(e){var t=this;if(t._availableSpace=Math.max(0,e),t._availableSpace>0){var n=t.calculateTickSize(t.originalTickSize);n>0&&n!==t.tickSize&&t.update()}}},{key:"snap",get:function(){return this._snap},set:function(e){e!==this._snap&&(this._snap=e,this.configured&&this.update())}},{key:"mainHeader",get:function(){return"mainHeaderLevel"in this?this.headers[this.mainHeaderLevel]:this.bottomHeader}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"lowestHeader",get:function(){return this.headers.length-1}},{key:"majorHeaderLevel",get:function(){var e=this.headers;return e?Math.max(e.length-2,0):null}}],[{key:"defaultConfig",get:function(){return{timeAxis:null,availableSpace:null,tickSize:100,snap:!1,forceFit:!1,headers:null,calendar:null,mode:"horizontal",suppressFit:!1,columnConfig:[],viewPreset:null,columnLinesFor:null,eventStore:null,originalTickSize:null,headersDatesCache:[]}}}]),t}(ze());md._$name="TimeAxisViewModel";var pd=new Date,yd={mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut"},kd=["viewPreset","eventBarTextField","eventRenderer","eventRendererThisObj","eventBodyTemplate"],bd={fn:"exitTransition",delay:0,cancelOutstanding:!0},wd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=e.schedulerRegion||"normal",i=e.subGridConfigs,o=void 0===i?{}:i;e.subGridConfigs=o,o[r]=o[r]||{},o[r].headerClass=vd,"flex"in o[r]||"width"in o[r]||(o[r].flex=1),e.startDate&&(e.startDate=vt.parse(e.startDate)),e.endDate&&(e.endDate=vt.parse(e.endDate)),se()(oe()(t.prototype),"construct",this).call(this,e),n.onSchedulerViewportResize=n.throttle(n.onSchedulerViewportResize,250),n.initDomEvents(),n.currentOrientation.init(),n.rowManager.on("refresh",(function(){n.forceLayout=!1})),n.loadMask&&n.crudManager&&n.crudManager.isLoading&&n.onStoreBeforeRequest()}},{key:"doDestroy",value:function(){var e=this,n=this.currentOrientation;n&&n.destroy(),e.partneredWith&&(e.partneredWith.forEach((function(t){e.removePartner(t)})),e.partneredWith.destroy()),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"startConfigure",value:function(e){se()(oe()(t.prototype),"startConfigure",this).call(this,e),this._thisIsAUsedExpression(this.partner)}},{key:"onPaint",value:function(e){var n=e.firstPaint;if(n){var r=this.timeAxisSubGrid,i=this.isVertical?ge.isIE11?r.element.parentElement.offsetHeight:r.height:r.width;this.timeAxisViewModel.update(i,!1,!0)}se()(oe()(t.prototype),"onPaint",this).call(this,Array.prototype.slice.call(arguments))}},{key:"initSubGrids",value:function(){se()(oe()(t.prototype),"initSubGrids",this).call(this);var e=this,n=e.timeAxisSubGrid=e.subGrids[e.timeAxisColumn.region];n.sealedColumns=!0,n.on({resize:e.onTimeAxisSubGridResize,thisObj:e})}},{key:"onSchedulerHorizontalScroll",value:function(e,n){this.currentOrientation.updateFromHorizontalScroll(n),se()(oe()(t.prototype),"onSchedulerHorizontalScroll",this).call(this,e,n)}},{key:"initScroll",value:function(){var e=this,n=0;se()(oe()(t.prototype),"initScroll",this).call(this),e.on("horizontalscroll",(function(t){var r=t.subGrid,i=t.scrollLeft;e.isPainted&&r===e.timeAxisSubGrid&&!e.isDestroying&&e.onSchedulerHorizontalScroll(r,i),n++})),"horizontal"===e.testPerformance&&setTimeout((function(){var t=performance.now(),r=5,i=1,o=setInterval((function(){if(r+=5,e.scrollLeft+=(10+Math.floor(r))*i,1===i&&e.scrollLeft>5500&&(i=-1,r=5),-1===i&&e.scrollLeft<=0){var a=1e3/((performance.now()-t)/n);a=Math.round(10*a)/10,clearInterval(o),console.log(e.eventPositionMode,e.eventScrollMode,a+"fps")}}),0)}),500)}},{key:"noFeatureElementsInAxis",value:function(){}},{key:"removePartner",value:function(e){var t=this,n=t.partneredWith;n&&n.includes(e)&&(n.remove(e),e.partneredWith.remove(t),e.scrollable.removePartner(t.scrollable),e.un({presetchange:"onPartnerPresetChange",thisObj:t}),t.un({presetchange:"onPartnerPresetChange",thisObj:e}))}},{key:"onPartnerPresetChange",value:function(e){var t=e.preset,n=e.startDate,r=e.endDate,i=e.centerDate;this._viewPresetChanging||this.viewPreset===t||this.setViewPreset(t,n,r,!1,{centerDate:i})}},{key:"applyWorkingTime",value:function(e){var t=this,n=t._workingTime;if(n){var r=null;n.fromHour>=0&&n.fromHour<24&&n.toHour>n.fromHour&&n.toHour<=24&&n.toHour-n.fromHour<24&&(r={from:n.fromHour,to:n.toHour});var i=null;n.fromDay>=0&&n.fromDay<7&&n.toDay>n.fromDay&&n.toDay<=7&&n.toDay-n.fromDay<7&&(i={from:n.fromDay,to:n.toDay}),e.include=r||i?{hour:r,day:i}:null}else e.include=null;t.isPainted&&(t.timeAxisColumn.refreshHeader(),t.features.columnLines&&t.features.columnLines.drawLines(),t.refreshWithTransition())}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n._timeAxis||{},i=r.startDate,o=r.endDate,a=r.mainUnit;if("string"==typeof e&&(e=vt.parse(e)),n._timeAxis&&o){if(e){var s=o;if(t&&i){var l=vt.diff(i,o,a,!0);s=vt.add(e,l,a)}r.setTimeSpan(e,s)}}else n._tempStartDate=e}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n._timeAxis||{},i=r.startDate,o=r.endDate,a=r.mainUnit;if("string"==typeof e&&(e=vt.parse(e)),n._timeAxis&&i){if(e){var s=i;if(t&&o){var l=vt.diff(i,o,a,!0);s=vt.add(e,-l,a)}r.setTimeSpan(s,e)}}else n._tempEndDate=e}},{key:"onLocaleChange",value:function(){se()(oe()(t.prototype),"onLocaleChange",this).call(this),this.timeAxisColumn.refreshHeader()}},{key:"onInternalResize",value:function(e,n,r,i,o){var a=this._bodyRectangle;se()(oe()(t.prototype),"onInternalResize",this).call(this,e,n,r,i,o),a&&r!==o&&this.onSchedulerViewportResize(a.width,this.bodyContainer.offsetHeight,a.width,a.height)}},{key:"onTimeAxisSubGridResize",value:function(e){var t=e.width,n=(e.height,e.oldWidth);e.oldHeight;if(this.isPainted&&t!==n){var r=this._bodyRectangle;this.onSchedulerViewportResize(t,r.height,n,r.height)}}},{key:"onSchedulerViewportResize",value:function(e,t,n,r){if(this.isPainted){var i=this,o=i.timeAxisSubGrid;i.currentOrientation.onViewportResize(e,t,n,r),null!=i._lastOverflow&&i._lastOverflow!==o.overflowingHorizontally||(i.setTimeout((function(){i.timeAxisViewModel.availableSpace=i.isHorizontal?o.width:o.height}),0),i.partneredWith&&!i.isSyncingFromPartner&&i.partneredWith.forEach((function(e){e.isSyncingFromPartner||(e.isSyncingFromPartner=!0,i.eachSubGrid((function(t){var n=e.subGrids[t.region];n.width!==t.width&&(t.collapsed?n.collapse():(n.collapsed&&n.expand(),t.flex?t.flex!==n.flex&&(n.flex=t.flex):n.width=t.width))})),e.isSyncingFromPartner=!1)}))),i.trigger("timelineViewportResize",{width:e,height:t,oldWidth:n,oldHeight:r}),i._lastOverflow=o.overflowingHorizontally}}},{key:"onTimeAxisViewModelUpdate",value:function(){this.updateCanvasSize(),this.isHorizontal&&(this.callEachSubGrid("refreshFakeScroll"),this.refreshVirtualScrollbars()),this.currentOrientation.onTimeAxisViewModelUpdate()}},{key:"updateCanvasSize",value:function(){var e=this;e.isHorizontal?(e.backgroundCanvas&&(e.backgroundCanvas.style.width="".concat(e.timeAxisViewModel.totalSize,"px")),e.foregroundCanvas.style.width="".concat(e.timeAxisViewModel.totalSize,"px")):(e.backgroundCanvas&&(e.backgroundCanvas.style.width=rn.setLength(e.timeAxisColumn.width)),e.foregroundCanvas.style.width=rn.setLength(e.timeAxisColumn.width))}},{key:"getHeaderDomConfigs",value:function(e){}},{key:"getForegroundDomConfigs",value:function(e){}},{key:"refresh",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;n.isPainted&&!n.refreshSuspended&&(n.hasVisibleEvents?(n.refreshRows(!1,e),t&&t()):n.rowManager.trigger("refresh"))}},{key:"render",value:function(){var e=this,n=e.timeAxisSubGridElement;e.useBackgroundCanvas&&(e._backgroundCanvas=rn.createElement({className:"b-sch-background-canvas",parent:n,nextSibling:n.firstElementChild}));var r=e._foregroundCanvas=rn.createElement({className:"b-sch-foreground-canvas",style:"font-size:".concat(e.rowHeight-2*e.barMargin,"px"),parent:n});e.timeAxisSubGrid.insertRowsBefore=r,se()(oe()(t.prototype),"render",this).apply(this,arguments)}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;r.isConfiguring||(r.currentOrientation.refreshRows(n),se()(oe()(t.prototype),"refreshRows",this).call(this,e))}},{key:"getDateConstraints",value:function(){}},{key:"runWithTransition",value:function(e,t){var n=this;n.isVisible&&(null!=t&&!0!==t||(t=n.transitionDuration),t&&n.enableEventAnimations&&(n.isAnimating=!0,bd.delay=t,n.setTimeout(bd))),e()}},{key:"exitTransition",value:function(){this.isAnimating=!1,this.trigger("transitionend")}},{key:"refreshWithTransition",value:function(e){var t=this;this.runWithTransition((function(){return t.refresh(e)}))}},{key:"getVisibleDateRange",value:function(){return this.currentOrientation.getVisibleDateRange()}},{key:"hasVisibleEvents",get:function(){var e=this;return!this.noFeatureElementsInAxis()||this.eventStore.storage.values.some((function(t){return e.timeAxis.isTimeSpanInAxis(t)}))}},{key:"capitalizedEventName",get:function(){return this._capitalizedEventName||(this._capitalizedEventName=A.capitalizeFirstLetter(this.scheduledEventName)),this._capitalizedEventName}},{key:"partner",set:function(e){var t=this,n=t.partneredWith||(t.partneredWith=new Un);t._partner=e,n.includes(e)||(n.add(e),(e.partneredWith||(e.partneredWith=new Un)).add(t),e.on({presetchange:"onPartnerPresetChange",thisObj:t}),t.on({presetchange:"onPartnerPresetChange",thisObj:e}),t.setConfig({viewPreset:e.viewPreset,timeAxis:e.timeAxis,timeAxisViewModel:e.timeAxisViewModel}),t.initScroll=kn.createSequence(t.initScroll,(function(){t.scrollable.addPartner(e.scrollable,"x")}),t))},get:function(){return this._partner}},{key:"timeAxisColumn",get:function(){return this.columns&&this._timeAxisColumn}},{key:"columns",get:function(){return se()(oe()(t.prototype),"columns",this)},set:function(e){var n,r,i,o=this,a=e&&e.length;e&&(e.forEach((function(e,t){"timeAxis"===e.type&&(a=t,n=e)})),o.isVertical?(o._horizontalColumns=e,e=[{type:"verticalTimeAxis",locked:!0,timeline:o},e[a]],a=1):e=e.slice(),n=e[a]=Object.assign({type:"timeAxis",locked:!1,timeline:o,cellCls:o.timeCellCls,mode:o.mode},n),kd.forEach((function(e){null!=(i=o[e])&&(n[e]=i)}))),fn()(oe()(t.prototype),"columns",e,this,!0),e&&(r=o._timeAxisColumn=o.columns.getAt(a),o.isVertical&&(o.verticalTimeAxisColumn=o.columns.getAt(a-1)),r.relayAll(o))}},{key:"timeView",get:function(){var e=this;return e.columns&&e.isVertical?e.verticalTimeAxisColumn&&e.verticalTimeAxisColumn.view:e.timeAxisColumn&&e.timeAxisColumn.timeAxisView}},{key:"eventCls",set:function(e){var t=this;t._eventCls=e,t.eventSelector||(t.eventSelector=".".concat(e,"-wrap"),t.unreleasedEventSelector="".concat(t.eventSelector,":not(.b-sch-released)")),t.eventInnerSelector||(t.eventInnerSelector="."+e)},get:function(){return this._eventCls}},{key:"timeAxisViewModel",set:function(e){var t=this,n={update:"onTimeAxisViewModelUpdate",prio:100,thisObj:t};t.partner&&!e||(e&&e.isTimeAxisViewModel?e.on(n):(e=Object.assign({mode:t._mode,snap:t.snap,forceFit:t.forceFit,timeAxis:t.timeAxis,listeners:n},e),e=new md(e)),t._timeAxisViewModel=e)},get:function(){return this._timeAxisViewModel||(this.timeAxisViewModel=null),this._timeAxisViewModel}},{key:"timeAxis",set:function(e){var t=this;t.partner&&!e||(t.timeAxisDetacher&&t.timeAxisDetacher(),e&&e.isTimeAxis||(e=kt.assign({viewPreset:t.viewPreset,autoAdjust:t.autoAdjustTimeAxis,mode:"plain",weekStartDay:t.weekStartDay},e),t.startDate&&(e.startDate=t.startDate),t.endDate&&(e.endDate=t.endDate),t.workingTime&&t.applyWorkingTime(e),e=new kc(e)),t.timeAxisDetacher=e.on({thisObj:t,reconfigure:function(e){var n=e.config;t.trigger("timeAxisChange",{config:n})}}),t._timeAxis=e)},get:function(){return this._timeAxis||(this.timeAxis=null),this._timeAxis}},{key:"workingTime",set:function(e){this._workingTime=e,this.isConfiguring||this.applyWorkingTime(this.timeAxis)},get:function(){return this._workingTime}},{key:"startDate",set:function(e){this.setStartDate(e)},get:function(){return this._timeAxis?this._timeAxis.startDate:this._tempStartDate||new Date}},{key:"endDate",set:function(e){this.setEndDate(e)},get:function(){var e=this;return e._timeAxis?e._timeAxis.endDate:e._tempEndDate||vt.add(e.startDate,e.viewPreset.defaultSpan,e.viewPreset.mainHeader.unit)}},{key:"features",get:function(){return se()(oe()(t.prototype),"features",this)},set:function(e){"regionResize"in(e=!0===e?{}:e)||(e.regionResize=!0),fn()(oe()(t.prototype),"features",e,this,!0)}},{key:"eventStyle",get:function(){return this._eventStyle},set:function(e){this._eventStyle=e,this.isPainted&&this.refreshWithTransition()}},{key:"eventColor",get:function(){return this._eventColor},set:function(e){this._eventColor=e,this.isPainted&&this.refreshWithTransition()}},{key:"currentOrientation",get:function(){throw new Error("Implement in subclass")}},{key:"isHorizontal",get:function(){return!0}},{key:"backgroundCanvas",get:function(){return this._backgroundCanvas}},{key:"foregroundCanvas",get:function(){return this._foregroundCanvas}},{key:"svgCanvas",get:function(){var e=this;if(!e._svgCanvas){var t=e._svgCanvas=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("id",Z.generateId("svg")),t.retainElement=!0,e.foregroundCanvas.appendChild(t),e.trigger("svgCanvasCreated")}return e._svgCanvas}},{key:"timeAxisSubGridElement",get:function(){return this.timeAxisColumn&&this.timeAxisColumn.subGridElement}}],[{key:"$name",get:function(){return"TimelineBase"}},{key:"defaultConfig",get:function(){return{weekStartDay:vt.weekStartDay,workingTime:null,timeAxis:null,timeAxisViewModel:null,autoAdjustTimeAxis:!0,startDate:null,endDate:null,snap:!1,snapRelativeToEventStartDate:!1,forceFit:!1,eventCls:null,getDateConstraints:null,timeCellCls:null,timeCellSelector:null,scheduledEventName:null,createEventOnDblClick:!0,overScheduledEventClass:null,preventOverCls:!1,hoveredEventNode:null,useBackgroundCanvas:!1,enableEventAnimations:!ge.isIE11,disableGridRowModelWarning:!0,animateRemovingRows:!1,partner:null,schedulerRegion:"normal",transitionDuration:200,animationTimeout:null,milestoneLayoutMode:"default",defaultRegion:"locked"}}}]),t}(pi(Su).mixes((function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getDateFromCoordinate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n||(e=this.currentOrientation.translateToScheduleCoordinate(e)),this.timeAxisViewModel.getDateFromPosition(e,t,r)}},{key:"getDateFromX",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.getDateFromCoordinate(e,t,n)}},{key:"getDateFromXY",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.currentOrientation.getDateFromXY(e,t,n,r)}},{key:"getDateFromDomEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getDateFromXY([e.x,e.y],t,!1,n)}},{key:"getStartEndDatesFromRectangle",value:function(e,t,n){var r,i,o=this,a=o.isHorizontal,s=a?o.timeAxisSubGrid.width:o.timeAxisSubGrid.height,l=a?e.x:e.top,u=a?e.right:e.bottom;return l>=0&&u<s?(r=o.getDateFromCoordinate(l,null,!0),i=o.getDateFromCoordinate(u,null,!0)):l<0?(i=o.getDateFromCoordinate(u,t,!0),r=vt.add(i,-n,"ms")):(r=o.getDateFromCoordinate(l,t,!0),i=vt.add(i,n,"ms")),{start:r,end:i}}},{key:"getFormattedDate",value:function(e){return vt.format(e,this.displayDateFormat)}},{key:"getDisplayEndDate",value:function(e,t){return 0!==e.getHours()||0!==e.getMinutes()||t&&e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()||vt.formatContainsHourInfo(this.displayDateFormat)||(e=vt.add(e,-1,"day")),e}},{key:"getFormattedEndDate",value:function(e,t){return this.getFormattedDate(this.getDisplayEndDate(e,t))}},{key:"getCoordinateFromDate",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this,i=r.timeAxisViewModel,o=r.timeAxis,a=o.isContinuous,s=o.startMS,l=o.endMS,u=o.startDate,c=o.unit,d=e.valueOf();if(!0===n?n={local:!0}:n?"local"in n||(n.local=!0):n={local:!1},e instanceof Date||(pd.setTime(e),e=pd),a&&e.getTimezoneOffset()===u.getTimezoneOffset()&&-1!==vt.getUnitToBaseUnitRatio(c,"day")){if(d<s||d>l)return-1;t=Math.round((d-s)/(l-s)*i.totalSize)}else t=i.getPositionFromDate(e,n);return n.local||(t=r.currentOrientation.translateToPageCoordinate(t)),t}},{key:"getTimeSpanDistance",value:function(e,t){return this.timeAxisViewModel.getDistanceBetweenDates(e,t)}},{key:"onSchedulerHorizontalScroll",value:function(e){e.subGrid,e.scrollLeft;this.scrollingToCenter||(this.cachedCenterDate=null)}},{key:"displayDateFormat",get:function(){return this._displayDateFormat},set:function(e){this._displayDateFormat=e,this.trigger("displayDateFormatChange",{format:e})}},{key:"viewportCenterDate",get:function(){var e=this,t=e.timeAxis,n=e.timeAxisSubGrid,r=n.scrollable,i=r.x+n.width/2,o=r.y+n.height/2;if(t.isContinuous){var a=e.isHorizontal?i/r.scrollWidth:o/r.scrollHeight,s=t.startMS+(t.endMS-t.startMS)*a;return new Date(s)}var l=e.isHorizontal?[i,0]:[0,o];return e.getDateFromXY(l,null,!0)}},{key:"viewportCenterDateCached",get:function(){return this.cachedCenterDate||(this.cachedCenterDate=this.viewportCenterDate)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution},set:function(e){this.timeAxis.resolution={increment:e,unit:this.timeAxis.resolution.unit}}},{key:"snap",set:function(e){this.isConfiguring?this._snap=e:this.timeAxisViewModel.snap=e},get:function(){return this.isConfiguring?this._snap:this.timeAxisViewModel.snap}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"initDomEvents",value:function(){var e=this;e.scheduledBarEvents.element=e.schedulerEvents.element=e.timeAxisSubGridElement,e.scheduledBarEvents.thisObj=e.schedulerEvents.thisObj=e,Ln.on(e.scheduledBarEvents),Ln.on(e.schedulerEvents)}},{key:"getTimeSpanMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getScheduleMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleScheduledBarEvent",value:function(e){var t=rn.up(e.target,this.eventSelector),n=yd[e.type]||A.capitalizeFirstLetter(e.type);t&&this.trigger(this.scheduledEventName+n,this.getTimeSpanMouseEventParams(t,e))}},{key:"handleScheduleEvent",value:function(e){var t=this,n=!rn.up(e.target,t.eventSelector)&&rn.up(e.target,"."+t.timeCellCls),r=yd[e.type]||A.capitalizeFirstLetter(e.type);if(n){var i=t.getDateFromDomEvent(e,"floor"),o=sl.get(n),a=o.row.dataIndex,s=t.timeAxis.getTickFromDate(i),l=t.timeAxis.getAt(Math.floor(s));l&&t.trigger("schedule"+r,Object.assign({date:i,tickStartDate:l.startDate,tickEndDate:l.endDate,row:o.row,index:a,event:e},t.getScheduleMouseEventParams(o,e)))}}},{key:"onElementMouseOver",value:function(e){se()(oe()(t.prototype),"onElementMouseOver",this).call(this,e);var n=this,r=e.target;if(r.closest(n.eventInnerSelector)){var i=r.closest(n.eventSelector);if(i.classList.add(n.overScheduledEventClass),i!==n.hoveredEventNode&&!n.preventOverCls){n.hoveredEventNode=i;var o=n.getTimeSpanMouseEventParams(i,e);o&&n.trigger(n.scheduledEventName+"MouseEnter",o)}}else n.hoveredEventNode=null}},{key:"onElementMouseOut",value:function(e){se()(oe()(t.prototype),"onElementMouseOut",this).call(this,e);var n=this;if(e.target.closest(n.eventInnerSelector)&&n.resolveTimeSpanRecord(e.target)&&n.hoveredEventNode){if(e.relatedTarget&&rn.isDescendant(e.target.closest(n.eventInnerSelector),e.relatedTarget))return;n.unhover(e)}}},{key:"unhover",value:function(e){var t=this,n=t.hoveredEventNode;n&&(n.classList.remove(t.overScheduledEventClass),t.trigger(t.scheduledEventName+"MouseLeave",t.getTimeSpanMouseEventParams(n,e)),t.hoveredEventNode=null)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{scheduledBarEvents:{mousedown:"handleScheduledBarEvent",mouseup:"handleScheduledBarEvent",click:"handleScheduledBarEvent",dblclick:"handleScheduledBarEvent",contextmenu:"handleScheduledBarEvent",mouseover:"handleScheduledBarEvent",mouseout:"handleScheduledBarEvent"},schedulerEvents:{click:"handleScheduleEvent",dblclick:"handleScheduleEvent",contextmenu:"handleScheduleEvent",mousemove:"handleScheduleEvent"}}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"barMargin",get:function(){return this._barMargin},set:function(e){var t=this;kt.assertNumber(e,"barMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._barMargin!==e&&(t._barMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"resourceMargin",get:function(){return null==this._resourceMargin?this.barMargin:this._resourceMargin},set:function(e){var t=this;kt.assertNumber(e,"resourceMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._resourceMargin!==e&&(t._resourceMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"tickWidth",set:function(e){this.tickSize=e},get:function(){return this.tickSize}},{key:"tickSize",set:function(e){kt.assertNumber(e,"tickSize"),this.timeAxisViewModel.tickSize=e},get:function(){return this.timeAxisViewModel.tickSize}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{barMargin:10,resourceMargin:null,managedEventSizing:!0,generatedIdCls:"b-sch-dirty-new",dirtyCls:"b-sch-dirty",committingCls:"b-sch-committing",endsOutsideViewCls:"b-sch-event-endsoutside",startsOutsideViewCls:"b-sch-event-startsoutside",fixedEventCls:"b-sch-event-fixed",eventStyle:"plain",eventColor:"green"}}},{key:"eventColors",get:function(){return["red","pink","purple","violet","indigo","blue","cyan","teal","green","lime","yellow","orange","gray"]}},{key:"eventStyles",get:function(){return["plain","border","hollow","colored","line","dashed","minimal"]}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"scrollToDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.timeAxisSubGrid.scrollable,i=r.viewport,o=n.getCoordinateFromDate(e,!0),a=n.isHorizontal?new Oe(n.getCoordinateFromDate(e,!1),i.y,n.timeAxisViewModel.tickSize,i.height):new Oe(i.x,n.getCoordinateFromDate(e,!1),i.width,n.timeAxisViewModel.tickSize);return n.scrollToCoordinate(o,a,e,t)}},{key:"scrollToNow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.scrollToDate(new Date,e)}},{key:"scrollToCoordinate",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this;if(e<0){var o=(i.timeAxis.endDate-i.timeAxis.startDate)/2,a=new Date(n.getTime()-o),s=new Date(n.getTime()+o);return a-i.startDate!=0&&s-i.endDate!=0?(i.setTimeSpan(a,s),i.scrollToDate(n,r)):void 0}return i.timeAxisSubGrid.scrollable.scrollIntoView(t,r)}},{key:"scrollHorizontallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"scrollVerticallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.scrollable.scrollTo(null,e,t)}},{key:"scrollTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"scrollLeft",set:function(e){this.timeAxisSubGrid.scrollable.x=e},get:function(){return this.timeAxisSubGrid.scrollable.x}},{key:"scrollTop",set:function(e){this.scrollable.y=e},get:function(){return this.scrollable.y}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"normalizePreset",value:function(e){var t=e,n=this.presets;if(!(e instanceof mc)){if("object"===U()(e)){if(e.base){var r=n.getById(e.base)||yc.getById(e.base);if(!r)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=kt.merge(kt.clone(r.data),e)}e.id?e=n.createRecord(e):(e=n.createRecord(kt.assign({},e))).id=e.generateId(n)}else e="number"==typeof e?n.getAt(e):n.getById(e)||yc.getById(e);if(!e)throw new Error("Invalid ViewPreset requested: ".concat(t))}return n.add(e)[0]}},{key:"setViewPreset",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=this,a=o.isHorizontal,s=o._timeAxis,l={startDate:t,endDate:n,from:o.viewPreset};if(e=l.to=l.preset=o.normalizePreset(e),Object.keys(i).length||!o._viewPreset||o._viewPreset!==e&&!o._viewPreset.equals(e)){r=r||o.isConfiguring;var u=i.centerDate;if(r||!1!==o.trigger("beforePresetChange",l)){if(o._viewPreset=e,o._viewPresetChanging=!0,o.displayDateFormat=o.config.displayDateFormat||e.displayDateFormat,s){if(o.suspendRefresh(),!r||!s.isConfigured){var c={weekStartDay:o.weekStartDay,startTime:o.startTime,endTime:o.endTime};r?(0===s.count||t)&&(c.startDate=t||new Date,c.endDate=n):t?(c.startDate=t,c.endDate=n,!u&&n&&(u=new Date((t.getTime()+n.getTime())/2))):(c.startDate=s.startDate,c.endDate=n||s.endDate,u||(u=o.viewportCenterDate)),s.isConfigured=!1,s.viewPreset=e,s.reconfigure(c,!0),o.timeAxisViewModel.reconfigure({viewPreset:o.viewPreset,headers:e.headers,columnLinesFor:e.headers.length-1,rowHeightHorizontal:o.readRowHeightFromPreset?e.rowHeight:o.rowHeight,tickSize:a?e.tickWidth:e.tickHeight||e.tickWidth||60}),o.resumeRefresh()}if(o.refresh(),!i.notScroll&&o.isPainted)if(u){o.cachedCenterDate=u;var d=null;d=Math.max(Math.floor(o.getCoordinateFromDate(u,!0)-o.timeAxisSubGrid.width/2),0),o.viewPresetActiveScroll={left:d},o.scrollingToCenter=!0,o.scrollHorizontallyTo(d,!1),o.setTimeout((function(){o.scrollingToCenter=!1}),100)}else o.scrollHorizontallyTo(0,!1)}o.trigger("presetChange",l)}o._viewPresetChanging=!1}}},{key:"presets",set:function(e){!0===e&&(e=yc.allRecords),this._presets=new pc({data:e})},get:function(){return this._presets}},{key:"viewPreset",get:function(){return this._viewPreset},set:function(e){e.name&&!e.base&&(e.base=e.name),this._viewPreset&&this._viewPreset.equals(e)||this.setViewPreset(e)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{viewPreset:"weekAndDayLetter",displayDateFormat:null,presets:!0}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.zoomOnMouseWheel&&Ln.on({element:n.timeAxisSubGridElement,wheel:"onWheel",thisObj:n,capture:!0,passive:!1}),n.zoomOnTimeAxisDoubleClick&&n.on("timeaxisheaderdblclick",(function(e){var t=e.startDate,r=e.endDate;n.isVertical||n.zoomToSpan({startDate:t,endDate:r})}))}},{key:"getMilliSecondsPerPixelForZoomLevel",value:function(e,t){var n=e.bottomHeader,r=this.isHorizontal?e.tickWidth:e.tickHeight;return Math.round((vt.add(new Date(1,0,1),n.increment||1,n.unit)-new Date(1,0,1))/(t?r:e.actualWidth||r))}},{key:"zoomTo",value:function(e){"object"===U()(e)?e.preset?this.zoomToLevel(e.preset,e):null!=e.level?this.zoomToLevel(e.level,e):this.zoomToSpan(e):this.zoomToLevel(e)}},{key:"zoomToLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"number"==typeof e&&(e=Math.min(Math.max(e,this.minZoomLevel),this.maxZoomLevel));var n=this,r=n.config,i=n.isVertical?"tickHeight":"tickWidth",o=n.normalizePreset(e),a=o[i],s=t.startDate,l=t.endDate,u=s&&l?{startDate:s,endDate:l}:null,c=t.centerDate||(u?new Date((s.getTime()+l.getTime())/2):n.viewportCenterDateCached),d=n.timeAxisSubGrid.width;u||(u=r.startDate&&r.endDate&&r.viewPreset&&o.equals(n.normalizePreset(r.viewPreset))?{startDate:r.startDate,endDate:r.endDate}:n.calculateOptimalDateRange(c,d,o)),"width"in t&&o.setData(i,t.width),n.isZooming=!0,n.setViewPreset(o,u.startDate||n.startDate,u.endDate||n.endDate,!1,{centerDate:c}),o.actualWidth=n.timeAxisViewModel.tickSize,n.isZooming=!1,o.setData(i,a)}},{key:"zoomToFit",value:function(e){var t=this.eventStore.getTotalTimeSpan();(e=Object.assign({leftMargin:0,rightMargin:0},e,t)).startDate&&e.endDate&&this.zoomToSpan(e)}},{key:"zoomToSpan",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((e.leftMargin||e.rightMargin)&&(e.adjustStart=0,e.adjustEnd=0),e.leftMargin||(e.leftMargin=0),e.rightMargin||(e.rightMargin=0),!e.startDate||!e.endDate)throw new Error("zoomToSpan: must provide startDate + endDate dates");var t=this,n=e.startDate,r=e.endDate,i=e.adjustStart>=0||e.adjustEnd>=0;if(i&&(n=vt.add(n,-e.adjustStart,t.timeAxis.mainUnit),r=vt.add(r,e.adjustEnd,t.timeAxis.mainUnit)),n<=r){var o=t.timeAxisViewModel.availableSpace,a=Math.floor(t.zoomLevel);-1===a&&(a=0);for(var s,l=t.presets.allRecords,u=r-n||1,c=t.getMilliSecondsPerPixelForZoomLevel(l[a],!0),d=u/c+e.leftMargin+e.rightMargin>o?-1:1,h=a+d,f=null;h>=0&&h<=l.length-1;){s=l[h];var g=u/(c=t.getMilliSecondsPerPixelForZoomLevel(s,!0))+e.leftMargin+e.rightMargin;if(-1===d){if(g<=o){f=h;break}}else{if(!(g<=o))break;a!==h-d&&(f=h)}h+=d}var v=(s=l[f=null!=f?f:h-d]).bottomHeader.unit;(e.leftMargin||e.rightMargin)&&(n=new Date(n.getTime()-c*e.leftMargin),r=new Date(r.getTime()+c*e.rightMargin));var m=vt.getDurationInUnit(n,r,v,!0)/s.bottomHeader.increment;if(0===m)return null;var p,y=Math.floor(o/m),k=e.centerDate||new Date((n.getTime()+r.getTime())/2);return p=i?{startDate:n,endDate:r}:t.calculateOptimalDateRange(k,o,s),t.zoomToLevel(f,Object.assign(p,{width:y,centerDate:k}))}return null}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t>=this.presets.count-1?null:this.zoomToLevel(Math.floor(t)+e)}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t<=0?null:this.zoomToLevel(Math.ceil(t)-e)}},{key:"zoomInFull",value:function(){return this.zoomToLevel(this.maxZoomLevel)}},{key:"zoomOutFull",value:function(){return this.zoomToLevel(this.minZoomLevel)}},{key:"calculateOptimalDateRange",value:function(e,t,n,r){if(r)return r;var i=this.timeAxis,o=n.bottomHeader,a=this.isHorizontal?n.tickWidth:n.tickHeight;if(this.zoomKeepsOriginalTimespan)return{startDate:i.startDate,endDate:i.endDate};var s=o.unit,l=Math.ceil(t/a*o.increment*this.visibleZoomFactor/2),u=vt.add(e,-l,s),c=vt.add(e,l,s);return{startDate:i.floorDate(u,!1,s,o.increment),endDate:i.ceilDate(c,!1,s,o.increment)}}},{key:"onWheel",value:function(e){var t=this;e.ctrlKey&&(e.preventDefault(),t.preventScrollZoom||(e.deltaY>0?t.zoomOut():e.deltaY<0&&t.zoomIn(),t.preventScrollZoom=!0,t.setTimeout((function(){return t.preventScrollZoom=!1}),30)))}},{key:"setTimeSpan",value:function(e,t){this.timeAxis.setTimeSpan(e,t)}},{key:"shift",value:function(e,t){this.timeAxis.shift(e,t)}},{key:"shiftNext",value:function(e){this.timeAxis.shiftNext(e)}},{key:"shiftPrevious",value:function(e){this.timeAxis.shiftPrevious(e)}},{key:"maxZoomLevel",get:function(){return this._maxZoomLevel||this.presets.count-1},set:function(e){if("number"!=typeof e&&(e=this.presets.count-1),e<0||e>=this.presets.count)throw new Error("Invalid range for `setMinZoomLevel`");this._maxZoomLevel=e}},{key:"minZoomLevel",get:function(){return this._minZoomLevel||0},set:function(e){if("number"!=typeof e&&(e=0),e<0||e>=this.presets.count)throw new Error("Invalid range for `minZoomLevel`");this._minZoomLevel=e}},{key:"zoomLevel",get:function(){return this.presets.indexOf(this.viewPreset)},set:function(e){this.zoomToLevel(e)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{zoomOnMouseWheel:!0,zoomOnTimeAxisDoubleClick:!0,preventScrollZoom:null,minZoomLevel:null,maxZoomLevel:null,visibleZoomFactor:5,zoomKeepsOriginalTimespan:null}}}]),t}(e||z)})));wd._$name="TimelineBase";var Sd={SchedulerCommon:{},ExcelExporter:{"No resource assigned":"No resource assigned"},ResourceInfoColumn:{eventCountText:function(e){return e+" event"+(1!==e?"s":"")}},Dependencies:{from:"From",to:"To",valid:"Valid",invalid:"Invalid",Checking:"Checking…"},DependencyEdit:{From:"From",To:"To",Type:"Type",Lag:"Lag","Edit dependency":"Edit dependency",Save:"Save",Delete:"Delete",Cancel:"Cancel",StartToStart:"Start to Start",StartToEnd:"Start to End",EndToStart:"End to Start",EndToEnd:"End to End"},EventEdit:{Name:"Name",Resource:"Resource",Start:"Start",End:"End",Save:"Save",Delete:"Delete",Cancel:"Cancel","Edit Event":"Edit event",Repeat:"Repeat"},EventDrag:{eventOverlapsExisting:"Event overlaps existing event for this resource",noDropOutsideTimeline:"Event may not be dropped completely outside the timeline"},Scheduler:{"Add event":"Add event","Delete event":"Delete event","Unassign event":"Unassign event"},HeaderContextMenu:{pickZoomLevel:"Zoom",activeDateRange:"Date range",startText:"Start date",endText:"End date",todayText:"Today"},EventFilter:{filterEvents:"Filter tasks",byName:"By name"},TimeRanges:{showCurrentTimeLine:"Show current timeline"},PresetManager:{minuteAndHour:{topDateFormat:"ddd MM/DD, hA"},hourAndDay:{topDateFormat:"ddd MM/DD"},weekAndDay:{displayDateFormat:"hh:mm A"}},RecurrenceConfirmationPopup:{"delete-title":"You’re deleting an event","delete-all-message":"Do you want to delete all occurrences of this event?","delete-further-message":"Do you want to delete this and all future occurrences of this event, or only the selected occurrence?","delete-further-btn-text":"Delete All Future Events","delete-only-this-btn-text":"Delete Only This Event","update-title":"You’re changing a repeating event","update-all-message":"Do you want to change all occurrences of this event?","update-further-message":"Do you want to change only this occurrence of the event, or this and all future occurrences?","update-further-btn-text":"All Future Events","update-only-this-btn-text":"Only This Event",Yes:"Yes",Cancel:"Cancel",width:600},RecurrenceLegend:{" and ":" and ",Daily:"Daily","Weekly on {1}":function(e){var t=e.days;return"Weekly on ".concat(t)},"Monthly on {1}":function(e){var t=e.days;return"Monthly on ".concat(t)},"Yearly on {1} of {2}":function(e){var t=e.days,n=e.months;return"Yearly on ".concat(t," of ").concat(n)},"Every {0} days":function(e){var t=e.interval;return"Every ".concat(t," days")},"Every {0} weeks on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," weeks on ").concat(n)},"Every {0} months on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," months on ").concat(n)},"Every {0} years on {1} of {2}":function(e){var t=e.interval,n=e.days,r=e.months;return"Every ".concat(t," years on ").concat(n," of ").concat(r)},position1:"the first",position2:"the second",position3:"the third",position4:"the fourth",position5:"the fifth","position-1":"the last",day:"day",weekday:"weekday","weekend day":"weekend day",daysFormat:function(e){var t=e.position,n=e.days;return"".concat(t," ").concat(n)}},RecurrenceEditor:{"Repeat event":"Repeat event",Cancel:"Cancel",Save:"Save",Frequency:"Frequency",Every:"Every",DAILYintervalUnit:"day(s)",WEEKLYintervalUnit:"week(s) on:",MONTHLYintervalUnit:"month(s)",YEARLYintervalUnit:"year(s) in:",Each:"Each","On the":"On the","End repeat":"End repeat","time(s)":"time(s)"},RecurrenceDaysCombo:{day:"day",weekday:"weekday","weekend day":"weekend day"},RecurrencePositionsCombo:{position1:"first",position2:"second",position3:"third",position4:"fourth",position5:"fifth","position-1":"last"},RecurrenceStopConditionCombo:{Never:"Never",After:"After","On date":"On date"},RecurrenceFrequencyCombo:{Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly"},RecurrenceCombo:{None:"None","Custom...":"Custom..."},ScheduleRangeCombo:{completeview:"Complete schedule",currentview:"Visible schedule",daterange:"Date range",completedata:"Complete schedule (for all events)"},SchedulerExportDialog:{"Schedule range":"Schedule range","Export from":"From","Export to":"To"}};for(var Cd in pu)Sd[Cd]=pu[Cd];je.registerLocale("En",{desc:"English",locale:Sd});var Ed=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"clearCache",value:function(e){e?delete this.nbrOfBandsByResource[e.id]:this.nbrOfBandsByResource={}}},{key:"getNumberOfBands",value:function(e,t){var n=this.nbrOfBandsByResource;if(n.hasOwnProperty(e.id))return n[e.id];var r=("function"==typeof t?t():t).map((function(e){return{start:e.startDate,end:e.endDate,event:e}}));return this.applyLayout(r,e)}},{key:"applyLayout",value:function(e,t){var n=e.slice(),r=this.layoutEventsInBands(n);return this.nbrOfBandsByResource[t.id]=r}}],[{key:"defaultConfig",get:function(){return{nbrOfBandsByResource:{},bandIndexToPxConvertFn:null,bandIndexToPxConvertThisObj:null}}}]),t}(z);Ed._$name="HorizontalLayout";var xd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"layoutEventsInBands",value:function(e){var t=0;do{for(var n=e[0];n;)n.top=this.bandIndexToPxConvertFn.call(this.bandIndexToPxConvertThisObj||this,t,n.event),e.splice(e.indexOf(n),1),n=this.findClosestSuccessor(n,e);t++}while(e.length>0);return t}},{key:"findClosestSuccessor",value:function(e,t){for(var n,r,i,o=1/0,a=e.endMs,s=0===e.event.duration,l=0,u=t.length;l<u;l++)(r=(i=t[l]).startMs-a)>=0&&r<o&&(r>0||i.endMs-i.startMs>0||!s)&&(n=i,o=r);return n}}]),t}(Ed);xd._$name="HorizontalLayoutStack";var Dd=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"applyLayout",value:function(e,t){for(var n,r,i,o,a=this,s=a.coordProp,l=a.sizeProp,u=0,c=e.length;u<c;u++){if(r=e[u],n=a.findStartSlot(e,r),(i=a.getCluster(e,u)).length>1){for(r[s]=n.start,r[l]=n.end-n.start,o=1;o<i.length-1&&i[o+1].start-r.start==0;)o++;var d=a.findStartSlot(e,i[o]);d&&d.start<.8&&(i.length=o)}var h=i.length,f=(n.end-n.start)/h;for(o=0;o<h;o++)t(i[o],o,n,f);u+=h-1}}},{key:"findStartSlot",value:function(e,t){var n,r=this.sizeProp,i=this.coordProp,o=this.getPriorOverlappingEvents(e,t);if(0===o.length)return{start:0,end:1};for(n=0;n<o.length;n++){if(0===n&&o[0][i]>0)return{start:0,end:o[0][i]};if(o[n][i]+o[n][r]<(n<o.length-1?o[n+1][i]:1))return{start:o[n][i]+o[n][r],end:n<o.length-1?o[n+1][i]:1}}return!1}},{key:"getPriorOverlappingEvents",value:function(e,t){for(var n=t.start,r=t.end,i=[],o=0,a=e.indexOf(t);o<a;o++)vt.intersectSpans(n,r,e[o].start,e[o].end)&&i.push(e[o]);return i.sort(this.sortOverlappers.bind(this)),i}},{key:"sortOverlappers",value:function(e,t){return e[this.coordProp]<t[this.coordProp]?-1:1}},{key:"getCluster",value:function(e,t){var n=e[t];if(t>=e.length-1)return[n];for(var r=[n],i=e.length,o=n.start,a=n.end,s=t+1;s<i&&vt.intersectSpans(o,a,e[s].start,e[s].end);)r.push(e[s]),o=vt.max(o,e[s].start),a=vt.min(e[s].end,a),s++;return r}}],[{key:"defaultConfig",get:function(){return{coordProp:"top",sizeProp:"height"}}}]),t}(e||z)},Td=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"applyLayout",value:function(e){var n=this;se()(oe()(t.prototype),"applyLayout",this).call(this,e,(function(e,t,n,r){e.height=r,e.top=n.start+t*r})),e.forEach((function(e){Object.assign(e,n.bandIndexToPxConvertFn.call(n.bandIndexToPxConvertThisObj||n,e.top,e.height,null,e.event))}))}}]),t}(Dd(Ed));Td._$name="HorizontalLayoutPack";var Rd=/-/g,Md=Math.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Fd={add:1,update:1,remove:1,filter:1},_d=new Promise((function(e){return e()})),Ad={block:"nearest",edgeOffset:20},Id=["eventLayout","barMargin","mode","tickSize","zoomLevel","eventColor","eventStyle","fillTicks","startDate","endDate"],Ld=function(e,t){return e.startDate-t.startDate},Od=function(e){return e.preventDefault()},Pd={},Hd=document.createRange();function Nd(e){return!(e.classList.contains("b-dragging")||e.classList.contains("b-resizing"))}var Bd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var t=this;t.view=e,t.innerElCls="".concat(e.eventCls),t.availableDivs=new Sr,t.reservedIds={},t.divCount=0}},{key:"init",value:function(){var e=this;e.view.rowManager.on({beforetranslaterow:e.onBeforeTranslateRow,translaterow:e.onTranslateRow,beforerowheight:e.onBeforeRowHeightChange,thisObj:e}),e.view.on({beforetogglenode:e.onBeforeToggleNode,togglenode:e.onToggleNode,beforetoggleallnodes:e.onBeforeToggleAllNodes,toggleallnodes:e.onToggleAllNodes,thisObj:e})}},{key:"translateToPageCoordinate",value:function(e){var t=this.column.subGridElement;return e+t.getBoundingClientRect().left-t.scrollLeft}},{key:"refreshRows",value:function(e){e&&(this.cache.clear(this.refreshFromRerender),this.view.refreshFromRerender=!1)}},{key:"onDragAbort",value:function(e){this.view.currentOrientation.availableDivs.includes(e.element)&&e.element.classList.add("b-sch-released")}},{key:"onLocaleChange",value:function(){this.cache.clear()}},{key:"calculateMS",value:function(e){throw new Error("Implement in subclass")}},{key:"getTimeSpanRenderData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=!0===n||n.timeAxis,a=!0===n||n.viewport;if(o||i.isTimeSpanInAxis(e)){var s=r.view,l=s.getRowById(t);if(l||a){var u=s.scrollable.y,c=Math.max(u-50,0),d=Math.min(u+s._bodyRectangle.height+50,s.virtualScrollHeight);if(a||l.top<d&&l.top+(l.height||l.lastHeight)>=c){var h,f,g=r.timeAxisViewModel.getSingleUnitInPixels("minute"),v=e.startDate,m=e.endDate||v,p=i.startMS,y=i.endMS,k=r.calculateMS(e),b=k.startMS,w=k.endMS,S=k.durationMS,C=b<p|(b>y)<<1,E=w>y|(w<=p)<<1,x=S/6e4,D=E?g*x:null,T=s.getCoordinateFromDate(w,{local:!0,respectExclusion:!0,isEnd:!0}),R=!1,M=!1;if(C?f=(b-p)/6e4*g:R=-1===(f=s.getCoordinateFromDate(b,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:-1!==T})),E?T=f+D:M=-1===T,M&&!R&&(T=s.getCoordinateFromDate(w,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0})),D>9999999&&(1===C?1===E?(f=-100,T=s.timeAxisColumn.width+100):f=T-9999999:1===E&&(T=f+9999999)),R&&M&&(f=s.getCoordinateFromDate(b,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:!0,max:w}))===(T=s.getCoordinateFromDate(w,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0,min:b})))return e.instanceMeta(s).excluded=!0,null;var F=(h={},$()(h,r.view.scheduledEventName,e),$()(h,"left",Math.min(f,T)),$()(h,"width",Math.abs(T-f)),$()(h,"start",v),$()(h,"end",m),$()(h,"startMs",b),$()(h,"endMs",w),$()(h,"rowId",t.id),$()(h,"startsOutsideView",C),$()(h,"endsOutsideView",E),$()(h,"clippedStart",R),$()(h,"clippedEnd",M),$()(h,"row",l),h);return r.view.fillTicks&&(F.dataStartMs=F.start.getTime(),F.dataEndMs=F.end.getTime()),F.top=Math.max(0,s.resourceMargin),s.managedEventSizing&&(F.height=Math.max(s.rowManager.rowHeight-2*s.resourceMargin,1)),F}}}}},{key:"onTranslateRow",value:function(e){e.source}},{key:"onBeforeRowHeightChange",value:function(e){var t=this.view,n=e?e.height:this.rowHeight;this.cache.clear(),t.foregroundCanvas&&(t.element.classList.add("b-notransition"),t.foregroundCanvas.style.fontSize="".concat(n-2*t.resourceMargin,"px"),this._thisIsAUsedExpression(window.getComputedStyle(t.foregroundCanvas).fontSize),t.element.classList.remove("b-notransition")),t.milestoneWidth=null}},{key:"onBeforeTranslateRow",value:function(e){var t=e.row;this.cache.clearRow(t.id)}},{key:"onViewportResize",value:function(){this.lastUpdateScrollPos=null,this.update()}},{key:"positionTimeSpan",value:function(e,t,n){switch(this.view.eventPositionMode||"translate"){case"position":return e.style.left="".concat(t,"px"),void(e.style.top="".concat(n,"px"));case"translate":return void(e.style.transform="translate(".concat(t,"px,").concat(n,"px)"));case"translate3d":e.style.transform="translate3d(".concat(t,"px,").concat(n,"px,0)")}}},{key:"getTimeSpanDiv",value:function(e){var t,n=this.availableDivs,r=e.id,i=e.oldId;return"move"===this.view.eventScrollMode?(r&&(t=n.get(r)||n.get(i)),t&&!Nd(t)&&(t=null),t||(t=n.find(Nd)),t&&(n.remove(t),t.classList.remove("b-sch-released")),t):null}},{key:"releaseTimeSpanDiv",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=e.style;t||e!==document.activeElement||n.view.focusElement.focus(),"move"===n.view.eventScrollMode?(n.availableDivs.add(e),!t&&Nd(e)&&e.classList.add("b-sch-released")):t||(r.opacity=0,r.pointerEvents="none",n.setTimeout((function(){e.remove(),r.opacity=1,r.pointerEvents=""}),200))}},{key:"updateElementId",value:function(e,t){var n=this.availableDivs;n.includes(e)&&(n.changeId(e,t),n.items.delete(e),n.items.add(e))}},{key:"triggerPaint",value:function(e,t){throw new Error("Implement in subclass")}},{key:"renderTimeSpan",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.view,s=e.cls,l=e.id,u=t&&t.div,c=!1,d=!1,h=!1,f=t&&t.eventEl;if(i||u||!(u=o.getTimeSpanDiv(e))||(c=u.id!==l),r=u&&u.classList.contains("b-sch-dragcreator-proxy"),!u||c){if(c)(f=u.innerElement||u.firstElementChild).innerHTML="",f.style.cssText="",f.nextSibling&&(Hd.setStartAfter(f),Hd.setEndAfter(u.lastChild),Hd.deleteContents());else{var g=rn.createElement({tabIndex:0,children:[{className:"".concat(o.innerElCls)}]},!0),v=fe()(g,2);u=v[0],f=v[1],u.innerElement=f}u.id=l,e[a.scheduledEventName+"Id"]&&(u.dataset[a.scheduledEventName+"Id"]=e[a.scheduledEventName+"Id"]),rn.syncClassList(u,e.wrapperCls),u.parentNode!==a.foregroundCanvas&&a.foregroundCanvas.appendChild(u),rn.syncClassList(f,s),(e.style||e.internalStyle)&&(f.style.cssText=(e.internalStyle||"")+(e.style||"")),e.body&&f.appendChild(e.body.cloneNode(!0)),u.style.cssText="width:".concat(e.width,"px;height:").concat(e.height,"px;").concat(e.wrapperStyle||""),o.positionTimeSpan(u,e.left,e.top),d=!0}else{var m=n&&t.div?n:Pd;if(f=u.querySelector(".".concat(o.innerElCls))||u.firstElementChild,rn.syncClassList(u,e.wrapperCls),rn.syncClassList(f,e.cls),e.style?f.style.cssText=e.style:f.style.cssText="",e.body){var p=f.innerHTML,y=f.featureEls;y&&y.forEach((function(t){return e.body.appendChild(t)})),f.innerHTML="",f.appendChild(e.body.cloneNode(!0)),d=f.innerHTML!==p}document.activeElement&&document.activeElement.id===e.id&&u.classList.add(a.focusCls),h=!0,e.wrapperStyle&&(u.style.cssText+=e.wrapperStyle),(m.left!==e.left||m.top!==e.top||e.style)&&(o.positionTimeSpan(u,e.left,e.top),d=!0),(m.width!==e.width||e.style)&&(u.style.width="".concat(e.width,"px"),d=!0),(m.height!==e.height||e.style)&&(u.style.height="".concat(e.height,"px"),d=!0)}return t.div=u,t.eventEl=f,d&&(h&&r&&(h=!1,u.classList.remove("b-sch-dragcreator-proxy")),o.triggerPaint(e,u,h)),u}},{key:"cacheTimeSpanElement",value:function(e,t,n){var r=this.availableDivs,i=this.view,o=i.getEventRenderId(e,t);r.includes(o)||(n?(n.id=o,i.foregroundCanvas.appendChild(n)):n=rn.createElement({id:o,tabIndex:0,children:[{className:"".concat(this.innerElCls)}]}),r.add(n))}},{key:"updateRowTimeSpans",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"renderer",value:function(e){}},{key:"updateFromHorizontalScroll",value:function(e){var t=this,n=t.view,r=n.timeAxisSubGrid.width,i=n.getDateFromX(Math.max(0,e-100)),o=n.getDateFromX(e+r+100)||n.timeAxis.endDate,a=t.view.timeAxisSubGrid.scrollable.x,s=t.lastUpdateScrollPos;t.viewportStart=i&&i.getTime(),t.viewportEnd=o&&o.getTime(),(!s||Math.abs(a-s.x)>50)&&t.update(),n.timeView.range={startDate:i,endDate:o}}},{key:"update",value:function(){var e=this.view;this.lastUpdateScrollPos={x:e.timeAxisSubGrid.scrollable.x,y:e.scrollable.y};var t=!0,n=!1,r=void 0;try{for(var i,o=e.rowManager[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value.getCell(e.timeAxisColumn.id),s=sl.get(a),l=e.store.getById(s.id);l&&this.updateRowTimeSpans(s.row,l,!1,!0)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[0];return n||(i=this.translateToScheduleCoordinate(i)),this.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-this.column.subGridElement.getBoundingClientRect().left+this.view.scrollLeft}},{key:"onBeforeToggleNode",value:function(e){var t=e.record,n=this;if(t.children&&t.children.length)for(var r=n.view.store.getNext(t);r&&n.view.getRowFor(r);)n.cache.clearRow(r.id),r=n.view.store.getNext(r.id);n.togglingNode=!0}},{key:"onToggleNode",value:function(){this.togglingAllNodes||(this.togglingNode=!1)}},{key:"onBeforeToggleAllNodes",value:function(){this.cache.clear(),this.togglingAllNodes=this.togglingNode=!0}},{key:"onToggleAllNodes",value:function(){this.togglingAllNodes=this.togglingNode=!1}},{key:"onRowRecordUpdate",value:function(e){var t=e.record;this.cache.clearRow(t.id,!1,!0)}},{key:"onRowRecordRemove",value:function(e){var t=this;e.records.forEach((function(e){return e.traverse((function(e){return t.cache.clearRow(e.id)}))}))}},{key:"getRowRegion",value:function(e,t,n){var r=this.view,i=this.column,o=r.getRowById(e.id);if(!o)return null;var a=o.getElement(i.region),s=this.timeAxis.startDate,l=this.timeAxis.endDate,u=t?vt.max(s,t):s,c=n?vt.min(l,n):l,d=r.getCoordinateFromDate(u),h=r.getCoordinateFromDate(c,!0,!0),f=o.top+r.verticalScroller.scrollTop,g=Math.min(d,h),v=f+a.offsetHeight;return new Oe(g,f,Math.max(d,h)-g,v-f)}},{key:"getVisibleDateRange",value:function(){var e=this.view,t=e.timeAxisSubGrid.scrollable.x,n=e.timeAxisSubGrid.width;return{startDate:e.getDateFromX(t),endDate:e.getDateFromX(t+n)||e.timeAxis.endDate}}},{key:"getConnectorStartSide",value:function(e){}},{key:"getConnectorEndSide",value:function(e){}},{key:"column",get:function(){return this.view.timeAxisColumn}},{key:"timeAxis",get:function(){return this.view.timeAxis}},{key:"timeAxisViewModel",get:function(){return this.view.timeAxisViewModel}}]),t}(de(z));Bd._$name="BaseHorizontalMapper";var zd=function(){function e(t){C()(this,e);this.mapper=t,this.renderedEventsMap={},this.rowLayoutCache={}}return x()(e,[{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.renderedEventsMap={},Object.keys(t.rowLayoutCache).forEach((function(n){return t.clearRow(n,!!e&&"immediate")}))}},{key:"addRenderedEvents",value:function(e,t){this.renderedEventsMap[e]=t}},{key:"addRenderedEvent",value:function(e){e.resourceId in this.renderedEventsMap&&((this.renderedEventsMap[e.resourceId]||(this.renderedEventsMap[e.resourceId]={}))[e.id]=e)}},{key:"getRenderedTimeSpan",value:function(e,t){var n=this.renderedEventsMap[e];return n&&n[t]}},{key:"clearRenderedTimeSpan",value:function(e,t){if(this.renderedEventsMap[e]){var n=this.renderedEventsMap[e][t];return delete this.renderedEventsMap[e][t],n}}},{key:"getRenderedEvents",value:function(e){return this.renderedEventsMap[e]}},{key:"clearRenderedEvents",value:function(e){this.renderedEventsMap[e]=null}},{key:"getTimeSpan",value:function(e,t){var n=this.rowLayoutCache[t],r=n&&n[e];return r?r.layoutCache:null}},{key:"clearEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.getTimeSpan(e,t);if(!o)return null;o.div&&i.mapper.clearDiv(o.div,n,r),i.rowLayoutCache[t][e].layoutCache=null}},{key:"getRow",value:function(e){return this.rowLayoutCache[e]}},{key:"addRow",value:function(e,t){this.rowLayoutCache[e]=t}},{key:"clearRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.rowLayoutCache[e];i&&(r.renderedEventsMap[e]&&delete r.renderedEventsMap[e],Object.keys(i).forEach((function(i){"_allEvents"!==i&&"_rowHeight"!==i&&r.clearEvent(i,e,t,n)})),delete r.rowLayoutCache[e])}}]),e}();zd._$name="HorizontalEventMapperCache";var jd=function(e,t,n,r,i){if(e.fillTicks){var o=Math.floor(t.getTickFromDate(n)),a=t.getAt(o);if(a)return a[i?"endDate":"startDate"].getTime()}return r},Vd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){this.scheduler=e,se()(oe()(t.prototype),"construct",this).call(this,e),this.cache=new zd(this)}},{key:"init",value:function(){se()(oe()(t.prototype),"init",this).call(this),this.scheduler.on({togglegroup:this.onToggleGroup,rowremove:this.onRowRemove,prio:2,thisObj:this})}},{key:"clearDiv",value:function(e,t,n){var r=e.style;!t||n?this.releaseTimeSpanDiv(e,n):"immediate"!==t&&this.scheduler.enableEventAnimations?(e.id=Z.generateId("obsolete-event"),r.opacity=0,r.pointerEvents="none",this.setTimeout((function(){e.remove(),r.opacity=1,r.pointerEvents=""}),200)):e.remove()}},{key:"clearAllDivs",value:function(){this.availableDivs.forEach((function(e){return e.remove()})),this.availableDivs.clear()}},{key:"clearEvents",value:function(){this.cache.clear(!0)}},{key:"releaseEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.cache.getRenderedTimeSpan(e,t),o=i&&r.cache.getTimeSpan(i.eventId,e);return o&&o.div&&(r.releaseTimeSpanDiv(o.div,n),o.div=o.eventEl=null),r.cache.clearRenderedTimeSpan(e,t)}},{key:"getElementFromEventRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scheduler.eventStore.getResourcesForEvent(e)[0];if(t){var n=this.cache.getRenderedEvents(t.id);if(n){var r=this.scheduler.getEventRenderId(e,t),i=n[r],o=i&&i.layoutCache;return o&&o.eventEl}}}},{key:"getElementsFromEventRecord",value:function(e,t){var n=this;return t?[n.getElementFromEventRecord(e,t)]:n.scheduler.eventStore.getResourcesForEvent(e).reduce((function(t,r){var i=n.getElementFromEventRecord(e,r);return i&&t.push(i),t}),[])}},{key:"resolveRowRecord",value:function(e){var t=this.view,n=e instanceof Event?e.target:e,r=3===n.nodeType?n.parentElement:n,i=r.matches(t.eventSelector)&&r||rn.up(r,t.eventSelector);return i?t.getResourceRecordFromDomId(i.id):t.getRecordFromElement(r)}},{key:"toggleCls",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t){var i=this.cache.getRenderedTimeSpan(t.id,this.scheduler.getEventRenderId(e,t)),o=this.getElementFromEventRecord(e,t);i&&(i.cls[n]=r?1:0),o&&o.classList[r?"add":"remove"](n)}}},{key:"getResourceEventBox",value:function(e,t){var n=this.cache.getTimeSpan(e,t);if(n)return n}},{key:"getScheduleRegion",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this,o=i.view,a=i.column;if(e){var s=t&&i.getElementsFromEventRecord(t,e)[0];if(n=Oe.from(o.getRowById(e.id).getElement("locked")),s){var l=Oe.from(s,a.subGridElement);n.y=l.y,n.bottom=l.bottom}else n.y=n.y+o.resourceMargin,n.bottom=n.bottom-o.resourceMargin}else(n=Oe.from(a.subGridElement).moveTo(null,0)).width=a.subGridElement.scrollWidth,n.y=n.y+o.resourceMargin,n.bottom=n.bottom-o.resourceMargin;var u=i.timeAxis.startDate,c=i.timeAxis.endDate,d=o.getDateConstraints(e,t)||{start:u,end:c},h=o.getCoordinateFromDate(vt.max(u,d.start)),f=o.getCoordinateFromDate(vt.min(c,d.end)),g=n.y,v=n.bottom;return r||(h=i.translateToPageCoordinate(h),f=i.translateToPageCoordinate(f)),{top:g,right:Math.max(h,f),bottom:v,left:Math.min(h,f)}}},{key:"getResoureEventBox",value:function(e,t){return this.cache.getTimeSpan(e,t)}},{key:"layoutEventVerticallyStack",value:function(e){var t=this.scheduler,n=t.resourceMargin,r=t.rowHeight,i=t.barMargin;return 0===e?n:n+e*(r-2*n)+e*i}},{key:"layoutEventVerticallyPack",value:function(e,t){var n=this.scheduler,r=n.resourceMargin,i=n.rowHeight,o=n.barMargin,a=1/t,s=e*a,l=(i-2*r-(a-1)*o)*t;return{top:r+s*l+s*o,height:l}}},{key:"calculateMS",value:function(e){var t=this.view,n=jd(t,this.timeAxis,e.startDate,e.startDateMS,!1),r=jd(t,this.timeAxis,e.endDate,e.endDateMS,!0),i=r-n;if("default"!==t.milestoneLayoutMode&&0===i){var o=this.timeAxisViewModel.getSingleUnitInPixels("minute");switch(i=60*(t.getMilestoneLabelWidth(e)*(1/o))*1e3,t.milestoneAlign){case"start":case"left":r=n+i;break;case"end":case"right":n=(r=n)-i;break;default:n=(r=n+i/2)-i}}return{startMS:n,endMS:r,durationMS:i}}},{key:"layoutEvents",value:function(e,t,n){var r=this,i=r.timeAxis,o=e.eventStore,a=t.id,s=o.getEventsForResource(a),l=o.isFiltered?s.filter((function(e){return o.indexOf(e)>-1})):s,u=(e.getEventsToRender(t,l)||[]).filter((function(e){return i.isTimeSpanInAxis(e)})).reduce((function(n,i){var o=e.generateTplData(i,t);return o?n.push(o):r.cache.getRenderedEvents(a)&&r.releaseEvent(a,e.getEventRenderId(i,t)),n}),[]);if(!u.length)return r.cache.clearRenderedEvents(a),!1;u.sort(e.horizontalEventSorterFn||r.eventSorter);var c=e.rowHeight,d=e.currentEventLayout,h=u.filter((function(e){return e.event.isEvent||e.event.isTask}));if("stack"===e.eventLayout){var f=d.applyLayout(h,t),g=e.rowHeight-2*e.resourceMargin;c=f*g+(f-1)*e.barMargin+2*e.resourceMargin}else"pack"===e.eventLayout&&d.applyLayout(h,t);var v=n.top;c!==n.height&&n.estimatedTop&&(v=n.top+n.height-c);var m={_allEvents:u,_rowHeight:c};return u.forEach((function(e){var t=r.cache.getTimeSpan(e.eventId,a),n=e.top;e.top+=v,e.rowTop=v,e.fillSize&&(e.height=c),e.layoutCache={layout:!0,div:t&&t.div,eventEl:t&&t.eventEl,width:e.width,height:e.height,start:e.left,end:e.left+e.width,relativeTop:n,top:e.top,relativeBottom:n+e.height,bottom:e.top+e.height},m[e.eventId]=e})),r.cache.addRow(a,m),!0}},{key:"eventSorter",value:function(e,t){var n=e.dataStartMs||e.startMs,r=e.dataEndMs||e.endMs,i=t.dataStartMs||t.startMs,o=t.dataEndMs||t.endMs;return n===i?r-o==0?e.event.name<t.event.name?-1:1:r>o?-1:1:n<i?-1:1}},{key:"onTranslateRow",value:function(e){var t=e.row;this.matchRowTranslation(t)}},{key:"renderEvent",value:function(e){var t=this,n=t.view.scheduledEventName+"Id",r=e[n],i=t.cache.getTimeSpan(r,e.resourceId),o=t.cache.getRenderedEvents(e.resourceId),a=e.event.instanceMeta(t.scheduler),s=t.renderTimeSpan(e,i,o[e.id],a.requireElement&&!a.fromDragProxy);e.assignment&&(s.dataset.assignmentId=e.assignment.id),r&&(s.dataset[n]=r),o[e.id]=e,a.requireElement&&(delete a.requireElement,delete a.fromDragProxy),t.scheduler.trigger("renderEvent",{eventRecord:e.event,resourceRecord:e.resource,assignmentRecord:e.assignment,element:s,tplData:e})}},{key:"triggerPaint",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.scheduler;r.trigger(n?"eventRepaint":"eventPaint",{scheduler:r,eventRecord:e.event,resourceRecord:e.resource,element:t})}},{key:"isEventInView",value:function(e){return e.startMs===e.endMs?e.startMs<=this.viewportEnd&&e.endMs>this.viewportStart:e.startMs<this.viewportEnd&&e.endMs>this.viewportStart}},{key:"updateRowTimeSpans",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.scheduler,a=t.id,s=i.cache.getRenderedEvents(a),l=i.cache.getRow(a);if((o.forceLayout||n||!l)&&!i.layoutEvents(o,t,e))return l&&l._rowHeight||0;if(!(l=i.cache.getRow(a)))return 0;var u=l._allEvents.filter((function(e){return e.event.instanceMeta(o).retainElement||e.assignment&&e.assignment.instanceMeta(o).retainElement||i.isEventInView(e)}));s||(s={},i.cache.addRenderedEvents(a,s));for(var c=0;c<u.length;c++){var d=u[c];if(o._firstRenderDone&&o._firstRenderDone(),!r&&!d.event.instanceMeta(o).retainElement||r&&!d.layoutCache.div){var h=o.isFirstRender&&d.top<o.bodyHeight&&o.useInitialAnimation;h&&(d.wrapperCls.add("b-first-render"),d.internalStyle="animation-delay: ".concat(d.row.index/20,"s;")),i.renderEvent(d),d.wrapperCls["b-first-render"]=null}}for(var f=Object.keys(s),g=function(e){var t=f[e];u.some((function(e){return e.id===t}))||i.releaseEvent(a,t)},v=0;v<f.length;v++)g(v);return l._rowHeight}},{key:"renderer",value:function(e){e.size.height=this.updateRowTimeSpans(e.row,e.record)}},{key:"matchRowTranslation",value:function(e){var t=this,n=t.scheduler.store.getAt(e.dataIndex).id,r=t.cache.getRow(n),i=r&&r._allEvents.length>0&&r._allEvents[0];if(i&&i.rowTop!==e.top){var o=e.top-i.rowTop;r._allEvents.forEach((function(n){var r=n.layoutCache;r.top+=o,r.bottom+=o,r.div&&t.positionTimeSpan(r.div,r.start,r.top),n.top+=o,n.rowTop=e.top}))}}},{key:"onTimeAxisViewModelUpdate",value:function(){this.cache.clear(),this.updateFromHorizontalScroll(this.scheduler.timeAxisSubGrid.scrollable.x)}},{key:"onRowRemove",value:function(e){var t=this,n=e.isCollapse,r=this.scheduler;n||r.runWithTransition((function(){r.rowManager.forEach((function(e){return t.matchRowTranslation(e)}))}))}},{key:"onToggleGroup",value:function(e){var t=this,n=e.groupRecord,r=e.collapse,i=this.scheduler.store,o=i.indexOf(n)+(r?1:n.groupChildren.length);for(r&&n.groupChildren.forEach((function(e){t.cache.clearRow(e.id)}));o<i.count;o++)this.cache.clearRow(i.getAt(o).id)}},{key:"onEventDataset",value:function(){this.cache.clear(!0)}},{key:"onEventAdd",value:function(e){var t,n,r=this,i=e.records,o=e.resources,a=this;i.forEach((function(e){if(t=e.startDate,n=e.endDate,t&&n&&a.timeAxis.timeSpanInAxis(t,n)){var i=e.resources;i&&i.some((function(e){return a.scheduler.getRowFor(e)}))&&(e.instanceMeta(a.scheduler).requireElement=!0),o.forEach((function(e){r.cache.clearRow(e.id,!1,!0)}))}}))}},{key:"onEventRemove",value:function(e){e.records;var t=e.resources,n=this;t.forEach((function(e){return n.cache.clearRow(e.id,!0)}))}},{key:"onEventUpdate",value:function(e){var t=e.source,n=e.record,r=e.changes,i=void 0===r?{}:r,o=e.resources,a=this,s="resourceId"in i;if(s||o.length){if(s){var l=t.resourceStore.getById(i.resourceId.oldValue),u=n.resource,c=u&&t.resourceStore.isAvailable(u),d=n.resource&&Boolean(a.getTimeSpanRenderData(n,n.resource));if(l){var h=a.cache.getTimeSpan(n.id,l.id);h&&(c?(h.div&&u&&(h.div.id=a.scheduler.getEventRenderId(n,u)),a.cache.clearRow(l.id,!1,c)):a.cache.clearEvent(n.id,i.resourceId.oldValue,!0))}else c&&(n.instanceMeta(a.scheduler).requireElement=!0);c&&a.cache.clearRow(u.id,!1,d),a.scheduler.rowManager.averageRowHeight=null}else("startDate"in i||"endDate"in i)&&o.forEach((function(e){a.scheduler.eventStore.getEventsForResource(e).length>1&&(a.scheduler.rowManager.averageRowHeight=null)}));o.forEach((function(e){var t=a.getTimeSpanRenderData(n,e),r=Boolean(t&&a.isEventInView(t));a.cache.clearRow(e.id,!1,r)}))}}},{key:"onEventStoreIdChange",value:function(e){var t=e.oldValue,n=e.value,r=this.view;rn.forEachSelector(r.element,'[data-event-id="'.concat(t,'"]'),(function(e){e.id=r.getEventRenderId(n,r.getResourceIdFromDomNodeId(e.id))}))}},{key:"onEventClearChanges",value:function(){this.cache.clear()}},{key:"onEventFilter",value:function(){this.cache.clear()}},{key:"onEventRemoveAll",value:function(){this.view.rowManager.averageRowHeight=null,this.cache.clear(!0)}},{key:"getConnectorStartSide",value:function(e){return"left"}},{key:"getConnectorEndSide",value:function(e){return"right"}}]),t}(Bd);Vd._$name="HorizontalEventMapper";var Wd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"applyLayout",value:function(e,n,r,i,o){var a=this;se()(oe()(t.prototype),"applyLayout",this).call(this,e,(function(e,t,o,s){if("none"===a.scheduler.eventLayout)e.width=n-2*r,e.left+=r;else{e.widthFactor=s;var l=e.leftFactor=o.start+t*s,u=Math.round(1/s),c=l/s,d=n-2*r-i*(u-1);"mixed"===a.scheduler.eventLayout&&2===u?(e.left+=l*n/5+i,e.width=n-l*n/5-2*i,e.zIndex=5+c):(e.width=s*d,e.left+=l*d+r+i*c)}}))}}],[{key:"defaultConfig",get:function(){return{coordProp:"leftFactor",sizeProp:"widthFactor"}}}]),t}(Dd());Wd._$name="VerticalLayout";var Gd={releaseElement:1,reuseElement:1},Yd={newElement:1,reuseOwnElement:1,reuseElement:1},Ud=Object.freeze([]),qd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){this.scheduler=e,this.timeAxisViewModel=e.timeAxisViewModel,this.verticalLayout=new Wd({scheduler:e}),se()(oe()(t.prototype),"construct",this).call(this,{})}},{key:"init",value:function(){var e=this,t=e.scheduler;e.resourceColumns=t.timeAxisColumn.resourceColumns,t.element.classList.add("b-sch-vertical"),t.on({assignmentstorechange:e.onChangeAssignmentStore,resourcestorechange:e.onChangeResourceStore,thisObj:e}),e.resourceColumns.on({columnWidthChange:e.onResourceColumnWidthChange,thisObj:e}),e.resourceStore=t.resourceStore,e.assignmentStore=t.assignmentStore,e.initialized=!0,t.isPainted&&e.renderer(),e.resourceColumns.availableWidth=t.timeAxisSubGrid.width}},{key:"resolveRowRecord",value:function(e,t){var n=this.scheduler,r=e instanceof Event?e:null,i=r?r.target:e,o=r?[r.offsetX,r.offsetY]:t,a=3===i.nodeType?i.parentElement:i,s=rn.up(a,n.eventSelector);if(s)return n.resourceStore.getById(s.dataset.resourceId);if(!rn.up(i,".b-sch-timeaxis-cell"))return null;if(!o)throw new Error("Vertical mode needs coordinates to resolve this element. Can also be called with a browser \n                event instead of element to extract element and coordinates from");var l=Math.floor(o[0]/this.resourceColumns.columnWidth);return n.resourceStore.getAt(l)}},{key:"getElementFromEventRecord",value:function(e,t){var n=this.getElementsFromEventRecord(e,t);return n.length?n[0]:null}},{key:"getElementsFromEventRecord",value:function(e){var t=this.eventMap[e.id];return t?Object.values(t).map((function(e){return e.element})):Ud}},{key:"toggleCls",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=kt.getPath(this.eventMap,"".concat(e.id,".").concat(t.id));i&&(i.tplData.cls[n]=r?1:0,i.element&&i.element.querySelector(this.scheduler.eventInnerSelector).classList[r?"add":"remove"](n))}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[1];return n||(i=this.translateToScheduleCoordinate(i)),this.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-this.scheduler._bodyRectangle.y+this.scheduler.scrollTop}},{key:"translateToPageCoordinate",value:function(e){return e+this.scheduler._bodyRectangle.y-this.scheduler.scrollTop}},{key:"getResourceEventBox",value:function(e,t){var n=(kt.getPath(this.eventMap,"".concat(e,".").concat(t))||{}).tplData;return n||(this.layoutResource(this.scheduler.resourceStore.getById(t)),n=kt.getPath(this.eventMap,"".concat(e,".").concat(t)).tplData),n?{start:n.left,end:n.left+n.width,top:n.top,bottom:n.bottom}:null}},{key:"getScheduleRegion",value:function(e,t,n){var r=this.scheduler,i=Oe.from(r.timeAxisSubGridElement);e&&(i.left=this.resourceStore.indexOf(e)*r.resourceColumnWidth,i.right=i.left+r.resourceColumnWidth);var o=r.timeAxis.startDate,a=r.timeAxis.endDate,s=r.getDateConstraints(e,t)||{start:o,end:a},l=r.getCoordinateFromDate(vt.max(o,s.start)),u=r.getCoordinateFromDate(vt.min(a,s.end));return n?(i.top=l,i.bottom=u):(i.top=this.translateToPageCoordinate(l),i.bottom=this.translateToPageCoordinate(u)),i}},{key:"getRowRegion",value:function(e,t,n){var r=this.scheduler,i=this.resourceStore.indexOf(e)*r.resourceColumnWidth,o=r.timeAxis.startDate,a=r.timeAxis.endDate,s=t?vt.max(o,t):o,l=n?vt.min(a,n):a,u=r.getCoordinateFromDate(s),c=r.getCoordinateFromDate(l,!0,!0),d=Math.min(u,c),h=Math.abs(u-c);return new Oe(i,d,r.resourceColumnWidth,h)}},{key:"getVisibleDateRange",value:function(){var e=this.scheduler,t=e.scrollable.y,n=e.scrollable.clientHeight;return{startDate:e.getDateFromCoordinate(t),endDate:e.getDateFromCoordinate(t+n)||e.timeAxis.endDate}}},{key:"onResourceColumnWidthChange",value:function(e){var t=e.width,n=e.oldWidth,r=this,i=r.scheduler;r.resourceColumns.width=i.timeAxisColumn.width=r.resourceStore.count*t,r.clearAll(),i.runWithTransition((function(){return r.renderer()}),Math.abs(t-n)>30)}},{key:"onEventStoreChange",value:function(e){var t=e.action,n=e.records,r=e.record,i=e.replaced,o=e.changes,a=e.fromRelationUpdate,s=this,l=n||(r?[r]:[]),u=new Set,c=!0;switch(l.forEach((function(e){e.resources.forEach((function(e){return u.add(e.id)}))})),t){case"sort":case"group":case"move":return;case"dataset":s.clearAll(),c=!1;break;case"add":case"remove":case"updateMultiple":s.clearResources(u);break;case"replace":i.forEach((function(e){var t=fe()(e,2),n=t[0],r=t[1];n.resources.map((function(e){return u.add(e.id)})),r.resources.map((function(e){return u.add(e.id)}))})),s.clearResources(u);break;case"removeall":case"filter":s.clearAll();break;case"update":if(r.meta.removingResource)return;var d=!1;if(("startDate"in o||"endDate"in o||"duration"in o||"id"in o)&&(s.clearResources(u),d=!0),"resourceId"in o){if(a)return;u.add(o.resourceId.oldValue),s.clearResources(u),d=!0}if(!d)Object.values(s.eventMap[r.id]).forEach((function(e){var t=e.tplData;e.tplData=s.scheduler.generateTplData(t.eventRecord,t.resourceRecord),e.tplData.left=t.left,e.tplData.width=t.width}))}s.scheduler.runWithTransition((function(){return s.renderer()}),c)}},{key:"onChangeResourceStore",value:function(e){var t=e.newResourceStore,n=this;n.firstResource=n.lastResource=null,n.clearAll(),n.resourceStore=t,n.renderer()}},{key:"onResourceStoreChange",value:function(e){var t=e.source,n=e.action,r=e.records,i=e.record,o=this,a=r||(i?[i]:[]);switch(o.firstResource=o.lastResource=null,n){case"add":for(var s=a.reduce((function(e,n){return Math.min(e,t.indexOf(n))}),t.count);s<t.count;s++)o.clearResources([t.getAt(s).id]);return;case"remove":case"removeall":return void o.clearAll();case"replace":case"update":break;case"filter":o.clearAll()}o.scheduler.runWithTransition((function(){return o.renderer()}),!0)}},{key:"onResourceStoreRefresh",value:function(e){var t=e.action,n=this;if("group"===t)throw new Error("Grouping of resources not supported in vertical mode");"sort"===t&&(n.firstResource=n.lastResource=null,n.clearAll(),n.scheduler.runWithTransition((function(){return n.renderer()})))}},{key:"onChangeAssignmentStore",value:function(e){var t=e.newAssignmentStore;this.assignmentStore=t}},{key:"onAssignmentStoreChange",value:function(e){var t=e.action,n=e.records,r=e.replaced,i=e.record,o=e.changes,a=this,s=new Set((n||(i?[i]:[])).map((function(e){return e.resourceId})));switch(t){case"add":case"remove":case"updateMultiple":a.clearResources(s);break;case"filter":case"removeall":a.clearAll();break;case"replace":r.forEach((function(e){var t=fe()(e,2),n=t[0],r=t[1];s.add(n.resourceId),s.add(r.resourceId)})),a.clearResources(s);break;case"update":"resourceId"in o&&s.add(o.resourceId.oldValue),a.clearResources(s)}a.scheduler.runWithTransition((function(){return a.renderer()}),!0)}},{key:"refreshRows",value:function(e){e&&(this.clearAll(),this.scheduler.refreshFromRerender=!1)}},{key:"updateFromHorizontalScroll",value:function(e){e!==this.prevScrollLeft&&(this.renderer(),this.prevScrollLeft=e)}},{key:"updateFromVerticalScroll",value:function(){this.renderer()}},{key:"scrollResourceIntoView",value:function(e,t){var n=this.scheduler,r=n.resourceStore.indexOf(e)*n.resourceColumnWidth;return n.scrollHorizontallyTo(r,t)}},{key:"onViewportResize",value:function(e){this.resourceColumns.availableWidth=e,this.renderer()}},{key:"onLocaleChange",value:function(){this.clearAll()}},{key:"onDragAbort",value:function(){}},{key:"onBeforeRowHeightChange",value:function(){}},{key:"onTimeAxisViewModelUpdate",value:function(){}},{key:"clearEvents",value:function(){}},{key:"updateElementId",value:function(){}},{key:"releaseTimeSpanDiv",value:function(){}},{key:"getTimeSpanRenderData",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=this,r=n.scheduler,i=e.startDate,o=e.endDate,a=r.getCoordinateFromDate(i),s=n.resourceStore.indexOf(t)*r.resourceColumnWidth,l=r.resourceColumnWidth-2*r.resourceMargin,u=i.getTime(),c=o.getTime(),d=r.getCoordinateFromDate(o),h=d-a;return-1===d&&(d=a+(h=Math.round((c-u)*r.timeAxisViewModel.getSingleUnitInPixels("ms")))),{eventRecord:e,resourceRecord:t,left:s,top:a,bottom:d,width:l,height:h,startDate:i,endDate:o,startDateMS:u,endDateMS:c,start:i,end:o,startMs:u,endMs:c}}},{key:"eventSorter",value:function(e,t){var n=e.dataStartMs||e.startDateMS,r=e.dataEndMs||e.endDateMS,i=t.dataStartMs||t.startDateMS,o=t.dataEndMs||t.endDateMS;return n===i?r-o==0?e.eventRecord.name<t.eventRecord.name?-1:1:r>o?-1:1:n<i?-1:1}},{key:"layoutResource",value:function(e){var t=this,n=t.scheduler,r=t.resourceMap[e.id]={},i=n.resourceStore.indexOf(e),o=n.eventStore.getEventsForResource(e),a=(o=n.getEventsToRender(e,o)).reduce((function(o,a){var s=n.generateTplData(a,e),l={tplData:s};return kt.setPath(t.eventMap,"".concat(s.eventId,".").concat(e.id),l),r[s.eventId]=l,s.fillSize?(s.left=i*n.resourceColumnWidth,s.width=n.resourceColumnWidth):o.push(s),o}),[]);return a.sort(t.eventSorter),t.verticalLayout.applyLayout(a,n.resourceColumnWidth,n.resourceMargin,n.barMargin,i),r}},{key:"renderEvent",value:function(e){var t=e.tplData,n=t.resourceRecord,r=t.eventRecord,i={className:t.wrapperCls,tabIndex:"0",children:[{className:t.cls,style:(t.internalStyle||"")+(t.style||""),html:t.body.cloneNode(!0),compareHtml:t.eventContent}],style:{transform:"translate(".concat(t.left,"px, ").concat(t.top,"px)"),height:t.height,width:t.width,zIndex:t.zIndex},dataset:{resourceId:n.id,eventId:t.eventId,syncId:t.assignment?t.assignment.id:t.eventId},elementData:e,retainElement:r.instanceMeta(this.scheduler).retainElement};return t.assignment&&(i.dataset.assignmentId=t.assignment.id),i}},{key:"renderResource",value:function(e){var t=this,n=t.topDateMS,r=t.bottomDateMS,i=[],o=t.resourceMap[e.id];for(var a in o||(o=t.layoutResource(e)),o){var s=o[a];s.tplData.endDateMS>=n&&s.tplData.startDateMS<=r&&i.push(t.renderEvent(s))}return i}},{key:"renderer",value:function(){var e=this,t=e.scheduler,n=t.resourceStore,r=e.resourceRange,i=r.firstResource,o=r.lastResource,a=e.dateRange,s=a.topDate,l=a.bottomDate,u=[],c=[];if(e.initialized){if(vt.isEqual(s,e.topDate)&&vt.isEqual(l,e.bottomDate)||(e.topDate=s,e.bottomDate=l,e.topDateMS=s.getTime(),e.bottomDateMS=l.getTime(),e.timeView.range={startDate:s,endDate:l}),-1!==i&&-1!==o)for(var d=i;d<=o;d++)u.push.apply(u,e.renderResource(n.getAt(d)));t.getForegroundDomConfigs(c),u.push.apply(u,c),Za.sync({domConfig:{onlyChildren:!0,children:u},targetElement:t.foregroundCanvas,syncIdField:"syncId",callback:function(e){var n=e.action,r=e.domConfig,i=e.lastDomConfig,o=e.targetElement;if(r&&r.className&&r.className[t.eventCls+"-wrap"]){var a=Yd[n];if(Gd[n]&&i&&!i.isReleased){var s=i.elementData.tplData,l={tplData:s,assignmentRecord:s.assignment,eventRecord:s.eventRecord,resourceRecord:s.resourceRecord,targetElement:o};t.trigger("releaseEvent",l)}if(a){var u=r.elementData.tplData,c={tplData:u,assignmentRecord:u.assignment,eventRecord:u.eventRecord,resourceRecord:u.resourceRecord,targetElement:o};o.elementData.element=o,c.reusingElement="reuseElement"===n,t.trigger("renderEvent",c)}"none"===n&&(r.elementData.element=o)}}}),e.firstResource===i&&e.lastResource===o||(e.resourceColumns.range={firstResource:i,lastResource:o},e.firstResource=i,e.lastResource=o)}}},{key:"clearResources",value:function(e){var t=this;e.forEach((function(e){t.resourceMap[e]&&(Object.keys(t.resourceMap[e]).forEach((function(n){delete t.eventMap[n][e]})),delete t.resourceMap[e])}))}},{key:"clearAll",value:function(){this.resourceMap={},this.eventMap={}}},{key:"resourceStore",set:function(e){var t=this;t.resourceStoreDetacher&&t.resourceStoreDetacher(),t.resourceColumns.resourceStore=t._resourceStore=e,t.resourceStoreDetacher=e.on({change:t.onResourceStoreChange,refresh:t.onResourceStoreRefresh,thisObj:t,prio:1})},get:function(){return this._resourceStore}},{key:"timeView",get:function(){return this.scheduler.timeView}},{key:"assignmentStore",set:function(e){var t=this;t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),t._assignmentStore=e,e&&(t.assignmentStoreDetacher=e.on({change:t.onAssignmentStoreChange,thisObj:t}))},get:function(){return this._assignmentStore}},{key:"resourceRange",get:function(){var e=this.scheduler,t=this.resourceStore;return t&&t.count?{firstResource:Math.max(Math.floor(e.scrollLeft/e.resourceColumnWidth)-1,0),lastResource:Math.min(Math.floor((e.scrollLeft+e.timeAxisSubGrid.width)/e.resourceColumnWidth)+1,t.count-1)}:{firstResource:-1,lastResource:-1}}},{key:"dateRange",get:function(){var e=this.scheduler,t=e.getDateFromCoordinate(Math.min(e.scrollTop+e.bodyHeight+e.tickSize-1,(e.virtualScrollHeight||e.scrollable.scrollHeight)-1));return t||(t=e.timeAxis.last.endDate),{topDate:e.getDateFromCoordinate(Math.max(e.scrollTop-e.tickSize,0)),bottomDate:t}}}],[{key:"properties",get:function(){return{eventMap:{},resourceMap:{},releasedElements:{}}}}]),t}(de(z));qd._$name="VerticalEventMapper";n(182);function $d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$d(Object(n),!0).forEach((function(t){$()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kd(e,t){return e===t.length-1}function Jd(e,t){return t===e.cells[e.cells.length-1]}var Qd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildCells",value:function(){var e=this,t=e.sizeProperty,n=[],r=e.levels.map((function(n,r){var i;return{className:(i={"b-sch-header-row":1},$()(i,"b-sch-header-row-".concat(n.position),1),$()(i,"b-sch-header-row-main",r===e.model.viewPreset.mainHeaderLevel),$()(i,"b-lowest",Kd(r,e.levels)),i),syncOptions:{releaseThreshold:5,syncIdField:"tickIndex"},dataset:{headerFeature:"headerRow".concat(r),headerPosition:n.position},children:n.cells.filter((function(t){return t.start<e.endDate&&t.end>e.startDate})).map((function(r){var i,o;return{className:(i={"b-sch-header-timeaxis-cell":1},$()(i,r.headerCellCls,r.headerCellCls),$()(i,"b-align-".concat(r.align),r.align),$()(i,"b-last",Jd(n,r)),i),dataset:Xd({tickIndex:r.index},window.DEBUG&&{date:r.start.getTime()}),style:(o={},$()(o,e.positionProperty,r.coord),$()(o,t,r.width),$()(o,"min-".concat(t),r.width),o),children:e.wrapText?[{className:"b-sch-header-text",html:r.value}]:null,html:e.wrapText?null:r.value}}))}}));return e.client&&e.client.getHeaderDomConfigs(n),r.push.apply(r,n),{className:"b-widget ".concat(e.cls),syncOptions:{releaseThreshold:0},style:$()({},t,e.size),children:r}}},{key:"render",value:function(e){se()(oe()(t.prototype),"render",this).call(this,e),this.refresh(!0)}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.levels.length,t=this,n=t.model.columnConfig,r=t.levels,i=r.length;if(e){r.length=0,n.forEach((function(e,t){return r[t]={position:t,cells:e}})),t.size=r[0].cells.reduce((function(e,t){return e+t.width}),0);var o=t.element.parentElement;o&&(o.classList.remove("b-sch-timeaxiscolumn-levels-".concat(i)),o.classList.add("b-sch-timeaxiscolumn-levels-".concat(r.length)))}t.startDate&&t.endDate&&(Za.sync({domConfig:t.buildCells(),targetElement:t.element,syncIdField:"headerFeature"}),t.trigger("refresh"))}},{key:"range",set:function(e){this.startDate=e.startDate,this.endDate=e.endDate,this.refresh(),this.trigger("rangeChange",{startDate:e.startDate,endDate:e.endDate})}}],[{key:"defaultConfig",get:function(){return{compactCellWidthThreshold:15,model:null,cls:null,sizeProperty:null,positionProperty:null,wrapText:null}}},{key:"properties",get:function(){return{startDate:null,endDate:null,levels:[],size:null}}}]),t}(vr);Qd._$name="TimeAxisBase";var Zd=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){se()(oe()(t.prototype),"construct",this).apply(this,arguments),this.model.on({update:this.onModelUpdate,thisObj:this})}},{key:"onModelUpdate",value:function(){this.model.availableSpace!==this.width&&this.refresh(!0)}},{key:"width",get:function(){return this.size}}],[{key:"$name",get:function(){return"HorizontalTimeAxis"}},{key:"defaultConfig",get:function(){return{cls:"b-horizontaltimeaxis",sizeProperty:"width",positionProperty:"left",wrapText:!1}}}]),t}(Qd);Zd._$name="HorizontalTimeAxis";var eh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).call(this,e);null!=this.imagePath&&(Ln.on({element:this.element,delegate:".b-resource-image",capture:!0,error:function(e){return n.setDefaultResourceImage(e.target)}}),this.element.classList.add("b-has-images"))}},{key:"onResourceStoreDataChange",value:function(e){var t=e.action,n=this,r=n.resourceStore.count*n.columnWidth;r!==n.width&&(n.element.style.width=r+"px",n.column.set("width",r,n.column.grid.isConfiguring)),"removeall"===t&&(n.element.innerHTML=""),"remove"!==t&&"add"!==t&&"filter"!==t||n.refreshWidths()}},{key:"setDefaultResourceImage",value:function(e){var t=this.getImageURL(this.defaultImageName);e.src&&!e.src.endsWith(t.replace(/\.\.\//gm,""))&&(e.src=t)}},{key:"getImageURL",value:function(e){return A.joinPaths([this.imagePath||"",e||""])}},{key:"refreshWidths",value:function(){var e=this,t=e.availableWidth,n=e._originalColumnWidth,r=e.resourceStore&&e.resourceStore.count;if(t&&r){e.refreshingWidths=!0;var i=e.fitWidth||e.fillWidth&&n*r<t?Math.floor(t/r):n,o=e.column.grid.enableEventAnimations&&Math.abs(e._columnWidth-i)>30;rn.addTemporaryClass(e.element,"b-animating",o?300:0),e.columnWidth=i,e.refreshingWidths=!1}}},{key:"refresh",value:function(){var e=this,t=e.firstResource,n=e.lastResource;if(!(e.column.grid.isConfiguring||-1===t||-1===n||n>=e.resourceStore.count)){for(var r=[],i=t;i<=n;i++){var o=e.resourceStore.getAt(i),a={className:new bt({"b-resourceheader-cell":1}),dataset:{resourceId:o.id},style:{left:i*e.columnWidth,width:e.columnWidth},children:[]};if(e.headerRenderer){var s=e.headerRenderer({elementConfig:a,resourceRecord:o});null!=s&&(a.html=s)}else{if(null!=e.imagePath){var l=o.name?o.imageUrl||o.name.toLowerCase()+".jpg":e.defaultImageName;a.children.push({tag:"img",className:"b-resource-image",src:e.getImageURL(l)})}o.iconCls&&a.children.push({tag:"i",className:o.iconCls}),a.children.push({tag:"span",className:"b-resource-name",html:o.name})}r.push(a)}Za.sync({domConfig:{onlyChildren:!0,children:r},targetElement:e.element,syncIdField:"resourceId"})}}},{key:"resourceStore",set:function(e){var t=this;e!==t._resourceStore&&(t.resourceStoreDetacher&&t.resourceStoreDetacher(),t._resourceStore=e,t.resourceStoreDetacher=e.on({change:"onResourceStoreDataChange",thisObj:t}),e.count&&t.onResourceStoreDataChange({}))},get:function(){return this._resourceStore}},{key:"columnWidth",get:function(){return this._columnWidth},set:function(e){var t=this;if(e!==t._columnWidth){var n=t._columnWidth;t._columnWidth=e,t.refreshingWidths||(t._originalColumnWidth=e,t.refreshWidths()),t.isConfiguring||(t.refresh(),t.trigger("columnWidthChange",{width:t._columnWidth,oldWidth:n}))}}},{key:"fillWidth",get:function(){return this._fillWidth},set:function(e){this._fillWidth=e,this.refreshWidths()}},{key:"fitWidth",get:function(){return this._fitWidth},set:function(e){this._fitWidth=e,this.refreshWidths()}},{key:"imagePath",get:function(){return this._imagePath},set:function(e){this._imagePath=e,this.refresh()}},{key:"availableWidth",get:function(){return this._availableWidth},set:function(e){this._availableWidth=e,this.refreshWidths()}},{key:"range",set:function(e){this.firstResource=e.firstResource,this.lastResource=e.lastResource,this.refresh()}}],[{key:"$name",get:function(){return"ResourceHeader"}},{key:"defaultConfig",get:function(){return{resourceStore:null,columnWidth:150,headerRenderer:null,fillWidth:!0,fitWidth:!1,imagePath:null,defaultImageName:null}}},{key:"properties",get:function(){return{firstResource:-1,lastResource:-1}}}]),t}(vr);eh._$name="ResourceHeader";var th=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=this;se()(oe()(t.prototype),"construct",this).apply(this,arguments),e.initialRender=!0,e.thisObj=e,e.timeAxisViewModel=e.timeline.timeAxisViewModel,e.mode=e.mode,e.grid.on({paint:"onTimelinePaint",thisObj:e,once:!0}),e.timeAxisViewModel.on({update:e.onViewModelUpdate,thisObj:e})}},{key:"onViewModelUpdate",value:function(e){var t=e.source,n=this;"horizontal"===n.mode?(n.refreshHeader(!0),n.width=t.totalSize,n.timeline.refresh()):"vertical"===n.mode&&n.timeline.refreshRows()}},{key:"onTimelinePaint",value:function(e){var t=e.firstPaint,n=this;n.subGrid.insertRowsBefore&&t&&(n.subGridElement.classList.add("b-timeline-subgrid"),n.element&&Ln.on({element:n.element,thisObj:n,click:"onContainerElementClick",dblclick:"onContainerElementClick",contextmenu:"onContainerElementClick"}),"vertical"===n.mode&&n.refreshHeader())}},{key:"refreshHeader",value:function(e){var t=this,n=t.element;n&&("horizontal"===t.mode?(!e&&t.timeAxisViewModel.update(null,!0),t.timeAxisView.rendered?t.timeAxisView.refresh(!0):(n.innerHTML="",t.timeAxisView.render(n))):"vertical"===t.mode&&(t.resourceColumns.currentElement||(n.innerHTML="",t.resourceColumns.render(n))))}},{key:"renderer",value:function(e){return this.timeline.currentOrientation.renderer(e)}},{key:"onContainerElementClick",value:function(e){var t=rn.up(e.target,".b-sch-header-timeaxis-cell");if(t){var n=t.dataset.tickIndex,r=t.parentElement.dataset.headerPosition,i=this.timeAxisViewModel.columnConfig[r][n],o=this.grid.features.contextMenu;o&&e.type===o.triggerEvent||this.trigger("timeAxisHeader"+A.capitalizeFirstLetter(e.type),{startDate:i.start,endDate:i.end,event:e})}}},{key:"mode",set:function(e){var t=this,n=t.timeline;t.set("mode",e),"horizontal"===e?t.timeAxisView=new Zd({model:t.timeAxisViewModel,compactCellWidthThreshold:t.compactCellWidthThreshold,owner:t.grid,client:t.grid}):"vertical"===e&&(t.resourceColumns=new eh(kt.assign({column:t,resourceStore:n.resourceStore,imagePath:n.resourceImagePath,defaultImageName:n.defaultResourceImageName},n.resourceColumns||{})))},get:function(){return this.get("mode")}}],[{key:"autoExposeFields",get:function(){return!0}},{key:"fields",get:function(){return["mode"]}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,resizable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cls:"b-sch-timeaxiscolumn",needWidth:!0,mode:null,region:"normal",exportable:!1}}},{key:"type",get:function(){return"timeAxis"}}]),t}(ze(Rs));Ms.registerColumnType(th),th._$name="TimeAxisColumn";var nh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"height",get:function(){return this.size}}],[{key:"$name",get:function(){return"VerticalTimeAxis"}},{key:"defaultConfig",get:function(){return{cls:"b-verticaltimeaxis",sizeProperty:"height",positionProperty:"top",wrapText:!0}}}]),t}(Qd);nh._$name="VerticalTimeAxis";var rh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this;se()(oe()(t.prototype),"construct",this).apply(this,arguments),n.timeAxisViewModel=e.timeline.timeAxisViewModel,n.view=new nh({model:n.timeAxisViewModel,client:e.timeline})}},{key:"renderer",value:function(e){var t=e.cellElement,n=e.size;this.view.render(t),n.height=this.view.height}}],[{key:"type",get:function(){return"verticalTimeAxis"}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cellCls:"b-verticaltimeaxiscolumn"}}}]),t}(Rs);Ms.registerColumnType(rh),rh._$name="VerticalTimeAxisColumn";var ih=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;se()(oe()(t.prototype),"construct",this).call(this,e),n.createEventOnDblClick&&n.on("scheduledblclick",n.onSchedulerDblClick)}},{key:"onLocaleChange",value:function(){this.currentOrientation.onLocaleChange(),se()(oe()(t.prototype),"onLocaleChange",this).call(this)}},{key:"onSchedulerDblClick",value:function(e){var t=e.date,n=e.resourceRecord,r=e.row;this.readOnly||n.meta.specialRow||this.internalAddEvent(t,n,r)}},{key:"onColumnsChanged",value:function(e){e.action;var n=e.changes,r=e.record;r===this.timeAxisColumn&&"width"in n&&this.updateCanvasSize(),se()(oe()(t.prototype),"onColumnsChanged",this).apply(this,arguments)}},{key:"onVerticalScroll",value:function(e){var t=e.scrollTop;this.currentOrientation.updateFromVerticalScroll(t)}},{key:"onEventCreated",value:function(e){}},{key:"onElementKeyDown",value:function(e){se()(oe()(t.prototype),"onElementKeyDown",this).call(this,e)}},{key:"onElementKeyUp",value:function(e){se()(oe()(t.prototype),"onElementKeyUp",this).call(this,e)}},{key:"onElementMouseOver",value:function(e){se()(oe()(t.prototype),"onElementMouseOver",this).call(this,e)}},{key:"onElementMouseOut",value:function(e){se()(oe()(t.prototype),"onElementMouseOut",this).call(this,e)}},{key:"getEventMenuItems",value:function(){}},{key:"getScheduleMenuItems",value:function(){}},{key:"internalAddEvent",value:function(e,t,n){var r=this,i=[t],o=new r.eventStore.modelClass({startDate:e,endDate:vt.add(e,1,r.timeAxis.unit)});if(r.onEventCreated(o),r.eventEdit){var a=r.currentOrientation.getTimeSpanRenderData(o,t),s=r.eventEdit.dragProxyElement=rn.createElement({parent:r.foregroundCanvas,className:"b-sch-dragcreator-proxy",style:"width:".concat(a.width,"px;height:").concat(a.height,"px")});return rn.setTranslateXY(s,a.left,(n&&n.top||0)+a.top),void r.editEvent(o,t,s)}!1!==r.trigger("beforeEventAdd",{eventRecord:o,resourceRecords:i,resources:i})&&(r.eventStore.add(o),r.eventStore.assignEventToResource(o,t))}},{key:"isDateRangeAvailable",value:function(e,t,n,r){return this.eventStore.isDateRangeAvailable(e,t,n,r)}},{key:"timeAxisViewModel",set:function(e){fn()(oe()(t.prototype),"timeAxisViewModel",e,this,!0),this.eventStore&&(this.timeAxisViewModel.eventStore=this.eventStore)},get:function(){return se()(oe()(t.prototype),"timeAxisViewModel",this)}},{key:"store",get:function(){return se()(oe()(t.prototype),"store",this)},set:function(e){fn()(oe()(t.prototype),"store",e,this,!0)}},{key:"isHorizontal",get:function(){return"horizontal"===this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"mode",get:function(){return this._mode},set:function(e){var t=this;t._mode=e,t[e]||("horizontal"===e?(t.horizontal=new Vd(t),t.isPainted&&t.horizontal.init(),t.un("scroll",t.onVerticalScroll,t)):"vertical"===e&&(t.zoomOnTimeAxisDoubleClick=t.zoomOnMouseWheel=!1,t.vertical=new qd(t),t.rendered&&t.vertical.init(),t.on("scroll",t.onVerticalScroll,t)))}},{key:"currentOrientation",get:function(){return this[this.mode]}}],[{key:"$name",get:function(){return"SchedulerBase"}},{key:"defaultConfig",get:function(){return{mode:"horizontal",eventCls:"b-sch-event",timeCellCls:"b-sch-timeaxis-cell",timeCellSelector:".b-sch-timeaxis-cell",scheduledEventName:"event",overScheduledEventClass:"b-sch-event-hover",allowOverlap:!0,rowHeight:60,milestoneCharWidth:10,milestoneAlign:"center",milestoneMinWidth:40}}}]),t}(pi(wd).mixes((function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getElementFromAssignmentRecord",value:function(e){return this.currentOrientation.getElementFromEventRecord(e.event,e.resource)}},{key:"getElementFromEventRecord",value:function(e,t){return this.currentOrientation.getElementFromEventRecord(e,t)}},{key:"getElementsFromEventRecord",value:function(e,t){return this.currentOrientation.getElementsFromEventRecord(e,t)}},{key:"getEventIdFromDomNodeId",value:function(e){var t=e.substring(this.eventPrefix.length).split("-")[0];return t&&t.replace(/\._\./g,"-")}},{key:"getEventRecordFromDomId",value:function(e){return e=this.getEventIdFromDomNodeId(e),this.eventStore.getById(e)}},{key:"getResourceIdFromDomNodeId",value:function(e){var t=e.substring(this.eventPrefix.length).split("-")[1];return t&&t.replace(/\._\./g,"-")}},{key:"getResourceRecordFromDomId",value:function(e){return e=this.getResourceIdFromDomNodeId(e),this.resourceStore.getById(e)}},{key:"resolveResourceRecord",value:function(e,t){return this.currentOrientation.resolveRowRecord(e,t)}},{key:"resolveEventRecord",value:function(e){if(e=rn.up(e,this.eventSelector)){if(e.dataset.eventId)return this.eventStore.getById(e.dataset.eventId);if(e.dataset.assignmentId)return this.assignmentStore.getById(e.dataset.assignmentId).event}return null}},{key:"resolveTimeSpanRecord",value:function(e){return this.resolveEventRecord(e)}},{key:"resolveAssignmentRecord",value:function(e){var t=this.eventStore.assignmentStore,n=null;if(t){var r=rn.up(e,this.eventSelector),i=this.resolveEventRecord(r),o=this.resolveResourceRecord(r);i&&o&&(n=t.getAssignmentForEventAndResource(i,o))}return n}},{key:"isRowVisible",value:function(e){return this.store.indexOf(e)>=0}},{key:"getMilestoneLabelWidth",value:function(e){var t=this,n=t.milestoneLayoutMode;if("measure"===n){var r=t.milestoneMeasureElement||(t.milestoneMeasureElement=rn.createElement({className:"b-sch-event-wrap b-milestone-wrap b-measure",children:[{className:"b-sch-event b-milestone",html:"<label></label>"}],parent:t.foregroundCanvas}));return r.firstElementChild.firstElementChild.innerHTML=e.name,r.offsetWidth}return"estimate"===n?Math.max(e.name.length*t.milestoneCharWidth,t.milestoneMinWidth):"data"===n?Math.max(e.milestoneWidth,t.milestoneMinWidth):0}},{key:"milestoneLayoutMode",set:function(e){this._milestoneLayoutMode=e,this.element.classList["default"!==e?"add":"remove"]("b-sch-layout-milestones"),this.refresh()},get:function(){return this._milestoneLayoutMode}},{key:"milestoneAlign",set:function(e){this._milestoneAlign=e,this.refresh()},get:function(){return this._milestoneAlign}},{key:"milestoneCharWidth",set:function(e){this._milestoneCharWidth=e,this.refresh()},get:function(){return this._milestoneCharWidth}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getTimeSpanMouseEventParams",value:function(e,t){return{eventRecord:this.resolveEventRecord(e),resourceRecord:this.resolveResourceRecord(e),assignmentRecord:this.resolveAssignmentRecord(e),eventElement:e,event:t}}},{key:"getScheduleMouseEventParams",value:function(e,t){return{resourceRecord:this.isVertical?this.resolveResourceRecord(t):this.store.getById(e.id)}}},{key:"onElementKeyDown",value:function(e){se()(oe()(t.prototype),"onElementKeyDown",this).call(this,e);this.selectedEvents.length&&this.trigger(this.scheduledEventName+"KeyDown",{eventRecord:this.selectedEvents})}},{key:"onElementKeyUp",value:function(e){se()(oe()(t.prototype),"onElementKeyUp",this).call(this,e);this.selectedEvents.length&&this.trigger(this.scheduledEventName+"KeyUp",{eventRecord:this.selectedEvents})}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){se()(oe()(t.prototype),"construct",this).call(this,e),this.hasFeature("eventDragCreate")&&this.on({dragcreateend:this.internalOnDragCreateEnd,thisObj:this})}},{key:"internalOnDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=this;if(!r.hasFeature("eventEdit")||r.features.eventEdit.disabled){var i=n?[n]:[];!1!==r.trigger("beforeEventAdd",{eventRecord:t,resources:i,resourceRecords:i})&&(r.onEventCreated(t),r.eventStore.add(t),t.assign(n))}}},{key:"eventEditor",get:function(){return this._eventEditor},set:function(e){this._eventEditor=e}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onStoreDataChange",value:function(e){e.source,e.action;this.currentOrientation.clearEvents(),se()(oe()(t.prototype),"onStoreDataChange",this).apply(this,arguments)}},{key:"refreshFromRowOnStoreAdd",value:function(e,n){var r=this,i=n.isExpand,o=arguments;this.runWithTransition((function(){var n;return(n=se()(oe()(t.prototype),"refreshFromRowOnStoreAdd",r)).call.apply(n,[r,e].concat(G()(o)))}),!i)}},{key:"onStoreAdd",value:function(e){var n=e.source,r=e.records,i=e.isChild,o=this,a=o.rowManager;if(!i||r[0].parent.isExpanded(o)){a.calculateRowCount(!1,!0,!0);var s=Math.max(a.topIndex+a.rowCount,Math.min(a.visibleRowCount,n.count));r=r.sort((function(e,t){return n.indexOf(e)-n.indexOf(t)}));var l=n.indexOf(r[0]);if(l<s)for(var u=l=Math.max(l,a.topIndex);u<s;u++)o.currentOrientation.onRowRecordUpdate({record:n.getAt(u)});else a.estimateTotalHeight();se()(oe()(t.prototype),"onStoreAdd",this).apply(this,arguments)}}},{key:"onStoreUpdateRecord",value:function(){var e;this.suspendStoreRedraw||((e=this.currentOrientation).onRowRecordUpdate.apply(e,arguments),se()(oe()(t.prototype),"onStoreUpdateRecord",this).apply(this,arguments))}},{key:"onStoreRemove",value:function(){var e;(e=this.currentOrientation).onRowRecordRemove.apply(e,arguments),se()(oe()(t.prototype),"onStoreRemove",this).apply(this,arguments)}},{key:"onStoreRemoveAll",value:function(){this.currentOrientation.clearEvents(),se()(oe()(t.prototype),"onStoreRemoveAll",this).call(this)}},{key:"doDestroy",value:function(){se()(oe()(t.prototype),"doDestroy",this).call(this);var e=this;e.destroyStores&&e.constructor.destroy(e.assignmentStore,e.resourceStore,e.dependencyStore,e.eventStore)}},{key:"getResourceStoreListenerConfig",value:function(){return{}}},{key:"getEventStoreListenerConfig",value:function(){return{thisObj:this,detachable:!0,change:"onInternalEventStoreChange",clearchanges:"onEventClearChanges",beforecommit:"onEventBeforeCommit",commit:"onEventCommit",beforeRemove:"onEventStoreBeforeRemove",refresh:"onEventStoreRefresh",exception:"onEventException",idchange:"onEventIdChange"}}},{key:"getAssignmentStoreListenerConfig",value:function(){var e=this;return{thisObj:e,refresh:e.onAssignmentRefresh,update:e.onAssignmentUpdate,add:e.onAssignmentAdd,beforeRemove:{fn:e.onBeforeAssignmentRemove,prio:-1e3},remove:e.onAssignmentRemove,filter:e.onAssignmentFilter,removeall:e.onAssignmentRemoveAll}}},{key:"getDependencyStoreListenerConfig",value:function(){return{}}},{key:"onEventIdChange",value:function(e){this.currentOrientation.onEventStoreIdChange&&this.currentOrientation.onEventStoreIdChange(e)}},{key:"onInternalEventStoreChange",value:function(e){var t=this;if(t._mode)if(t.isVertical)t.currentOrientation.onEventStoreChange(e);else{var n=function(){var n,r,i=t.currentOrientation,o=e.source,a=t.rowManager,s=t.resourceStore,l=e.action,u=e.changes,c=e.isCollapse,d=e.records||(e.record?[e.record]:null),h=[],f=new Set,g=!1;if(!t.isPainted)return{v:void 0};if(c||"update"===l&&d.length&&d[0].meta.removingResource)return{v:void 0};if(!("filter"===l&&t.hasFeature("resourceTimeRanges"))&&Fd[l]&&d){if(u&&"resourceId"in u&&null!=u.resourceId.oldValue){var v=s.getById(u.resourceId.oldValue),m=v&&a.getRowFor(v);m&&(h.push(v),f.add(m))}for(r=0,n=d.length;r<n;r++)h.push.apply(h,G()(o.getResourcesForEvent(d[r]).filter((function(e){if(e&&t.resourceStore.isAvailable(e.id)){var n=a.getRowFor(e);if(n)return f.add(n),!0}return!1}))));if(h.length){if(f.size>1)f=new Set(G()(f).sort((function(e,t){return e.dataIndex-t.dataIndex})));else if(!f.size)return{v:void 0}}else if("filter"!==l||d.length)return a.estimateTotalHeight(),{v:void 0};e.resources=h}switch(l){case"dataset":if(i.onEventDataset(),!o.count)return{v:void 0};break;case"add":i.onEventAdd(e),g=!0;break;case"update":i.onEventUpdate(e),g=!0;break;case"remove":i.onEventRemove(e),g=!0;break;case"removeall":i.onEventRemoveAll();break;case"filter":i.onEventFilter(e);break;case"clearchanges":i.onEventClearChanges(e)}t.runWithTransition((function(){f.size?a.renderRows(f):a.renderFromRow()}),g)}();if("object"===U()(n))return n.v}}},{key:"onEventStoreRefresh",value:function(e){"batch"===e.action&&this.rowManager.rowCount&&(this.currentOrientation.onEventDataset&&this.currentOrientation.onEventDataset(),this.refresh())}},{key:"onEventStoreBeforeRemove",value:function(e){var t=e.records,n=this;if(n.activeEvent&&t.includes(n.activeEvent)){var r;if("key"===ir.lastInteractionType)for(var i=0,o=t.length;i<o&&(!r||t.includes(r));i++)if(n.eventStore.getResourcesForEvent(t[i]).length){var a=t[i],s=a.assignments&&a.assignments.length?a.assignments[0]:a;r=n.getNext(s,!0)||n.getPrevious(s,!0)}r?n.navigateTo(r):n.element.focus()}}},{key:"onEventCommit",value:function(e){var t=this,n=e.changes,r=[].concat(G()(n.added),G()(n.modified)).map((function(e){return t.eventStore.getResourcesForEvent(e)}));r=Array.prototype.concat.apply([],r),new Set(r).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"onEventBeforeCommit",value:function(e){var t=this,n=e.changes;[].concat(G()(n.added),G()(n.modified)).forEach((function(e){return t.getElementsFromEventRecord(e).forEach((function(e){return e.classList.add(t.committingCls)}))}))}},{key:"onEventException",value:function(e){var t=this;if("commit"===e.action){var n=this.eventStore.changes;[].concat(G()(n.added),G()(n.modified),G()(n.removed)).forEach((function(e){return t.repaintEvent(e)}))}}},{key:"onEventClearChanges",value:function(){this.refresh()}},{key:"onAssignmentRefresh",value:function(e){!this.isHorizontal||"dataset"!==e.action&&"batch"!==e.action||this.refresh()}},{key:"onAssignmentAdd",value:function(e){var t=this,n=e.records;this.isHorizontal&&n.forEach((function(e){var n=e.resource;n&&t.repaintEventsForResource(n)}))}},{key:"onAssignmentUpdate",value:function(e){var t=e.record,n=e.changes;if(this.isHorizontal){var r,i=this.rowManager,o=this.currentOrientation.cache,a="resourceId"in n&&n.resourceId.oldValue,s=t.resourceId,l=Md;null!=a&&(r=i.getRowFor(a))&&(o.clearRow(a),l=Math.min(l,r.index)),s&&(r=i.getRowFor(s))&&(o.clearRow(s),l=Math.min(l,r.index)),l!==Md&&i.renderFromRow(i.rows[l])}}},{key:"onBeforeAssignmentRemove",value:function(e){var t=e.source,n=e.records,r=e.doRemoveLastEvent;if(!t.isRemovingEvent){var i,o=this,a=n.reduce((function(e,t){var n=t.event;return!n||n.placeHolder||e.includes(n)||e.push(n),e}),[]);if(o.activeEvent&&a.includes(o.activeEvent)){if("key"===ir.lastInteractionType)for(var s=0,l=n.length;s<l&&(!i||n.includes(i));s++)if(o.eventStore.getResourcesForEvent(n[s].event).length){var u=n[s],c=u.assignments&&u.assignments.length?u.assignments[0]:u;i=o.getNext(c)||o.getPrevious(c)}i?o.navigateTo(i):o.element.focus()}if(o.removeUnassignedEvent&&!o.isRemoving&&!1!==r&&(!t.stm||!t.stm.isRestoring)){var d=a.reduce((function(e,t){var r=t.assignments?t.assignments.length:0;return(r-=n.filter((function(e){return e.event===t})).length)||e.push(t),e}),[]);o.eventStore.remove(d)}}}},{key:"onAssignmentRemove",value:function(e){var t=this,n=e.records;this.isHorizontal&&n.forEach((function(e){var n=e.resource;n&&t.repaintEventsForResource(n)}))}},{key:"onAssignmentRemoveAll",value:function(){this.isHorizontal&&this.refresh()}},{key:"onAssignmentFilter",value:function(){this.isHorizontal&&this.refresh()}},{key:"applyStartEndParameters",value:function(e){var t=e.source,n=e.params,r=t.modelClass.fieldMap.startDate.dateFormat;n[this.startParamName]=vt.format(this.startDate,r),n[this.endParamName]=vt.format(this.endDate,r)}},{key:"store",get:function(){var e=this;return e._thisIsAUsedExpression(e.resources),!e._store&&e.isVertical&&(e._store=new Fi({data:[{id:"verticalTimeAxisRow"}]})),se()(oe()(t.prototype),"store",this)},set:function(e){fn()(oe()(t.prototype),"store",e,this,!0)}},{key:"resources",get:function(){var e=this.resourceStore;return e&&e.records},set:function(e){this.resourceStore.data=e}},{key:"resourceStore",get:function(){var e=this;return e._resourceStore||e.crudManager&&e.crudManager.resourceStore||(e.resourceStore=new zu),e._resourceStore},set:function(e){var t=this,n=t._resourceStore;if(e!==n){if(e instanceof zu||(e=new zu(e)),n){var r=n===t.store;t._resourceStore=e,e&&t.isHorizontal&&(r?(t.store=t.resourceStore,t.store.metaMapId=t.id):t.refresh())}else t._resourceStore=e;e&&(t.isVertical&&e.on("load",(function(){return t.unmaskBody()})),t.trigger("resourceStoreChange",{newResourceStore:e,oldResourceStore:n})),t.isHorizontal&&!t._store&&(t.store=e)}}},{key:"events",get:function(){return this._eventStore.records},set:function(e){this.eventStore.data=e}},{key:"eventStore",get:function(){var e=this;return e._eventStore||e.crudManager&&e.crudManager.eventStore||(e.eventStore=new sc({resourceStore:e.resourceStore})),this._eventStore},set:function(e){var t=this,n=t._eventStore,r=!1;if(e!==n){var i=t.resourceStore;if(n){var o=t.eventStore,a=t.assignmentStore,s=t.dependencyStore;if(e===o)return;t.eventStoreDetacher&&t.eventStoreDetacher(),t._eventStore=e,t.timeAxisViewModel.eventStore=e,e&&(i&&!e.resourceStore&&(e.resourceStore=i),a&&!e.assignmentStore&&(e.assignmentStore=a),s&&!e.dependencyStore&&(e.dependencyStore=s),t.trigger("eventStoreChange",{newEventStore:e,oldEventStore:o}),t.refresh())}else{if(e.isEventStore){if(i&&e.resourceStore!==i){if(e.resourceStore)throw new Error("eventStore ".concat(e.id," is already linked to resourceStore ").concat(e.resourceStore.id));e.resourceStore=i}}else r=e.autoLoad,e.autoLoad=!1,e=new sc(Object.assign({resourceStore:t.resourceStore},e));t._eventStore=e}if(e){var l=this.getEventStoreListenerConfig();t.passStartEndParameters&&(l.beforeload=t.applyStartEndParameters),t.eventStoreDetacher&&t.eventStoreDetacher(),t.eventStoreDetacher=e.on(l),e.assignmentStore&&(t.assignmentStore=e.assignmentStore),r&&e.load().catch((function(){}))}t.eventStore.count>0&&(t.eventsRendered=!0)}}},{key:"assignments",get:function(){return this.assignmentStore&&this.assignmentStore.records},set:function(e){this.assignmentStore||(this.eventStore.assignmentStore=this.assignmentStore=new Lu),this.assignmentStore.data=e}},{key:"assignmentStore",get:function(){var e=this.eventStore,t=this.crudManager;return t&&t.assignmentStore||e&&e.assignmentStore},set:function(e){var t=this,n=t.assignmentStore;t.eventStore.assignmentStore!==e&&(t.eventStore.assignmentStore=e),t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),e&&(t.assignmentStoreDetacher=e.on(t.getAssignmentStoreListenerConfig()),t.trigger("assignmentStoreChange",{newAssignmentStore:e,oldAssignmentStore:n}),t.refresh())}},{key:"dependencyStore",get:function(){var e=this.eventStore,t=this.crudManager;return t&&t.dependencyStore||e&&e.dependencyStore||this._dependencyStore},set:function(e){var t=this;if(t.isConfigured){var n=t.dependencyStore;t.eventStore.dependencyStore=e,e&&(t.trigger("dependencyStoreChange",{newDependencyStore:e,oldDependencyStore:n}),t.refresh())}else t._dependencyStore=e}},{key:"crudManager",get:function(){return this._crudManager},set:function(e){e instanceof hc?this._crudManager=e:e=new hc(Object.assign({scheduler:this},e))}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{eventStore:null,resourceStore:null,assignmentStore:null,dependencyStore:null,store:null,startParamName:"startDate",endParamName:"endDate",passStartEndParameters:!1,crudManager:null,events:null,resources:null,assignments:null,removeUnassignedEvent:!0}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"scrollEventIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ad,n=this,r=e.resources||[e];if(r.length>1)throw new Error("scrollEventIntoView() is not applicable for events with multiple assignments, please use scrollResourceEventIntoView() instead.");return r.length?n.scrollResourceEventIntoView(r[0],e,null,t):(console.warn("You have asked to scroll to an event which is not assigned to a resource"),_d)}},{key:"scrollResourceEventIntoView",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ad,o=this,a=t.startDate,s=t.endDate,l=a<o.timeAxis.startDate|(s>o.timeAxis.endDate)<<1;if(null==i.edgeOffset&&(i.edgeOffset=20),l&&!1!==i.extendTimeAxis){var u,c,d=o.timeAxis.endDate-o.timeAxis.startDate;3===l?o.timeAxis.setTimeSpan(new Date(a.valueOf()-d/2),new Date(s.getTime()+d/2)):(u=1&l?o.getCoordinateFromDate(t.endDate):o.getCoordinateFromDate(t.startDate),1&l?o.timeAxis.setTimeSpan(new Date(a),new Date(a.valueOf()+d)):o.timeAxis.setTimeSpan(new Date(s.valueOf()-d),new Date(s)),c=1&l?o.getCoordinateFromDate(t.endDate):o.getCoordinateFromDate(t.startDate),o.timeAxisSubGrid.scrollable.scrollBy(c-u))}if(r=o.getElementFromEventRecord(t,e)){rn.isFocusable(r)||(r=r.parentNode);var h=o.timeAxisSubGrid.scrollable;return o.timeAxisSubGrid.forceScrollUpdate=!0,h.scrollIntoView(r,i)}return l&&!1===i.extendTimeAxis?(console.warn("You have asked to scroll to an event which is outside the current view and extending timeaxis is disabled"),_d):o.eventStore.isAvailable(t)?o.scrollUnrenderedEventIntoView(e,t,i):(console.warn("You have asked to scroll to an event which is not available"),_d)}},{key:"scrollUnrenderedEventIntoView",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ad;return null==r.edgeOffset&&(r.edgeOffset=20),new Promise((function(i){var o=n,a=o.timeAxisSubGrid.scrollable,s=o.getResourceEventBox(t,e),l=a.viewport,u=new Oe(s.start,s.top,s.end-s.start,s.bottom-s.top).translate(l.x-a.x,l.y-a.y),c=function(e){e.scheduler;var n=e.eventRecord,o=(e.resourceRecord,e.element);n===t&&(d(),r.highlight&&rn.highlight(o),r.focus&&o.focus(),i())},d=o.on({eventrepaint:c,eventpaint:c});a.scrollIntoView(u,Object.assign({},r,{highlight:!1}))}))}},{key:"scrollResourceIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ad;return this.isVertical?this.currentOrientation.scrollResourceIntoView(e,t):this.scrollRowIntoView(e,t)}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getState",value:function(){return kt.copyProperties(se()(oe()(t.prototype),"getState",this).call(this),this,Id)}},{key:"applyState",value:function(e){kt.copyProperties(this,e,Id),se()(oe()(t.prototype),"applyState",this).call(this,e)}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getEventsToRender",value:function(e,t){return t}},{key:"repaintEventsForResource",value:function(e){if(this.isHorizontal){this.currentOrientation.cache.clearRow(e.id);var t=this.getRowFor(e);t&&t.render()}}},{key:"repaintEvent",value:function(e){var t=this;this.eventStore.getResourcesForEvent(e).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"generateTplData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{viewport:!0},r=this,i=r.currentOrientation.getTimeSpanRenderData(e,t,n),o="";if(i){var a,s=e.isResizable;i.startsOutsideView&&(!0===s?s="end":"start"===s&&(s=!1)),i.endsOutsideView&&(!0===s?s="start":"end"===s&&(s=!1));var l=e.isResourceTimeRange?new bt:e.cls.clone(),u=e.isResourceTimeRange?e.cls.clone():new bt;if(Object.assign(l,(a={},$()(a,t.cls,t.cls),$()(a,r.generatedIdCls,e.hasGeneratedId),$()(a,r.dirtyCls,e.isPersistable&&e.modifications),$()(a,r.committingCls,e.isCommitting),$()(a,r.endsOutsideViewCls,i.endsOutsideView),$()(a,r.startsOutsideViewCls,i.startsOutsideView),$()(a,"b-clipped-start",i.clippedStart),$()(a,"b-clipped-end",i.clippedEnd),a)),Object.assign(u,$()({},"".concat(r.eventCls,"-parent"),t.isParent)),e.isEvent||e.isTask){var c,d;Object.assign(l,(c={},$()(c,r.eventCls,1),$()(c,"b-milestone",e.isMilestone),$()(c,"b-sch-event-narrow",i.width<10),$()(c,r.fixedEventCls,!1===e.isDraggable),$()(c,"b-sch-event-resizable-".concat(s),Boolean(r.features.eventResize)),$()(c,r.eventSelectedCls,r.isEventSelected(e)),$()(c,"b-recurring",e.isRecurring),$()(c,"b-occurrence",e.isOccurrence),c)),i.eventId=e.id,i.id=r.getEventRenderId(e,t),"id"in e.meta.modified&&(i.oldId=r.getEventRenderId(e.meta.modified.id,t)),Object.assign(u,(d={},$()(d,"".concat(r.eventCls,"-wrap"),1),$()(d,"b-milestone-wrap",e.isMilestone),d));var h=e.eventStyle||t.eventStyle||r.eventStyle,f=e.eventColor||t.eventColor||r.eventColor;i.eventColor=f,i.eventStyle=h,r.assignmentStore&&e.assignments&&(i.assignment=e.assignments.find((function(e){return e.resourceId===t.id})))}if(i.wrapperCls=u,i.cls=l,i.iconCls=new bt(e.get(r.eventBarIconClsField)||e.iconCls),e.isResourceTimeRange?(i.style="",i.wrapperStyle=e.style||""):i.style=e.style||"",i.resource=t,i.resourceId=i.rowId,e.isEvent||e.isTask){if(r.eventRenderer){var g=r.eventRenderer.call(r.eventRendererThisObj||r,{eventRecord:e,resourceRecord:t,assignmentRecord:i.assignment,tplData:i});"string"==typeof i.cls&&(i.cls=new bt(i.cls)),"string"==typeof i.wrapperCls&&(i.wrapperCls=new bt(i.wrapperCls)),"string"==typeof i.iconCls&&(i.iconCls=new bt(i.iconCls)),o=r.eventBodyTemplate&&r.eventBodyTemplate(g)||(null==g?"":String(g))}else r.eventBodyTemplate?o=r.eventBodyTemplate(e):r.eventBarTextField&&(o=e.data[r.eventBarTextField]||"");r.eventBodyTemplate||(e.isMilestone&&o&&(o="<label>".concat(o,"</label>")),i.iconCls&&i.iconCls.length&&(o='<i class="'.concat(i.iconCls,'"></i>').concat(o))),i.wrapperCls["b-sch-style-".concat(i.eventStyle)]=i.eventStyle,i.eventColor&&i.eventColor.startsWith("#")?i.style="background-color:".concat(i.eventColor,";")+i.style:i.wrapperCls["b-sch-color-".concat(i.eventColor)]=i.eventColor}i.cls["b-sch-event-withicon"]=i.iconCls.length,o.includes("<")?i.body=rn.createElementFromTemplate(o,{fragment:!0}):(i.body=document.createDocumentFragment(),i.body.textContent=o),i.eventContent=o,r.onEventDataGenerated(i)}return i}},{key:"onEventDataGenerated",value:function(e){}},{key:"getEventRenderId",value:function(e,t){var n=(e instanceof Hu?e.id:e).toString().replace(Rd,"._."),r=(t instanceof Bu?t.id:t).toString().replace(Rd,"._.");return this.eventPrefix+"".concat(n,"-").concat(r,"-x")}},{key:"eventPrefix",get:function(){return this._eventPrefix},set:function(e){this._eventPrefix=e||this.id+"-"}},{key:"layouts",get:function(){var e=this;return e._eventLayout||(e._eventLayout={},e.horizontalLayoutPackClass&&(e._eventLayout.horizontalPack=new e.horizontalLayoutPackClass(Object.assign({scheduler:e,timeAxisViewModel:e.timeAxisViewModel,bandIndexToPxConvertFn:e.horizontal.layoutEventVerticallyPack,bandIndexToPxConvertThisObj:e.horizontal}))),e.horizontalLayoutStackClass&&(e._eventLayout.horizontalStack=new e.horizontalLayoutStackClass(Object.assign({scheduler:e,timeAxisViewModel:e.timeAxisViewModel,bandIndexToPxConvertFn:e.horizontal.layoutEventVerticallyStack,bandIndexToPxConvertThisObj:e.horizontal})))),e._eventLayout}},{key:"eventLayout",get:function(){return this._overlapMode},set:function(e){var t=this;e!=t._overlapMode&&(t.element.classList.remove("b-eventlayout-".concat(t._overlapMode)),t._overlapMode=e,t.runWithTransition((function(){t.element.classList.add("b-eventlayout-".concat(t._overlapMode)),t.refresh()})))}},{key:"fillTicks",get:function(){return this._fillTicks},set:function(e){e!=this._fillTicks&&(this._fillTicks=e,this.refreshWithTransition())}},{key:"currentEventLayout",get:function(){if(!this.isHorizontal)return null;switch(this.eventLayout){case"stack":return this.layouts.horizontalStack;case"pack":return this.layouts.horizontalPack;default:return null}}},{key:"useInitialAnimation",get:function(){return this._useInitialAnimation},set:function(e){var t=this;t._useInitialAnimation&&t.element.classList.remove("b-initial-".concat(t._useInitialAnimation)),t._useInitialAnimation=!0===e?"fade-in":e,e&&t.element.classList.add("b-initial-".concat(t._useInitialAnimation))}},{key:"isFirstRender",set:function(e){var t=this;t._isFirstRender=e,!t._firstRenderDone&&e&&(t._firstRenderDone=t.createOnFrame((function(){t._isFirstRender=!1,t._firstRenderDone=null})))},get:function(){return this._isFirstRender}},{key:"horizontalEventSorterFn",set:function(e){this._horizontalEventSorterFn=e?function(t,n){return e(t.event,n.event)}:e,this.rendered&&this.refreshWithTransition()},get:function(){return this._horizontalEventSorterFn}},{key:"resourceColumns",set:function(e){this._resourceColumns=e},get:function(){return this.timeAxisColumn&&this.timeAxisColumn.resourceColumns||this._resourceColumns}},{key:"resourceColumnWidth",get:function(){return this.resourceColumns?this.resourceColumns.columnWidth:null}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{eventRenderer:null,eventRendererThisObj:null,eventPrefix:"",eventLayout:"stack",horizontalLayoutPackClass:Td,horizontalLayoutStackClass:xd,horizontalEventSorterFn:null,eventBarTextField:"name",eventBodyTemplate:null,eventPositionMode:"translate",eventScrollMode:"move",fillTicks:!1,useInitialAnimation:!0,resourceColumns:null,resourceImagePath:null,defaultResourceImageName:"none.png",resourceMargin:null,isFirstRender:!0}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"getScheduleRegion",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.currentOrientation.getScheduleRegion(e,t,n)}},{key:"getResourceRegion",value:function(e,t,n){return this.currentOrientation.getRowRegion(e,t,n)}},{key:"getResourceEventBox",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.currentOrientation.getResourceEventBox(e.id,t.id);if(i)return i;var o,a,s,l,u,c,d,h,f=r.timeAxis.startDate,g=r.timeAxis.endDate,v=e.startDate,m=e.endDate,p=null;if(v&&m&&(n||vt.intersectSpans(v,m,f,g))&&this.isRowVisible(t)){if(r.getRowFor(t))r.managedEventSizing?(o=r.currentEventLayout,a=r.eventStore.getEventsForResource(t).reduce((function(e,i){var o=r[r.mode].getTimeSpanRenderData(i,t,n);return o&&e.push(o),e}),[]),o&&o.applyLayout(a,t),(s=a.find((function(t){return t.event==e})))&&(l=r.getRecordCoords(t,!0).y,p={layout:!0,start:s.hasOwnProperty("left")?s.left:s.right,end:(s.hasOwnProperty("left")?s.left:s.right)+s.width,top:l+s.top,bottom:l+s.top+s.height})):(u=r.getElementsFromEventRecord(e,e!==t&&t)).length&&(d=(c=u[0]).getOffsetsTo(r.getEl()),h=c.getBox(),p={layout:!0,start:d[0],end:d[0]+h.width,top:d[1],bottom:d[1]+h.height});else{p={layout:!1,start:r.getCoordinateFromDate(Math.max(e.startDateMS,r.timeAxis.startMS)),end:r.getCoordinateFromDate(Math.min(e.endDateMS,r.timeAxis.endMS))};var y=r.rowManager.getRecordCoords(t,!0);p.top=y.y+r.barMargin,p.height=Math.max(r.rowManager.rowHeight-2*r.barMargin,1),p.bottom=p.top+p.height}p&&(p=r.adjustItemBox(e,p))}return p}},{key:"getItemBox",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.resources.map((function(r){return t.getResourceEventBox(e,r,n)}))}},{key:"adjustItemBox",value:function(e,t){var n=this.timeAxis.startMS,r=this.timeAxis.endMS,i=e.startDateMS,o=e.endDateMS,a=this.timeAxisViewModel.totalSize;return n>i&&(t.start=-40),n>o&&(t.end=-40),r<i&&(t.start=a+40),r<o&&(t.end=a+40),t}},{key:"widgetClass",get:function(){}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"afterConstruct",value:function(){se()(oe()(t.prototype),"afterConstruct",this).call(this),this.navigator.on({navigate:"onEventNavigate",thisObj:this})}},{key:"isEventSelected",value:function(e){return this.selectedCollection.includes(e)}},{key:"selectEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEventSelected(e)||(t?this.selectedCollection.add(e):this.selectedEvents=e)}},{key:"deselectEvent",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEventSelected(e)&&this.selectedCollection.remove(e)}},{key:"selectEvents",value:function(e){this.selectedCollection.add(e)}},{key:"deselectEvents",value:function(e){this.selectedCollection.remove(e)}},{key:"clearEventSelection",value:function(){this.selectedEvents=[]}},{key:"onSelectedCollectionChange",value:function(e){var t=e.added,n=e.removed,r=this,i=r.selectedEvents,o=t||[],a=n||[];function s(e,t){var n=e.isTask?e:e.resource,i=e.isAssignment?e.event:e;if(i){var o=r.getElementFromEventRecord(i,n);r.currentOrientation.toggleCls(i,n,r.eventSelectedCls,t),e.isAssignment&&r.getElementsFromEventRecord(i).forEach((function(e){e!==o&&e.classList[t?"add":"remove"](r.eventAssignHighlightCls)}))}}o.forEach((function(e){return s(e,!0)})),a.forEach((function(e){return s(e,!1)})),r.silent||r.trigger("eventSelectionChange",{action:i.length>0?o.length>0&&a.length>0?"update":o.length>0?"select":"deselect":"clear",selection:i,selected:o,deselected:a})}},{key:"onInternalEventStoreChange",value:function(e){var n=e.action,r=e.records,i=e.source;se()(oe()(t.prototype),"onInternalEventStoreChange",this).apply(this,arguments);var o=this;o.silent=!o.triggerSelectionChangeOnRemove,"remove"===n?o.deselectEvents(r):"dataset"===n&&(o.maintainSelectionOnDatasetChange?o.selectedEvents=o.selectedEvents.filter((function(e){return i.includes(e)})):o.clearEventSelection()),o.silent=!1}},{key:"onAssignmentRemove",value:function(e){var n=e.records;se()(oe()(t.prototype),"onAssignmentRemove",this).apply(this,arguments);var r=this;r.silent=!r.triggerSelectionChangeOnRemove,r.deselectEvents(n),r.silent=!1}},{key:"onEventSelectionClick",value:function(e,t){var n=this;n.isEventSelected(t)?e.ctrlKey&&n.deselectEvent(t,n.multiEventSelect):n.selectEvent(t,e.ctrlKey&&n.multiEventSelect)}},{key:"onEventNavigate",value:function(e){var t=e.event,n=e.item;if(!this.eventSelectionDisabled){var r=this,i=n&&(1===n.nodeType?r.assignmentStore?r.resolveAssignmentRecord(n):r.resolveEventRecord(n):n);i?r.onEventSelectionClick(t,i):r.clearEventSelection()}}},{key:"selectedCollection",set:function(e){e instanceof Un||(e=new Un(e)),this._selectedCollection=e,e.on({change:"onSelectedCollectionChange",thisObj:this})},get:function(){return this._selectedCollection}},{key:"selectedEvents",get:function(){return this.selectedCollection.values},set:function(e){this.selectedCollection.splice(0,this.selectedCollection.count,e||[])}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{multiEventSelect:!1,eventSelectionDisabled:!1,eventSelectedCls:"b-sch-event-selected",triggerSelectionChangeOnRemove:!1,maintainSelectionOnDatasetChange:!0,eventAssignHighlightCls:"b-sch-event-assign-selected",selectedCollection:{}}}}]),t}(e||z)}),(function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e){var n=this,r=kn.createThrottled(n.onDeleteKey,500,n);n.isInTimeAxis=n.isInTimeAxis.bind(n),se()(oe()(t.prototype),"construct",this).call(this,e);var i=kt.merge({ownerCmp:n,target:n.timeAxisSubGridElement,processEvent:n.processEvent,itemSelector:".".concat(n.eventCls,"-wrap"),focusCls:n.focusCls,navigatePrevious:kn.createThrottled(n.navigatePrevious,200,n,null,Od),navigateNext:kn.createThrottled(n.navigateNext,200,n,null,Od),allowCtrlKey:!0,scrollSilently:!0,keys:{Space:"onEventSpaceKey",Enter:"onEventEnterKey",Delete:r,Backspace:r}},n.navigator);n.navigator=new Hi(i)}},{key:"doDestroy",value:function(){this.navigator.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"isInTimeAxis",value:function(e){return!e.instanceMeta(this).excluded&&this.timeAxis.isTimeSpanInAxis(e)}},{key:"accessibleFocusCell",value:function(e,n){if((e=this.normalizeCellContext(e)).columnId!==this.timeAxisColumn.id)return se()(oe()(t.prototype),"focusCell",this).call(this,e,n)}},{key:"getPrevious",value:function(e,t){var n=this,r=n.resourceStore,i=e.isAssignment;if(e.isTask)return n.eventStore.getAt(n.eventStore.indexOf(e)-1);var o=e.resource||n.eventStore.getResourcesForEvent(e)[0],a=o.getEvents().filter(n.isInTimeAxis).sort(Ld),s=i?e.event:e,l=a[a.indexOf(s)-1];if(!l)for(var u=r.indexOf(o)-1;(!l||t&&l===s)&&u>=0;u--){var c=(o=r.getAt(u)).getEvents().filter(n.isInTimeAxis).sort(Ld);l=c.length&&c[c.length-1]}return i?n.assignmentStore.getAssignmentForEventAndResource(l,o):l}},{key:"navigatePrevious",value:function(e){var t=this.getPrevious(e.assignmentRecord||e.eventRecord);e.preventDefault(),t&&(e.ctrlKey||this.clearEventSelection(),this.navigateTo(t,e))}},{key:"getNext",value:function(e,t){var n=this,r=n.resourceStore,i=e.isAssignment;if(e.isTask)return n.eventStore.getAt(n.eventStore.indexOf(e)+1);var o=i?e.resource:e.resources[0],a=o.getEvents().filter(n.isInTimeAxis).sort(Ld),s=i?e.event:e,l=a[a.indexOf(s)+1];if(!l)for(var u=r.indexOf(o)+1;(!l||t&&l===s)&&u<r.count;u++)l=(o=r.getAt(u)).getEvents().filter(n.isInTimeAxis).sort(Ld)[0];return i?n.assignmentStore.getAssignmentForEventAndResource(l,o):l}},{key:"navigateNext",value:function(e){var t=this.getNext(e.assignmentRecord||e.eventRecord);e.preventDefault(),t&&(e.ctrlKey||this.clearEventSelection(),this.navigateTo(t,e))}},{key:"navigateTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;if(e){n.navigator.disabled=!0;var r=e.resource;n.scrollResourceEventIntoView(r,e.isAssignment?e.event:e,null,{animate:100}).then((function(){n.isDestroyed||(n.navigator.disabled=!1,n.activeEvent=e,n.navigator.trigger("navigate",{event:t,item:rn.up(n.getElementFromEventRecord(e,r),n.navigator.itemSelector)}))}))}}},{key:"processEvent",value:function(e){var t=this,n=rn.up(e.target,t.eventSelector);return!t.navigator.disabled&&n&&(e.assignmentRecord=t.resolveAssignmentRecord(n),e.eventRecord=t.resolveEventRecord(n),e.resourceRecord=t.resolveResourceRecord(n)),e}},{key:"onDeleteKey",value:function(e){var t=e.assignmentRecord||e.eventRecord;!this.readOnly&&this.enableDeleteKey&&t&&this.removeRecords([t])}},{key:"removeRecords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.readOnly&&e.length){var n={finalize:function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&t(n),!1!==n&&e.forEach((function(e){return e.remove()}))}};if(!1!==this.trigger("beforeEventDelete",{eventRecords:e,context:n}))return n.finalize(),!0}return!1}},{key:"onEventSpaceKey",value:function(e){}},{key:"onEventEnterKey",value:function(e){}},{key:"activeEvent",set:function(e){var t=this.getElementFromEventRecord(e.isAssignment?e.event:e,e.resource);this.navigator.activeItem=t.parentNode},get:function(){var e=this.navigator.activeItem;if(e)return this.resolveEventRecord(e)}},{key:"previousActiveEvent",get:function(){var e=this.navigator.previousActiveItem;if(e)return this.resolveEventRecord(e)}},{key:"isActionableLocation",get:function(){if(!this.navigator.activeItem)return se()(oe()(t.prototype),"isActionableLocation",this)}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{navigator:null,focusCls:"b-active",enableDeleteKey:!0}}}]),t}(e||z)})));ih.localeClass="Scheduler",ih._$name="SchedulerBase",X.register("schedulerbase",ih);var oh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),this.scheduler=e}},{key:"getHeaderMenuItems",value:function(e,t){var n=this,r=n.scheduler,i=n.processItems,o=r.timeAxis,a={magnitude:o.shiftIncrement,unit:o.shiftUnit};"timeAxis"===e.type&&(t.push({text:n.L("pickZoomLevel"),icon:"b-fw-icon b-icon-search-plus",disabled:!r.presets.count||n.disabled,menu:{type:"popup",items:[{type:"slider",showValue:!1,listeners:{input:n.onZoomSliderChange,thisObj:n},minWidth:130}],onBeforeShow:function(e){var t=e.source,n=fe()(t.items,1)[0];n.min=r.minZoomLevel,n.max=r.maxZoomLevel,n.value=r.zoomLevel}}}),n.startDateField=new oo({label:n.L("startText"),labelWidth:"6em",required:!0,step:a,listeners:{change:n.onRangeDateFieldChange,thisObj:n}}),n.endDateField=new oo({label:n.L("endText"),labelWidth:"6em",required:!0,step:a,listeners:{change:n.onRangeDateFieldChange,thisObj:n}}),t.push({text:n.L("activeDateRange"),icon:"b-fw-icon b-icon-calendar",disabled:n.disabled,menu:{type:"popup",width:"20em",items:[n.startDateField,n.endDateField,{type:"button",cls:"b-left-nav-btn",icon:"b-icon b-icon-prev",color:"b-blue b-raised",flex:1,margin:0,listeners:{click:n.onLeftShiftBtnClick,thisObj:n}},{type:"button",cls:"b-today-nav-btn",color:"b-blue b-raised",text:n.L("todayText"),flex:4,margin:"0 8",listeners:{click:n.onTodayBtnClick,thisObj:n}},{type:"button",cls:"b-right-nav-btn",icon:"b-icon b-icon-next",color:"b-blue b-raised",flex:1,listeners:{click:n.onRightShiftBtnClick,thisObj:n}}],onBeforeShow:function(){return n.initDates()}}}),n.extraItems&&t.push.apply(t,n.extraItems),i&&i({items:t}))}},{key:"onZoomSliderChange",value:function(e){var t=e.value,n=this.client.features.contextMenu.currentMenu;n.scrollAction="realign",this.scheduler.zoomLevel=t,n.setTimeout({fn:function(){return n.scrollAction="hide"},delay:100,cancelOutstanding:!0})}},{key:"initDates",value:function(){var e=this;e.startDateField.suspendEvents(),e.endDateField.suspendEvents(),e.startDateField.value=e.startDateFieldInitialValue=e.scheduler.startDate,e.endDateField.value=e.endDateFieldInitialValue=e.scheduler.endDate,e.startDateField.resumeEvents(),e.endDateField.resumeEvents()}},{key:"onRangeDateFieldChange",value:function(e){var t=this,n=e.source===t.startDateField,r=t.client,i=r.timeResolution,o=r.timeAxisSubGrid.scrollable,a=t.startDateFieldInitialValue&&!n?t.startDateFieldInitialValue:t.startDateField.value,s=r.getDateFromX(o.x),l=t.endDateFieldInitialValue&&n?t.endDateFieldInitialValue:t.endDateField.value;n?t.startDateFieldInitialValue=null:t.endDateFieldInitialValue=null,l-a?l<a&&(l=vt.add(a,i.increment,i.unit)):l=vt.add(l,i.increment,i.unit),t.scheduler.timeAxis.setTimeSpan(a,l),o.x=r.getCoordinateFromDate(s,!0),t.initDates()}},{key:"onLeftShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftPrevious(),this.initDates()}},{key:"onTodayBtnClick",value:function(){var e=vt.clearTime(new Date);this.scheduler.timeAxis.setTimeSpan(e,vt.add(e,1,"day")),this.initDates()}},{key:"onRightShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftNext(),this.initDates()}}],[{key:"$name",get:function(){return"HeaderContextMenu"}},{key:"defaultConfig",get:function(){return{extraItems:null,processItems:null}}},{key:"pluginConfig",get:function(){return{chain:["getHeaderMenuItems"]}}}]),t}(ai);oh.featureClass="",oh._$name="HeaderContextMenu",Xs.registerFeature(oh,!0,["Scheduler","Gantt"]);var ah=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),this.scheduler=e}},{key:"showEventContextMenu",value:function(e){var t=this.scheduler,n=t.getEventData(e),r=n?t.columns.getById(n.columnId)===t.timeAxisColumn:t.timeAxisSubGrid.element===e.target,i=t.resolveResourceRecord(e)||t.resourceStore.last;r&&(this.showContextMenu({menuType:"schedule",date:t.getDateFromDomEvent(e,"floor"),resourceRecord:i,event:e}),e.preventDefault())}},{key:"namedItems",get:function(){var e=this.client;return this._namedItems||(this._namedItems={addEvent:{text:e.L("Add event",null),icon:"b-icon b-icon-add",disabled:0===e.resourceStore.count,weight:100,onItem:function(t){var n=t.date,r=t.resourceRecord;e.internalAddEvent(n,r,e.getRowFor(r))}}}),this._namedItems}}],[{key:"$name",get:function(){return"ScheduleContextMenu"}},{key:"defaultConfig",get:function(){return{items:null,processItems:null,defaultItems:{addEvent:!0}}}}]),t}(Lc);ah.featureClass="",ah._$name="ScheduleContextMenu",Xs.registerFeature(ah,!0,"Scheduler");var sh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"render",value:function(){var e,t=this,n=t.client;t.hoverTip&&t.hoverTip.destroy();var r=t.hoverTip=new Ur({id:"".concat(n.id,"-schedule-tip"),cls:"b-sch-scheduletip",allowOver:!0,hoverDelay:0,hideDelay:100,showOnHover:!0,forElement:n.timeAxisSubGridElement,anchorToTarget:!1,trackMouse:!0,forSelector:".b-schedulerbase:not(.b-animating):not(.b-dragging-event):not(.b-dragcreating) .b-timeline-subgrid > :not(.b-sch-foreground-canvas):not(.b-group-footer):not(.b-group-row) *",constrainTo:null,getHtml:t.getHoverTipHtml.bind(t),onDocumentMouseDown:function(t){r.forElement.contains(t.event.target)&&(e=Ln.on({element:n.timeAxisSubGridElement,mousemove:function(e){return r.internalOnPointerOver(e)},capture:!0}));var i=r.hideAnimation;r.hideAnimation=!1,r.constructor.prototype.onDocumentMouseDown.call(r,t),r.hideAnimation=i},listeners:{pointerover:function(r){var i=r.event,o="buttons"in i?i.buttons>0:i.which>0;return!o&&e&&e(),!t.disabled&&!n.readOnly&&!o}}}),i=r.onMouseMove;r.onMouseMove=function(e){i.call(r,e),t.onTipMove(r,e)},t.clockTemplate=new Pc({timeAxisViewModel:n.timeAxisViewModel})}},{key:"doDestroy",value:function(){this.clockTemplate&&this.clockTemplate.destroy(),this.hoverTip&&this.hoverTip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onTipMove",value:function(e,t){this.clockTemplate.updateDateIndicator(e.element,this.lastTime)}},{key:"getHoverTipHtml",value:function(e){var t=e.tip,n=e.event,r=this,i=r.client,o=n&&i.getDateFromDomEvent(n,"floor",!0),a=r.lastHtml;if(o){var s=i.resolveResourceRecord(n);o-r.lastTime==0&&s===r.lastResource||(r.lastResource=s,a=r.lastHtml=r.updateHoverTip(o,n))}else t.hide(),r.lastTime=null,r.lastResource=null;return a}},{key:"updateHoverTip",value:function(e,t){if(e){var n=this,r=n.clockTemplate.template({date:e,text:n.client.getFormattedDate(e)}),i=n.messageTemplate({message:n.getText(e,t)||""});return n.lastTime=e,r+i}}},{key:"getText",value:function(e,t){}}],[{key:"$name",get:function(){return"ScheduleTooltip"}},{key:"defaultConfig",get:function(){return{messageTemplate:function(e){return'<div class="b-sch-hovertip-msg">'.concat(e.message,"</div>")}}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),t}(ai);sh.featureClass="b-scheduletip",sh._$name="ScheduleTooltip",Xs.registerFeature(sh,!0,"Scheduler");var lh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"$name",get:function(){return"Scheduler"}}]),t}(ih);lh._$name="Scheduler",X.register("scheduler",lh),I.setVersion("scheduler","3.0.0");var uh={add:1,remove:1,update:1,removeAll:1,filter:1},ch=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;if(e.isVertical)throw new Error("GroupSummary feature is not supported in vertical mode");r.scheduler=e,se()(oe()(t.prototype),"construct",this).call(this,e,n),!r.summaries&&r.renderer&&(r.summaries=[{renderer:r.renderer}]),r.isScheduler=e instanceof lh,r.isScheduler&&(e.eventStore.on({change:r.onEventStoreChange,thisObj:r}),e.timeAxis.on({reconfigure:r.onTimeAxisChange,thisObj:r}),e.timeAxisViewModel.on({update:r.onTimeAxisChange,thisObj:r}))}},{key:"doDestroy",value:function(){this._tip&&this._tip.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"onTimeAxisChange",value:function(){this.rerenderGroupSummaries()}},{key:"onEventStoreChange",value:function(e){var t=e.action;uh[t]&&this.rerenderGroupSummaries()}},{key:"rerenderGroupSummaries",value:function(){this.scheduler.rowManager.rows.forEach((function(e){e.isGroupFooter&&e.render()}))}},{key:"onBeforeRenderRow",value:function(e){var n=e.row,r=e.record;if(n.isGroupFooter&&!r.meta.hasOwnProperty("groupFooterFor")){var i=n.elements.normal.querySelector(".b-sch-timeaxis-cell");i&&(i.innerHTML="")}se()(oe()(t.prototype),"onBeforeRenderRow",this).apply(this,arguments)}},{key:"generateHtml",value:function(e,n,r){if("timeAxis"===e.type){var i=this,o=i.scheduler,a=o.tickSize,s="";return o.timeAxis.forEach((function(e){var t=o.eventStore.getEventsInTimeSpan(e.startDate,e.endDate,!0,!0).filter((function(e){return e.resources.some((function(e){return n.includes(e)}))})),r=i.summaries.map((function(n){var r=n.renderer({startDate:e.startDate,endDate:e.endDate,eventStore:o.eventStore,resourceStore:o.resourceStore,events:t});return'<div class="b-timeaxis-summary-value">'.concat(r,"</div>")})).join("");s+='<div class="b-timeaxis-tick" style="width: '.concat(a,'px">').concat(r,"</div>")})),'<div class="b-timeaxis-group-summary">'.concat(s,"</div>")}return se()(oe()(t.prototype),"generateHtml",this).call(this,e,n,r)}},{key:"updateSummaryHtml",value:function(e,n,r){var i=se()(oe()(t.prototype),"updateSummaryHtml",this).call(this,e,n,r);if("timeAxis"===n.type){var o={count:0,height:0};return this.summaries.forEach((function(e){e.height?o.height+=e.height:o.count++})),o}return i}},{key:"getTipHtml",value:function(e){var t=e.forElement,n=this,r=Array.from(t.parentElement.children).indexOf(t),i=n.scheduler.timeAxis.getAt(r),o="<header>".concat(n.L("Summary for")," ").concat(n.scheduler.getFormattedDate(i.startDate),"</header>"),a=!1;return rn.forEachSelector(t,".b-timeaxis-summary-value",(function(e,t){var r=n._labels[t],i=e.innerText.trim();o+="<label>".concat(r||"",'</label><div class="b-timeaxis-summary-value">').concat(i,"</div>"),e.innerHTML&&(a=!0)})),a?o:null}},{key:"render",value:function(){var e=this,t=e.scheduler;e.isScheduler&&e.summaries&&e.summaries.some((function(e){return e.label}))&&e.showTooltip&&!e._tip&&(e._labels=e.summaries.map((function(e){return e.label||""})),e._tip=new Ur({id:"".concat(t.id,"-groupsummary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:0,forElement:t.timeAxisSubGridElement,anchorToTarget:!0,forSelector:".b-timeaxis-group-summary .b-timeaxis-tick",clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],getHtml:e.getTipHtml.bind(e)}))}}],[{key:"$name",get:function(){return"GroupSummary"}},{key:"defaultConfig",get:function(){return{showTooltip:!0,summaries:null,renderer:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),t}(gd);ch._$name="GroupSummary",ch._$name="GroupSummary",Xs.registerFeature(ch,!1,"Scheduler");var dh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;if(!e.touches&&0===e.button&&!t.disabled&&e.target.matches(".b-sch-header-timeaxis-cell")){var r=n.subGrids.normal.header.headersElement;t.startX=e.clientX,t.element=rn.createElement({parent:r,tag:"div",className:"b-headerzoom-rect"}),t.headerElementRect=Oe.from(r)}}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||ge.isSafari||ge.isIE11&&!e.isTrusted){if("number"==typeof t.startX){var n=Math.max(e.clientX,t.headerElementRect.left),r=Math.min(t.startX,n),i=Math.abs(t.startX-n),o=new Oe(r-t.headerElementRect.x+t.client.scrollLeft,0,i,t.headerElementRect.height);rn.setTranslateX(t.element,o.left),t.element.style.width=o.width+"px"}}else t.onElementMouseUp(e)}},{key:"onElementMouseUp",value:function(e){var t=this;if("number"==typeof t.startX){var n=t.client,r=Oe.from(t.element),i=n.getDateFromCoordinate(r.left,"round",!1),o=n.getDateFromCoordinate(r.right,"round",!1);t.element&&t.element.remove(),t.startX=null,t.client.zoomToSpan({startDate:i,endDate:o})}}}],[{key:"$name",get:function(){return"HeaderZoom"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),t}(ai);dh._$name="HeaderZoom",Xs.registerFeature(dh,!1,"Scheduler");var hh=["top","left","right","bottom"],fh={top:"b-b",right:"l-l",bottom:"t-t",left:"r-r"},gh={top:1,bottom:1},vh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;if(e.isVertical)throw new Error("Labels feature is not supported in vertical mode");r.scheduler=e,r.labelElements={},se()(oe()(t.prototype),"construct",this).call(this,e,n);var i=r.top,o=r.bottom,a=r.left,s=r.right;(i||o||a||s)&&(r.schedulerDetatcher=e.on({eventpaint:"onEventPaint",eventrepaint:"onEventPaint",thisObj:r}),r.updateHostClasslist())}},{key:"updateHostClasslist",value:function(){var e=this.top,t=this.bottom,n=this.scheduler.element.classList;n.remove("b-labels-topbottom"),n.remove("b-labels-top"),n.remove("b-labels-bottom"),(e||t)&&(n.add("b-labels-topbottom"),e&&n.add("b-labels-top"),t&&n.add("b-labels-bottom"))}},{key:"onEventDblClick",value:function(e){var t=e.event,n=t.target.closest(".b-sch-label");if(n&&!this.scheduler.readOnly){var r=n.dataset.side,i=this[r],o=i.editor,a=i.field,s=i.recordType;if(o)return o instanceof no||(i.editor=new no({appendTo:this.scheduler.element,blurAction:this.blurAction,inputField:o,scrollAction:"realign"})),i.editor.startEdit({target:n,align:fh[r],matchSize:!1,record:e["".concat(s,"Record")],field:a}),t.stopImmediatePropagation(),!1}}},{key:"processLabelSpec",value:function(e,t){if("function"==typeof e)e={renderer:e};else if("string"==typeof e)e={field:e};else{if(!e)return;e=Object.setPrototypeOf({},e)}var n,r=this.scheduler,i=r.eventStore,o=r.resourceStore,a=r.taskStore,s=(r.id,e),l=s.field,u=s.editor;(gh[t]&&(r.milestoneWidth=null),l)&&(i&&!a&&((n=i.modelClass.fieldMap[l])?(e.fieldDef=n,e.recordType="event"):Reflect.has(i.modelClass.prototype,l)&&(e.recordType="event")),!n&&a&&((n=a.modelClass.fieldMap[l])?(e.fieldDef=n,e.recordType="task"):Reflect.has(o.modelClass.prototype,l)&&(e.recordType="task")),!n&&o&&((n=o.modelClass.fieldMap[l])?(e.fieldDef=n,e.recordType="resource"):Reflect.has(o.modelClass.prototype,l)&&(e.recordType="resource")),u&&("boolean"==typeof u?r.editor={type:"textfield"}:"string"==typeof u&&(r.editor={type:u}),r.on({eventdblclick:"onEventDblClick",taskdblclick:"onEventDblClick",thisObj:this})));return e}},{key:"doDestroy",value:function(){this.schedulerDetatcher&&this.schedulerDetatcher(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){se()(oe()(t.prototype),"doDisable",this).call(this,e),this.client.isPainted&&this.client.refresh()}},{key:"onEventPaint",value:function(e){if(rn.removeEachSelector(e.element,".b-sch-label"),!this.disabled){var t=!0,n=!1,r=void 0;try{for(var i,o=hh[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this[a]&&this.appendLabel(a,e.element,e)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"appendLabel",value:function(e,t,n){this.labelElements[e]=rn.createElement({tag:"label",dataset:{side:e},parent:t}),this.updateLabel(e,n)}},{key:"updateLabel",value:function(e,t){var n,r=this,i=r[e],o=i.field,a=i.fieldDef,s=i.recordType,l=i.renderer,u=i.thisObj,c=r.labelElements[e];c.className="".concat(r.labelCls," ").concat(r.labelCls,"-").concat(e),l?n=l.call(u||r.thisObj||r,Object.assign({labelElement:c},t)):(n=t["".concat(s,"Record")][o],a&&"date"===a.type&&!l&&(n=vt.format(n,r.scheduler.displayDateFormat))),c.innerHTML=n||" "}},{key:"top",set:function(e){this._top=this.processLabelSpec(e,"top"),this.updateHostClasslist()},get:function(){return this._top}},{key:"right",set:function(e){this._right=this.processLabelSpec(e,"right"),this.updateHostClasslist()},get:function(){return this._right}},{key:"bottom",set:function(e){this._bottom=this.processLabelSpec(e,"bottom"),this.updateHostClasslist()},get:function(){return this._bottom}},{key:"left",set:function(e){this._left=this.processLabelSpec(e,"left"),this.updateHostClasslist()},get:function(){return this._left}}],[{key:"$name",get:function(){return"Labels"}},{key:"defaultConfig",get:function(){return{labelCls:"b-sch-label",top:null,right:null,bottom:null,left:null,thisObj:null,blurAction:"cancel"}}},{key:"pluginConfig",get:function(){return{}}}]),t}(ai);vh.featureClass="b-sch-labels",vh._$name="Labels",Xs.registerFeature(vh,!1,"Scheduler");n(183);var mh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;se()(oe()(t.prototype),"construct",this).call(this,e,n),r.cls=r.cls||"b-timerange-".concat(r.constructor.$name),r.baseSelector=".".concat(r.baseCls,".").concat(r.cls),r.enableResizing&&(r.showHeaderElements=!0)}},{key:"doDestroy",value:function(){var e=this;e.storeDetacher&&e.storeDetacher(),e.timeAxisViewModelDetacher&&e.timeAxisViewModelDetacher(),e.timeAxisDetacher&&e.timeAxisDetacher(),e.clockTemplate&&e.clockTemplate.destroy(),e.tip&&e.tip.destroy(),e.drag&&e.drag.destroy(),e.resize&&e.resize.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.client.isPainted&&this.renderRanges(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"onPaint",value:function(){var e=this;e.isPainted||(e.timeAxisViewModel=e.client.timeAxisViewModel,e.timeAxisViewModelDetacher=e.timeAxisViewModel.on({reconfigure:e.onTimeAxisViewModelUpdate,update:e.onTimeAxisViewModelUpdate,thisObj:e}),e.timeAxisDetacher=e.client.timeAxis.on({includeChange:e.onTimeAxisViewModelUpdate,thisObj:e}),e.enableResizing&&!e.client.hideHeaders&&(e.drag=new qa({name:"rangeDrag",mode:e.client.isVertical?"translateY":"translateX",constrain:!0,outerElement:e.headerContainerElement,targetSelector:"".concat(e.baseSelector),isElementDraggable:function(t,n){return!e.client.readOnly&&e.isElementDraggable(t,n)},transitionDuration:e.client.transitionDuration,listeners:{dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,abort:e.onInvalidDrop,thisObj:e}}),e.resize=new ls({direction:e.client.mode,targetSelector:"".concat(e.baseSelector,".b-sch-range"),outerElement:e.headerContainerElement,listeners:{resizestart:e.onResizeStart,resizing:e.onResizeDrag,resize:e.onResize,thisObj:e}})),e.renderRanges())}},{key:"renderRanges",value:function(){var e=this,t=e.client.foregroundCanvas;if(t){var n=e.headerContainerElement,r=e.store;if(rn.removeEachSelector(t,e.baseSelector),n&&rn.removeEachSelector(n,e.baseSelector),!e.disabled){var i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;e.renderRange(u,!0)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}}}},{key:"renderRange",value:function(e,t){var n=this,r=n.client;if(e.duration&&r.timeAxis.timeSpanInAxis(e.startDate,e.endDate)||e.startDate&&r.timeAxis.dateInAxis(e.startDate)){var i,o=r.getCoordinateFromDate(vt.max(e.startDate,r.timeAxis.startDate),{respectExclusion:!0}),a=e.duration&&r.getCoordinateFromDate(vt.min(e.endDate,r.timeAxis.endDate),{respectExclusion:!0,isEnd:!0}),s="<label>".concat(e.name||"&nbsp;","</label>"),l={className:"".concat(n.baseCls," ").concat(n.cls," ").concat(a?n.rangeCls:n.lineCls," ").concat(e.cls||""),dataset:{id:e.id},style:r.isVertical?"transform: translateY(".concat(o,"px); ").concat(a?"height:".concat(a-o,"px"):"",";"):"transform: translateX(".concat(o,"px); ").concat(a?"width:".concat(a-o,"px"):"",";"),retainElement:!0},u=rn.createElement(Object.assign({},l,{parent:t&&r.foregroundCanvas,style:l.style+(e.style||""),html:n.showHeaderElements?"":s}));n.showHeaderElements&&(i=rn.createElement(Object.assign({parent:t&&n.headerContainerElement,html:e.name?s:""},l)));var c={bodyElement:u,headerElement:i};return t&&n.rotateLabel(c),c}}},{key:"rotateLabel",value:function(e){var t=e.bodyElement,n=t.firstChild;if(n){n.classList.remove("b-vertical");var r=this.client.isVertical?n.offsetHeight<t.offsetHeight:n.offsetWidth>t.offsetWidth;n.classList[r?"add":"remove"]("b-vertical")}}},{key:"getElementsByRecord",value:function(e){var t="object"!==U()(e)?e:e.id,n=this.client.foregroundCanvas.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]')),r=this.headerContainerElement.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]'));return n?{bodyElement:n,headerElement:r}:null}},{key:"getBodyElementByRecord",value:function(e){var t="string"==typeof e?e:e.id;return this.client.foregroundCanvas.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]'))}},{key:"getRecordByElement",value:function(e){return this.store.getById(e.dataset.id)}},{key:"getHeaderMenuItems",value:function(e,t){return[]}},{key:"onTimeAxisViewModelUpdate",value:function(){this.renderRanges()}},{key:"onStoreChanged",value:function(e){var t=this;if(!t.isConfiguring)if("update"===e.action){var n=e.changes.hasOwnProperty("id")?e.changes.id.oldValue:e.record.id,r=t.getElementsByRecord(n),i=t.renderRange(e.record,!r);if(r&&!i&&(r.bodyElement.remove(),r.headerElement&&r.headerElement.remove()),!r||!i)return;t.client.runWithTransition((function(){rn.sync(i.bodyElement,r.bodyElement),t.showHeaderElements&&rn.sync(i.headerElement,r.headerElement),t.rotateLabel(r)}))}else t.renderRanges()}},{key:"showTip",value:function(e){var t=this;t.showTooltip&&(t.clockTemplate=new Pc({timeAxisViewModel:t.client.timeAxisViewModel}),t.tip=new Ur({id:"".concat(t.client.id,"-time-range-tip"),cls:"b-interaction-tooltip",align:"b-t",autoShow:!0,forElement:e.element,getHtml:function(){return t.getTipHtml(e.record,e.element)}}))}},{key:"isElementDraggable",value:function(e){return(e=e.closest(this.baseSelector))&&!e.classList.contains("b-over-resize-handle")}},{key:"onDragStart",value:function(e){var t=e.context,n=this,r=n.getRecordByElement(t.element.closest(n.baseSelector)),i=n.getBodyElementByRecord(r),o=n.drag;Object.assign(t,{record:r,rangeBodyEl:i,originRangeX:rn.getTranslateX(i),originRangeY:rn.getTranslateY(i)}),n.client.isVertical?(o.minY=0,o.maxY=n.timeAxisViewModel.totalSize-t.rangeBodyEl.offsetHeight,o.minX=0,o.maxX=Number.MAX_SAFE_INTEGER):(o.minX=0,o.maxX=n.timeAxisViewModel.totalSize-t.rangeBodyEl.offsetWidth,o.minY=0,o.maxY=Number.MAX_SAFE_INTEGER),n.client.element.classList.add("b-dragging-timerange"),n.showTip(t)}},{key:"onDrag",value:function(e){var t=e.context;this.client.isVertical?rn.setTranslateY(t.rangeBodyEl,rn.getTranslateY(t.element)):rn.setTranslateX(t.rangeBodyEl,rn.getTranslateX(t.element)),this.showTooltip&&this.tip.realign()}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=t.record,i=t.rangeBodyEl.getBoundingClientRect(),o=n.client.getDateFromCoordinate(n.client.isVertical?i.top:i.left,"round",!1);r.startDate-o!=0?r.setStartDate(o):n.onInvalidDrop(),n.tip&&(n.tip.destroy(),n.tip=null),n.client.element.classList.remove("b-dragging-timerange")}},{key:"onInvalidDrop",value:function(){var e=this;e.drag.reset(),e.renderRanges(),e.client.element.classList.remove("b-dragging-timerange"),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"onResizeStart",value:function(e){var t=e.context,n=this.getRecordByElement(t.element.closest(this.baseSelector)),r=this.getBodyElementByRecord(n);Object.assign(t,{record:n,rangeBodyEl:r}),this.showTip(t)}},{key:"onResizeDrag",value:function(e){var t=e.context;this.client.isVertical?("top"===t.edge&&rn.setTranslateY(t.rangeBodyEl,t.newY),t.rangeBodyEl.style.height=t.newHeight+"px"):("left"===t.edge&&rn.setTranslateX(t.rangeBodyEl,t.newX),t.rangeBodyEl.style.width=t.newWidth+"px"),this.showTooltip&&this.tip.realign()}},{key:"onResize",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=n.client,i=t.record,o=t.element.getBoundingClientRect(),a=r.isVertical?o.top:o.left,s=r.isVertical?o.bottom:o.right,l=r.getDateFromCoordinate(a,"round",!1),u="left"===t.edge||"top"===t.edge,c=r.getDateFromCoordinate(s,"round",!1);(u&&i.startDate-l!=0||c&&i.endDate-c!=0)&&c>l?u?i.setStartDate(l,!1):i.setEndDate(c,!1):n.onInvalidResize(),n.tip&&(n.tip.destroy(),n.tip=null)}},{key:"onInvalidResize",value:function(){var e=this;e.resize.reset(),e.renderRanges(),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"getTipHtml",value:function(e,t){var n=this.client,r=t.getBoundingClientRect(),i=n.isVertical?r.top:r.left,o=n.isVertical?r.bottom:r.right,a=n.getDateFromCoordinate(i,"round",!1),s=e.endDate&&n.getDateFromCoordinate(o,"round",!1),l=n.getFormattedDate(a),u=s&&n.getFormattedEndDate(s,a);return this.dragTipTemplate({name:e.name||"",startDate:a,endDate:s,startText:l,endText:u,startClockHtml:this.clockTemplate.template({date:a,text:l,cls:"b-sch-tooltip-startdate"}),endClockHtml:u&&this.clockTemplate.template({date:s,text:u,cls:"b-sch-tooltip-enddate"})})}},{key:"headerContainerElement",get:function(){var e=this.client,t=e.isVertical,n=e.timeView,r=e.timeAxisColumn,i=null;return t&&n.element?i=n.element.parentElement:t||(i=r.element),i}},{key:"showHeaderElements",get:function(){return this._showHeaderElements},set:function(e){this._showHeaderElements=e,this.client.isPainted&&(e?this.client.element.classList.add("b-sch-timeranges-with-headerelements"):this.client.element.classList.remove("b-sch-timeranges-with-headerelements"),this.renderRanges())}},{key:"store",get:function(){return this._store},set:function(e){var t=this;t._store=Fi.getStore(e,Fi);var n=!1;t.storeDetacher&&(t.storeDetacher(),n=!0),t.storeDetacher=t._store.on({change:t.onStoreChanged,thisObj:t}),n&&this.renderRanges()}}],[{key:"defaultConfig",get:function(){return{rangeCls:"b-sch-range",lineCls:"b-sch-line",store:{modelClass:Hu},enableResizing:!1,showTooltip:!0,showHeaderElements:!0,dragTipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    <div class="b-sch-tip-name">').concat(e.name||"","</div>\n                    ").concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml||"","\n                </div>\n            ")},baseCls:"b-sch-timerange",cls:""}}},{key:"pluginConfig",get:function(){return{chain:["onPaint","getHeaderMenuItems"]}}}]),t}(de(ai));mh._$name="AbstractTimeRanges";var ph=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){se()(oe()(t.prototype),"construct",this).call(this,e,n),this.calendar&&e.calendar||(this.calendar=new Nu),this.bindCalendar(this.calendar)}},{key:"doDestroy",value:function(){this.bindCalendar(null),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"bindCalendar",value:function(e){var t=this;t.calendarDetacher&&t.calendarDetacher(),e&&(t.calendarDetacher=e.on({change:t.renderRanges,thisObj:t,delay:1})),t.calendar=e,t.renderRanges()}},{key:"renderRanges",value:function(){var e=this;if(e.store&&!e.store.isDestroyed){var n=vt.as(e.client.timeAxis.unit,1,"week")>=1;e.store.removeAll(!0),e.calendar&&e.highlightWeekends&&n&&e.store.add(e.calendar.getHolidaysRanges(e.client.timeAxis.startDate,e.client.timeAxis.endDate,!0),!0)}se()(oe()(t.prototype),"renderRanges",this).call(this)}}],[{key:"$name",get:function(){return"NonWorkingTime"}},{key:"defaultConfig",get:function(){return{highlightWeekends:!0,showHeaderElements:!0,cls:"b-sch-nonworkingtime"}}}]),t}(mh);ph._$name="NonWorkingTime",Xs.registerFeature(ph,!1,"Scheduler");var yh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){if(this.timeline=e,e.features.eventDragCreate&&!e.features.eventDragCreate.disabled)throw new Error("Cannot combine Pan and eventDragCreate features");this.targetSelector=[".b-grid-cell",".b-timeline-subgrid"].join(","),se()(oe()(t.prototype),"construct",this).call(this,e,n)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.timeline,r=Object.values(n.features).find((function(e){return e instanceof Hc})),i=n.readOnly||!r||r.disabled;e.touches||0!==e.button||t.disabled||(e.target.matches(t.targetSelector)||i&&e.target.closest(n.eventSelector))&&(t.mouseX=e.clientX,t.mouseY=e.clientY)}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||ge.isSafari||ge.isIE11&&!e.isTrusted){if("number"==typeof t.mouseX){var n=t.timeline.subGrids.normal.scrollable,r=t.timeline.scrollable,i=e.clientX,o=e.clientY;e.preventDefault(),t.vertical&&r.scrollBy(0,t.mouseY-o),n.scrollBy(t.mouseX-i),t.mouseX=i,t.mouseY=o}}else t.onElementMouseUp()}},{key:"onElementMouseUp",value:function(e){this.mouseX=this.mouseY=null}}],[{key:"$name",get:function(){return"Pan"}},{key:"defaultConfig",get:function(){return{vertical:!0}}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),t}(ai);yh._$name="Pan",Xs.registerFeature(yh,!1,["Scheduler","Gantt"]);var kh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){this.isConstructing=!0,se()(oe()(t.prototype),"construct",this).call(this,e,n),this.isConstructing=!1}},{key:"afterConstruct",value:function(){this.disabled||!this.isRecurrenceSupported?this.disableRecurringTimeSpans():this.enableRecurringTimeSpans()}},{key:"enableRecurringTimeSpans",value:function(){var e=this.client,t=this.store;e&&t&&(this.bindClient(e),this.bindStore(t),this.refreshOccurrences())}},{key:"disableRecurringTimeSpans",value:function(){this.bindClient(null),this.bindStore(null),this.store&&this.removeOccurrences()}},{key:"suspendTracking",value:function(){isNaN(this._trackingSuspended)&&(this._trackingSuspended=0),this._trackingSuspended++}},{key:"resumeTracking",value:function(){isNaN(this._trackingSuspended)?this._trackingSuspended=0:this._trackingSuspended--}},{key:"bindClient",value:function(e){this.bindTimeAxis(e&&e.timeAxis)}},{key:"bindStore",value:function(e){var t=this;t.storeDetacher&&t.storeDetacher(),e&&(t.storeDetacher=e.on({refresh:t.onTimeSpansRefresh,add:t.onTimeSpanAdd,update:t.onTimeSpanUpdate,remove:t.onTimeSpanRemove,delayedgenerateoccurrencesstart:t.onGenerateOccurrencesStart,delayedgenerateoccurrencesend:t.onGenerateOccurrencesEnd,delayedregenerateoccurrencesstart:t.onGenerateOccurrencesStart,delayedregenerateoccurrencesend:t.onGenerateOccurrencesEnd,thisObj:t}))}},{key:"bindTimeAxis",value:function(e){this.timeAxisDetacher&&this.timeAxisDetacher(),e&&(this.timeAxisDetacher=e.on({reconfigure:this.onTimeAxisReconfigure,thisObj:this}))}},{key:"onTimeAxisReconfigure",value:function(){this.trackingSuspended||this.refreshOccurrences()}},{key:"onGenerateOccurrencesStart",value:function(){this.suspendTracking()}},{key:"onGenerateOccurrencesEnd",value:function(){this.resumeTracking()}},{key:"refreshOccurrences",value:function(){var e=this.store,t=this.startDate,n=this.endDate;e&&t&&n&&e.generateOccurrencesForTimeSpansBuffered(e.getRecurringTimeSpans(),t,n)}},{key:"removeOccurrences",value:function(){var e=this.store;e&&e.removeOccurrencesForAll()}},{key:"onTimeSpansRefresh",value:function(e){var t=e.source,n=e.action,r=e.records;if("dataset"==n&&!this.trackingSuspended){var i=r.filter((function(e){return e.isRecurring}));i.length&&t.generateOccurrencesForTimeSpansBuffered(i,this.startDate,this.endDate)}}},{key:"onTimeSpanAdd",value:function(e){var t=e.source,n=e.records,r=e.allRecords;if(!this.trackingSuspended){var i=(r||n).filter((function(e){return e.isRecurring}));i.length&&t.generateOccurrencesForTimeSpansBuffered(i,this.startDate,this.endDate)}}},{key:"onTimeSpanUpdate",value:function(e){var t=e.source,n=e.record,r=e.changes;if(!this.trackingSuspended&&this.isRecurrenceRelatedFieldChange(n,r)){var i=this.startDate,o=this.endDate,a=n.startDate,s=n.recurrence;s?i&&o&&a&&(!s.endDate||s.endDate>=i&&a<=o)&&t.regenerateOccurrencesForTimeSpansBuffered(n,i,o):t.removeOccurrencesForTimeSpans(n)}}},{key:"onTimeSpanRemove",value:function(e){var t=e.source,n=e.allRecords,r=e.records;if(!this.trackingSuspended){var i=(n||r).filter((function(e){return e.isRecurring}));i.length&&t.removeOccurrencesForTimeSpans(i)}}},{key:"isRecurrenceRelatedFieldChange",value:function(e,t){return e.isRecurring||"recurrenceRule"in t}},{key:"disabled",get:function(){return se()(oe()(t.prototype),"disabled",this)},set:function(e){fn()(oe()(t.prototype),"disabled",e,this,!0);this.isConstructing||(e||!this.isRecurrenceSupported?this.disableRecurringTimeSpans():this.enableRecurringTimeSpans())}},{key:"trackingSuspended",get:function(){return Boolean(this._trackingSuspended)}},{key:"client",get:function(){return se()(oe()(t.prototype),"client",this)},set:function(e){fn()(oe()(t.prototype),"client",e,this,!0),this.isConstructing||this.bindClient(e)}},{key:"store",set:function(e){var t=this;e=e&&e.supportsRecurringTimeSpans?e:null,t._store=e,t.isConstructing||(t.bindStore(e),t.isRecurrenceSupported&&!t.disabled?t.enableRecurringTimeSpans():t.disableRecurringTimeSpans())},get:function(){return this._store}},{key:"isRecurrenceSupported",get:function(){var e=this.store,t=this.startDate,n=this.endDate;return Boolean(e&&e.supportsRecurringTimeSpans&&t&&n)}},{key:"timeAxis",get:function(){return this.client&&this.client.timeAxis}},{key:"startDate",get:function(){return this.timeAxis&&this.timeAxis.startDate}},{key:"endDate",get:function(){return this.timeAxis&&this.timeAxis.endDate}}],[{key:"$name",get:function(){return"RecurringTimeSpans"}},{key:"defaultConfig",get:function(){return{store:void 0}}}]),t}(ai);kh._$name="RecurringTimeSpans",Xs.registerFeature(kh,!1,"Scheduler");var bh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"bindClient",value:function(e){var n=this;se()(oe()(t.prototype),"bindClient",this).call(this,e),n._eventPanelDetacher&&n._eventPanelDetacher(),e&&(n._eventPanelDetacher=e.on({beforeeventdropfinalize:n.onBeforeEventDropFinalize,beforeeventresizefinalize:n.onBeforeEventResizeFinalize,beforeEventDelete:n.onRecurrableEventBeforeDelete,thisObj:n}))}},{key:"onEventStoreChange",value:function(e){var t=e.newEventStore;e.oldEventStore;this.store=t}},{key:"showDisplayConfirmationOnEventDelete",value:function(e){var t=this.client.features.eventEdit;return e.supportsRecurring&&(e.isRecurring||e.isOccurrence)&&(!t||!t.isEditing||t.eventRecord!==e)}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=fe()(t,1)[0];if(this.showDisplayConfirmationOnEventDelete(r))return this.confirmationPopup.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"onBeforeEventDropFinalize",value:function(e){var t=e.context,n=t.record;n.supportsRecurring&&(n.isRecurring||n.isOccurrence)&&(t.async=!0,this.confirmationPopup.confirm({actionType:"update",eventRecord:n,changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}},{key:"onBeforeEventResizeFinalize",value:function(e){var t=e.context,n=t.eventRecord;n.supportsRecurring&&(n.isRecurring||n.isOccurrence)&&(t.async=!0,this.confirmationPopup.confirm({actionType:"update",eventRecord:n,changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}},{key:"client",get:function(){return se()(oe()(t.prototype),"client",this)},set:function(e){fn()(oe()(t.prototype),"client",e,this,!0),e&&(this._onEventStoreChangeDetacher&&this._onEventStoreChangeDetacher(),this._onEventStoreChangeDetacher=e.on("eventstorechange",this.onEventStoreChange,this)),this.store=e?e.eventStore:null}},{key:"confirmationPopup",get:function(){return this._confirmationPopup||(this._confirmationPopup=new $c),this._confirmationPopup},set:function(e){this._confirmationPopup=e}}],[{key:"$name",get:function(){return"RecurringEvents"}}]),t}(kh);bh._$name="RecurringEvents",Xs.registerFeature(bh,!1,"Scheduler");var wh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"noFeatureElementsInAxis",value:function(){var e=this.scheduler.timeAxis;return!this.store.storage.values.some((function(t){return e.isTimeSpanInAxis(t)}))}},{key:"construct",value:function(e,n){var r=this;r.scheduler=e,se()(oe()(t.prototype),"construct",this).call(this,e,n),Object.defineProperty(e,"resourceTimeRanges",{get:function(){return r.store.records},set:function(e){return r.store.data=e}})}},{key:"doDisable",value:function(e){this.client.isPainted&&this.client.refresh(),se()(oe()(t.prototype),"doDisable",this).call(this,e)}},{key:"getEventsToRender",value:function(e,t){return e.timeRanges&&e.timeRanges.length&&!this.disabled&&t.push.apply(t,G()(e.timeRanges)),t}},{key:"onEventDataGenerated",value:function(e){var t=this,n=e.event||e.eventRecord;n.isResourceTimeRange&&(t.scheduler.isVertical?e.width=t.scheduler.resourceColumnWidth:(e.top=0,e.id="".concat(t.scheduler.id,"-").concat(t.idPrefix,"-").concat(n.id)),e.fillSize=!0,e.eventId="".concat(t.idPrefix,"-").concat(n.id),e.wrapperCls[t.rangeCls]=1,e.wrapperCls["b-sch-color-".concat(n.timeRangeColor)]=n.timeRangeColor,e.body=document.createDocumentFragment(),e.body.textContent=n.name)}},{key:"onStoreChange",value:function(e){this.scheduler.onInternalEventStoreChange(e)}},{key:"store",set:function(e){var t=this,n=t.scheduler;t._store=e=e||new vc,n.resourceTimeRangeStore||(n.resourceTimeRangeStore=e),n.resourceTimeRanges&&(e.add(n.resourceTimeRanges),delete n.resourceTimeRanges),e.resourceStore||(e.resourceStore=n.resourceStore),t.storeDetacher&&t.storeDetacher(),t.storeDetacher=t.store.on({change:t.onStoreChange,thisObj:t})},get:function(){return this._store}}],[{key:"$name",get:function(){return"ResourceTimeRanges"}},{key:"defaultConfig",get:function(){return{idPrefix:"resourcetimerange",rangeCls:"b-sch-resourcetimerange",store:!1,resourceTimeRanges:null}}},{key:"pluginConfig",get:function(){return{chain:["getEventsToRender","onEventDataGenerated","noFeatureElementsInAxis"]}}}]),t}(ai);wh.featureClass="",wh._$name="ResourceTimeRanges",Xs.registerFeature(wh,!1,"Scheduler");var Sh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r,i=this;i.scheduler=e,i.eventStore=e.eventStore,e.eventEdit=i,se()(oe()(t.prototype),"construct",this).call(this,e,n),i.clientListenersDetacher=e.on((r={},$()(r,i.triggerEvent,(function(e){var t=e.eventRecord,n=e.eventElement;return i.editEvent(t,t.resource,n)})),$()(r,"dragcreateend",i.onDragCreateEnd),$()(r,"thisObj",i),r))}},{key:"doDestroy",value:function(){this.clientListenersDetacher(),this.editor&&this.editor.destroy(),se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"editEvent",value:function(e,t,n){var r=this,i=r.scheduler;i.readOnly||r.disabled||(n=rn.down(n,i.eventInnerSelector)||n,e=e instanceof Iu?e.event:e,r.resource=t,r.event=e,r.element=n,i.element.classList.add("b-eventeditor-editing"),r.editor||(r.editor=new no(Object.assign({owner:r.scheduler.timeAxisSubGrid,appendTo:r.scheduler.timeAxisSubGridElement,scrollAction:"realign",cls:"b-simpleeventeditor",listeners:{complete:r.onEditorComplete,cancel:r.onEditorCancel,thisObj:r}},r.editorConfig)),r.relayEvents(r.editor,["beforestart","start","beforecomplete","complete","beforecancel","cancel"])),r.editor.startEdit({target:n,record:e,field:r.field}))}},{key:"onEditorComplete",value:function(){var e=this;0===e.event.stores.length&&(e.eventStore.add(e.editor.record),e.event.assign(e.resource)),e.element&&e.element.classList.contains("b-sch-dragcreator-proxy")&&e.element.remove(),e.scheduler.element.classList.remove("b-eventeditor-editing")}},{key:"onEditorCancel",value:function(){0===this.event.stores.length&&this.element.remove(),this.scheduler.element.classList.remove("b-eventeditor-editing")}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord,r=t?this.scheduler.getElementFromAssignmentRecord(t):this.scheduler.getElementFromEventRecord(n),i=(t||n).resource;this.editEvent(n,i,r)}},{key:"onDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=e.proxyElement;this.scheduler.onEventCreated(t);var i=r.cloneNode(!0);i.removeAttribute("id"),r.parentElement.appendChild(i),this.element=i,this.editEvent(t,n,i)}}],[{key:"$name",get:function(){return"SimpleEventEdit"}},{key:"defaultConfig",get:function(){return{triggerEvent:"eventdblclick",eventRecord:null,field:"name",editorConfig:null}}},{key:"pluginConfig",get:function(){return{chain:["onEventEnterKey"],assign:["editEvent"]}}}]),t}(ai);Sh._$name="SimpleEventEdit",Xs.registerFeature(Sh,!1,"Scheduler");var Ch=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;Object.assign(r,{grid:e,store:e.store}),se()(oe()(t.prototype),"construct",this).call(this,e,n),r.store.on({change:r.onStoreChanged,thisObj:r}),r.grid.eachSubGrid((function(e){e.footer||(e.footer=new ql({subGrid:e,parent:e}))}))}},{key:"doDestroy",value:function(){se()(oe()(t.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){se()(oe()(t.prototype),"doDisable",this).call(this,e),e?this.grid.element.classList.add("b-summary-disabled"):(this.updateSummaries(),this.grid.element.classList.remove("b-summary-disabled"))}},{key:"renderRows",value:function(){this.updateSummaries()}},{key:"updateSummaries",value:function(){var e=this,t=e.grid,n=e.store,r=rn.children(t.element,".b-grid-footer"),i=n.storage.values.filter((function(e){return!e.meta.specialRow}));t.columns.forEach((function(e){e.summaries&&e.summaries.forEach((function(e){"seed"in e&&("initialSeed"in e||(e.initialSeed=e.seed),["number","string","date"].includes(U()(e.initialSeed))?e.seed=e.initialSeed:e.seed=Object.assign({},e.initialSeed))}))})),r.forEach((function(n){var r=t.columns.get(n.dataset.column),o=e.generateHtml(r,i,"b-grid-footer-summary");(r.summaries?r.summaries.length:!!r.sum)&&(n.children.length?rn.sync(o,n.firstElementChild):n.innerHTML=o)}))}},{key:"onStoreChanged",value:function(e){var t=this,n=e.action,r=e.changes,i=!0;this.disabled||("update"===n&&(i=Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))),i&&this.updateSummaries())}}],[{key:"$name",get:function(){return"Summary"}},{key:"pluginConfig",get:function(){return{chain:["renderRows"]}}}]),t}(fd(ai));Ch.featureClass="b-summary",Ch._$name="Summary",Xs.registerFeature(Ch);var Eh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;if(e.isVertical)throw new Error("Summary feature is not supported in vertical mode");r.scheduler=e,se()(oe()(t.prototype),"construct",this).call(this,e,n),r.summaries||(r.summaries=[{renderer:r.renderer}]),e instanceof lh&&(e.eventStore.on({change:r.updateScheduleSummaries,thisObj:r}),e.resourceStore.on({change:r.updateScheduleSummaries,thisObj:r}),e.timeAxisViewModel.on({update:r.renderRows,thisObj:r}))}},{key:"renderRows",value:function(){se()(oe()(t.prototype),"renderRows",this).call(this),this.render()}},{key:"updateScheduleSummaries",value:function(){var e=this,t=e.scheduler,n=t.element.querySelector(".b-grid-footer.b-sch-timeaxiscolumn");n&&rn.forEachSelector(n,".b-timeaxis-tick",(function(n,r){var i=t.timeAxis.getAt(r),o=t.eventStore.getEventsInTimeSpan(i.startDate,i.endDate,!0,!0),a="",s="<header>".concat(e.L("Summary for")," ").concat(t.getFormattedDate(i.startDate),"</header>");e.summaries.forEach((function(r){var l=r.renderer({startDate:i.startDate,endDate:i.endDate,eventStore:t.eventStore,resourceStore:t.resourceStore,events:o,element:n}),u='<div class="b-timeaxis-summary-value">'.concat(l,"</div>");(e.summaries.length>1||""!==l)&&(a+=u),s+="<label>".concat(r.label||"","</label>")+u})),n.innerHTML=a,n._tipHtml=s}))}},{key:"render",value:function(){var e=this,t=e.scheduler,n=t.element.querySelector(".b-grid-footer.b-sch-timeaxiscolumn");n&&(e.summaries.some((function(e){return e.label}))&&e.showTooltip&&!e._tip&&(e._tip=new Ur({id:"".concat(t.id,"-summary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:100,forElement:n,anchorToTarget:!0,trackMouse:!1,forSelector:".b-timeaxis-tick",getHtml:function(e){return e.forElement._tipHtml}})),n.innerHTML='<div class="b-timeaxis-tick" style="width: '.concat(t.tickSize,'px"></div>').repeat(t.timeAxis.count),e.updateScheduleSummaries())}}],[{key:"$name",get:function(){return"Summary"}},{key:"defaultConfig",get:function(){return{showTooltip:!0,summaries:null,renderer:null}}}]),t}(Ch);Eh._$name="Summary",Eh._$name="Summary",Xs.registerFeature(Eh,!1,"Scheduler");var xh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(e,n){var r=this;se()(oe()(t.prototype),"construct",this).call(this,e,n),e._timeRangesExposed||(Object.defineProperty(e,"timeRanges",{get:function(){return r.store.records},set:function(e){return r.store.data=e}}),e._timeRangesExposed=!0)}},{key:"startConfigure",value:function(e){var t=this.client;if(t.project){var n=t.project.timeRangeStore;n&&(e.store=n)}}},{key:"initCurrentTimeLine",value:function(){var e=this,t=new Date;!e.currentTimeLine&&e.showCurrentTimeLine&&(e.currentTimeLine=new e.store.modelClass({id:"currentTime",cls:"b-sch-current-time",startDate:t,name:vt.format(t,e.currentDateFormat)}),e.updateCurrentTimeLine=e.updateCurrentTimeLine.bind(e),e.currentTimeInterval=e.setInterval(e.updateCurrentTimeLine,e.updateCurrentTimeLineInterval),e.client.isPainted&&e.renderRanges())}},{key:"updateCurrentTimeLine",value:function(){var e=this;e.currentTimeLine.startDate=new Date,e.currentTimeLine.name=vt.format(e.currentTimeLine.startDate,e.currentDateFormat),e.onStoreChanged({action:"update",record:e.currentTimeLine,changes:{}})}},{key:"hideCurrentTimeLine",value:function(){var e=this;e.currentTimeLine&&(e.clearInterval(e.currentTimeInterval),e.currentTimeLine=null,e.client.isPainted&&e.renderRanges())}},{key:"renderRanges",value:function(){se()(oe()(t.prototype),"renderRanges",this).call(this),this.showCurrentTimeLine&&!this.disabled&&this.renderRange(this.currentTimeLine,!0)}},{key:"getHeaderMenuItems",value:function(e,t){var n=this;t.some((function(e){return e.isCurrentTimeline}))||"timeAxis"!==e.type||t.push({isCurrentTimeline:!0,text:n.L("showCurrentTimeLine"),checked:n.showCurrentTimeLine,onToggle:function(e){var t=e.checked;n.showCurrentTimeLine=t}})}},{key:"showCurrentTimeLine",get:function(){return this._showCurrentTimeLine},set:function(e){this._showCurrentTimeLine=e,e?this.initCurrentTimeLine():this.hideCurrentTimeLine()}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this.client.isPainted&&this.renderRanges()}},{key:"store",get:function(){return this._store},set:function(e){var n=this,r=n.client;e.storeId||(e.storeId="timeRanges"),fn()(oe()(t.prototype),"store",e,this,!0),r.timeRanges&&!r._timeRangesExposed&&(n._store.add(r.timeRanges),delete r.timeRanges),n.timeRanges&&(n._store.add(n.timeRanges),delete n.timeRanges)}}],[{key:"$name",get:function(){return"TimeRanges"}},{key:"defaultConfig",get:function(){return{store:{modelClass:Hu,storeId:"timeRanges"},updateCurrentTimeLineInterval:1e4,currentDateFormat:"HH:mm",timeRanges:null,showCurrentTimeLine:!1}}}]),t}(mh);xh._$name="TimeRanges",Xs.registerFeature(xh,!1,["Scheduler","Gantt"]);var Dh={completeview:"completeview",currentview:"currentview",daterange:"daterange"},Th=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"buildLocalizedItems",value:function(){var e=this;return Object.entries(Dh).map((function(t){var n=fe()(t,2),r=n[0],i=n[1];return{id:r,text:e.L(i)}}))}}],[{key:"$name",get:function(){return"ScheduleRangeCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),t}(Il);Th._$name="ScheduleRangeCombo",X.register(Th.$name.toLowerCase(),Th);var Rh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"onLocaleChange",value:function(){var e=this.L("labelWidth");this.width=this.L("width"),this.items.forEach((function(t){t instanceof ri?t.labelWidth=e:"rangeFieldsContainer"===t.ref&&(t.items[0].width=e)}))}},{key:"buildDialogItems",value:function(e){var n=this,r=e.client,i=se()(oe()(t.prototype),"buildDialogItems",this).call(this,e),o=n.L("labelWidth");n.columnsStore=r.columns.chain((function(e){return e.isLeaf&&!(e instanceof th)}));var a=i.find((function(e){return"columnsField"===e.ref}));return a.store=n.columnsStore,a.value=n.columnsStore.allRecords,i.splice(1,0,{labelWidth:o,type:"schedulerangecombo",ref:"scheduleRangeField",label:"L{Schedule range}",localeClass:n,value:Dh.completeview,onChange:function(e){var t=e.value!==Dh.daterange,n=this.owner.widgetMap;n.rangeStartField.hidden=n.rangeEndField.hidden=t}},{type:"container",ref:"rangeFieldsContainer",flex:"1 0 100%",items:[{type:"widget",width:o},{type:"datefield",ref:"rangeStartField",label:"L{Export from}",hidden:!0,flex:"1 0 25%",localeClass:n,value:e.client.startDate},{type:"datefield",ref:"rangeEndField",label:"L{Export to}",hidden:!0,flex:"1 0 25%",localeClass:n,value:e.client.endDate}]}),i}}],[{key:"$name",get:function(){return"SchedulerExportDialog"}}]),t}(Pl);Rh._$name="SchedulerExportDialog";var Mh=function(e){return function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n,r,i,o;return ue()(t,e),x()(t,[{key:"scrollRowIntoView",value:(o=Di()(Ei.a.mark((function e(t,n){var r,i,o;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],i=!1,o=t.timeAxisSubGrid.scrollable.on({scrollstart:function(e){null!=e.x&&(i=!0)}}),r.push(t.scrollRowIntoView(t.store.getAt(n),{block:"start"})),o(),i&&r.push(new Promise((function(e){t.rowManager.on({renderDone:function(){e()},once:!0})}))),e.abrupt("return",Promise.all(r));case 7:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"scrollToDate",value:(i=Di()(Ei.a.mark((function e(t,n){var r,i,o;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,i=[],o=t.timeAxisSubGrid.scrollable.on({scrollstart:function(e){null!=e.x&&(r=!0)}}),i.push(t.scrollToDate(n)),o(),r&&(i.push(new Promise((function(e){t.timeView.on({refresh:function(){e()},once:!0})}))),t.features.dependencies&&!t.features.dependencies.disabled&&i.push(new Promise((function(e){t.on({dependenciesDrawn:function(){e()},once:!0})})))),e.next=7,Promise.all(i);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"prepareComponent",value:(r=Di()(Ei.a.mark((function e(n){var r,i,o,a,s,l,u,c,d,h,f;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this,i=n.client,e.t0=n.scheduleRange,e.next=e.t0===Dh.completeview?4:e.t0===Dh.currentview?7:11;break;case 4:return n.rangeStart=i.startDate,n.rangeEnd=i.endDate,e.abrupt("break",11);case 7:return o=i.getVisibleDateRange(),a=o.startDate,s=o.endDate,n.rangeStart=a,n.rangeEnd=s,e.abrupt("break",11);case 11:return i.setTimeSpan(n.rangeStart,n.rangeEnd),e.next=14,se()(oe()(t.prototype),"prepareComponent",this).call(this,n);case 14:if(l=r.exportMeta,u=r.element.querySelector(".b-sch-foreground-canvas"),c=r.element.querySelector(".b-horizontaltimeaxis"),n.scheduleRange!==Dh.completeview&&(l.totalWidth-=l.subGrids.normal.width,l.totalWidth+=l.subGrids.normal.width=i.timeAxisViewModel.getDistanceBetweenDates(n.rangeStart,n.rangeEnd),l.subGrids.normal.scrollLeft=i.getCoordinateFromDate(n.rangeStart)),l.timeAxisHeaders=[],l.timeAxisPlaceholders=[],l.headersColleted=!1,rn.forEachSelector(c,".b-sch-header-row",(function(e){l.timeAxisPlaceholders.push(r.createPlaceholder(e)),l.timeAxisHeaders.push(new Map)})),l.subGrids.normal.eventsPlaceholder=r.createPlaceholder(u,!1),rn.removeEachSelector(u,".b-sch-event-wrap"),l.eventsBoxes=new Map,l.client=i,!i.features.dependencies||i.features.dependencies.disabled){e.next=30;break}return d=r.element.querySelector('[id="'.concat(i.svgCanvas.getAttribute("id"),'"]')),l.dependenciesPlaceholder=d,rn.removeEachSelector(d,".b-sch-dependency"),e.next=30,new Promise((function(e){i.on({dependenciesDrawn:function(){e()},once:!0}),i.features.dependencies.scheduleDraw()}));case 30:if(vt.betweenLesser(n.rangeStart,i.startDate,i.endDate)){e.next=33;break}return e.next=33,r.scrollToDate(i,n.rangeStart);case 33:h=Math.ceil(l.totalWidth/l.pageWidth),f=h*l.verticalPages,l.horizontalPages=h,l.totalPages=f;case 36:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onRowsCollected",value:(n=Di()(Ei.a.mark((function e(n,r){var i,o,a,s,l,u,c;return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se()(oe()(t.prototype),"onRowsCollected",this).call(this,n),i=this,o=r.client,a=o.timeView,s=i.getCurrentPageDateRange(r),l=s.pageRangeStart,u=s.pageRangeEnd,c=!1,e.next=5,i.scrollToDate(o,l);case 5:if(c){e.next=20;break}if(i.collectHeaders(r),i.collectEvents(n,r),!vt.timeSpanContains(a.startDate,a.endDate,l,u)){e.next=12;break}c=!0,e.next=18;break;case 12:if(!(a.endDate.getTime()>=u.getTime())){e.next=16;break}c=!0,e.next=18;break;case 16:return e.next=18,i.scrollToDate(o,a.endDate);case 18:e.next=5;break;case 20:return e.next=22,i.scrollToDate(o,r.rangeStart);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getCurrentPageDateRange",value:function(e){var t,n,r=e.rangeStart,i=e.rangeEnd,o=e.client,a=this.exportMeta,s=a.horizontalPages,l=a.horizontalPosition,u=a.pageWidth,c=a.subGrids;if(s>1){var d=l*u,h=(l+1)*u,f=c.locked.width;h<=f?n=t=null:(t=o.getDateFromCoordinate(Math.max(d-f,0)),n=o.getDateFromCoordinate(1.2*(h-f))||i)}else t=r,n=i;return{pageRangeStart:t,pageRangeEnd:n}}},{key:"prepareExportElement",value:function(){var e=this.element,n=this.exportMeta,r=n.subGrids.normal,i=r.id,o=r.headerId,a=r.footerId,s=r.scrollLeft,l=e.querySelector('[id="'.concat(i,'"]'));return[".b-sch-background-canvas",".b-sch-foreground-canvas"].forEach((function(e){var t=l.querySelector(e);n.lastExportedRowBottom?t.style.height="".concat(n.lastExportedRowBottom,"px"):t.style.height="",s&&(t.style.marginLeft="-".concat(s,"px"))})),s&&[o,a].forEach((function(t){var n=e.querySelector('[id="'.concat(t,'"] .b-widget-scroller'));n&&(n.style.marginLeft="-".concat(s,"px"))})),se()(oe()(t.prototype),"prepareExportElement",this).call(this)}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=fe()(n,2),i=r[0],o=[r[1].outerHTML,e.top,e.offsetHeight];"normal"===i&&o.push(new Map),t[i].rows.push(o)}))}},{key:"collectHeaders",value:function(e){var t=e.client,n=this.exportMeta;if(!n.headersCollected){var r=t.timeView.element,i=n.timeAxisHeaders;rn.forEachSelector(r,".b-sch-header-row",(function(e,r,o){var a=i[r];rn.forEachSelector(e,".b-sch-header-timeaxis-cell",(function(e){a.has(e.dataset.tickIndex)||a.set(e.dataset.tickIndex,e.outerHTML)})),r===o.length-1&&a.has(t.timeAxis.count-1)&&(n.headersColleted=!0)}))}}},{key:"collectEvents",value:function(e,t){var n=e.length,r=t.client,i=this.exportMeta.subGrids.normal.rows;e.forEach((function(e,t){var o=i[i.length-n+t],a=r.store.getAt(e.dataIndex),s=o[3];a.events.forEach((function(e){if(e.isScheduled){var t=r.getElementFromEventRecord(e,a);t&&(t=t.parentElement)&&!s.has(e.id)&&s.set(e.id,[t.outerHTML,Oe.from(t,t.offsetParent)])}}))}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta,n=t.subGrids,r=t.timeAxisHeaders,i=t.timeAxisPlaceholders,o=e.prepareExportElement();return Object.values(n).forEach((function(t){var n=t.placeHolder,r=t.eventsPlaceholder,i=t.rows,a=n.outerHTML,s=e.positionRows(i),l=s.resources,u=s.events;o=o.replace(a,l.join("")),r&&(o=o.replace(r.outerHTML,u.join("")))})),r.forEach((function(e,t){o=o.replace(i[t].outerHTML,Array.from(e.values()).join(""))})),o=e.buildDependenciesHtml(o)}},{key:"getDependenciesOuterHTML",value:function(){var e,t=this.exportMeta.dependenciesPlaceholder;if(ge.isIE11){var n=document.createElement("div"),r=t.cloneNode(!0);n.appendChild(r),e=n.innerHTML}else e=t.outerHTML;return e}},{key:"renderDependencies",value:function(){var e=this.exportMeta,t=e.client,n=e.dependenciesPlaceholder,r=e.eventsBoxes,i=t.dependencies,o=t.features.dependencies,a=Array.from(r.keys());i.filter((function(e){return a.includes(String(e.from))||a.includes(String(e.to))})).forEach((function(e){var t=r.get(String(e.from)),i=r.get(String(e.to)),a=e.sourceEvent,s=e.targetEvent;if(!t&&a){var l=o.getBox(e,!0);l&&(t=l instanceof Oe?l:new Oe(l.start,l.top,l.end-l.start,l.bottom-l.top))}if(!i&&s){var u=o.getBox(e,!1);u&&(i=u instanceof Oe?u:new Oe(u.start,u.top,u.end-u.start,u.bottom-u.top))}var c={startRectangle:t&&t.clone(),endRectangle:i&&i.clone()};t&&i&&o.drawDependency(e,c,null,n,!1)}));var s=this.getDependenciesOuterHTML();return rn.removeEachSelector(n,".b-sch-dependency"),s}},{key:"buildDependenciesHtml",value:function(e){if(this.exportMeta.dependenciesPlaceholder){var t=this.getDependenciesOuterHTML();e=e.replace(t,this.renderDependencies())}return e}}]),t}(e)},Fh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"collectDependencies",value:function(){}},{key:"positionRows",value:function(e){var t=this,n=0,r=[],i=[],o=/translate\((\d+.?\d*)px, (\d+.?\d*)px\)/;return e.forEach((function(e){var a=fe()(e,4),s=a[0],l=a[1],u=a[2],c=a[3];r.push(s.replace(o,"translate($1px, ".concat(n,"px)")));var d=n-l;c&&Array.from(c.entries()).forEach((function(e){var n=fe()(e,2),r=n[0],a=fe()(n[1],2),s=a[0],l=a[1];l.translate(0,d),t.exportMeta.eventsBoxes.set(String(r),l),i.push(s.replace(o,"translate($1px, ".concat(l.y,"px)")))})),n+=u})),{resources:r,events:i}}}]),t}(Mh(_l));Fh._$name="SinglePageExporter";var _h=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}var n;return ue()(t,e),x()(t,[{key:"stateNextPage",value:(n=Di()(Ei.a.mark((function e(n){return Ei.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se()(oe()(t.prototype),"stateNextPage",this).call(this,n);case 2:this.exportMeta.eventsBoxes.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=this,n=[],r=[];return e.forEach((function(e){var i=fe()(e,4),o=i[0],a=(i[1],i[2],i[3]);n.push(o),a&&Array.from(a.entries()).forEach((function(e){var n=fe()(e,2),i=n[0],o=fe()(n[1],2),a=o[0],s=o[1];r.push(a),t.exportMeta.eventsBoxes.set(String(i),s)}))})),{resources:n,events:r}}}]),t}(Mh(Fl));_h._$name="MultiPageExporter";var Ah=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"showExportDialog",value:function(){var e=this;e.exportDialog||(e.exportDialog=new Rh({client:e.client,exporters:e.exporters,listeners:{export:e.onExportDialogExport,thisObj:e}}),e.client.on({export:function(t){var n=t.response,r=t.error;e.exportDialog.close(),!r&&n.ok||te.toast("Export failed")}})),e.exportDialog.show()}},{key:"buildExportConfig",value:function(e){e=se()(oe()(t.prototype),"buildExportConfig",this).call(this,e);var n=this.scheduleRange,r=this.rangeStart,i=this.rangeEnd;return e.columns&&!e.columns.find((function(e){return"timeAxis"===e.type}))&&e.columns.push(e.client.timeAxisColumn.id),kt.assign({scheduleRange:n,rangeStart:r,rangeEnd:i},e)}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exporters:[Fh,_h],scheduleRange:"completeview",rangeStart:null,rangeEnd:null}}}]),t}(Hl);Ah._$name="PdfExport",Xs.registerFeature(Ah,!1,"Scheduler");n(184);var Ih=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"normalizeColumns",value:function(e){se()(oe()(t.prototype),"normalizeColumns",this).call(this,e),e.eventColumns=e.eventColumns.map((function(e){return"string"==typeof e?{field:e}:e}))}},{key:"generateExportData",value:function(e){var t=this.target instanceof lh,n=this.generateColumns(e),r=t?this.generateEventColumns(e):[];return{columns:n.concat(r),rows:this.generateRows(e)}}},{key:"generateEventColumns",value:function(e){var t=this;return e.eventColumns.map((function(n){return t.processEventColumn(n,e)}))}},{key:"processEventColumn",value:function(e,t){var n=e.width,r=e.minWidth,i=t.defaultColumnWidth;return{field:e.field,value:e.text,width:Math.max(n||i,r||i),eventColumn:!0,type:this.getColumnType(e,this.target.eventStore)}}},{key:"generateRows",value:function(e){var n,r=this,i=r.target;if(i instanceof lh){if(n=[],i.resourceStore.map((function(t){var i=t.events||[];i.length||i.push(""),i.forEach((function(i){return n.push(r.getRowData(e,t,i))}))})),e.includeUnassigned&&e.eventColumns.length){var o=i.eventStore.query((function(e){return!e.resources.length&&!i.resourceStore.isAvailable(e)}));if(o.length){var a=new Array(e.columns.length).fill("");a.push(r.L("No resource assigned")),n.push(a),o.forEach((function(t){return n.push(r.getRowData(e,null,t))}))}}n=n.filter((function(e){return e.length}))}else n=se()(oe()(t.prototype),"generateRows",this).call(this,e);return n}},{key:"getRowData",value:function(e,t,n){var r=e.columns,i=e.eventColumns,o=[];return o.push.apply(o,G()(this.processRecord(t,r,e))),t&&t.meta.specialRow||o.push.apply(o,G()(this.processRecord(n,i,e))),o}}],[{key:"defaultConfig",get:function(){return{includeUnassigned:!0,eventColumns:[{text:"Task",field:"name"},{text:"Starts",field:"startDate",width:140},{text:"Ends",field:"endDate",width:140}]}}}]),t}(Ve(Nl));Ih._$name="ScheduleTableExporter";var Lh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,null,[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{exporterClass:Ih,exporterConfig:null}}}]),t}(zl);Lh._$name="ExcelExporter",Xs.registerFeature(Lh,!1,"Scheduler");var Oh=function(e){function t(){return C()(this,t),re()(this,oe()(t).apply(this,arguments))}return ue()(t,e),x()(t,[{key:"construct",value:function(){var e=this;se()(oe()(t.prototype),"construct",this).apply(this,arguments),e.grid.isPainted?e.addErrorListener():e.grid.on({paint:e.addErrorListener,thisObj:e,once:!0})}},{key:"getImageURL",value:function(e){return A.joinPaths([this.imagePath||"",e||""])}},{key:"addErrorListener",value:function(){var e=this;Ln.on({element:this.grid.element,delegate:".b-resource-image",error:function(t){return e.setDefaultResourceImage(t.target)},capture:!0})}},{key:"setDefaultResourceImage",value:function(e){var t=this.getImageURL(this.defaultImageName);e.src&&!e.src.endsWith(t.replace(/\.\.\//gm,""))&&(e.src=t)}},{key:"template",value:function(e){var t,n=this,r=n.showImage,i=n.showRole,o=n.showEventCount,a=e["string"==typeof i?i:"role"],s=e.events.length,l=e.get(n.field);if(r)if(e.imageUrl)t=e.imageUrl;else{var u="string"==typeof r?r:e.image||l&&l.toLowerCase()||n.defaultImageName;t=n.getImageURL(u),u.includes(".")||(!n.validNames||n.validNames.includes(u)?t+=".jpg":t=n.getImageURL(n.defaultImageName))}return'\n            <div class="b-resource-info">\n                '.concat(t?'<img class="b-resource-image" draggable="false" src="'.concat(t,'">'):"","\n                <dl>\n                <dt>").concat(l,"</dt>\n                ").concat(i?'<dd class="b-resource-role">'.concat(a,"</dd>"):"","\n                ").concat(o?'<dd class="b-resource-events">'.concat(n.L("eventCountText",s),"</dd>"):"","\n                </dl>\n            </div>\n        ")}},{key:"defaultRenderer",value:function(e){var t,n=e.grid,r=e.record,i=e.cellElement,o=e.value,a=e.isExport;return r.meta.specialRow?t="":a?t=o:(this.autoScaleThreshold&&n.rowHeight<this.autoScaleThreshold?i.style.fontSize=n.rowHeight/40+"em":i.style.fontSize="",t=this.template(r)),t}},{key:"imagePath",set:function(e){this.set("imagePath",e)},get:function(){return this.get("imagePath")||this.grid.resourceImagePath}},{key:"defaultImageName",set:function(e){this.set("defaultImageName",e)},get:function(){return this.get("defaultImageName")||this.grid.defaultResourceImageName}}],[{key:"type",get:function(){return"resourceInfo"}},{key:"fields",get:function(){return["showEventCount","showRole","showImage","imagePath","validNames","defaultImageName","autoScaleThreshold"]}},{key:"defaults",get:function(){return{showImage:!0,showEventCount:!0,showRole:!1,imagePath:null,validNames:["amit","angelo","arcady","arnold","celia","chang","dan","dave","emilia","george","gloria","henrik","hitomi","jong","kate","lee","linda","lisa","lola","macy","madison","malik","mark","maxim","mike","rob","steve"],defaultImageName:null,autoScaleThreshold:40,field:"name",htmlEncode:!1,width:140,cellCls:"b-resourceinfo-cell",autoSyncHtml:!0}}}]),t}(Rs);Ms.registerColumnType(Oh),Oh._$name="ResourceInfoColumn";var Ph=function(e){function t(){var e;C()(this,t),e=re()(this,oe()(t).call(this));var n=Bs()(e),r=[],i=[],o=[],a=!0,s=!1,l=void 0;try{for(var u,c=n.children[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;if("COLUMN"===d.tagName){var h=parseInt(d.dataset.width),f=parseInt(d.dataset.flex),g={field:d.dataset.field,text:d.innerHTML};h?g.width=h:g.flex=f||1,r.push(g)}else if("DATA"===d.tagName){var v=!0,m=!1,p=void 0;try{for(var y,k=d.children[Symbol.iterator]();!(v=(y=k.next()).done);v=!0){var b=y.value,w=!0,S=!1,E=void 0;try{for(var x,D=b.children[Symbol.iterator]();!(w=(x=D.next()).done);w=!0){var T=x.value,R={};Object.assign(R,T.dataset),"EVENTS"===b.tagName?o.push(R):"RESOURCES"===b.tagName&&i.push(R)}}catch(e){S=!0,E=e}finally{try{w||null==D.return||D.return()}finally{if(S)throw E}}}}catch(e){m=!0,p=e}finally{try{v||null==k.return||k.return()}finally{if(m)throw p}}}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}var M=e.attachShadow({mode:"open"}),F=document.createElement("link");return F.rel="stylesheet",F.href="../../build/scheduler.default.css",F.onload=function(){var e=document.createElement("div");e.id="container",e.style.width="100%",e.style.height="100%",M.appendChild(e),ur(M);var t={appendTo:e,columns:r,resources:i,events:o};Object.assign(t,n.dataset);var a=new lh(t);window.scheduler||(window.scheduler=a)},M.appendChild(F),e}return ue()(t,e),t}(window.customElements?HTMLElement:Object);try{window.customElements&&window.customElements.define("bryntum-scheduler",Ph)}catch(e){}Ph._$name="SchedulerTag",n.d(t,"Base",(function(){return z})),n.d(t,"Localizable",(function(){return Ve})),n.d(t,"LocaleManager",(function(){return je})),n.d(t,"AjaxHelper",(function(){return Pe})),n.d(t,"ArrayHelper",(function(){return He})),n.d(t,"BrowserHelper",(function(){return ge})),n.d(t,"CSSHelper",(function(){return Ha})),n.d(t,"DateHelper",(function(){return vt})),n.d(t,"DomHelper",(function(){return rn})),n.d(t,"DomSync",(function(){return Za})),n.d(t,"DomClassList",(function(){return bt})),n.d(t,"DragHelper",(function(){return qa})),n.d(t,"EventHelper",(function(){return Ln})),n.d(t,"FunctionHelper",(function(){return kn})),n.d(t,"IdHelper",(function(){return Z})),n.d(t,"ObjectHelper",(function(){return kt})),n.d(t,"ResizeHelper",(function(){return ls})),n.d(t,"StringHelper",(function(){return A})),n.d(t,"TemplateHelper",(function(){return Hr})),n.d(t,"VersionHelper",(function(){return I})),n.d(t,"WidgetHelper",(function(){return te})),n.d(t,"Point",(function(){return yn})),n.d(t,"Rectangle",(function(){return Oe})),n.d(t,"ResizeMonitor",(function(){return pn})),n.d(t,"GlobalEvents",(function(){return ir})),n.d(t,"DataGenerator",(function(){return cs})),n.d(t,"RandomGenerator",(function(){return us})),n.d(t,"DemoBot",(function(){return hs})),n.d(t,"Fullscreen",(function(){return fs})),n.d(t,"Scroller",(function(){return Qn})),n.d(t,"Delayable",(function(){return de})),n.d(t,"Events",(function(){return ze})),n.d(t,"InstancePlugin",(function(){return ai})),n.d(t,"Override",(function(){return vs})),n.d(t,"Pluggable",(function(){return li})),n.d(t,"State",(function(){return ui})),n.d(t,"BooleanCombo",(function(){return ms})),n.d(t,"Button",(function(){return Jr})),n.d(t,"ButtonGroup",(function(){return Qr})),n.d(t,"CalendarPanel",(function(){return Ji})),n.d(t,"Checkbox",(function(){return oi})),n.d(t,"Combo",(function(){return qi})),n.d(t,"Container",(function(){return Dr})),n.d(t,"Field",(function(){return ri})),n.d(t,"FileField",(function(){return ys})),n.d(t,"FilePicker",(function(){return ks})),n.d(t,"FlagField",(function(){return bs})),n.d(t,"DateField",(function(){return oo})),n.d(t,"DatePicker",(function(){return ro})),n.d(t,"DisplayField",(function(){return ws})),n.d(t,"DurationField",(function(){return Ss})),n.d(t,"List",(function(){return Vi})),n.d(t,"ChipView",(function(){return Gi})),n.d(t,"Mask",(function(){return dn})),n.d(t,"Menu",(function(){return Wr})),n.d(t,"MenuItem",(function(){return jr})),n.d(t,"MessageDialog",(function(){return Cs})),n.d(t,"NumberField",(function(){return lo})),n.d(t,"Tool",(function(){return mr})),n.d(t,"PagingToolbar",(function(){return Es})),n.d(t,"Panel",(function(){return _r})),n.d(t,"Popup",(function(){return Ar})),n.d(t,"Ripple",(function(){return wr})),n.d(t,"Slider",(function(){return co})),n.d(t,"Splitter",(function(){return Ts})),n.d(t,"TabPanel",(function(){return vo})),n.d(t,"TextField",(function(){return Oi})),n.d(t,"TextAreaField",(function(){return yo})),n.d(t,"TimeField",(function(){return bo})),n.d(t,"TimePicker",(function(){return ko})),n.d(t,"Toast",(function(){return Gr})),n.d(t,"Tooltip",(function(){return Ur})),n.d(t,"Widget",(function(){return vr})),n.d(t,"BryntumWidgetAdapter",(function(){return wo})),n.d(t,"BryntumWidgetAdapterRegister",(function(){return X})),n.d(t,"AjaxStore",(function(){return Ii})),n.d(t,"Model",(function(){return mi})),n.d(t,"Store",(function(){return Fi})),n.d(t,"StateTrackingManager",(function(){return Pa})),n.d(t,"Transaction",(function(){return Bo})),n.d(t,"AggregateColumn",(function(){return Fs})),n.d(t,"Column",(function(){return Rs})),n.d(t,"CheckColumn",(function(){return As})),n.d(t,"DateColumn",(function(){return Is})),n.d(t,"PercentColumn",(function(){return Ls})),n.d(t,"RatingColumn",(function(){return Ps})),n.d(t,"RowNumberColumn",(function(){return Hs})),n.d(t,"TemplateColumn",(function(){return zs})),n.d(t,"TimeColumn",(function(){return js})),n.d(t,"TreeColumn",(function(){return Ws})),n.d(t,"WidgetColumn",(function(){return _s})),n.d(t,"TimeAxisColumn",(function(){return th})),n.d(t,"ResourceInfoColumn",(function(){return Oh})),n.d(t,"GridFeatureManager",(function(){return Xs})),n.d(t,"CellEdit",(function(){return Qs})),n.d(t,"CellTooltip",(function(){return ll})),n.d(t,"ColumnPicker",(function(){return rl})),n.d(t,"ColumnReorder",(function(){return il})),n.d(t,"ColumnResize",(function(){return ol})),n.d(t,"ContextMenu",(function(){return al})),n.d(t,"Filter",(function(){return ul})),n.d(t,"FilterBar",(function(){return cl})),n.d(t,"Group",(function(){return dl})),n.d(t,"QuickFind",(function(){return hl})),n.d(t,"Search",(function(){return fl})),n.d(t,"Sort",(function(){return gl})),n.d(t,"RegionResize",(function(){return vl})),n.d(t,"RowReorder",(function(){return ml})),n.d(t,"Stripe",(function(){return pl})),n.d(t,"GridPdfExport",(function(){return Hl})),n.d(t,"GridSinglePageExporter",(function(){return _l})),n.d(t,"GridMultiPageExporter",(function(){return Fl})),n.d(t,"GridExportDialog",(function(){return Pl})),n.d(t,"PaperFormat",(function(){return xl})),n.d(t,"Orientation",(function(){return Dl})),n.d(t,"RowsRange",(function(){return El})),n.d(t,"FileFormat",(function(){return Tl})),n.d(t,"GridExcelExporter",(function(){return zl})),n.d(t,"Tree",(function(){return kl})),n.d(t,"GridBase",(function(){return Su})),n.d(t,"Grid",(function(){return Cu})),n.d(t,"TreeGrid",(function(){return Eu})),n.d(t,"TableExporter",(function(){return Nl})),n.d(t,"SchedulerCommon",(function(){return xu})),n.d(t,"AjaxTransport",(function(){return Du})),n.d(t,"AbstractCrudManager",(function(){return _u})),n.d(t,"JsonEncoder",(function(){return Au})),n.d(t,"ColumnStore",(function(){return Ms})),n.d(t,"AssignmentStore",(function(){return Lu})),n.d(t,"Calendar",(function(){return Nu})),n.d(t,"CrudManager",(function(){return hc})),n.d(t,"DependencyStore",(function(){return dc})),n.d(t,"EventStore",(function(){return sc})),n.d(t,"RecurringTimeSpansMixin",(function(){return Ju})),n.d(t,"RecurringEventsMixin",(function(){return Qu})),n.d(t,"AbstractRecurrenceIterator",(function(){return Wu})),n.d(t,"DailyRecurrenceIterator",(function(){return Gu})),n.d(t,"MonthlyRecurrenceIterator",(function(){return Xu})),n.d(t,"RecurrenceDayRuleEncoder",(function(){return qu})),n.d(t,"RecurrenceLegend",(function(){return fc})),n.d(t,"WeeklyRecurrenceIterator",(function(){return $u})),n.d(t,"YearlyRecurrenceIterator",(function(){return Ku})),n.d(t,"ResourceStore",(function(){return zu})),n.d(t,"ResourceTimeRangeStore",(function(){return vc})),n.d(t,"TimeAxis",(function(){return kc})),n.d(t,"ColumnLines",(function(){return bc})),n.d(t,"Dependencies",(function(){return _c})),n.d(t,"DependencyEdit",(function(){return Ic})),n.d(t,"EventContextMenu",(function(){return Oc})),n.d(t,"EventDrag",(function(){return Bc})),n.d(t,"EventDragCreate",(function(){return jc})),n.d(t,"EventDragSelect",(function(){return Vc})),n.d(t,"EventEdit",(function(){return ad})),n.d(t,"EventFilter",(function(){return sd})),n.d(t,"EventResize",(function(){return cd})),n.d(t,"EventTooltip",(function(){return hd})),n.d(t,"GroupSummary",(function(){return ch})),n.d(t,"HeaderContextMenu",(function(){return oh})),n.d(t,"HeaderZoom",(function(){return dh})),n.d(t,"Labels",(function(){return vh})),n.d(t,"NonWorkingTime",(function(){return ph})),n.d(t,"Pan",(function(){return yh})),n.d(t,"RecurringTimeSpans",(function(){return kh})),n.d(t,"RecurringEventEdit",(function(){return od})),n.d(t,"RecurringEvents",(function(){return bh})),n.d(t,"ResourceTimeRanges",(function(){return wh})),n.d(t,"ScheduleTooltip",(function(){return sh})),n.d(t,"SimpleEventEdit",(function(){return Sh})),n.d(t,"Summary",(function(){return Eh})),n.d(t,"TimeRanges",(function(){return xh})),n.d(t,"ExcelExporter",(function(){return Lh})),n.d(t,"PdfExport",(function(){return Ah})),n.d(t,"SinglePageExporter",(function(){return Fh})),n.d(t,"MultiPageExporter",(function(){return _h})),n.d(t,"SchedulerExportDialog",(function(){return Rh})),n.d(t,"ScheduleRange",(function(){return Dh})),n.d(t,"AssignmentModel",(function(){return Iu})),n.d(t,"CalendarDayModel",(function(){return Ou})),n.d(t,"DependencyBaseModel",(function(){return uc})),n.d(t,"DependencyModel",(function(){return cc})),n.d(t,"EventModel",(function(){return ac})),n.d(t,"RecurringTimeSpan",(function(){return oc})),n.d(t,"RecurrenceModel",(function(){return rc})),n.d(t,"ResourceModel",(function(){return Bu})),n.d(t,"ResourceTimeRangeModel",(function(){return gc})),n.d(t,"TimeSpan",(function(){return Hu})),n.d(t,"PresetStore",(function(){return pc})),n.d(t,"PresetManager",(function(){return yc})),n.d(t,"ViewPreset",(function(){return mc})),n.d(t,"RectangularPathFinder",(function(){return wc})),n.d(t,"ScheduleTableExporter",(function(){return Ih})),n.d(t,"TimeAxisViewModel",(function(){return md})),n.d(t,"HorizontalTimeAxis",(function(){return Zd})),n.d(t,"RecurrenceConfirmationPopup",(function(){return $c})),n.d(t,"RecurrenceEditor",(function(){return id})),n.d(t,"RecurrenceStopConditionCombo",(function(){return nd})),n.d(t,"RecurrenceCombo",(function(){return Kc})),n.d(t,"RecurrenceDaysCombo",(function(){return Qc})),n.d(t,"RecurrenceMonthsButtonGroup",(function(){return td})),n.d(t,"RecurrenceMonthDaysButtonGroup",(function(){return ed})),n.d(t,"RecurrenceFrequencyCombo",(function(){return Xc})),n.d(t,"RecurrencePositionsCombo",(function(){return rd})),n.d(t,"RecurrenceDaysButtonGroup",(function(){return Zc})),n.d(t,"RecurrenceLegendButton",(function(){return Jc})),n.d(t,"SchedulerBase",(function(){return ih})),n.d(t,"Scheduler",(function(){return lh})),n.d(t,"RowManager",(function(){return Wl})),n.d(t,"SchedulerTag",(function(){return Ph}));window.bryntum||(window.bryntum={})}])}));
//# sourceMappingURL=scheduler.umd.min.js.map